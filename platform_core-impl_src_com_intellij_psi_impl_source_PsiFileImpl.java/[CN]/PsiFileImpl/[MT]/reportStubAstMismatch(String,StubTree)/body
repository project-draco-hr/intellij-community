{
  rebuildStub();
  String msg=message;
  msg+="\n file=" + this;
  msg+="\n name=" + getName();
  msg+="\n stub debugInfo=" + stubTree.getDebugInfo();
  FileViewProvider viewProvider=getViewProvider();
  msg+="\n viewProvider=" + viewProvider;
  msg+="\n viewProvider stamp: " + viewProvider.getModificationStamp();
  VirtualFile file=viewProvider.getVirtualFile();
  msg+="; file stamp: " + file.getModificationStamp();
  msg+="; file modCount: " + file.getModificationCount();
  Document document=FileDocumentManager.getInstance().getCachedDocument(file);
  if (document != null) {
    msg+="\n doc saved: " + !FileDocumentManager.getInstance().isDocumentUnsaved(document);
    msg+="; doc stamp: " + document.getModificationStamp();
    msg+="; committed: " + PsiDocumentManager.getInstance(getProject()).isCommitted(document);
  }
  throw new AssertionError(msg);
}
