{
  PsiElement element=PsiTreeUtil.getParentOfType(file.findElementAt(editor.getCaretModel().getOffset()),PyBinaryExpression.class,false);
  while (element.getParent() instanceof PyBinaryExpression) {
    element=element.getParent();
  }
  StringBuilder stringLiteral=new StringBuilder();
  StringBuilder parameters=new StringBuilder("(");
  for (  PyExpression expression : getSimpleExpressions((PyBinaryExpression)element)) {
    if (expression instanceof PyStringLiteralExpression) {
      stringLiteral.append(((PyStringLiteralExpression)expression).getStringValue());
    }
 else {
      stringLiteral.append("%s");
      parameters.append(expression.getText()).append(", ");
    }
  }
  PyElementGenerator elementGenerator=PythonLanguage.getInstance().getElementGenerator();
  PyStringLiteralExpression stringLiteralExpression=elementGenerator.createStringLiteralAlreadyEscaped(project,"\"" + stringLiteral.toString() + "\"");
  PyParenthesizedExpression expression=(PyParenthesizedExpression)elementGenerator.createFromText(project,PyExpressionStatement.class,parameters.substring(0,parameters.length() - 2) + ")").getExpression();
  element.replace(elementGenerator.createBinaryExpression(project,"%",stringLiteralExpression,expression));
}
