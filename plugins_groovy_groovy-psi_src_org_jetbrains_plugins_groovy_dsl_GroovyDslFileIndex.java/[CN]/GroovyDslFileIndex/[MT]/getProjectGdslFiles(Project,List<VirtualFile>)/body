{
  if (result == null)   result=ContainerUtil.newArrayList();
  final ProjectFileIndex fileIndex=ProjectRootManager.getInstance(project).getFileIndex();
  final GlobalSearchScope scope=GlobalSearchScope.allScope(project);
  for (  VirtualFile vfile : FileBasedIndex.getInstance().getContainingFiles(NAME,OUR_KEY,scope)) {
    if (!vfile.isValid()) {
      continue;
    }
    if (!GdslUtil.GDSL_FILTER.value(vfile)) {
      LOG.error("Index returned non-gdsl file: " + vfile);
      continue;
    }
    if (fileIndex.isInLibrarySource(vfile)) {
      continue;
    }
    if (!fileIndex.isInLibraryClasses(vfile)) {
      if (!fileIndex.isInSourceContent(vfile) || !isActivated(vfile)) {
        continue;
      }
    }
    result.add(vfile);
  }
  return result;
}
