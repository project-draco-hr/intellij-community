{
  try {
    Binding binding=new Binding();
    if (result != null) {
      for (      MatchResult r : result.getMatches()) {
        binding.setVariable(r.getName(),r.getMatchRef().getElement());
      }
    }
    if (context == null) {
      context=result.getMatchRef().getElement();
    }
    if (context instanceof PsiIdentifier)     context=context.getParent();
    binding.setVariable("__context__",context);
    script.setBinding(binding);
    Object o=script.run();
    return String.valueOf(o);
  }
 catch (  GroovyRuntimeException ex) {
    LoggerFactory.getInstance().getLoggerInstance(getClass().getName()).error(ex);
    return StringUtil.convertLineSeparators(ex.getLocalizedMessage());
  }
}
