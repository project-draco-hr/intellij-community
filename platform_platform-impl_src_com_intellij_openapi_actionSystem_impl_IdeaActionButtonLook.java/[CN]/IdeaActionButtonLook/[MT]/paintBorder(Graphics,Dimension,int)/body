{
  GraphicsConfig config=GraphicsUtil.setupAAPainting(g);
  try {
    if (UIUtil.isUnderAquaLookAndFeel()) {
      if (state == ActionButtonComponent.POPPED) {
        g.setColor(JBColor.GRAY);
        g.drawRoundRect(2,2,size.width - 3,size.height - 3,4,4);
      }
    }
 else {
      final double shift=UIUtil.isUnderDarcula() ? 1 / 0.49 : 0.49;
      g.setColor(ColorUtil.shift(UIUtil.getPanelBackground(),shift));
      ((Graphics2D)g).setStroke(BASIC_STROKE);
      g.drawRoundRect(2,2,size.width - 3,size.height - 3,4,4);
    }
  }
  finally {
    config.restore();
  }
}
