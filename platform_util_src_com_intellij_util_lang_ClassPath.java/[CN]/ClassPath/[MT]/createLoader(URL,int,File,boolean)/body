{
  if (file.isDirectory()) {
    return new FileLoader(url,index,myCanHavePersistentIndex);
  }
 else   if (file.isFile()) {
    Loader loader=new JarLoader(url,myCanLockJars,index,myPreloadJarContents);
    if (processRecursively) {
      String[] referencedJars=loadManifestClasspath(file);
      if (referencedJars != null) {
        for (        String referencedJar : referencedJars) {
          try {
            URI uri=new URI(referencedJar);
            File referencedFile=new File(uri);
            URL referencedUrl=uri.toURL();
            Loader referencedLoader=createLoader(referencedUrl,index++,referencedFile,false);
            if (referencedLoader != null) {
              initLoader(referencedUrl,false,referencedLoader);
            }
          }
 catch (          Exception e) {
            Logger.getInstance(ClassPath.class).info("url: " + url + " / "+ referencedJar,e);
          }
        }
      }
    }
    return loader;
  }
  return null;
}
