{
  PyReferenceExpression seeker=this;
  ResolveResult ret=null;
  SEARCH:   while (ret == null) {
    ResolveResult[] targets=seeker.getReference().multiResolve(false);
    for (    ResolveResult target : targets) {
      PsiElement elt=target.getElement();
      if (elt instanceof PyTargetExpression) {
        PyExpression assigned_from=((PyTargetExpression)elt).findAssignedValue();
        if (assigned_from instanceof PyReferenceExpression) {
          seeker=(PyReferenceExpression)assigned_from;
          continue SEARCH;
        }
 else         if (assigned_from != null)         ret=new PsiElementResolveResult(assigned_from);
      }
 else       if (ret == null && elt instanceof PyElement) {
        ret=target;
      }
    }
    break;
  }
  if (ret == null) {
    ret=new ResolveResult(){
      public PsiElement getElement(){
        return null;
      }
      public boolean isValidResult(){
        return false;
      }
    }
;
  }
  return ret;
}
