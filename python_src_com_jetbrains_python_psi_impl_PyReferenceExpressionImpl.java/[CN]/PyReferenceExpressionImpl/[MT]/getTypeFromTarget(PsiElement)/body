{
  if (target instanceof PyTargetExpression && PyNames.NONE.equals(((PyTargetExpression)target).getName())) {
    return PyNoneType.INSTANCE;
  }
  if (target instanceof PyFile) {
    return new PyModuleType((PyFile)target);
  }
  if (target instanceof PyExpression) {
    return ((PyExpression)target).getType();
  }
  if (target instanceof PyClass) {
    return new PyClassType((PyClass)target,true);
  }
  if (target instanceof PsiDirectory) {
    PsiFile file=((PsiDirectory)target).findFile(PyNames.INIT_DOT_PY);
    if (file != null)     return getTypeFromTarget(file);
  }
  return getReferenceTypeFromProviders(target);
}
