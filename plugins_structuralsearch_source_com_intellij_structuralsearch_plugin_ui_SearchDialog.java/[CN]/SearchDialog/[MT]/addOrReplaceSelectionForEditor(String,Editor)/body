{
  final Project project=searchContext.getProject();
  UIUtil.setContent(editor,selection,0,-1,project);
  final Document document=editor.getDocument();
  editor.getSelectionModel().setSelection(0,document.getTextLength());
  final PsiDocumentManager documentManager=PsiDocumentManager.getInstance(project);
  documentManager.commitDocument(document);
  final PsiFile file=documentManager.getPsiFile(document);
  if (file == null)   return;
  new WriteCommandAction(project,file){
    @Override protected void run(    @NotNull Result result) throws Throwable {
      CodeStyleManager.getInstance(project).adjustLineIndent(file,new TextRange(0,document.getTextLength()));
    }
  }
.execute();
}
