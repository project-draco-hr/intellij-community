{
  Editor editor=null;
  if (fileTypes != null) {
    final String selectedFileTypeName=(String)fileTypes.getSelectedItem();
    if (selectedFileTypeName != null) {
      final FileType fileType=getFileTypeByName(selectedFileTypeName);
      final Language dialect=(Language)dialects.getSelectedItem();
      if (fileType != null) {
        final StructuralSearchProfile profile=StructuralSearchUtil.getProfileByFileType(fileType);
        if (profile != null) {
          editor=profile.createEditor(searchContext,fileType,dialect,text,useLastConfiguration);
        }
      }
    }
  }
  if (editor == null) {
    final EditorFactory factory=EditorFactory.getInstance();
    final Document document=factory.createDocument("");
    editor=factory.createEditor(document,searchContext.getProject());
    editor.getSettings().setFoldingOutlineShown(false);
  }
  editor.getDocument().addDocumentListener(new DocumentListener(){
    public void beforeDocumentChange(    final DocumentEvent event){
    }
    public void documentChanged(    final DocumentEvent event){
      initiateValidation();
    }
  }
);
  return editor;
}
