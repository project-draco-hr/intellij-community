{
  myContentPanel=new JPanel(new BorderLayout());
  myEditorPanel=createEditorContent();
  myContentPanel.add(BorderLayout.CENTER,myEditorPanel);
  myContentPanel.add(BorderLayout.SOUTH,Box.createVerticalStrut(8));
  JComponent centerPanel=new JPanel(new BorderLayout());
{
    JPanel panel=new JPanel(new BorderLayout());
    panel.add(BorderLayout.CENTER,myContentPanel);
    panel.add(BorderLayout.SOUTH,createTemplateManagementButtons());
    centerPanel.add(BorderLayout.CENTER,panel);
  }
  JPanel optionsContent=new JPanel(new BorderLayout());
  centerPanel.add(BorderLayout.SOUTH,optionsContent);
  JPanel searchOptions=new JPanel();
  searchOptions.setLayout(new GridLayout(getRowsCount(),1,0,0));
  searchOptions.setBorder(IdeBorderFactory.createTitledBorder(SSRBundle.message("ssdialog.options.group.border"),true));
  myScopeChooserCombo=new ScopeChooserCombo(searchContext.getProject(),true,false,FindSettings.getInstance().getDefaultScopeName());
  Disposer.register(myDisposable,myScopeChooserCombo);
  JPanel allOptions=new JPanel(new BorderLayout());
  if (myShowScopePanel) {
    JPanel scopePanel=new JPanel(new GridBagLayout());
    TitledSeparator separator=new TitledSeparator(SSRBundle.message("search.dialog.scope.label"),myScopeChooserCombo.getComboBox());
    scopePanel.add(separator,new GridBagConstraints(0,0,1,1,1,1,GridBagConstraints.WEST,GridBagConstraints.HORIZONTAL,new Insets(5,0,0,0),0,0));
    scopePanel.add(myScopeChooserCombo,new GridBagConstraints(0,1,1,1,1,1,GridBagConstraints.WEST,GridBagConstraints.HORIZONTAL,new Insets(0,10,0,0),0,0));
    allOptions.add(scopePanel,BorderLayout.SOUTH);
    myScopeChooserCombo.getComboBox().addItemListener(new ItemListener(){
      @Override public void itemStateChanged(      ItemEvent e){
        initiateValidation();
      }
    }
);
  }
  buildOptions(searchOptions);
  allOptions.add(searchOptions,BorderLayout.CENTER);
  optionsContent.add(allOptions,BorderLayout.CENTER);
  if (myRunFindActionOnClose) {
    JPanel panel=new JPanel(new BorderLayout());
    panel.setBorder(BorderFactory.createEmptyBorder(0,4,0,0));
    openInNewTab=new JCheckBox(SSRBundle.message("open.in.new.tab.checkbox"));
    openInNewTab.setSelected(ourOpenInNewTab);
    ToolWindow findWindow=ToolWindowManager.getInstance(searchContext.getProject()).getToolWindow(ToolWindowId.FIND);
    openInNewTab.setEnabled(findWindow != null && findWindow.isAvailable());
    panel.add(openInNewTab,BorderLayout.EAST);
    optionsContent.add(BorderLayout.SOUTH,panel);
  }
  updateEditor();
  return centerPanel;
}
