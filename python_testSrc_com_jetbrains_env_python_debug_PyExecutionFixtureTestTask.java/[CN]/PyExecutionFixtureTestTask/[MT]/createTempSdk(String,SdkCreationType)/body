{
  final VirtualFile binary=LocalFileSystem.getInstance().findFileByPath(sdkHome);
  Assert.assertNotNull("Interpreter file not found: " + sdkHome,binary);
  final Ref<Sdk> ref=Ref.create();
  UsefulTestCase.edt(new Runnable(){
    @Override public void run(){
      final Sdk sdk=SdkConfigurationUtil.setupSdk(new Sdk[0],binary,PythonSdkType.getInstance(),true,null,null);
      Assert.assertNotNull(sdk);
      ref.set(sdk);
    }
  }
);
  final Sdk sdk=ref.get();
  if (sdkCreationType != SdkCreationType.EMPTY_SDK) {
    generateTempSkeletonsOrPackages(sdk,sdkCreationType == SdkCreationType.SDK_PACKAGES_AND_SKELETONS);
  }
  UsefulTestCase.edt(new Runnable(){
    @Override public void run(){
      SdkConfigurationUtil.addSdk(sdk);
    }
  }
);
  return sdk;
}
