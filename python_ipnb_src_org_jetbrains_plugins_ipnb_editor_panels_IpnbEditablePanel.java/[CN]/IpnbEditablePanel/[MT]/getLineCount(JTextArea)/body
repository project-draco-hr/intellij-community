{
  int totalCharacters=textArea.getText().length();
  int lineCount=1;
  try {
    int offset=totalCharacters;
    while (offset > 0) {
      offset=Utilities.getRowStart(textArea,offset) - 1;
      lineCount++;
    }
  }
 catch (  BadLocationException e) {
    return 1;
  }
  return lineCount;
}
