{
  AsyncResult<VALUE> asyncResult=fieldUpdater.get(host);
  if (asyncResult == null) {
    if (!fieldUpdater.compareAndSet(host,null,asyncResult=new AsyncResult<VALUE>())) {
      return fieldUpdater.get(host);
    }
  }
 else   if (!asyncResult.isProcessed()) {
    return asyncResult;
  }
 else   if (asyncResult.isDone()) {
    if (!checkFreshness || isUpToDate(host,asyncResult.getResult())) {
      return asyncResult;
    }
    if (!fieldUpdater.compareAndSet(host,asyncResult,asyncResult=new AsyncResult<VALUE>())) {
      AsyncResult<VALUE> valueFromAnotherThread=fieldUpdater.get(host);
      while (valueFromAnotherThread == null) {
        if (fieldUpdater.compareAndSet(host,null,asyncResult)) {
          if (load) {
            load(host,asyncResult);
          }
          return asyncResult;
        }
 else {
          valueFromAnotherThread=fieldUpdater.get(host);
        }
      }
      return valueFromAnotherThread;
    }
  }
  if (load) {
    load(host,asyncResult);
  }
  return asyncResult;
}
