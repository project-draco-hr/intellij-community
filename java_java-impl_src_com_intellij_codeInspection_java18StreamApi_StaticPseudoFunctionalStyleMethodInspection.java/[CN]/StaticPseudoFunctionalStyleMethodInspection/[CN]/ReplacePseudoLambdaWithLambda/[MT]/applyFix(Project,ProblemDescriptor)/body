{
  PsiMethodCallExpression expression=PsiTreeUtil.getParentOfType(descriptor.getPsiElement(),PsiMethodCallExpression.class);
  LOG.assertTrue(expression != null);
  final PsiExpression[] expressions=expression.getArgumentList().getExpressions();
  PsiExpression lambdaExpression=expressions[myLambdaIndex];
  lambdaExpression=convertToJavaLambda(lambdaExpression,mySuitableHandler.getStreamApiMethodName());
  LOG.assertTrue(lambdaExpression != null);
  final PsiExpression collectionExpression=expressions[(1 + myLambdaIndex) % 2];
  final String pipelineHead=createPipelineHeadText(collectionExpression);
  final String patternForFake=StreamApiConstants.FAKE_STREAM_API_METHODS_TO_PATTERN.getValue().get(mySuitableHandler.getStreamApiMethodName());
  final String lambdaExpressionText;
  final String elementText;
  if (patternForFake == null) {
    elementText=mySuitableHandler.getStreamApiMethodName();
    lambdaExpressionText=lambdaExpression.getText();
  }
 else {
    elementText=String.format(patternForFake,lambdaExpression.getText());
    lambdaExpressionText=null;
  }
  final String pipelineTail=StreamApiConstants.STREAM_STREAM_API_METHODS.getValue().contains(mySuitableHandler.getStreamApiMethodName()) ? findSuitableTailMethodForCollection(myMethodPointer.getElement()) : null;
  final PsiElement replaced=expression.replace(createPipelineExpression(pipelineHead,elementText,lambdaExpressionText,pipelineTail,project));
  JavaCodeStyleManager.getInstance(project).shortenClassReferences(replaced.getParent());
}
