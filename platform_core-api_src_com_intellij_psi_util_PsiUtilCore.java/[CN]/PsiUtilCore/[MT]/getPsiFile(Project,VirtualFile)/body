{
  PsiManager psiManager=PsiManager.getInstance(project);
  PsiFile psi=psiManager.findFile(file);
  if (psi != null)   return psi;
  FileType fileType=file.getFileType();
  FileViewProvider viewProvider=psiManager.findViewProvider(file);
  Document document=FileDocumentManager.getInstance().getDocument(file);
  StringBuilder sb=new StringBuilder();
  sb.append("valid=").append(file.isValid()).append(" isDirectory=").append(file.isDirectory()).append(" hasDocument=").append(document != null).append(" length=").append(file.getLength());
  sb.append("\nproject=").append(project.getName()).append(" default=").append(project.isDefault()).append(" open=").append(project.isOpen());
  ;
  sb.append("\nfileType=").append(fileType.getName()).append("/").append(fileType.getClass().getName());
  sb.append("\nviewProvider=").append(viewProvider == null ? "null" : viewProvider.getClass().getName());
  if (viewProvider != null) {
    List<PsiFile> files=viewProvider.getAllFiles();
    sb.append(" language=").append(viewProvider.getBaseLanguage().getID());
    sb.append(" physical=").append(viewProvider.isPhysical());
    sb.append(" rootCount=").append(files.size());
    for (    PsiFile o : files) {
      sb.append("\n  root=").append(o.getLanguage().getID()).append("/").append(o.getClass().getName());
    }
  }
  LOG.error("no PSI for file '" + file.getName() + "'",new Attachment(file.getPresentableUrl(),sb.toString()));
  throw new AssertionError();
}
