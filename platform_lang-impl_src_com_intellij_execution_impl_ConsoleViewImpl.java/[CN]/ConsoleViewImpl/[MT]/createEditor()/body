{
  return ApplicationManager.getApplication().runReadAction(new Computable<EditorEx>(){
    @Override public EditorEx compute(){
      final EditorEx editor=createRealEditor();
      editor.addEditorMouseListener(new EditorPopupHandler(){
        @Override public void invokePopup(        final EditorMouseEvent event){
          popupInvoked(event.getMouseEvent());
        }
      }
);
      final int bufferSize=myBuffer.isUseCyclicBuffer() ? myBuffer.getCyclicBufferSize() : 0;
      editor.getDocument().setCyclicBufferSize(bufferSize);
      editor.putUserData(CONSOLE_VIEW_IN_EDITOR_VIEW,ConsoleViewImpl.this);
      return editor;
    }
  }
);
}
