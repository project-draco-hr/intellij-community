{
  for (  PsiReference ref : refs) {
    final PsiElement element=ref.getElement();
    if (checkRangeContainsOffset(offset,ref.getRangeInElement(),element))     return element;
  }
  if (nameIdentifier != null) {
    final TextRange range=nameIdentifier.getTextRange();
    if (range != null && checkRangeContainsOffset(offset,range,nameIdentifier,0))     return nameIdentifier;
  }
  for (  Pair<PsiElement,TextRange> stringUsage : stringUsages) {
    if (checkRangeContainsOffset(offset,stringUsage.second,stringUsage.first))     return stringUsage.first;
  }
  LOG.error(nameIdentifier + " by " + this.getClass().getName());
  return null;
}
