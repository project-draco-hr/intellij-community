{
  ProgressManager.getInstance().run(new Task.Backgroundable(myContext.getProject(),"Loading Templates"){
    @Override public void run(    @NotNull ProgressIndicator indicator){
      try {
        myTemplatesList.setPaintBusy(true);
        RemoteTemplatesFactory factory=new RemoteTemplatesFactory();
        String[] groups=factory.getGroups();
        for (        String group : groups) {
          ProjectTemplate[] templates=factory.createTemplates(group,myContext);
          for (          ProjectTemplate template : templates) {
            String id=((ArchivedProjectTemplate)template).getCategory();
            myTemplates.putValue(id == null ? group : id,template);
          }
        }
        SwingUtilities.invokeLater(new Runnable(){
          public void run(){
            int index=myTemplatesList.getSelectedIndex();
            ProjectCategory type=myProjectTypesList.getSelectedType();
            if (type != null) {
              updateTemplates(type,false);
            }
            myTemplatesList.setSelectedIndex(index);
          }
        }
);
      }
  finally {
        myTemplatesList.setPaintBusy(false);
      }
    }
  }
);
}
