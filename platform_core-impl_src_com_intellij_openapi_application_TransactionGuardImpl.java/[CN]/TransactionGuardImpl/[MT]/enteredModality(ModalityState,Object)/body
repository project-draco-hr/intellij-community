{
  TransactionIdImpl contextTransaction=getContextTransaction();
  if (contextTransaction != null) {
    myModality2Transaction.put(modality,contextTransaction);
  }
  if (myWritingAllowed) {
    myWriteSafeModalities.add(modality);
  }
 else   if (myUnsafeModality == null) {
    myUnsafeModality=modalityObject;
  }
}
