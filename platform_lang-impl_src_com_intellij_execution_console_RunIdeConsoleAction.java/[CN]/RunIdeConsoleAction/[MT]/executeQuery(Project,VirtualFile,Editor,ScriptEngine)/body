{
  TextRange selectedRange=EditorUtil.getSelectionInAnyMode(editor);
  if (selectedRange.getLength() == 0)   return;
  String command=editor.getDocument().getText(selectedRange);
  ConsoleView consoleView=getConsoleView(project,file,engine);
  try {
    consoleView.print("> " + command,ConsoleViewContentType.USER_INPUT);
    consoleView.print("\n",ConsoleViewContentType.USER_INPUT);
    Object o=engine.eval(command);
    String string=o == null ? "nil" : String.valueOf(o);
    consoleView.print(string,ConsoleViewContentType.NORMAL_OUTPUT);
    consoleView.print("\n",ConsoleViewContentType.NORMAL_OUTPUT);
  }
 catch (  Exception e) {
    consoleView.print(e.getMessage(),ConsoleViewContentType.ERROR_OUTPUT);
    consoleView.print("\n",ConsoleViewContentType.ERROR_OUTPUT);
  }
}
