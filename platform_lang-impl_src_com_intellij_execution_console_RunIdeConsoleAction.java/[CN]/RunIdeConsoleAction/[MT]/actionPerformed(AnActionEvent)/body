{
  Engines.prepareEngines(true);
  if (Engines.ourEngines.size() == 1) {
    runConsole(e,Engines.ourEngines.values().iterator().next());
  }
 else {
    List<ScriptEngineFactory> engines=ContainerUtil.newArrayList(Engines.ourEngines.values());
    ContainerUtil.removeDuplicates(engines);
    DefaultActionGroup actions=new DefaultActionGroup(ContainerUtil.map(engines,new NotNullFunction<ScriptEngineFactory,AnAction>(){
      @NotNull @Override public AnAction fun(      final ScriptEngineFactory engine){
        return new AnAction(engine.getLanguageName()){
          @Override public void actionPerformed(          @NotNull AnActionEvent e){
            runConsole(e,engine);
          }
        }
;
      }
    }
));
    JBPopupFactory.getInstance().createActionGroupPopup("Script Engine",actions,e.getDataContext(),JBPopupFactory.ActionSelectionAid.NUMBERING,false).showInBestPositionFor(e.getDataContext());
  }
}
