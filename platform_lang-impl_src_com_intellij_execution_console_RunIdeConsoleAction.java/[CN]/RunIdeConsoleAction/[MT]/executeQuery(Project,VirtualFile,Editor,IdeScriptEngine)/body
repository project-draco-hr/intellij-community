{
  String command=getCommand(editor);
  String profile=getProfile(file);
  RunContentDescriptor descriptor=getConsoleView(project,file);
  ConsoleViewImpl consoleView=(ConsoleViewImpl)descriptor.getExecutionConsole();
  prepareEngine(project,engine,descriptor);
  try {
    consoleView.print("> " + command,ConsoleViewContentType.USER_INPUT);
    consoleView.print("\n",ConsoleViewContentType.USER_INPUT);
    Object o=engine.eval(profile == null ? command : profile + "\n" + command);
    consoleView.print("=> " + o,ConsoleViewContentType.NORMAL_OUTPUT);
    consoleView.print("\n",ConsoleViewContentType.NORMAL_OUTPUT);
  }
 catch (  Throwable e) {
    Throwable ex=ExceptionUtil.getRootCause(e);
    consoleView.print(ex.getClass().getSimpleName() + ": " + ex.getMessage(),ConsoleViewContentType.ERROR_OUTPUT);
    consoleView.print("\n",ConsoleViewContentType.ERROR_OUTPUT);
  }
  selectContent(descriptor);
}
