{
  MacrosDialog dialog=new MacrosDialog(myProject);
  if (dialog.showAndGet() && dialog.getSelectedMacro() != null) {
    String macro=dialog.getSelectedMacro().getName();
    int position=myTextField.getCaretPosition();
    try {
      myTextField.getDocument().insertString(position,"$" + macro + "$",null);
      myTextField.setCaretPosition(position + macro.length() + 2);
    }
 catch (    BadLocationException ignored) {
    }
    ;
  }
  IdeFocusManager.findInstance().requestFocus(myTextField,true);
}
