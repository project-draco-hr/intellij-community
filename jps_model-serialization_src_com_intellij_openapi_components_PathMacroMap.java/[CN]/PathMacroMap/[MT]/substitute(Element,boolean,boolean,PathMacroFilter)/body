{
  for (  Content child : e.getContent()) {
    if (child instanceof Element) {
      substitute((Element)child,caseSensitive,recursively,filter);
    }
 else     if (child instanceof Text) {
      Text t=(Text)child;
      if (filter == null || !filter.skipPathMacros(t)) {
        t.setText((recursively || (filter != null && filter.recursePathMacros(t))) ? substituteRecursively(t.getText(),caseSensitive) : substitute(t.getText(),caseSensitive));
      }
    }
 else     if (!(child instanceof Comment)) {
      LOG.error("Wrong content: " + child.getClass());
    }
  }
  for (  Attribute attribute : e.getAttributes()) {
    if (filter == null || !filter.skipPathMacros(attribute)) {
      attribute.setValue((recursively || (filter != null && filter.recursePathMacros(attribute))) ? substituteRecursively(attribute.getValue(),caseSensitive) : substitute(attribute.getValue(),caseSensitive));
    }
  }
}
