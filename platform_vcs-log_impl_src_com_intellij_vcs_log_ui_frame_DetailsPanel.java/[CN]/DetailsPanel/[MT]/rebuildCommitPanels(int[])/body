{
  myEmptyText.setText("");
  int selectionLength=selection.length;
  int existingCount=(myMainContentPanel.getComponentCount() + 1) / 2;
  int requiredCount=Math.min(selectionLength,MAX_ROWS);
  for (int i=existingCount; i < requiredCount; i++) {
    if (i > 0) {
      myMainContentPanel.add(new SeparatorComponent(0,OnePixelDivider.BACKGROUND,null));
    }
    int index=i;
    myMainContentPanel.add(new CommitPanel(myLogData,myColorManager,myDataPack){
      @Override public Dimension getMaximumSize(){
        Dimension preferredSize=super.getPreferredSize();
        if (index == mySelection.size() - 1) {
          Dimension maximumSize=super.getMaximumSize();
          return new Dimension(preferredSize.width,maximumSize.height);
        }
        return preferredSize;
      }
    }
);
  }
  while (myMainContentPanel.getComponentCount() > 2 * requiredCount - 1) {
    myMainContentPanel.remove(myMainContentPanel.getComponentCount() - 1);
  }
  if (selectionLength > MAX_ROWS) {
    myMainContentPanel.add(new SeparatorComponent(0,OnePixelDivider.BACKGROUND,null));
    JBLabel label=new JBLabel("(showing " + MAX_ROWS + " of "+ selectionLength+ " selected commits)");
    label.setFont(CommitPanel.getCommitDetailsFont());
    label.setBorder(JBUI.Borders.empty(VcsLogGraphTable.ROOT_INDICATOR_WHITE_WIDTH / 2,myColorManager.isMultipleRoots() ? VcsLogGraphTable.ROOT_INDICATOR_WHITE_WIDTH + VcsLogGraphTable.ROOT_INDICATOR_COLORED_WIDTH : VcsLogGraphTable.ROOT_INDICATOR_WHITE_WIDTH / 2,CommitPanel.BOTTOM_BORDER,0));
    myMainContentPanel.add(label);
  }
  for (int i=myMainContentPanel.getComponentCount() - 1; i >= 0; i--) {
    ((JComponent)myMainContentPanel.getComponent(i)).setAlignmentX(LEFT_ALIGNMENT);
  }
  mySelection=Ints.asList(Arrays.copyOf(selection,requiredCount));
  repaint();
}
