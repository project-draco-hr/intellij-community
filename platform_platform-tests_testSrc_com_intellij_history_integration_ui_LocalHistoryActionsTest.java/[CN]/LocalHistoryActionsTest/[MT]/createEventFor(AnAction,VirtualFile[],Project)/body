{
  DataContext dc=new DataContext(){
    @Override @Nullable public Object getData(    String id){
      if (CommonDataKeys.VIRTUAL_FILE_ARRAY.is(id))       return files;
      if (CommonDataKeys.EDITOR.is(id))       return editor;
      if (CommonDataKeys.PROJECT.is(id))       return p;
      return null;
    }
  }
;
  return new AnActionEvent(null,dc,"",a.getTemplatePresentation(),ActionManager.getInstance(),-1);
}
