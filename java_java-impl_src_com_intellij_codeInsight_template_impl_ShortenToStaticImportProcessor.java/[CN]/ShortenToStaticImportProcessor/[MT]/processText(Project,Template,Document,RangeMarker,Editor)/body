{
  if (!template.getValue(Template.Property.USE_STATIC_IMPORT_IF_POSSIBLE)) {
    return;
  }
  PsiDocumentManager.getInstance(project).commitDocument(document);
  final PsiFile file=PsiUtilBase.getPsiFileInEditor(editor,project);
  if (file == null) {
    return;
  }
  List<Pair<PsiElement,StaticImporter>> staticImportTargets=new ArrayList<Pair<PsiElement,StaticImporter>>();
  for (PsiElement element=PsiUtilCore.getElementAtOffset(file,templateRange.getStartOffset()); element != null && element.getTextRange().getStartOffset() < templateRange.getEndOffset(); element=getNext(element)) {
    for (    StaticImporter importer : IMPORTERS) {
      if (importer.canPerform(element)) {
        staticImportTargets.add(Pair.create(element,importer));
        break;
      }
    }
  }
  Collections.reverse(staticImportTargets);
  for (  Pair<PsiElement,StaticImporter> pair : staticImportTargets) {
    if (pair.first.isValid()) {
      pair.second.perform(project,file,editor,pair.first);
    }
  }
}
