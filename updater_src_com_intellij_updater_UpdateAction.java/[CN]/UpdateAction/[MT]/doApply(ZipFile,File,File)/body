{
  File source=getSource(backupDir);
  File updated;
  if (!myIsMove) {
    updated=Utils.createTempFile();
    InputStream in=Utils.findEntryInputStream(patchFile,myPath);
    boolean executable=readExecutableFlag(in);
    OutputStream out=new BufferedOutputStream(new FileOutputStream(updated));
    try {
      InputStream oldFileIn=Utils.newFileInputStream(source,myPatch.isNormalized());
      try {
        applyDiff(in,oldFileIn,out);
      }
  finally {
        oldFileIn.close();
      }
    }
  finally {
      out.close();
    }
    Utils.setExecutable(updated,executable);
  }
 else {
    updated=source;
  }
  replaceUpdated(updated,toFile);
}
