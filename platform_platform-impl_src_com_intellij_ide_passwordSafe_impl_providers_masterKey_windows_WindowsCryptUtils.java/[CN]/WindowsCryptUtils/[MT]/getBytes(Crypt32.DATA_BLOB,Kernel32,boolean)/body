{
  if (!rc) {
    W32API.DWORD drc=kernel.GetLastError();
    throw new MasterPasswordUnavailableException("CryptProtectData failed: " + drc.intValue());
  }
 else {
    byte[] output=new byte[out.cbData.intValue()];
    out.pbData.read(0,output,0,output.length);
    kernel.LocalFree(out.pbData);
    return output;
  }
}
