{
  if (!(commenter instanceof EscapingCommenter))   return range;
  RangeMarker marker=myDocument.createRangeMarker(range);
  if (escape) {
    ((EscapingCommenter)commenter).escape(myDocument,range);
  }
 else {
    ((EscapingCommenter)commenter).unescape(myDocument,range);
  }
  return TextRange.create(marker.getStartOffset(),marker.getEndOffset());
}
