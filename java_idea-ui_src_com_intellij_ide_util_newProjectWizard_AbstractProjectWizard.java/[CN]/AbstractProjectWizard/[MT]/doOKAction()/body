{
  final Ref<Boolean> result=Ref.create(false);
  DumbService.allowStartingDumbModeInside(DumbModePermission.MAY_START_BACKGROUND,new Runnable(){
    @Override public void run(){
      result.set(doFinishAction());
    }
  }
);
  if (!result.get())   return;
  super.doOKAction();
}
