{
  try {
    String url=getUrl(descriptor,host,buildNumber);
    String id=descriptor.getPluginId().getIdString();
    PluginDownloader downloader=new PluginDownloader(id,url,descriptor.getName(),descriptor.getVersion(),buildNumber,forceHttps);
    downloader.setDescriptor(descriptor);
    downloader.setDescription(descriptor.getDescription());
    List<PluginId> depends;
    if (descriptor instanceof PluginNode) {
      depends=((PluginNode)descriptor).getDepends();
    }
 else {
      depends=new ArrayList<PluginId>(Arrays.asList(descriptor.getDependentPluginIds()));
    }
    downloader.setDepends(depends);
    return downloader;
  }
 catch (  URISyntaxException e) {
    throw new IOException(e);
  }
}
