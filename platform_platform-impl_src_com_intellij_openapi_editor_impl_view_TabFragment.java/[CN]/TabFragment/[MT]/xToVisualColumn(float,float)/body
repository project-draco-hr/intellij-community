{
  if (x <= startX)   return 0;
  float nextTabStop=getNextTabStop(startX);
  if (x >= nextTabStop)   return getVisualColumnCount(startX);
  if (myEditor.getSettings().isCaretInsideTabs()) {
    int plainSpaceWidth=myView.getPlainSpaceWidth();
    return ((int)(x - startX) + plainSpaceWidth / 2) / plainSpaceWidth;
  }
 else {
    return x > (startX + nextTabStop) / 2 ? getVisualColumnCount(startX) : 0;
  }
}
