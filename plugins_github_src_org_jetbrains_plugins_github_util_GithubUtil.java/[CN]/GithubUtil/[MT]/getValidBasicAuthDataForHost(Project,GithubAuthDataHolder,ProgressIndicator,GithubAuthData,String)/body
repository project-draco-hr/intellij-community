{
  authHolder.runTransaction(oldAuth,new ThrowableComputable<GithubAuthData,GithubOperationCanceledException>(){
    @Override @NotNull public GithubAuthData compute() throws GithubOperationCanceledException {
      final GithubAuthData[] authData=new GithubAuthData[1];
      final boolean[] ok=new boolean[1];
      ApplicationManager.getApplication().invokeAndWait(new Runnable(){
        @Override public void run(){
          final GithubLoginDialog dialog=new GithubBasicLoginDialog(project,oldAuth,host);
          DialogManager.show(dialog);
          ok[0]=dialog.isOK();
          if (ok[0]) {
            authData[0]=dialog.getAuthData();
            final GithubSettings settings=GithubSettings.getInstance();
            if (settings.getAuthType() != GithubAuthData.AuthType.TOKEN) {
              GithubSettings.getInstance().setAuthData(authData[0],dialog.isSavePasswordSelected(),indicator.getModalityState());
            }
          }
        }
      }
,indicator.getModalityState());
      if (!ok[0]) {
        throw new GithubOperationCanceledException("Can't get valid credentials");
      }
      return authData[0];
    }
  }
);
}
