{
  boolean usePty=commandLine instanceof PtyCommandLine;
  if (usePty && SystemInfo.isWindows) {
    addProcessListener(new ProcessAdapter(){
      @Override public void processTerminated(      ProcessEvent event){
        getProcess().destroy();
      }
    }
);
  }
  setShouldDestroyProcessRecursively(!usePty);
}
