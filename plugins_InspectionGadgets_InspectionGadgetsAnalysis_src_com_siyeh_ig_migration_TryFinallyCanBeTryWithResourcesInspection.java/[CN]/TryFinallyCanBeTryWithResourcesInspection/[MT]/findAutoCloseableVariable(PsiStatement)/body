{
  if (statement instanceof PsiIfStatement) {
    final PsiIfStatement ifStatement=(PsiIfStatement)statement;
    if (ifStatement.getElseBranch() != null) {
      return null;
    }
    final PsiExpression condition=ifStatement.getCondition();
    if (!(condition instanceof PsiBinaryExpression)) {
      return null;
    }
    final PsiBinaryExpression binaryExpression=(PsiBinaryExpression)condition;
    final IElementType tokenType=binaryExpression.getOperationTokenType();
    if (!JavaTokenType.NE.equals(tokenType)) {
      return null;
    }
    final PsiExpression lhs=binaryExpression.getLOperand();
    final PsiExpression rhs=binaryExpression.getROperand();
    if (rhs == null) {
      return null;
    }
    final PsiElement variable;
    if (PsiType.NULL.equals(rhs.getType())) {
      variable=resolveLocalVariable(lhs);
    }
 else     if (PsiType.NULL.equals(lhs.getType())) {
      variable=resolveLocalVariable(rhs);
    }
 else {
      return null;
    }
    if (variable == null) {
      return null;
    }
    final PsiStatement thenBranch=ifStatement.getThenBranch();
    final PsiLocalVariable resourceVariable;
    if (thenBranch instanceof PsiExpressionStatement) {
      resourceVariable=findAutoCloseableVariable(thenBranch);
    }
 else     if (thenBranch instanceof PsiBlockStatement) {
      final PsiBlockStatement blockStatement=(PsiBlockStatement)thenBranch;
      final PsiCodeBlock codeBlock=blockStatement.getCodeBlock();
      resourceVariable=findAutoCloseableVariable(ControlFlowUtils.getOnlyStatementInBlock(codeBlock));
    }
 else {
      return null;
    }
    if (variable.equals(resourceVariable)) {
      return resourceVariable;
    }
  }
 else   if (statement instanceof PsiExpressionStatement) {
    final PsiExpressionStatement expressionStatement=(PsiExpressionStatement)statement;
    final PsiExpression expression=expressionStatement.getExpression();
    if (!(expression instanceof PsiMethodCallExpression)) {
      return null;
    }
    final PsiMethodCallExpression methodCallExpression=(PsiMethodCallExpression)expression;
    final PsiReferenceExpression methodExpression=methodCallExpression.getMethodExpression();
    final String methodName=methodExpression.getReferenceName();
    if (!HardcodedMethodConstants.CLOSE.equals(methodName)) {
      return null;
    }
    final PsiExpression qualifier=methodExpression.getQualifierExpression();
    if (!(qualifier instanceof PsiReferenceExpression)) {
      return null;
    }
    final PsiReferenceExpression referenceExpression=(PsiReferenceExpression)qualifier;
    final PsiElement target=referenceExpression.resolve();
    if (!(target instanceof PsiLocalVariable) || target instanceof PsiResourceVariable) {
      return null;
    }
    final PsiLocalVariable variable=(PsiLocalVariable)target;
    if (!isAutoCloseable(variable)) {
      return null;
    }
    return variable;
  }
  return null;
}
