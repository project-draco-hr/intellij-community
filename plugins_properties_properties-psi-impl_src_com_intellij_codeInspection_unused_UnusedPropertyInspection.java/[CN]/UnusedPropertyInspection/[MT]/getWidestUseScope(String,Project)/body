{
  if (key == null)   return null;
  Set<Module> modules=ContainerUtil.newLinkedHashSet();
  for (  IProperty property : PropertiesImplUtil.findPropertiesByKey(project,key)) {
    Module module=ModuleUtilCore.findModuleForPsiElement(property.getPsiElement());
    if (module == null) {
      return GlobalSearchScope.allScope(project);
    }
    modules.add(module);
  }
  if (modules.isEmpty())   return null;
  List<Module> list=ContainerUtil.newArrayList(modules);
  GlobalSearchScope result=GlobalSearchScope.moduleWithDependentsScope(list.get(0));
  for (int i=1; i < list.size(); i++) {
    result=result.uniteWith(GlobalSearchScope.moduleWithDependentsScope(list.get(i)));
  }
  return result;
}
