{
  if (lambdaExpression != null) {
    final PsiType typeTypeByParentCall=getTargetTypeFromParent(lambdaExpression,errorMessage,inferParent);
    if (typeTypeByParentCall != null) {
      return LambdaUtil.getFunctionalInterfaceReturnType(FunctionalInterfaceParameterizationUtil.getGroundTargetType(typeTypeByParentCall,lambdaExpression));
    }
    final PsiType cachedLambdaType=LambdaUtil.getFunctionalTypeMap().get(lambdaExpression);
    if (cachedLambdaType != null) {
      return LambdaUtil.getFunctionalInterfaceReturnType(FunctionalInterfaceParameterizationUtil.getGroundTargetType(cachedLambdaType,lambdaExpression));
    }
    return inferParent || !(PsiUtil.skipParenthesizedExprUp(lambdaExpression.getParent()) instanceof PsiExpressionList) ? LambdaUtil.getFunctionalInterfaceReturnType(lambdaExpression.getFunctionalInterfaceType()) : null;
  }
  return null;
}
