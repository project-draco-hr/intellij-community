{
  final List<List<InferenceVariable>> independentVars=InferenceVariablesOrder.resolveOrder(myInferenceVariables.values(),this);
  for (  List<InferenceVariable> variables : independentVars) {
    for (    InferenceVariable inferenceVariable : variables) {
      if (inferenceVariable.getInstantiation() != null)       continue;
      final List<PsiType> eqBounds=inferenceVariable.getBounds(InferenceBound.EQ);
      if (!eqBounds.isEmpty()) {
        inferenceVariable.setInstantiation(eqBounds.get(0));
        continue;
      }
      final List<PsiType> lowerBounds=inferenceVariable.getBounds(InferenceBound.LOWER);
      PsiType lub=null;
      for (      PsiType lowerBound : lowerBounds) {
        if (isProperType(lowerBound)) {
          if (lub == null) {
            lub=lowerBound;
          }
 else {
            lub=GenericsUtil.getLeastUpperBound(lub,lowerBound,myManager);
          }
        }
      }
      if (lub != null) {
        inferenceVariable.setInstantiation(lub);
      }
 else {
        PsiType glb=null;
        for (        PsiType upperBound : inferenceVariable.getBounds(InferenceBound.UPPER)) {
          if (isProperType(upperBound)) {
            if (glb == null) {
              glb=upperBound;
            }
 else {
              glb=GenericsUtil.getGreatestLowerBound(glb,upperBound);
            }
          }
        }
        if (glb != null) {
          inferenceVariable.setInstantiation(glb);
        }
      }
    }
  }
}
