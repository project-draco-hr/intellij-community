{
  if (parentMethod instanceof PsiMethod) {
    final PsiParameter[] parameters=((PsiMethod)parentMethod).getParameterList().getParameters();
    if (parameters.length == 0)     return null;
    final PsiExpression[] args=argumentList.getExpressions();
    if (!((PsiMethod)parentMethod).isVarArgs() && parameters.length != args.length)     return null;
    PsiElement arg=context;
    while (arg.getParent() instanceof PsiParenthesizedExpression) {
      arg=arg.getParent();
    }
    final int i=ArrayUtilRt.find(args,arg);
    if (i < 0)     return null;
    if (pair != null) {
      return getParameterType(parameters,args,i,pair.second);
    }
 else {
      args[i]=null;
      final PsiTypeParameter[] typeParameters=((PsiMethod)parentMethod).getTypeParameters();
      final InferenceSession inferenceSession=new InferenceSession(typeParameters,PsiSubstitutor.EMPTY,parentMethod.getManager());
      inferenceSession.initExpressionConstraints(parameters,args,argumentList.getParent());
      inferenceSession.infer(parameters,args,argumentList.getParent(),true);
      final PsiSubstitutor substitutor=((MethodCandidateInfo)result).inferSubstitutorFromArgs(DefaultParameterTypeInferencePolicy.INSTANCE,args);
      return getParameterType(parameters,args,i,substitutor);
    }
  }
  return null;
}
