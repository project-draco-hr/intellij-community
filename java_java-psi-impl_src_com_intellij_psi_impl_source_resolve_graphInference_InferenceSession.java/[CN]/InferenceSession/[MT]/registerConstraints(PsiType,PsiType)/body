{
  final InferenceVariable inferenceVariable=shouldResolveAndInstantiate(returnType,targetType);
  if (inferenceVariable != null) {
    resolveBounds(Collections.singletonList(inferenceVariable),mySiteSubstitutor,true);
    myConstraints.add(new TypeCompatibilityConstraint(inferenceVariable.getInstantiation(),returnType));
  }
 else {
    if (targetType instanceof PsiClassType && ((PsiClassType)targetType).isRaw()) {
      setErased();
    }
    myConstraints.add(new TypeCompatibilityConstraint(myErased ? TypeConversionUtil.erasure(targetType) : GenericsUtil.eliminateWildcards(targetType,false),returnType));
  }
}
