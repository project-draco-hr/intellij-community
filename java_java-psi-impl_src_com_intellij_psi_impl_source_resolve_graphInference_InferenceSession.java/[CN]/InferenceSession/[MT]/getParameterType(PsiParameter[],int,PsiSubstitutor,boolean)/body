{
  if (substitutor == null)   return null;
  final PsiParameter parameter=parameters[i < parameters.length ? i : parameters.length - 1];
  final PsiType type=parameter.getType();
  if (!type.isValid()) {
    PsiUtil.ensureValidType(type,"Invalid type of parameter " + parameter + " of "+ parameter.getClass());
  }
  PsiType parameterType=substitutor.substitute(type);
  if (parameterType instanceof PsiEllipsisType && varargs) {
    parameterType=((PsiEllipsisType)parameterType).getComponentType();
  }
  return parameterType;
}
