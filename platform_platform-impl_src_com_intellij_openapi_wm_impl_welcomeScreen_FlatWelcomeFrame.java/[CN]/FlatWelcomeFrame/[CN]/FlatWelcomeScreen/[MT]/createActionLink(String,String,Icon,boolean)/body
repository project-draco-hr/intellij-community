{
  final Ref<ActionLink> ref=new Ref<ActionLink>(null);
  AnAction action=new AnAction(){
    @Override public void actionPerformed(    @NotNull AnActionEvent e){
      int offset=-UIUtil.getListCellHPadding() - UIUtil.getListViewportPadding().left;
      if (ref.get().getIcon() != null) {
        offset+=ref.get().getIcon().getIconWidth() + ref.get().getIconTextGap();
      }
      RelativePoint point=new RelativePoint(ref.get(),new Point(offset,ref.get().getHeight() + 1));
      ActionGroup configureGroup=(ActionGroup)ActionManager.getInstance().getAction(groupId);
      JBPopupFactory.getInstance().createActionGroupPopup(null,new IconsFreeActionGroup(configureGroup),e.getDataContext(),false,false,false,null,10,null).show(point);
    }
  }
;
  ref.set(new ActionLink(text,icon,action));
  ref.get().setPaintUnderline(false);
  ref.get().setNormalColor(getLinkNormalColor());
  NonOpaquePanel panel=new NonOpaquePanel(new BorderLayout());
  panel.setBorder(new EmptyBorder(4,10,4,10));
  panel.add(ref.get());
  panel.add(createArrow(ref.get()),BorderLayout.EAST);
  installFocusable(panel,action,KeyEvent.VK_UP,KeyEvent.VK_DOWN,focusListOnLeft);
  return panel;
}
