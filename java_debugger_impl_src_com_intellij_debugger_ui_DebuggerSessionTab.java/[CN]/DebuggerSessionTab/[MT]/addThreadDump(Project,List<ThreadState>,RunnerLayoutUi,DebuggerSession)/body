{
  final TextConsoleBuilder consoleBuilder=TextConsoleBuilderFactory.getInstance().createBuilder(project);
  consoleBuilder.filters(ExceptionFilters.getFilters(session.getSearchScope()));
  final ConsoleView consoleView=consoleBuilder.getConsole();
  final DefaultActionGroup toolbarActions=new DefaultActionGroup();
  consoleView.allowHeavyFilters();
  final ThreadDumpPanel panel=new ThreadDumpPanel(project,consoleView,toolbarActions,threads);
  final String id=createThreadDumpContentId();
  final Content content=ui.createContent(id,panel,id,null,null);
  content.setCloseable(true);
  content.setDescription("Thread Dump");
  ui.addContent(content);
  ui.selectAndFocus(content,true,true);
  myThreadDumpsCount+=1;
  myCurrentThreadDumpId+=1;
  Disposer.register(content,new Disposable(){
    @Override public void dispose(){
      myThreadDumpsCount-=1;
      if (myThreadDumpsCount == 0) {
        myCurrentThreadDumpId=1;
      }
    }
  }
);
  Disposer.register(content,consoleView);
  ui.selectAndFocus(content,true,false);
  if (threads.size() > 0) {
    panel.selectStackFrame(0);
  }
}
