{
  Type type=descriptor.getType();
  if (type == null) {
    return null;
  }
  try {
    if (type instanceof ArrayType) {
      type=((ArrayType)type).componentType();
    }
    if (type instanceof ClassType) {
      ClassType clsType=(ClassType)type;
      Method lambdaMethod=MethodBytecodeUtil.getLambdaMethod(clsType);
      Location location=lambdaMethod != null ? ContainerUtil.getFirstItem(DebuggerUtilsEx.allLineLocations(lambdaMethod)) : null;
      if (location == null) {
        location=ContainerUtil.getFirstItem(clsType.allLineLocations());
      }
      if (location != null) {
        SourcePosition position=debugProcess.getPositionManager().getSourcePosition(location);
        return ApplicationManager.getApplication().runReadAction(new Computable<SourcePosition>(){
          @Override public SourcePosition compute(){
            if (clsType.name().indexOf('$') < 0) {
              PsiClass classAt=JVMNameUtil.getClassAt(position);
              if (classAt != null) {
                SourcePosition classPosition=SourcePosition.createFromElement(classAt);
                if (classPosition != null) {
                  return classPosition;
                }
              }
            }
            return position;
          }
        }
);
      }
    }
  }
 catch (  ClassNotPreparedException|AbsentInformationException e) {
    LOG.debug(e);
  }
  return null;
}
