{
  final Value value=descriptor.getValue();
  if (value == null) {
    return null;
  }
  Type type=value.type();
  if (type == null) {
    return null;
  }
  try {
    if (type instanceof ArrayType) {
      type=((ArrayType)type).componentType();
    }
    if (type instanceof ClassType) {
      final ClassType clsType=(ClassType)type;
      final Location location=ContainerUtil.getFirstItem(clsType.allLineLocations());
      if (location != null) {
        return ApplicationManager.getApplication().runReadAction(new Computable<SourcePosition>(){
          @Override public SourcePosition compute(){
            SourcePosition position=debugProcess.getPositionManager().getSourcePosition(location);
            if (clsType.name().indexOf('$') < 0) {
              final PsiClass classAt=JVMNameUtil.getClassAt(position);
              if (classAt != null) {
                final SourcePosition classPosition=SourcePosition.createFromElement(classAt);
                if (classPosition != null) {
                  position=classPosition;
                }
              }
            }
            return position;
          }
        }
);
      }
    }
  }
 catch (  ClassNotPreparedException e) {
    LOG.debug(e);
  }
catch (  AbsentInformationException e) {
    LOG.debug(e);
  }
  return null;
}
