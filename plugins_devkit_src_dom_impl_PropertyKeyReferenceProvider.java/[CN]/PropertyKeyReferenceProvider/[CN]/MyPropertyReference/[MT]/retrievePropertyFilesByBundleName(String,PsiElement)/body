{
  final List<String> allBundleNames;
  if (bundleName == null) {
    allBundleNames=getPluginResourceBundles(element);
  }
 else {
    allBundleNames=Collections.singletonList(bundleName);
  }
  final Project project=element.getProject();
  final PropertiesReferenceManager propertiesReferenceManager=PropertiesReferenceManager.getInstance(project);
  final GlobalSearchScope searchScope=GlobalSearchScope.projectScope(project);
  final List<PropertiesFile> allPropertiesFiles=new ArrayList<PropertiesFile>();
  for (  String name : allBundleNames) {
    final List<PropertiesFile> propertiesFiles=propertiesReferenceManager.findPropertiesFiles(searchScope,name,BundleNameEvaluator.DEFAULT);
    allPropertiesFiles.addAll(propertiesFiles);
  }
  return allPropertiesFiles;
}
