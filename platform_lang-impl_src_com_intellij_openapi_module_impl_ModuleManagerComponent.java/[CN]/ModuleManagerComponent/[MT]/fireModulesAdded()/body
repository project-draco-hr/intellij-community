{
  if (myModuleModel.myModules.isEmpty()) {
    return;
  }
  Runnable runnableWithProgress=new Runnable(){
    @Override public void run(){
      for (      final Module module : myModuleModel.myModules.values()) {
        final Application app=ApplicationManager.getApplication();
        final Runnable swingRunnable=new Runnable(){
          @Override public void run(){
            fireModuleAddedInWriteAction(module);
          }
        }
;
        if (app.isDispatchThread()) {
          swingRunnable.run();
        }
 else {
          ProgressIndicator pi=ProgressManager.getInstance().getProgressIndicator();
          app.invokeAndWait(swingRunnable,pi.getModalityState());
        }
      }
    }
  }
;
  ProgressIndicator progressIndicator=myProgressManager.getProgressIndicator();
  if (progressIndicator == null) {
    myProgressManager.runProcessWithProgressSynchronously(runnableWithProgress,"Initializing modules...",false,myProject);
  }
 else {
    runnableWithProgress.run();
  }
}
