{
  final BuildoutFacet facet=BuildoutFacet.getInstance(module);
  if (facet == null) {
    return;
  }
  final List<String> paths=facet.getConfiguration().getPaths();
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      final LibraryOrderEntry orderEntry=findEggsOrderEntry(ModuleRootManager.getInstance(module));
      if (orderEntry != null) {
        Library lib=orderEntry.getLibrary();
        if (lib != null) {
          fillLibrary(module.getProject(),lib,paths);
          return;
        }
      }
      final ModifiableRootModel root_model=ModuleRootManager.getInstance(module).getModifiableModel();
      Library lib=LibraryTablesRegistrar.getInstance().getLibraryTable(root_model.getProject()).createLibrary(BUILDOUT_LIB_NAME);
      fillLibrary(module.getProject(),lib,paths);
      root_model.addLibraryEntry(lib);
      root_model.commit();
    }
  }
);
}
