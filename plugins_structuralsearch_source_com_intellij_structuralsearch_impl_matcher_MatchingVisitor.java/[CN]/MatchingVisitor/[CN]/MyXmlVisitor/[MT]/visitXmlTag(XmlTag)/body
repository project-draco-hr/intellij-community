{
  final XmlTag another=(XmlTag)element;
  final boolean isTypedVar=matchContext.getPattern().isTypedVar(tag.getName());
  result=(tag.getName().equals(another.getName()) || isTypedVar) && matchInAnyOrder(tag.getAttributes(),another.getAttributes());
  if (result && tag.getValue() != null) {
    final XmlTagChild[] contentChildren=tag.getValue().getChildren();
    if (contentChildren != null && contentChildren.length > 0) {
      result=matchSequentially(new ArrayBackedNodeIterator(contentChildren),new ArrayBackedNodeIterator(another.getValue() != null ? another.getValue().getChildren() : XmlTagChild.EMPTY_ARRAY));
    }
  }
  if (result && isTypedVar) {
    MatchingHandler handler=matchContext.getPattern().getHandler(tag.getName());
    result=((SubstitutionHandler)handler).handle(another,matchContext);
  }
}
