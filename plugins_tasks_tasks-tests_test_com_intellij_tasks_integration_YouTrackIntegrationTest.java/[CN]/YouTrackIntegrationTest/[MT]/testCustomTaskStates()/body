{
  final Task task=myRepository.findTask(REQUEST_WITH_CUSTOM_STATES_ID);
  assertNotNull(task);
  final Set<CustomTaskState> states=myRepository.getAvailableTaskStates(task);
  final List<String> stateNames=ContainerUtil.map(states,new Function<CustomTaskState,String>(){
    @Override public String fun(    CustomTaskState state){
      return state.getPresentableName();
    }
  }
);
  assertContainsElements(stateNames,"North","South");
  myRepository.setTaskState(task,NORTH_STATE);
  Element element=myRepository.fetchRequestAsElement(REQUEST_WITH_CUSTOM_STATES_ID);
  assertEquals("North",element.getAttributeValue("state"));
  myRepository.setTaskState(task,SUBMITTED_STATE);
  element=myRepository.fetchRequestAsElement(REQUEST_WITH_CUSTOM_STATES_ID);
  assertEquals("Submitted",element.getAttributeValue("state"));
}
