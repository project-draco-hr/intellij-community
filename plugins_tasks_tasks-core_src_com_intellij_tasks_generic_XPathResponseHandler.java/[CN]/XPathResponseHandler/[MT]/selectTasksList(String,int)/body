{
  Document document=new SAXBuilder(false).build(new StringReader(response));
  Element root=document.getRootElement();
  XPath xPath=lazyCompile(getSelector(TASKS).getPath());
  @SuppressWarnings("unchecked") List<Object> rawTaskElements=xPath.selectNodes(root);
  if (!rawTaskElements.isEmpty() && !(rawTaskElements.get(0) instanceof Element)) {
    throw new Exception(String.format("Expression '%s' should match list of XML elements. Got '%s' instead.",xPath.getXPath(),rawTaskElements.toString()));
  }
  return rawTaskElements.subList(0,Math.min(rawTaskElements.size(),max));
}
