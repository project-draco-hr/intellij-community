{
  for (  DiffFragment fragment : fragments) {
    assertTrue(fragment.getStartOffset1() <= fragment.getEndOffset1());
    assertTrue(fragment.getStartOffset2() <= fragment.getEndOffset2());
    if (fragment instanceof LineFragment) {
      LineFragment lineFragment=(LineFragment)fragment;
      assertTrue(lineFragment.getStartLine1() <= lineFragment.getEndLine1());
      assertTrue(lineFragment.getStartLine2() <= lineFragment.getEndLine2());
      assertTrue(lineFragment.getStartLine1() != lineFragment.getEndLine1() || lineFragment.getStartLine2() != lineFragment.getEndLine2());
      assertTrue(lineFragment.getStartLine1() >= 0);
      assertTrue(lineFragment.getStartLine2() >= 0);
      assertTrue(lineFragment.getEndLine1() <= getLineCount(before));
      assertTrue(lineFragment.getEndLine2() <= getLineCount(after));
      checkLineOffsets(lineFragment,before,after,policy);
    }
 else {
      assertTrue(fragment.getStartOffset1() != fragment.getEndOffset1() || fragment.getStartOffset2() != fragment.getEndOffset2());
    }
    if (fragment instanceof FineLineFragment) {
      List<DiffFragment> fineFragments=((FineLineFragment)fragment).getFineFragments();
      if (fineFragments != null)       checkConsistency(fineFragments,before,after,policy);
    }
  }
}
