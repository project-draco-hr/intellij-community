{
  Editor editor=CommonDataKeys.EDITOR.getData(e.getDataContext());
  Presentation presentation=e.getPresentation();
  boolean enabled=false;
  if (editor != null && isPython(editor)) {
    String text=getSelectionText(editor);
    if (text != null) {
      presentation.setText(EXECUTE_SELECTION_IN_CONSOLE);
    }
 else {
      text=getLineUnderCaret(editor);
      if (text != null) {
        presentation.setText("Execute Line in Console");
      }
    }
    enabled=!StringUtil.isEmpty(text);
  }
  presentation.setEnabled(enabled);
  presentation.setVisible(enabled);
}
