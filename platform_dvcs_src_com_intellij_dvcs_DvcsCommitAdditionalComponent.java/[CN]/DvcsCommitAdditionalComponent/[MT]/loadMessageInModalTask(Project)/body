{
  try {
    String messageFromHg=ProgressManager.getInstance().runProcessWithProgressSynchronously(new ThrowableComputable<String,VcsException>(){
      @Override public String compute() throws VcsException {
        return getLastCommitMessage();
      }
    }
,"Reading commit message...",false,project);
    if (!StringUtil.isEmptyOrSpaces(messageFromHg)) {
      substituteCommitMessage(messageFromHg);
      myAmendedMessage=messageFromHg;
    }
  }
 catch (  VcsException e) {
    Messages.showErrorDialog(getComponent(),"Couldn't load commit message of the commit to amend.\n" + e.getMessage(),"Commit Message not Loaded");
    log.info(e);
  }
}
