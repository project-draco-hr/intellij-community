{
  final ASTNode fileNode=element.getContainingFile().getNode();
  if (DUMP_FORMATTING_AST) {
    System.out.println("AST tree for " + element.getContainingFile().getName() + ":");
    printAST(fileNode,0);
  }
  final PyBlockContext context=new PyBlockContext(settings,createSpacingBuilder(settings),mode);
  final PyBlock block=new PyBlock(null,fileNode,null,Indent.getNoneIndent(),null,context);
  if (DUMP_FORMATTING_AST) {
    FormattingModelDumper.dumpFormattingModel(block,2,System.out);
  }
  return FormattingModelProvider.createFormattingModelForPsiFile(element.getContainingFile(),block,settings);
}
