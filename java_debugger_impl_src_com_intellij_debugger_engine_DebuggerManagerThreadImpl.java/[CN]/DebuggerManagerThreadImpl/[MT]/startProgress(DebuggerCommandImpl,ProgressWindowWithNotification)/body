{
  progressWindow.addListener(new ProgressIndicatorListenerAdapter(){
    @Override public void cancelled(){
      command.release();
    }
  }
);
  ApplicationManager.getApplication().executeOnPooledThread(new Runnable(){
    @Override public void run(){
      ProgressManager.getInstance().runProcess(new Runnable(){
        @Override public void run(){
          invokeAndWait(command);
        }
      }
,progressWindow);
    }
  }
);
}
