{
  PsiDocumentManager docmgr=PsiDocumentManager.getInstance(element.getProject());
  PsiFile containingFile=element.getContainingFile();
  if (containingFile == null) {
    return;
  }
  Document doc=docmgr.getDocument(containingFile);
  if (doc == null) {
    return;
  }
  if (!FileDocumentManager.getInstance().requestWriting(doc,element.getProject())) {
    throw new IllegalStateException();
  }
}
