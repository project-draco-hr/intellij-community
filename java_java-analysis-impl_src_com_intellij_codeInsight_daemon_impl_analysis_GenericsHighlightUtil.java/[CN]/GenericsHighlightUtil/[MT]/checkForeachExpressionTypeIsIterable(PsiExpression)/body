{
  if (expression == null || expression.getType() == null)   return null;
  final PsiType itemType=JavaGenericsUtil.getCollectionItemType(expression);
  if (itemType == null) {
    String description=JavaErrorMessages.message("foreach.not.applicable",JavaHighlightUtil.formatType(expression.getType()));
    final HighlightInfo highlightInfo=HighlightInfo.newHighlightInfo(HighlightInfoType.ERROR).range(expression).descriptionAndTooltip(description).create();
    QuickFixAction.registerQuickFixAction(highlightInfo,QUICK_FIX_FACTORY.createNotIterableForEachLoopFix(expression));
    return highlightInfo;
  }
  return null;
}
