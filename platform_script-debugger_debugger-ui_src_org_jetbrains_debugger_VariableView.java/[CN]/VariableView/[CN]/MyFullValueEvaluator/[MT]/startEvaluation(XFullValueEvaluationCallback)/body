{
  if (!(value instanceof StringValue) || !((StringValue)value).isTruncated()) {
    callback.evaluated(value.getValueString());
    return;
  }
  final AtomicBoolean evaluated=new AtomicBoolean();
  ((StringValue)value).getFullString().doWhenDone(new Runnable(){
    @Override public void run(){
      if (!callback.isObsolete() && evaluated.compareAndSet(false,true)) {
        callback.evaluated(value.getValueString());
      }
    }
  }
).doWhenRejected(createErrorMessageConsumer(callback));
}
