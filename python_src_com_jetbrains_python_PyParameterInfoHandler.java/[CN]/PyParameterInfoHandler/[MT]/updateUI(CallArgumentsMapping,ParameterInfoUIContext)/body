{
  if (prevResult == null)   return;
  final PyArgumentList argList=prevResult.getArgumentList();
  if (!argList.isValid())   return;
  final TypeEvalContext typeEvalContext=TypeEvalContext.userInitiated(argList.getProject(),argList.getContainingFile());
  final PyResolveContext resolveContext=PyResolveContext.noImplicits().withTypeEvalContext(typeEvalContext);
  final CallArgumentsMapping argumentsMapping=argList.analyzeCall(resolveContext);
  final PyMarkedCallee marked=argumentsMapping.getMarkedCallee();
  if (marked == null)   return;
  final PyCallable callable=marked.getCallable();
  final List<PyParameter> parameterList=PyUtil.getParameters(callable,typeEvalContext);
  final List<PyNamedParameter> namedParameters=new ArrayList<PyNamedParameter>(parameterList.size());
  final Map<PyNamedParameter,Integer> parameterToIndex=new HashMap<PyNamedParameter,Integer>();
  final Map<Integer,EnumSet<ParameterInfoUIContextEx.Flag>> hintFlags=new HashMap<Integer,EnumSet<ParameterInfoUIContextEx.Flag>>();
  final List<String> hintsList=buildParameterListHint(parameterList,namedParameters,parameterToIndex,hintFlags);
  final int currentParamOffset=context.getCurrentParameterIndex();
  for (int i=0; i < marked.getImplicitOffset(); i+=1) {
    hintFlags.get(parameterToIndex.get(namedParameters.get(i))).add(ParameterInfoUIContextEx.Flag.DISABLE);
  }
  final List<PyExpression> flattenedArgs=PyUtil.flattenedParensAndLists(argList.getArguments());
  int lastParamIndex=collectHighlights(argumentsMapping,parameterList,parameterToIndex,hintFlags,flattenedArgs,currentParamOffset);
  highlightNext(marked,parameterList,namedParameters,parameterToIndex,hintFlags,flattenedArgs.isEmpty(),lastParamIndex);
  String[] hints=ArrayUtil.toStringArray(hintsList);
  if (context instanceof ParameterInfoUIContextEx) {
    final ParameterInfoUIContextEx pic=(ParameterInfoUIContextEx)context;
    EnumSet[] flags=new EnumSet[hintFlags.size()];
    for (int i=0; i < flags.length; i+=1)     flags[i]=hintFlags.get(i);
    if (hints.length < 1) {
      hints=new String[]{NO_PARAMS_MSG};
      flags=new EnumSet[]{EnumSet.of(ParameterInfoUIContextEx.Flag.DISABLE)};
    }
    pic.setupUIComponentPresentation(hints,flags,context.getDefaultParameterColor());
  }
 else {
    StringBuilder signatureBuilder=new StringBuilder();
    if (hints.length > 1) {
      for (      String s : hints)       signatureBuilder.append(s);
    }
 else {
      signatureBuilder.append(XmlStringUtil.escapeString(NO_PARAMS_MSG));
    }
    context.setupUIComponentPresentation(signatureBuilder.toString(),-1,0,false,false,false,context.getDefaultParameterColor());
  }
}
