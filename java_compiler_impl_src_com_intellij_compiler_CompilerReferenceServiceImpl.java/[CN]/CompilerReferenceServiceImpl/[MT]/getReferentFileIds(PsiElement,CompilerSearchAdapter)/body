{
  final PsiFile file=element.getContainingFile();
  if (file == null)   return null;
  final VirtualFile vFile=file.getVirtualFile();
  if (vFile == null)   return null;
  ElementPlace place=ElementPlace.get(vFile,myProjectFileIndex);
  if (place == null) {
    return null;
  }
  if (myDirtyScope.contains(vFile)) {
    return null;
  }
  CompilerElement[] compilerElements=place == ElementPlace.SRC ? new CompilerElement[]{adapter.asCompilerElement(element)} : adapter.libraryElementAsCompilerElements(element);
  if (compilerElements.length == 0)   return null;
synchronized (myLock) {
    if (myReader == null)     return null;
    TIntHashSet referentFileIds=new TIntHashSet();
    for (    CompilerElement compilerElement : compilerElements) {
      referentFileIds.addAll(myReader.findReferentFileIds(compilerElement,adapter).toArray());
    }
    return referentFileIds;
  }
}
