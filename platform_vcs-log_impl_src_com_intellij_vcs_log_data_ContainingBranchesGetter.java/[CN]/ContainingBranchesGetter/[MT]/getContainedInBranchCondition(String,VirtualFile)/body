{
  LOG.assertTrue(EventQueue.isDispatchThread());
  if (myRefs == null || myGraph == null)   return Conditions.alwaysFalse();
  VcsRef branchRef=ContainerUtil.find(myRefs.getBranches(),new Condition<VcsRef>(){
    @Override public boolean value(    VcsRef vcsRef){
      return vcsRef.getRoot().equals(root) && vcsRef.getName().equals(branchName);
    }
  }
);
  if (branchRef == null)   return Conditions.alwaysFalse();
  ContainedInBranchCondition condition=myConditions.get(root);
  if (condition == null || !condition.getBranch().equals(branchName)) {
    condition=new ContainedInBranchCondition(myGraph.getContainedInBranchCondition(Collections.singleton(myDataManager.getCommitIndex(branchRef.getCommitHash(),branchRef.getRoot()))),branchName);
    myConditions.put(root,condition);
  }
  return condition;
}
