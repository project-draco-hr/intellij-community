{
  try {
    VcsLogProvider provider=logData.getLogProvider(root);
    if (graph != null && refs != null && VcsLogProperties.get(provider,VcsLogProperties.LIGHTWEIGHT_BRANCHES)) {
      Set<Integer> branchesIndexes=graph.getContainingBranches(logData.getCommitIndex(hash,root));
      Collection<VcsRef> branchesRefs=new HashSet<>();
      for (      Integer index : branchesIndexes) {
        branchesRefs.addAll(refs.branchesToCommit(index));
      }
      branchesRefs=ContainerUtil.sorted(branchesRefs,provider.getReferenceManager().getLabelsOrderComparator());
      ArrayList<String> branchesList=new ArrayList<>();
      for (      VcsRef ref : branchesRefs) {
        branchesList.add(ref.getName());
      }
      return branchesList;
    }
 else {
      List<String> branches=new ArrayList<>(provider.getContainingBranches(root,hash));
      Collections.sort(branches);
      return branches;
    }
  }
 catch (  VcsException e) {
    LOG.warn(e);
    return Collections.emptyList();
  }
}
