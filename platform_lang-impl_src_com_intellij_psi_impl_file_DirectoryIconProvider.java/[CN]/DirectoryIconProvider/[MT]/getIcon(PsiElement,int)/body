{
  if (element instanceof PsiDirectory) {
    final PsiDirectory psiDirectory=(PsiDirectory)element;
    final VirtualFile vFile=psiDirectory.getVirtualFile();
    Project project=psiDirectory.getProject();
    SourceFolder sourceFolder=ProjectRootsUtil.getModuleSourceRoot(vFile,project);
    if (sourceFolder != null) {
      return SourceRootPresentation.getSourceRootIcon(sourceFolder);
    }
 else {
      if (!Registry.is("ide.hide.excluded.files")) {
        boolean ignored=ProjectRootManager.getInstance(project).getFileIndex().isExcluded(vFile);
        if (ignored) {
          return AllIcons.Modules.ExcludeRoot;
        }
      }
      return PlatformIcons.DIRECTORY_CLOSED_ICON;
    }
  }
  return null;
}
