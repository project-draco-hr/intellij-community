{
  final FilePath filePath=new FilePathImpl(file);
  final GitRevisionNumber currentRevisionNumber=(GitRevisionNumber)GitHistoryUtils.getCurrentRevision(project,filePath,head);
  final GitRevisionNumber compareRevisionNumber=(GitRevisionNumber)GitHistoryUtils.getCurrentRevision(project,filePath,branchToCompare);
  if (compareRevisionNumber == null) {
    fileDoesntExistInBranchError(project,file,branchToCompare);
    return;
  }
  if (currentRevisionNumber == null) {
    LOG.error(String.format("Current revision number is null for file [%s] and branch [%s]",filePath,head));
    return;
  }
  final VcsFileRevision compareRevision=new GitFileRevision(project,filePath,new GitRevisionNumber(branchToCompare,compareRevisionNumber.getTimestamp()));
  CurrentRevision currentRevision=new CurrentRevision(file,new GitRevisionNumber(head,currentRevisionNumber.getTimestamp()));
  new GitDiffFromHistoryHandler(project).showDiffForTwo(new FilePathImpl(file),compareRevision,currentRevision);
}
