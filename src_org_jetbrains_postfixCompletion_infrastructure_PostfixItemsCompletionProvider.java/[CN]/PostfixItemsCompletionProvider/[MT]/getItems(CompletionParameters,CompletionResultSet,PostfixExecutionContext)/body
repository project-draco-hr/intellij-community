{
  PostfixTemplatesService templatesService=PostfixTemplatesService.getInstance();
  if (templatesService == null) {
    return Collections.emptyList();
  }
  PostfixTemplateContext context=templatesService.isAvailable(parameters.getPosition(),executionContext);
  if (context == null)   return Collections.emptyList();
  String extraPrefix=context.shouldFixPrefixMatcher();
  if (extraPrefix != null) {
    PrefixMatcher prefixMatcher=result.getPrefixMatcher();
    PrefixMatcher extraMatcher=prefixMatcher.cloneWithPrefix(extraPrefix + prefixMatcher.getPrefix());
    result=result.withPrefixMatcher(extraMatcher);
  }
  List<LookupElement> lookupElements=templatesService.collectTemplates(context);
  for (  LookupElement postfixElement : lookupElements) {
    result.addElement(postfixElement);
  }
  return lookupElements;
}
