{
  PsiDocumentManager.getInstance(project).commitAllDocuments();
  PsiElement element=getElement();
  if (LOG.isDebugEnabled()) {
    LOG.debug("CreateFromUsage: element =" + element);
  }
  if (element == null) {
    return;
  }
  List<PsiClass> targetClasses=filterTargetClasses(element,project);
  if (targetClasses.isEmpty())   return;
  if (targetClasses.size() == 1 || ApplicationManager.getApplication().isUnitTestMode()) {
    doInvoke(project,targetClasses.get(0));
  }
 else {
    chooseTargetClass(targetClasses,editor);
  }
}
