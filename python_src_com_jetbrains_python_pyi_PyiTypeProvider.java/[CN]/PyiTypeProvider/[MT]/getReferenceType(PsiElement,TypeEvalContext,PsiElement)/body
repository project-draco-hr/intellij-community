{
  if (target instanceof PyTargetExpression) {
    final PsiElement pythonStub=PyiUtil.getPythonStub((PyTargetExpression)target);
    if (pythonStub instanceof PyTypedElement) {
      final TypeEvalContext effectiveContext=context.maySwitchToAST(pythonStub) ? context : TypeEvalContext.deepCodeInsight(target.getProject());
      return effectiveContext.getType((PyTypedElement)pythonStub);
    }
  }
  return null;
}
