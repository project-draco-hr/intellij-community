{
  final Action copy=getActionMap().get("copy");
  if (copy == null || copy instanceof UIResource) {
    Action newCopy=new AbstractAction(){
      @Override public boolean isEnabled(){
        return getSelectedIndex() != -1;
      }
      @Override public void actionPerformed(      ActionEvent e){
        ArrayList<String> selected=new ArrayList<String>();
        JBList list=JBList.this;
        ListCellRenderer renderer=list.getCellRenderer();
        if (renderer != null) {
          for (          int index : getSelectedIndices()) {
            Object value=list.getModel().getElementAt(index);
            Component c=renderer.getListCellRendererComponent(list,value,index,true,true);
            SimpleColoredComponent coloredComponent=null;
            if (c instanceof JComponent) {
              coloredComponent=UIUtil.findComponentOfType((JComponent)c,SimpleColoredComponent.class);
            }
            if (coloredComponent != null) {
              selected.add(coloredComponent.toString());
            }
 else             if (c instanceof JTextComponent) {
              selected.add(((JTextComponent)c).getText());
            }
 else             if (value != null) {
              selected.add(value.toString());
            }
          }
        }
        if (selected.size() > 0) {
          String text=StringUtil.join(selected," ");
          CopyPasteManager.getInstance().setContents(new StringSelection(text));
        }
      }
    }
;
    getActionMap().put("copy",newCopy);
  }
}
