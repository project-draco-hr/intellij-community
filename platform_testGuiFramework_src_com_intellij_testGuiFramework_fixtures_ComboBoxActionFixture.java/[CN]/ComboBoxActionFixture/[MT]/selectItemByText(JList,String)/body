{
  Pause.pause(new Condition("Wait until the list is populated."){
    @Override public boolean test(){
      ListPopupModel popupModel=(ListPopupModel)list.getModel();
      for (int i=0; i < popupModel.getSize(); ++i) {
        PopupFactoryImpl.ActionItem actionItem=(PopupFactoryImpl.ActionItem)popupModel.get(i);
        assertNotNull(actionItem);
        if (text.equals(actionItem.getText())) {
          return true;
        }
      }
      return false;
    }
  }
,GuiTestUtil.SHORT_TIMEOUT);
  final Integer appIndex=execute(new GuiQuery<Integer>(){
    @Override protected Integer executeInEDT() throws Throwable {
      ListPopupModel popupModel=(ListPopupModel)list.getModel();
      for (int i=0; i < popupModel.getSize(); ++i) {
        PopupFactoryImpl.ActionItem actionItem=(PopupFactoryImpl.ActionItem)popupModel.get(i);
        assertNotNull(actionItem);
        if (text.equals(actionItem.getText())) {
          return i;
        }
      }
      return -1;
    }
  }
);
  assertTrue(appIndex >= 0);
  execute(new GuiTask(){
    @Override protected void executeInEDT() throws Throwable {
      list.setSelectedIndex(appIndex);
    }
  }
);
  assertEquals(text,((PopupFactoryImpl.ActionItem)list.getSelectedValue()).getText());
}
