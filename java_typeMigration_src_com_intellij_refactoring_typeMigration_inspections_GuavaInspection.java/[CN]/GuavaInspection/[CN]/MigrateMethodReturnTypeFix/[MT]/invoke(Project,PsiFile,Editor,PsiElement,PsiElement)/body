{
  if (!FileModificationService.getInstance().prepareFileForWrite(file))   return;
  try {
    PsiMethod method=(PsiMethod)getStartElement();
    final TypeMigrationRules rules=new TypeMigrationRules(TypeMigrationLabeler.getElementType(method));
    rules.setMigrationRootType(myTargetType);
    rules.setBoundScope(method.getUseScope());
    TypeMigrationProcessor.runHighlightingTypeMigration(project,editor,rules,method,true);
    UndoUtil.markPsiFileForUndo(file);
  }
 catch (  IncorrectOperationException e) {
    LOG.error(e);
  }
}
