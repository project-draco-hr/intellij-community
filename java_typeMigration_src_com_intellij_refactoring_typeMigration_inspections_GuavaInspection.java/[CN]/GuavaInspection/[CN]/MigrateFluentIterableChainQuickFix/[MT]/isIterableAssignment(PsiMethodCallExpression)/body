{
  final PsiElement maybeVariable=expression.getParent();
  PsiClass variableClass;
  if (maybeVariable instanceof PsiLocalVariable && (variableClass=PsiTypesUtil.getPsiClass(((PsiLocalVariable)maybeVariable).getType())) != null && CommonClassNames.JAVA_LANG_ITERABLE.equals(variableClass.getQualifiedName())) {
    final PsiMethod method=expression.resolveMethod();
    if (method != null) {
      final PsiClass returnClass=PsiTypesUtil.getPsiClass(method.getReturnType());
      if (returnClass != null && GuavaFluentIterableConversionRule.FLUENT_ITERABLE.equals(returnClass.getQualifiedName())) {
        return true;
      }
    }
  }
  return false;
}
