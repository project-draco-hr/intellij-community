{
  if (myCourse != null && !myCourse.isUpToDate()) {
    myCourse.setUpToDate(true);
    updateCourse();
  }
  ApplicationManager.getApplication().invokeLater(new DumbAwareRunnable(){
    @Override public void run(){
      ApplicationManager.getApplication().runWriteAction(new DumbAwareRunnable(){
        @Override public void run(){
          if (myCourse != null) {
            StartupManager.getInstance(myProject).runWhenProjectIsInitialized(new Runnable(){
              @Override public void run(){
                ToolWindowManager.getInstance(myProject).getToolWindow(ToolWindowId.PROJECT_VIEW).show(new Runnable(){
                  @Override public void run(){
                    FileEditor[] editors=FileEditorManager.getInstance(myProject).getSelectedEditors();
                    if (editors.length > 0) {
                      final JComponent focusedComponent=editors[0].getPreferredFocusedComponent();
                      if (focusedComponent != null) {
                        ApplicationManager.getApplication().invokeLater(new Runnable(){
                          @Override public void run(){
                            IdeFocusManager.getInstance(myProject).requestFocus(focusedComponent,true);
                          }
                        }
);
                      }
                    }
                  }
                }
);
              }
            }
);
            UISettings.getInstance().HIDE_TOOL_STRIPES=false;
            UISettings.getInstance().fireUISettingsChanged();
            ToolWindowManager toolWindowManager=ToolWindowManager.getInstance(myProject);
            String toolWindowId=StudyToolWindowFactory.STUDY_TOOL_WINDOW;
            try {
              Method method=toolWindowManager.getClass().getDeclaredMethod("registerToolWindow",String.class,JComponent.class,ToolWindowAnchor.class,boolean.class,boolean.class,boolean.class);
              method.setAccessible(true);
              method.invoke(toolWindowManager,toolWindowId,null,ToolWindowAnchor.LEFT,true,true,true);
            }
 catch (            Exception e) {
              final ToolWindow toolWindow=toolWindowManager.getToolWindow(toolWindowId);
              if (toolWindow == null) {
                toolWindowManager.registerToolWindow(toolWindowId,true,ToolWindowAnchor.RIGHT,myProject,true);
              }
            }
            final ToolWindow studyToolWindow=toolWindowManager.getToolWindow(toolWindowId);
            if (studyToolWindow != null) {
              StudyUtils.updateStudyToolWindow(myProject);
              studyToolWindow.show(null);
            }
            addShortcut(StudyNextWindowAction.SHORTCUT,StudyNextWindowAction.ACTION_ID,false);
            addShortcut(StudyPrevWindowAction.SHORTCUT,StudyPrevWindowAction.ACTION_ID,false);
            addShortcut(StudyShowHintAction.SHORTCUT,StudyShowHintAction.ACTION_ID,false);
            addShortcut(StudyNextWindowAction.SHORTCUT2,StudyNextWindowAction.ACTION_ID,true);
            addShortcut(StudyCheckAction.SHORTCUT,StudyCheckAction.ACTION_ID,false);
            addShortcut(StudyNextStudyTaskAction.SHORTCUT,StudyNextStudyTaskAction.ACTION_ID,false);
            addShortcut(StudyPreviousStudyTaskAction.SHORTCUT,StudyPreviousStudyTaskAction.ACTION_ID,false);
            addShortcut(StudyRefreshTaskFileAction.SHORTCUT,StudyRefreshTaskFileAction.ACTION_ID,false);
          }
        }
      }
);
    }
  }
);
}
