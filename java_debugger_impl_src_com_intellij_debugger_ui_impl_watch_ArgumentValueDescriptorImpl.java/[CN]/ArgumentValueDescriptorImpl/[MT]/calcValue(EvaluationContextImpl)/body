{
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    public void run(){
      final SourcePosition position=ContextUtil.getSourcePosition(evaluationContext);
      if (position != null) {
        final PsiMethod method=PsiTreeUtil.getParentOfType(position.getElementAt(),PsiMethod.class);
        if (method != null) {
          final PsiParameterList params=method.getParameterList();
          if (myIndex < params.getParametersCount()) {
            final PsiParameter param=params.getParameters()[myIndex];
            myName=param.getName();
            myParameterNameCalcutated=true;
          }
 else {
            final PsiCodeBlock body=method.getBody();
            if (body != null) {
              final StringBuilder nameBuilder=new StringBuilder();
              try {
                final int startSlot=params.getParametersCount() + (method.hasModifierProperty(PsiModifier.STATIC) ? 0 : 1);
                body.accept(new LocalVariableNameFinder(startSlot,nameBuilder));
              }
  finally {
                myName=nameBuilder.length() > 0 ? myDefaultName + ": " + nameBuilder.toString() : myDefaultName;
              }
            }
          }
        }
      }
    }
  }
);
  return myValue;
}
