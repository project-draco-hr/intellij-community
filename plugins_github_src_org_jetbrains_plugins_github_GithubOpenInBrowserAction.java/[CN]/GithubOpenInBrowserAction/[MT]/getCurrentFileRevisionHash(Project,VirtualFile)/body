{
  final Ref<GitRevisionNumber> ref=new Ref<GitRevisionNumber>();
  ProgressManager.getInstance().run(new Task.Modal(project,"Getting Last Revision",true){
    @Override public void run(    @NotNull ProgressIndicator indicator){
      try {
        ref.set((GitRevisionNumber)GitHistoryUtils.getCurrentRevision(project,VcsUtil.getFilePath(file),"HEAD"));
      }
 catch (      VcsException e) {
        LOG.warn(e);
      }
    }
    @Override public void onCancel(){
      throw new ProcessCanceledException();
    }
  }
);
  if (ref.isNull())   return null;
  return ref.get().getRev();
}
