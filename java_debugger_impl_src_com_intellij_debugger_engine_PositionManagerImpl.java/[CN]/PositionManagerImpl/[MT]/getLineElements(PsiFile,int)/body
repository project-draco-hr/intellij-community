{
  ApplicationManager.getApplication().assertReadAccessAllowed();
  Document document=PsiDocumentManager.getInstance(file.getProject()).getDocument(file);
  if (document == null || lineNumber >= document.getLineCount()) {
    return EmptyIterable.getInstance();
  }
  final int startOffset=document.getLineStartOffset(lineNumber);
  final int endOffset=document.getLineEndOffset(lineNumber);
  return new Iterable<PsiElement>(){
    @Override public Iterator<PsiElement> iterator(){
      return new Iterator<PsiElement>(){
        PsiElement myElement=file.findElementAt(startOffset);
        @Override public boolean hasNext(){
          return myElement != null;
        }
        @Override public PsiElement next(){
          PsiElement res=myElement;
          myElement=PsiTreeUtil.nextLeaf(myElement);
          if (myElement != null && myElement.getTextOffset() > endOffset) {
            myElement=null;
          }
          return res;
        }
        @Override public void remove(){
        }
      }
;
    }
  }
;
}
