{
  if (location == null) {
    return null;
  }
  final ReferenceType refType=location.declaringType();
  if (refType == null) {
    return null;
  }
  if (DumbService.getInstance(project).isDumb()) {
    return null;
  }
  final String originalQName=refType.name();
  final GlobalSearchScope searchScope=myDebugProcess.getSearchScope();
  PsiClass psiClass=DebuggerUtils.findClass(originalQName,project,searchScope);
  if (psiClass == null) {
    int dollar=originalQName.indexOf('$');
    if (dollar > 0) {
      final String qName=originalQName.substring(0,dollar);
      psiClass=DebuggerUtils.findClass(qName,project,searchScope);
    }
  }
  if (psiClass != null) {
    final PsiElement element=psiClass.getNavigationElement();
    return element.getContainingFile();
  }
 else {
    try {
      PsiFile[] files=FilenameIndex.getFilesByName(project,refType.sourceName(),GlobalSearchScope.allScope(project));
      if (files.length > 0) {
        return files[0];
      }
    }
 catch (    AbsentInformationException ignore) {
    }
  }
  return null;
}
