{
  if (response.getStatus() != HttpResponseStatus.NOT_MODIFIED) {
    if (response instanceof FullHttpResponse) {
      HttpHeaders.setContentLength(response,((FullHttpResponse)response).content().readableBytes());
    }
 else     if (!HttpHeaders.isContentLengthSet(response)) {
      HttpHeaders.setContentLength(response,0);
    }
  }
  addCommonHeaders(response);
  send(response,channel,request != null && !addKeepAliveIfNeed(response,request));
}
