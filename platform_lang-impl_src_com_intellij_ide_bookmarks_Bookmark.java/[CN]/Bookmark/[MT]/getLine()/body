{
  int targetLine=myTarget.getLine();
  if (targetLine == -1)   return targetLine;
  RangeHighlighterEx highlighter=findMyHighlighter();
  if (highlighter != null && highlighter.isValid()) {
    Document document=getDocument();
    if (document != null) {
      return document.getLineNumber(highlighter.getStartOffset());
    }
  }
  RangeMarker marker=myTarget.getRangeMarker();
  if (marker != null && marker.isValid()) {
    Document document=marker.getDocument();
    return document.getLineNumber(marker.getStartOffset());
  }
  return targetLine;
}
