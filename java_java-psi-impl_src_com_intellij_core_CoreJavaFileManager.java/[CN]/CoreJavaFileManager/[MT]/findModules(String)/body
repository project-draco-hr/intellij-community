{
  Collection<PsiJavaModule> result=null;
  for (  VirtualFile root : roots()) {
    VirtualFile moduleInfo=root.findChild(PsiJavaModule.MODULE_INFO_FILE);
    if (moduleInfo == null)     moduleInfo=root.findChild(PsiJavaModule.MODULE_INFO_CLS_FILE);
    if (moduleInfo != null) {
      PsiFile file=myPsiManager.findFile(moduleInfo);
      if (file instanceof PsiJavaFile) {
        PsiJavaModule module=((PsiJavaFile)file).getModuleDeclaration();
        if (module != null) {
          if (result == null)           result=ContainerUtil.newSmartList();
          result.add(module);
        }
      }
    }
  }
  return result != null ? result : Collections.<PsiJavaModule>emptySet();
}
