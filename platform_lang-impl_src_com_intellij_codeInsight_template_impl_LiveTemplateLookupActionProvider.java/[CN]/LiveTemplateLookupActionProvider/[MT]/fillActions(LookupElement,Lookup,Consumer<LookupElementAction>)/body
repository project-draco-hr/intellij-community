{
  if (element instanceof LiveTemplateLookupElementImpl) {
    final TemplateImpl template=((LiveTemplateLookupElementImpl)element).getTemplate();
    final TemplateImpl templateFromSettings=TemplateSettings.getInstance().getTemplate(template.getKey(),template.getGroupName());
    if (templateFromSettings != null) {
      consumer.consume(new LookupElementAction(PlatformIcons.EDIT,"Edit live template settings"){
        @Override public Result performLookupAction(){
          final Project project=lookup.getProject();
          ApplicationManager.getApplication().invokeLater(new Runnable(){
            @Override public void run(){
              if (project.isDisposed())               return;
              final LiveTemplatesConfigurable configurable=new LiveTemplatesConfigurable();
              ShowSettingsUtil.getInstance().editConfigurable(project,configurable,new Runnable(){
                @Override public void run(){
                  configurable.getTemplateListPanel().editTemplate(template);
                }
              }
);
            }
          }
);
          return Result.HIDE_LOOKUP;
        }
      }
);
      consumer.consume(new LookupElementAction(AllIcons.Actions.Delete,String.format("Disable '%s' template",template.getKey())){
        @Override public Result performLookupAction(){
          ApplicationManager.getApplication().invokeLater(new Runnable(){
            @Override public void run(){
              templateFromSettings.setDeactivated(true);
            }
          }
);
          return Result.HIDE_LOOKUP;
        }
      }
);
    }
  }
}
