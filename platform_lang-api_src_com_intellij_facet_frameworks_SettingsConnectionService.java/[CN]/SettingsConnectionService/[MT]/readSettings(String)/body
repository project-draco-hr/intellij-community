{
  Map<String,String> settings=ContainerUtil.newLinkedHashMap();
  try {
    String url=getSettingsUrl();
    HttpConfigurable.getInstance().prepareURL(url);
    String text=FileUtil.loadTextAndClose(getStream(new URL(url)));
    if (text.startsWith("<html>") || text.startsWith("<!DOCTYPE html>")) {
      LOG.info("HTML text obtained from " + url + ": "+ StringUtil.first(text,300,true));
      return settings;
    }
    try {
      Document document=JDOMUtil.loadDocument(text);
      Element root=document.getRootElement();
      for (      String s : attributes) {
        String attributeValue=root.getAttributeValue(s);
        if (StringUtil.isNotEmpty(attributeValue)) {
          settings.put(s,attributeValue);
        }
      }
    }
 catch (    JDOMException e) {
      LOG.error("",e,text);
    }
  }
 catch (  MalformedURLException e) {
    LOG.error(e);
  }
catch (  IOException e) {
  }
catch (  Exception e) {
    LOG.error(e);
  }
  return settings;
}
