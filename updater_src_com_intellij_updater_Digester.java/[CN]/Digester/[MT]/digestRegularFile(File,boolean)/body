{
  if (file.isDirectory()) {
    return DIRECTORY;
  }
  InputStream in=new BufferedInputStream(Utils.newFileInputStream(file,normalize));
  try {
    return digestStream(in);
  }
  finally {
    in.close();
  }
}
