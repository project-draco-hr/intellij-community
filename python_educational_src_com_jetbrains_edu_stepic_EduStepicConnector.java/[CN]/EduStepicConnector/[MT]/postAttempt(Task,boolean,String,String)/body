{
  if (task.getStepicId() <= 0) {
    return;
  }
  if (ourClient == null) {
    if (StringUtil.isEmptyOrSpaces(login) || StringUtil.isEmptyOrSpaces(password)) {
      return;
    }
 else {
      final boolean success=login(login,password);
      if (!success)       return;
    }
  }
  final HttpPost attemptRequest=new HttpPost(stepicApiUrl + "attempts");
  setHeaders(attemptRequest,"application/json");
  String attemptRequestBody=new Gson().toJson(new AttemptWrapper(task.getStepicId()));
  attemptRequest.setEntity(new StringEntity(attemptRequestBody,ContentType.APPLICATION_JSON));
  try {
    final CloseableHttpResponse attemptResponse=ourClient.execute(attemptRequest);
    final HttpEntity responseEntity=attemptResponse.getEntity();
    final String attemptResponseString=responseEntity != null ? EntityUtils.toString(responseEntity) : "";
    final StatusLine statusLine=attemptResponse.getStatusLine();
    if (statusLine.getStatusCode() != 201) {
      LOG.error("Failed to make attempt " + attemptResponseString);
    }
    final AttemptWrapper.Attempt attempt=new Gson().fromJson(attemptResponseString,AttemptContainer.class).attempts.get(0);
    final Map<String,TaskFile> taskFiles=task.getTaskFiles();
    final ArrayList<SolutionFile> files=new ArrayList<SolutionFile>();
    for (    TaskFile fileEntry : taskFiles.values()) {
      files.add(new SolutionFile(fileEntry.name,fileEntry.text));
    }
    postSubmission(passed,attempt,files);
  }
 catch (  IOException e) {
    LOG.error(e.getMessage());
  }
}
