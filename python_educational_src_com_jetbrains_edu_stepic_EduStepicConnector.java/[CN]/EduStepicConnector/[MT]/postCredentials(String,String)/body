{
  String url=stepicUrl + "accounts/login/";
  final HttpPost request=new HttpPost(url);
  List<NameValuePair> nvps=new ArrayList<NameValuePair>();
  nvps.add(new BasicNameValuePair("csrfmiddlewaretoken",ourCSRFToken));
  nvps.add(new BasicNameValuePair("login",user));
  nvps.add(new BasicNameValuePair("next","/"));
  nvps.add(new BasicNameValuePair("password",password));
  nvps.add(new BasicNameValuePair("remember","on"));
  try {
    request.setEntity(new UrlEncodedFormEntity(nvps,HTTP.UTF_8));
  }
 catch (  UnsupportedEncodingException e) {
    LOG.error(e.getMessage());
    ourClient=null;
    return false;
  }
  setHeaders(request,"application/x-www-form-urlencoded");
  try {
    final CloseableHttpResponse response=ourClient.execute(request);
    saveCSRFToken();
    final StatusLine line=response.getStatusLine();
    if (line.getStatusCode() != HttpStatus.SC_MOVED_TEMPORARILY) {
      final HttpEntity responseEntity=response.getEntity();
      final String responseString=responseEntity != null ? EntityUtils.toString(responseEntity) : "";
      LOG.error("Failed to login " + responseString);
      ourClient=null;
      return false;
    }
  }
 catch (  IOException e) {
    LOG.warn(e.getMessage());
    ourClient=null;
    return false;
  }
  return true;
}
