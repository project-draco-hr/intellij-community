{
  final PsiFile psiFile=psiElement instanceof PsiFile ? (PsiFile)psiElement : psiElement.getContainingFile();
  if (psiFile == null) {
    return null;
  }
  VirtualFile virtualFile=psiFile.getVirtualFile();
  if (virtualFile == null) {
    return null;
  }
  if (virtualFile instanceof HttpVirtualFile) {
    return Collections.singleton(Urls.newFromVirtualFile(virtualFile));
  }
  if (!(preferLocalUrl && HtmlUtil.isHtmlFile(psiFile))) {
    Pair<WebBrowserUrlProvider,Set<Url>> provider=getProvider(psiElement);
    if (provider != null) {
      if (provider.second != null) {
        return provider.second;
      }
      try {
        Set<Url> urls=provider.first.getUrls(psiElement,psiFile,virtualFile);
        if (!urls.isEmpty()) {
          return urls;
        }
      }
 catch (      WebBrowserUrlProvider.BrowserException e) {
        if (!HtmlUtil.isHtmlFile(psiFile)) {
          throw e;
        }
      }
    }
  }
  return virtualFile instanceof LightVirtualFile ? Collections.<Url>emptySet() : Collections.singleton(Urls.newFromVirtualFile(virtualFile));
}
