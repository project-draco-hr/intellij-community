{
  if (!FileModificationService.getInstance().preparePsiElementsForWrite(Arrays.asList(myPsiFiles)))   return;
  final RunResult[] results={result};
  doExecuteCommand(new Runnable(){
    @Override public void run(){
      AccessToken token=ApplicationManager.getApplication().acquireWriteActionLock(WriteCommandAction.this.getClass());
      try {
        results[0].run();
        results[0]=null;
      }
  finally {
        token.finish();
      }
    }
  }
);
}
