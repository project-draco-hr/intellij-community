{
  return connect(new HttpRequests.RequestProcessor<String>(){
    @Override public String process(    @NotNull HttpRequests.Request request) throws IOException {
      int contentLength=request.getConnection().getContentLength();
      BufferExposingByteArrayOutputStream out=new BufferExposingByteArrayOutputStream(contentLength > 0 ? contentLength : 16 * 1024);
      NetUtils.copyStreamContent(indicator,request.getInputStream(),out,contentLength);
      Charset charset=CharsetToolkit.UTF8_CHARSET;
      String contentEncoding=request.getConnection().getContentEncoding();
      if (contentEncoding != null) {
        try {
          charset=Charset.forName(contentEncoding);
        }
 catch (        Exception ignored) {
          charset=CharsetToolkit.UTF8_CHARSET;
        }
      }
      return new String(out.getInternalBuffer(),0,out.size(),charset);
    }
  }
);
}
