{
  String libFileName=mapLibraryName(libName);
  String libPath=null;
  String jarPath=PathManager.getJarPathForClass(UrlClassLoader.class);
  if (jarPath != null) {
    File jarDirectoryPath=new File(jarPath).getParentFile();
    File libFile=new File(jarDirectoryPath,libFileName);
    if (libFile.exists()) {
      libPath=libFile.getPath();
    }
  }
  if (libPath == null) {
    if (!reportError && PathManager.getHomePathFor(PathManager.class) == null) {
      return false;
    }
    libPath=PathManager.getBinPath() + "/" + libFileName;
  }
  if (!new File(libPath).exists()) {
    String platform=getPlatformName();
    if (!new File(libPath=PathManager.getHomePath() + "/community/bin/" + platform+ libFileName).exists()) {
      if (!new File(libPath=PathManager.getHomePath() + "/bin/" + platform+ libFileName).exists()) {
        if (!new File(libPath=PathManager.getHomePathFor(IdeaWin32.class) + "/bin/" + libFileName).exists()) {
          if (!reportError) {
            return false;
          }
          File libDir=new File(PathManager.getBinPath());
          throw new UnsatisfiedLinkError("'" + libFileName + "' not found in '"+ libDir+ "' among "+ Arrays.toString(libDir.list()));
        }
      }
    }
  }
  System.load(libPath);
  return true;
}
