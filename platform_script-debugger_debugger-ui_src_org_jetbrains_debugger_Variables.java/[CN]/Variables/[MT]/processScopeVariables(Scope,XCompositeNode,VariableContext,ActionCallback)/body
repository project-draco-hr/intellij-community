{
  final boolean isLast=compoundActionCallback == null;
  AsyncResult<?> result=ObsolescentAsyncResults.consume(scope.getVariables(),node,new PairConsumer<List<Variable>,XCompositeNode>(){
    @Override public void consume(    List<Variable> variables,    XCompositeNode node){
      List<Variable> properties=new ArrayList<Variable>(variables.size());
      List<Variable> functions=new SmartList<Variable>();
      for (      Variable variable : variables) {
        if (context.getMemberFilter().isMemberVisible(variable,false)) {
          Value value=variable.getValue();
          if (value != null && value.getType() == ValueType.FUNCTION && value.getValueString() != null && !UNNAMED_FUNCTION_PATTERN.matcher(value.getValueString()).lookingAt()) {
            functions.add(variable);
          }
 else {
            properties.add(variable);
          }
        }
      }
      sort(properties);
      sort(functions);
      if (!properties.isEmpty()) {
        node.addChildren(createVariablesList(properties,context),functions.isEmpty() && isLast);
      }
      if (!functions.isEmpty()) {
        node.addChildren(XValueChildrenList.bottomGroup(new VariablesGroup("Functions",functions,context)),isLast);
      }
 else       if (isLast && properties.isEmpty()) {
        node.addChildren(XValueChildrenList.EMPTY,true);
      }
      if (!isLast) {
        compoundActionCallback.setDone();
      }
    }
  }
);
  if (!isLast) {
    result.notifyWhenRejected(compoundActionCallback);
  }
}
