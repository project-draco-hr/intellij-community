{
  myMergeContext=context;
  myMergeRequest=request;
  Project project=myMergeRequest.getProject();
  VirtualFile file=FileDocumentManager.getInstance().getFile(myMergeRequest.getDocument());
  DiffContentFactory contentFactory=DiffContentFactory.getInstance();
  DocumentContent localContent=contentFactory.create(myMergeRequest.getLocalContent(),file);
  DocumentContent mergedContent=contentFactory.create(project,myMergeRequest.getDocument());
  MergeUtil.ProxyDiffContext diffContext=new MergeUtil.ProxyDiffContext(myMergeContext);
  SimpleDiffRequest diffRequest=new SimpleDiffRequest(myMergeRequest.getTitle(),localContent,mergedContent,myMergeRequest.getLocalTitle(),myMergeRequest.getResultTitle());
  myViewer=new MySimpleDiffViewer(diffContext,diffRequest);
  myResultEditor=myViewer.getEditor2();
  myPatchEditor=DiffUtil.createEditor(new DocumentImpl("",true),project,true,true);
  DiffUtil.setEditorHighlighter(project,myPatchEditor,mergedContent);
  DiffUtil.disableBlitting(myPatchEditor);
  myPatchEditor.getGutterComponentEx().setForceShowRightFreePaintersArea(true);
  JPanel patchPanel=new JPanel(new BorderLayout(0,DiffUtil.TITLE_GAP));
  patchPanel.add(myPatchEditor.getComponent(),BorderLayout.CENTER);
  patchPanel.add(myViewer.getPatchTitle(),BorderLayout.NORTH);
  myPatchSplitter=new DiffSplitter(2f / 3);
  myPatchSplitter.setFirstComponent(myViewer.getComponent());
  myPatchSplitter.setSecondComponent(patchPanel);
  myPatchSplitter.setHonorComponentsMinimumSize(false);
  myStatusPanel=new MyStatusPanel();
}
