{
  if (processOptionArgument(option.getWord())) {
    return;
  }
  final Option commandOption=CommandBasedRangeInfoDriver.findOptionByName(myCommand,option.getOptionName());
  final WordWithPosition attachedArgument=option.getAttachedArgument();
  if (commandOption == null) {
    if (attachedArgument != null) {
      mySkipNextArgument=true;
    }
    myRangeInfos.add(new RangeInfo(null,PyBundle.message("commandLine.validation.badOption"),getCurrentSuggestions(false,null),option.getWord(),false));
    return;
  }
  final Pair<Integer,OptionArgumentInfo> argumentAndQuantity=commandOption.getArgumentAndQuantity();
  final String optionAlreadyUsed=Sets.intersection(Sets.newHashSet(commandOption.getAllNames()),myUsedOptions).isEmpty() ? null : PyBundle.message("commandLine.validation.badOption");
  myRangeInfos.add(new RangeInfo(commandOption.getHelp(),optionAlreadyUsed,getCurrentSuggestions(false,null),option.getWord(),argumentAndQuantity != null));
  myUsedOptions.addAll(commandOption.getAllNames());
  if (argumentAndQuantity == null) {
    if (attachedArgument != null) {
      myRangeInfos.add(new RangeInfo(null,PyBundle.message("commandLine.validation.noArgAllowed"),false,attachedArgument));
      mySkipNextArgument=true;
    }
  }
 else {
    myExpectedOptionArgument=argumentAndQuantity;
  }
}
