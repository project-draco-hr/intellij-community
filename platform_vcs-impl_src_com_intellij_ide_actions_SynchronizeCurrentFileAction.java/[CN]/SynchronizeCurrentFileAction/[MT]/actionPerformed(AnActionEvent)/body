{
  final Project project=getEventProject(e);
  final VirtualFile[] files=getFiles(e);
  if (project == null || files == null || files.length == 0)   return;
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      for (      VirtualFile file : files) {
        VirtualFileSystem fs=file.getFileSystem();
        if (fs instanceof LocalFileSystem && file instanceof NewVirtualFile) {
          ((NewVirtualFile)file).markDirtyRecursively();
        }
      }
    }
  }
);
  RefreshQueue.getInstance().refresh(true,true,new Runnable(){
    @Override public void run(){
      postRefresh(project,files);
    }
  }
,files);
}
