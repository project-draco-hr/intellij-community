{
  ProjectFileIndex index=ProjectFileIndex.SERVICE.getInstance(project);
  VirtualFile classRoot=index.getClassRootForFile(directory);
  if (classRoot == null)   return;
  String relativePath=VfsUtilCore.getRelativePath(directory,classRoot);
  if (relativePath == null)   return;
  for (  OrderEntry orderEntry : index.getOrderEntriesForFile(directory)) {
    for (    VirtualFile sourceRoot : orderEntry.getFiles(OrderRootType.SOURCES)) {
      VirtualFile sourceFile=sourceRoot.findFileByRelativePath(relativePath);
      if (sourceFile != null) {
        outSourceRoots.add(sourceFile);
      }
    }
  }
}
