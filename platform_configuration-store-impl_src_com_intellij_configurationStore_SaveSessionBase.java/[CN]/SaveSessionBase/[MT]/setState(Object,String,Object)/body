{
  Element element;
  try {
    if (state instanceof Element) {
      element=(Element)state;
    }
 else     if (state instanceof JDOMExternalizable) {
      element=new Element("temp_element");
      ((JDOMExternalizable)state).writeExternal(element);
    }
 else {
      if (serializationFilter == null) {
        serializationFilter=new SkipDefaultsSerializationFilter();
      }
      element=XmlSerializer.serializeIfNotDefault(state,serializationFilter);
    }
  }
 catch (  WriteExternalException e) {
    LOG.debug(e);
    return;
  }
catch (  Throwable e) {
    LOG.error("Unable to serialize " + componentName + " state",e);
    return;
  }
  setSerializedState(component,componentName,element);
}
