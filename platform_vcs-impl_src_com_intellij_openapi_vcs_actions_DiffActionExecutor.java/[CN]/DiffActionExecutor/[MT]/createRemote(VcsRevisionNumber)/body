{
  final ContentRevision fileRevision=myDiffProvider.createFileContent(revisionNumber,mySelectedFile);
  if (fileRevision == null)   return null;
  if (fileRevision instanceof BinaryContentRevision) {
    FilePath filePath=fileRevision.getFile();
    final byte[] content=((BinaryContentRevision)fileRevision).getBinaryContent();
    if (content == null)     return null;
    return DiffContentFactory.getInstance().createBinary(myProject,filePath.getName(),filePath.getFileType(),content);
  }
  if (fileRevision instanceof ByteBackedContentRevision) {
    byte[] content=((ByteBackedContentRevision)fileRevision).getContentAsBytes();
    if (content == null)     throw new VcsException("Failed to load content");
    return FileAwareDocumentContent.create(myProject,content,fileRevision.getFile());
  }
 else {
    String content=fileRevision.getContent();
    if (content == null)     throw new VcsException("Failed to load content");
    return FileAwareDocumentContent.create(myProject,content,fileRevision.getFile());
  }
}
