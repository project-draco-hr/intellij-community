{
  PsiSwitchStatement switchStatement=getSwitchFromLabelPosition(position);
  PsiExpression expression=switchStatement == null ? null : switchStatement.getExpression();
  PsiClass switchType=expression == null ? null : PsiUtil.resolveClassInClassTypeOnly(expression.getType());
  if (switchType == null || !switchType.isEnum())   return;
  Set<PsiField> used=ReferenceExpressionCompletionContributor.findConstantsUsedInSwitch(switchStatement);
  for (  PsiField field : switchType.getAllFields()) {
    String name=field.getName();
    if (!(field instanceof PsiEnumConstant) || used.contains(CompletionUtil.getOriginalOrSelf(field)) || name == null) {
      continue;
    }
    String prefix="case ";
    String suffix=name + ":";
    LookupElementBuilder caseConst=LookupElementBuilder.create(field,prefix + suffix).bold().withPresentableText(prefix).withTailText(suffix).withLookupString(name);
    result.addElement(new JavaCompletionContributor.IndentingDecorator(caseConst));
  }
}
