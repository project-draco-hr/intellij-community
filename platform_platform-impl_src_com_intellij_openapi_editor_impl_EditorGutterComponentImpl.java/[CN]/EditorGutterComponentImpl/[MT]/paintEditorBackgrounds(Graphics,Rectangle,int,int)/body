{
  Color defaultBackgroundColor=myEditor.getBackgroundColor();
  int startX=getWhitespaceSeparatorOffset() + 1;
  IterationState state=new IterationState(myEditor,firstVisibleOffset,lastVisibleOffset,true,false);
  while (!state.atEnd()) {
    VisualPosition visualStart=myEditor.offsetToVisualPosition(state.getStartOffset());
    VisualPosition visualEnd=myEditor.offsetToVisualPosition(state.getEndOffset());
    for (int line=visualStart.getLine(); line <= visualEnd.getLine(); line++) {
      if (line == visualStart.getLine()) {
        if (visualStart.getColumn() == 0) {
          drawEditorLineBackgroundRect(g,clip,state,defaultBackgroundColor,startX,myEditor.visibleLineToY(line));
        }
      }
 else       if (line != visualEnd.getLine() || visualEnd.getColumn() != 0) {
        drawEditorLineBackgroundRect(g,clip,state,defaultBackgroundColor,startX,myEditor.visibleLineToY(line));
      }
    }
    state.advance();
  }
}
