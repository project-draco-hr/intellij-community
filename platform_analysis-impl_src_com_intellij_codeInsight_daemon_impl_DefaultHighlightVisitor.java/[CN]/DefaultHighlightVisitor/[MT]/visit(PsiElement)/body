{
  if (element instanceof PsiErrorElement) {
    if (myHighlightErrorElements)     visitErrorElement((PsiErrorElement)element);
  }
 else {
    ASTNode node=element.getNode();
    if (node != null && node.getElementType() == TokenType.BAD_CHARACTER) {
      String message=String.format("Illegal character: \\u%04X",(int)element.textToCharArray()[0]);
      myHolder.add(HighlightInfo.newHighlightInfo(HighlightInfoType.ERROR).range(element).descriptionAndTooltip(message).create());
    }
    if (myRunAnnotators)     runAnnotators(element);
  }
  if (myAnnotationHolder.hasAnnotations()) {
    for (    Annotation annotation : myAnnotationHolder) {
      myHolder.add(HighlightInfo.fromAnnotation(annotation,null,myBatchMode));
    }
    myAnnotationHolder.clear();
  }
}
