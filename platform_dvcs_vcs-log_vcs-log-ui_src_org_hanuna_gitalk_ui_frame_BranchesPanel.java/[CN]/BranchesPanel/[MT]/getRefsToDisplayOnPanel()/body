{
  Collection<VcsRef> allRefs=myDataHolder.getDataPack().getRefsModel().getAllRefs();
  final List<VcsRef> localRefs=ContainerUtil.filter(allRefs,new Condition<VcsRef>(){
    @Override public boolean value(    VcsRef ref){
      return ref.getType().isLocalOrHead();
    }
  }
);
  List<VcsRef> refsToShow=ContainerUtil.filter(allRefs,new Condition<VcsRef>(){
    @Override public boolean value(    VcsRef ref){
      if (ref.getType() == VcsRef.RefType.REMOTE_BRANCH) {
        return thereIsLocalRefOfHash(ref.getCommitHash(),localRefs);
      }
      if (ref.getType().isLocalOrHead()) {
        return true;
      }
      return false;
    }
  }
);
  return sortReferences(refsToShow);
}
