{
  if (antDomProject == null) {
    return Collections.emptyList();
  }
  final Set<PropertiesFile> files=new java.util.HashSet<PropertiesFile>();
  final int stopOffset=stopElement.getTextOffset();
  for (Iterator<AntDomElement> iterator=antDomProject.getAntChildrenIterator(); iterator.hasNext(); ) {
    AntDomElement child=iterator.next();
    final XmlElement xmlElement=child.getXmlElement();
    if (xmlElement != null && xmlElement.getTextOffset() >= stopOffset) {
      break;
    }
    if (child instanceof AntDomProperty) {
      final AntDomProperty property=(AntDomProperty)child;
      final PropertiesFile file=property.getPropertiesFile();
      if (file != null) {
        files.add(file);
      }
    }
  }
  return files;
}
