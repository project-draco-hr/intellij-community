{
  TIntObjectHashMap<List<String>> contractClauses=new TIntObjectHashMap<List<String>>();
  TIntObjectIterator<Value> solutionsIterator=internalIdSolutions.iterator();
  TIntHashSet notNulls=annotations.notNulls;
  TIntObjectHashMap<String> contracts=annotations.contracts;
  for (int i=internalIdSolutions.size(); i-- > 0; ) {
    solutionsIterator.advance();
    int key=Math.abs(solutionsIterator.key());
    Value value=solutionsIterator.value();
    if (value == Value.Top || value == Value.Bot) {
      continue;
    }
    int[] compoundKey=null;
    try {
      compoundKey=myCompoundKeyEnumerator.valueOf(key);
    }
 catch (    IOException e) {
      LOG.error(e);
    }
    if (compoundKey != null) {
      Direction direction=extractDirection(compoundKey);
      if (value == Value.NotNull && (direction instanceof In || direction instanceof Out)) {
        notNulls.add(key);
      }
 else       if (direction instanceof InOut) {
        compoundKey[0]=0;
        compoundKey[1]=0;
        compoundKey[2]=0;
        try {
          int baseKey=myCompoundKeyEnumerator.enumerate(compoundKey);
          List<String> clauses=contractClauses.get(baseKey);
          if (clauses == null) {
            clauses=new ArrayList<String>();
            contractClauses.put(baseKey,clauses);
          }
          int arity=compoundKey[8];
          clauses.add(contractElement(arity,(InOut)direction,value));
        }
 catch (        IOException e) {
          LOG.error(e);
        }
      }
    }
  }
  TIntObjectIterator<List<String>> buildersIterator=contractClauses.iterator();
  for (int i=contractClauses.size(); i-- > 0; ) {
    buildersIterator.advance();
    int key=buildersIterator.key();
    List<String> clauses=buildersIterator.value();
    Collections.sort(clauses);
    StringBuilder sb=new StringBuilder("\"");
    StringUtil.join(clauses,";",sb);
    sb.append('"');
    contracts.put(key,sb.toString().intern());
  }
}
