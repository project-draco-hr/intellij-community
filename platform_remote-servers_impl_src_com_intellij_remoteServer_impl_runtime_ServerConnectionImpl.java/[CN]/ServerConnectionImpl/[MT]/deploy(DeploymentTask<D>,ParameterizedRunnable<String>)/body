{
  connectIfNeeded(new ConnectionCallbackBase<D>(){
    @Override public void connected(    @NotNull ServerRuntimeInstance<D> instance){
      LocalDeploymentImpl deployment=new LocalDeploymentImpl(instance,ServerConnectionImpl.this,DeploymentStatus.DEPLOYING,null,null,task);
      String deploymentName=deployment.getName();
synchronized (myLocalDeployments) {
        myLocalDeployments.put(deploymentName,deployment);
      }
      DeploymentLogManagerImpl logManager=new DeploymentLogManagerImpl(task.getProject(),new ChangeListener()).withMainHandlerVisible(true);
      LoggingHandlerImpl handler=logManager.getMainLoggingHandler();
      myLogManagers.put(deploymentName,logManager);
      handler.printlnSystemMessage("Deploying '" + deploymentName + "'...");
      onDeploymentStarted.run(deploymentName);
      instance.deploy(task,logManager,new DeploymentOperationCallbackImpl(deploymentName,(DeploymentTaskImpl<D>)task,handler,deployment));
    }
  }
);
}
