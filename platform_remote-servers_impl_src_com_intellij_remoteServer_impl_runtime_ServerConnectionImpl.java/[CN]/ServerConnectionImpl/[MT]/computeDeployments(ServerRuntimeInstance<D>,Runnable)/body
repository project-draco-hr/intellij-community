{
  instance.computeDeployments(new ServerRuntimeInstance.ComputeDeploymentsCallback(){
    private final List<DeploymentImpl> myDeployments=new ArrayList<>();
    @Override public void addDeployment(    @NotNull String deploymentName){
      addDeployment(deploymentName,null);
    }
    @Override public void addDeployment(    @NotNull String deploymentName,    @Nullable DeploymentRuntime deploymentRuntime){
      addDeployment(deploymentName,deploymentRuntime,null,null);
    }
    @Override public Deployment addDeployment(    @NotNull String deploymentName,    @Nullable DeploymentRuntime deploymentRuntime,    @Nullable DeploymentStatus deploymentStatus,    @Nullable String deploymentStatusText){
      DeploymentImpl result;
      if (deploymentStatus == null) {
        deploymentStatus=DeploymentStatus.DEPLOYED;
      }
synchronized (myRemoteDeployments) {
        result=myRemoteDeployments.get(deploymentName);
        if (result == null) {
          result=new DeploymentImpl(ServerConnectionImpl.this,deploymentName,deploymentStatus,deploymentStatusText,deploymentRuntime,null);
        }
 else         if (!result.getStatus().isTransition()) {
          result.changeState(result.getStatus(),deploymentStatus,deploymentStatusText,deploymentRuntime);
        }
        myDeployments.add(result);
      }
      return result;
    }
    @Override public void succeeded(){
synchronized (myRemoteDeployments) {
        myRemoteDeployments.clear();
        for (        DeploymentImpl deployment : myDeployments) {
          myRemoteDeployments.put(deployment.getName(),deployment);
        }
      }
      myEventDispatcher.queueDeploymentsChanged(ServerConnectionImpl.this);
      onFinished.run();
    }
    @Override public void errorOccurred(    @NotNull String errorMessage){
synchronized (myRemoteDeployments) {
        myRemoteDeployments.clear();
      }
      myStatusText="Cannot obtain deployments: " + errorMessage;
      myEventDispatcher.queueConnectionStatusChanged(ServerConnectionImpl.this);
      myEventDispatcher.queueDeploymentsChanged(ServerConnectionImpl.this);
      onFinished.run();
    }
  }
);
}
