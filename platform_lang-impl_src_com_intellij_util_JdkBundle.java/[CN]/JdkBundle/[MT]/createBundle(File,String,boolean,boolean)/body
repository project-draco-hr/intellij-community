{
  File javaHome=SystemInfo.isMac ? new File(jvm,homeSubPath) : jvm;
  if (bundled)   javaHome=new File(PathManager.getHomePath(),javaHome.getPath());
  boolean hasToolsJar=new File(javaHome,"lib" + File.separator + "tools.jar").exists();
  if (!SystemInfo.isMac && !hasToolsJar)   return null;
  File absJvmLocation=bundled ? new File(PathManager.getHomePath(),jvm.getPath()) : jvm;
  Pair<String,Pair<Version,Integer>> nameVersionAndUpdate=getJDKNameVersionAndUpdate(absJvmLocation,homeSubPath);
  if (SystemInfo.isMac && nameVersionAndUpdate.second != null && nameVersionAndUpdate.second.first.isOrGreaterThan(1,7) && !hasToolsJar)   return null;
  return new JdkBundle(jvm,nameVersionAndUpdate.first,nameVersionAndUpdate.second,boot,bundled);
}
