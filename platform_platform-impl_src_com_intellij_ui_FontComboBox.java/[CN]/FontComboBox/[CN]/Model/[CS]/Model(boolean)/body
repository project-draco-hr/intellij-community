{
  Application application=ApplicationManager.getApplication();
  if (application == null || application.isUnitTestMode()) {
    setFonts(FontInfo.getAll(withAllStyles));
  }
 else {
    application.executeOnPooledThread(new Runnable(){
      @Override public void run(){
        List<FontInfo> allFonts=FontInfo.getAll(withAllStyles);
        application.invokeLater(new Runnable(){
          @Override public void run(){
            setFonts(allFonts);
            updateSelectedItem();
          }
        }
,application.getAnyModalityState());
      }
    }
);
  }
}
