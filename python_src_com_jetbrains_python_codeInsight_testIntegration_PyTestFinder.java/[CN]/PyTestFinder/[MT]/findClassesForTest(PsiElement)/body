{
  final PyFunction sourceFunction=PsiTreeUtil.getParentOfType(element,PyFunction.class);
  final PyClass source=PsiTreeUtil.getParentOfType(element,PyClass.class);
  if (sourceFunction == null && source == null)   return Collections.emptySet();
  List<Pair<? extends PsiNamedElement,Integer>> classesWithWeights=new ArrayList<Pair<? extends PsiNamedElement,Integer>>();
  final List<Pair<String,Integer>> possibleNames=new ArrayList<Pair<String,Integer>>();
  if (source != null)   possibleNames.addAll(TestFinderHelper.collectPossibleClassNamesWithWeights(source.getName()));
  if (sourceFunction != null)   possibleNames.addAll(TestFinderHelper.collectPossibleClassNamesWithWeights(sourceFunction.getName()));
  for (  Pair<String,Integer> eachNameWithWeight : possibleNames) {
    for (    PyClass eachClass : PyClassNameIndex.find(eachNameWithWeight.first,element.getProject(),GlobalSearchScope.projectScope(element.getProject()))) {
      if (!PyTestUtil.isPyTestClass(eachClass,null))       classesWithWeights.add(new Pair<PsiNamedElement,Integer>(eachClass,eachNameWithWeight.second));
    }
    for (    PyFunction function : PyFunctionNameIndex.find(eachNameWithWeight.first,element.getProject(),GlobalSearchScope.projectScope(element.getProject()))) {
      if (!PyTestUtil.isPyTestFunction(function))       classesWithWeights.add(new Pair<PsiNamedElement,Integer>(function,eachNameWithWeight.second));
    }
  }
  return TestFinderHelper.getSortedElements(classesWithWeights,false);
}
