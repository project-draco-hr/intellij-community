{
  WorkingCopyFormat format=WorkingCopyFormat.UNKNOWN;
  final Ref<Boolean> wasOk=new Ref<Boolean>();
  while ((format == WorkingCopyFormat.UNKNOWN) && (!Boolean.FALSE.equals(wasOk.get()))) {
    format=showUpgradeDialog(WorkingCopyFormat.ONE_DOT_SEVEN,wasOk);
  }
  return Boolean.TRUE.equals(wasOk.get()) ? format : WorkingCopyFormat.UNKNOWN;
}
