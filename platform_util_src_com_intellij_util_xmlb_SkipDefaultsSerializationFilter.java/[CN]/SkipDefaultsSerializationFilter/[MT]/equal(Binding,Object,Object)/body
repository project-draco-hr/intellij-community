{
  if (defaultValue instanceof Element && currentValue instanceof Element) {
    return JDOMUtil.areElementsEqual((Element)currentValue,(Element)defaultValue);
  }
 else {
    if (currentValue == defaultValue) {
      return true;
    }
    if (currentValue == null || defaultValue == null) {
      return false;
    }
    if (binding instanceof BasePrimitiveBinding) {
      Binding referencedBinding=((BasePrimitiveBinding)binding).myBinding;
      if (referencedBinding instanceof BeanBinding) {
        Class<?> referencedBeanClass=((BeanBinding)referencedBinding).myBeanClass;
        ThreeState compareByFields;
        if (hasEqualMethod == null) {
          compareByFields=null;
          hasEqualMethod=new THashMap<Class<?>,ThreeState>();
        }
 else {
          compareByFields=hasEqualMethod.get(referencedBeanClass);
        }
        if (compareByFields == null) {
          try {
            referencedBeanClass.getDeclaredMethod("equals",Object.class);
            compareByFields=ThreeState.NO;
            hasEqualMethod.put(referencedBeanClass,compareByFields);
          }
 catch (          NoSuchMethodException ignored) {
            compareByFields=ThreeState.YES;
            hasEqualMethod.put(referencedBeanClass,compareByFields);
          }
catch (          Exception e) {
            BeanBinding.LOG.warn(e);
          }
        }
        if (compareByFields == ThreeState.YES) {
          return ((BeanBinding)referencedBinding).equalByFields(currentValue,defaultValue,this);
        }
      }
    }
    return Comparing.equal(currentValue,defaultValue);
  }
}
