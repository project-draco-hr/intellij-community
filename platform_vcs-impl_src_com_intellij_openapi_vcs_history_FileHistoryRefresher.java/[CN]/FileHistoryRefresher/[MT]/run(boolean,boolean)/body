{
  myIsRefresh=isRefresh;
  mySessionPartner.beforeRefresh();
  final VcsHistoryProviderBackgroundableProxy proxy=new VcsHistoryProviderBackgroundableProxy(myVcs,myVcsHistoryProvider,myVcs.getDiffProvider());
  if (myVcsHistoryProvider instanceof VcsHistoryProviderEx && myStartingRevisionNumber != null) {
    proxy.executeAppendableSession(myVcs.getKeyInstanceMethod(),myPath,myStartingRevisionNumber,mySessionPartner,null);
  }
 else {
    proxy.executeAppendableSession(myVcs.getKeyInstanceMethod(),myPath,mySessionPartner,null,myCanUseCache,canUseLastRevision);
  }
  myCanUseCache=false;
}
