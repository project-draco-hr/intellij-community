{
  if (myToFocus != null) {
    if (Registry.is("actionSystem.doNotStealFocus")) {
      Window topWindow=SwingUtilities.windowForComponent(myToFocus);
      UIUtil.setAutoRequestFocus(topWindow,topWindow.isActive());
      while (topWindow.getOwner() != null) {
        topWindow=SwingUtilities.windowForComponent(topWindow);
        UIUtil.setAutoRequestFocus(topWindow,topWindow.isActive());
      }
      if (topWindow.isActive()) {
        if (!myToFocus.requestFocusInWindow()) {
          myToFocus.requestFocus();
        }
      }
 else {
        myToFocus.requestFocusInWindow();
      }
    }
 else {
      if (!(myToFocus.requestFocusInWindow())) {
        if (!SystemInfo.isMac || isForced()) {
          myToFocus.requestFocus();
        }
      }
    }
  }
  clear();
  return new ActionCallback.Done();
}
