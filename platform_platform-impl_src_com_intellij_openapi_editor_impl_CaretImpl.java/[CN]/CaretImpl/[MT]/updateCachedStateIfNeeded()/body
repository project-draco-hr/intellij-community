{
  if (!ApplicationManager.getApplication().isDispatchThread())   return;
  int modelCounter=myEditor.getCaretModel().myDocumentUpdateCounter;
  if (myDocumentUpdateCounter != modelCounter) {
    LogicalPosition lp=myEditor.offsetToLogicalPosition(getOffset());
    setCurrentLogicalCaret(new LogicalPosition(lp.line,lp.column + myVirtualSpaceOffset,myLeansTowardsLargerOffsets));
    myVisibleCaret=myEditor.logicalToVisualPosition(myLogicalCaret);
    updateVisualLineInfo();
    setLastColumnNumber(myLogicalCaret.column);
    myDesiredSelectionStartColumn=myDesiredSelectionEndColumn=-1;
    myDesiredX=-1;
    myDocumentUpdateCounter=modelCounter;
  }
}
