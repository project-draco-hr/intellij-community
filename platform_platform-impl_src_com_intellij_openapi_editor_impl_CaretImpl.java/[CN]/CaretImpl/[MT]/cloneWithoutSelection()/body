{
  updateCachedStateIfNeeded();
  CaretImpl clone=new CaretImpl(myEditor);
  clone.myLogicalCaret=myLogicalCaret;
  clone.myCaretInfo=myCaretInfo;
  clone.myVisibleCaret=myVisibleCaret;
  clone.myPositionMarker=new PositionMarker(getOffset());
  clone.myLeansTowardsLargerOffsets=myLeansTowardsLargerOffsets;
  clone.myVirtualSpaceOffset=myVirtualSpaceOffset;
  clone.myVisualLineStart=myVisualLineStart;
  clone.myVisualLineEnd=myVisualLineEnd;
  clone.mySkipChangeRequests=mySkipChangeRequests;
  clone.myLastColumnNumber=myLastColumnNumber;
  clone.myReportCaretMoves=myReportCaretMoves;
  clone.myDesiredX=myDesiredX;
  clone.myDesiredSelectionStartColumn=-1;
  clone.myDesiredSelectionEndColumn=-1;
  return clone;
}
