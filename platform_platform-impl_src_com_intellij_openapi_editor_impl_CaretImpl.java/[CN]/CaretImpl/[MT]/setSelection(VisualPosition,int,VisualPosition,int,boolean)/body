{
  VisualPosition startPositionToUse=startPosition == null ? myEditor.offsetToVisualPosition(startOffset,true) : startPosition;
  VisualPosition endPositionToUse=endPosition == null ? myEditor.offsetToVisualPosition(endOffset) : endPosition;
  doSetSelection(startPositionToUse,startOffset,endPositionToUse,endOffset,true,updateSystemSelection);
}
