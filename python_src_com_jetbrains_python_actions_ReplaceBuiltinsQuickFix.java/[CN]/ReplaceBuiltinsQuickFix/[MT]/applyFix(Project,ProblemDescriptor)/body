{
  PyElementGenerator elementGenerator=PyElementGenerator.getInstance(project);
  PsiElement importStatement=descriptor.getPsiElement();
  if (importStatement instanceof PyImportStatement) {
    for (    PyImportElement importElement : ((PyImportStatement)importStatement).getImportElements()) {
      PyReferenceExpression importReference=importElement.getImportReference();
      if (importReference != null) {
        if (LanguageLevel.forFile(importStatement.getContainingFile().getVirtualFile()).isPy3K()) {
          if ("__builtin__".equals(importReference.getName())) {
            importReference.replace(elementGenerator.createFromText(LanguageLevel.getDefault(),PyReferenceExpression.class,"builtins"));
          }
        }
 else {
          if ("builtins".equals(importReference.getName())) {
            importReference.replace(elementGenerator.createFromText(LanguageLevel.getDefault(),PyReferenceExpression.class,"__builtin__"));
          }
        }
      }
    }
  }
}
