{
  InputStream inputStream=new ByteArrayInputStream(content,0,content.length);
  ImageInputStream imageInputStream=ImageIO.createImageInputStream(inputStream);
  try {
    Iterator<ImageReader> imageReaders=ImageIO.getImageReaders(imageInputStream);
    if (imageReaders.hasNext()) {
      ImageReader imageReader=imageReaders.next();
      try {
        ImageReadParam param=imageReader.getDefaultReadParam();
        imageReader.setInput(imageInputStream,true,true);
        int minIndex=imageReader.getMinIndex();
        return imageReader.read(minIndex,param);
      }
  finally {
        imageReader.dispose();
      }
    }
  }
  finally {
    imageInputStream.close();
  }
  throw new IOException("Can't read image from given content");
}
