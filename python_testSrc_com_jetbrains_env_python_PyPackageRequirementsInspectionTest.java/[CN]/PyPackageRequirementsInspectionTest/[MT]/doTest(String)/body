{
  final String dir=getTestName(false);
  runPythonTest(new PyExecutionFixtureTestTask(){
    @Override protected String getTestDataPath(){
      return PythonTestUtil.getTestDataPath() + "/inspections/PyPackageRequirementsInspection";
    }
    @Override public void runTestOn(    String sdkHome) throws Exception {
      myFixture.enableInspections(PyPackageRequirementsInspection.class);
      final Sdk sdk=createTempSdk(sdkHome,SdkCreationType.SDK_PACKAGES_ONLY);
      final String perSdkDir=Integer.toHexString(System.identityHashCode(sdk));
      final VirtualFile root=myFixture.copyDirectoryToProject(dir,perSdkDir);
      assertNotNull(root);
      final Module module=myFixture.getModule();
      setupModuleSdk(module,sdk,root);
      try {
        final VirtualFile file=root.findFileByRelativePath(filename);
        assertNotNull(file);
        edt(new Runnable(){
          @Override public void run(){
            myFixture.testHighlighting(true,true,true,file);
          }
        }
);
      }
  finally {
        PsiTestUtil.removeAllRoots(module,sdk);
      }
    }
    @NotNull @Override public Set<String> getTags(){
      return TAGS;
    }
  }
);
}
