{
  return new ContentIterator(){
    @Override public boolean processFile(    @NotNull final VirtualFile fileOrDir){
      final boolean isInScope=ApplicationManager.getApplication().runReadAction(new Computable<Boolean>(){
        @Override public Boolean compute(){
          if (isFiltered(fileOrDir,projectFileIndex))           return false;
          if (GeneratedSourcesFilter.isGeneratedSourceByAnyFilter(fileOrDir,myProject))           return false;
          return searchScope == null || ((GlobalSearchScope)searchScope).contains(fileOrDir);
        }
      }
).booleanValue();
      return !isInScope || processor.process(fileOrDir);
    }
  }
;
}
