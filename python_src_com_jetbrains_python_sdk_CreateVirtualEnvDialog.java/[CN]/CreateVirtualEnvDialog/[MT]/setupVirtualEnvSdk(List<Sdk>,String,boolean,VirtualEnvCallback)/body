{
  final VirtualFile sdkHome=ApplicationManager.getApplication().runWriteAction(new Computable<VirtualFile>(){
    @Nullable public VirtualFile compute(){
      return LocalFileSystem.getInstance().refreshAndFindFileByPath(path);
    }
  }
);
  if (sdkHome != null) {
    final String name=SdkConfigurationUtil.createUniqueSdkName(PythonSdkType.getInstance(),sdkHome.getPath(),allSdks);
    final ProjectJdkImpl sdk=new ProjectJdkImpl(name,PythonSdkType.getInstance());
    sdk.setHomePath(FileUtil.toSystemDependentName(sdkHome.getPath()));
    callback.virtualEnvCreated(sdk,associateWithProject);
    PythonSdkType.setupSdkPaths(sdk,myProject,null);
  }
}
