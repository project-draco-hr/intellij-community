{
  final int offset=offsetForPoint(editor,point);
  final Document document=editor.getDocument();
  if (offset < 0 || offset >= document.getTextLength()) {
    return null;
  }
  char c=document.getCharsSequence().charAt(offset);
  if (Character.isWhitespace(c)) {
    return null;
  }
  IterationState state=new IterationState(editor,offset,offset + 1,false);
  Sprite sprite;
  try {
    TextAttributes attributes=state.getMergedAttributes();
    int fontType=attributes.getFontType();
    Color color=attributes.getForegroundColor();
    sprite=getAnimationManager().addSprite(editor,c,fontType,color,editor.visualPositionToXY(editor.offsetToVisualPosition(offset)),0,0);
  }
  finally {
    state.dispose();
  }
  DocumentModifier.removeCharacter(editor,offset);
  return sprite;
}
