{
  if (myPainters.isEmpty())   return ArrayUtil.EMPTY_INT_ARRAY;
  int i=0;
  int[] offsets=new int[2 + myPainters.size() * 2];
  Graphics2D g=(Graphics2D)gg;
  AffineTransform transform=g.getTransform();
  offsets[i++]=(int)transform.getTranslateX();
  offsets[i++]=(int)transform.getTranslateY();
  Rectangle r=null;
  Component prev=null;
  for (  Painter painter : myPainters) {
    if (!painter.needsRepaint())     continue;
    Component cur=myPainter2Component.get(painter);
    if (cur != prev || r == null) {
      Container curParent=cur.getParent();
      if (curParent == null)       continue;
      r=SwingUtilities.convertRectangle(curParent,cur.getBounds(),component);
      prev=cur;
    }
    offsets[i++]=r.x;
    offsets[i++]=r.y;
  }
  return offsets;
}
