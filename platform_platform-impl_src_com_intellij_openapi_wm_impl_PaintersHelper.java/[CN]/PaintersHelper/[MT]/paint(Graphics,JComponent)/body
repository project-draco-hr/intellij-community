{
  if (myPainters.isEmpty())   return;
  Graphics2D g2d=(Graphics2D)g;
  Rectangle clip=ObjectUtils.notNull(g.getClipBounds(),component.getBounds());
  Rectangle r=null;
  boolean clipMatched=false;
  Component prev=null;
  for (  Painter painter : myPainters) {
    if (!painter.needsRepaint())     continue;
    Component cur=myPainter2Component.get(painter);
    if (cur != prev || r == null) {
      Container curParent=cur.getParent();
      if (curParent == null)       continue;
      r=SwingUtilities.convertRectangle(curParent,cur.getBounds(),component);
      clipMatched=clip.contains(r) || clip.intersects(r);
      prev=cur;
    }
    if (!clipMatched)     continue;
    g2d.setClip(clip.intersection(r));
    g2d.translate(r.x,r.y);
    painter.paint(prev,g2d);
    g2d.translate(-r.x,-r.y);
  }
}
