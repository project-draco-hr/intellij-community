{
  if (myPainters.isEmpty())   return;
  Graphics2D g2d=(Graphics2D)g;
  Rectangle clip=ObjectUtils.notNull(g.getClipBounds(),current.getBounds());
  Component component=null;
  Rectangle componentBounds=null;
  boolean clipMatched=false;
  for (  Painter painter : myPainters) {
    if (!painter.needsRepaint())     continue;
    Component cur=myPainter2Component.get(painter);
    if (cur != component || componentBounds == null) {
      Container parent=(component=cur).getParent();
      if (parent == null)       continue;
      componentBounds=SwingUtilities.convertRectangle(parent,component.getBounds(),current);
      clipMatched=clip.contains(componentBounds) || clip.intersects(componentBounds);
    }
    if (!clipMatched)     continue;
    Point targetPoint=SwingUtilities.convertPoint(current,0,0,component);
    Rectangle targetRect=new Rectangle(targetPoint,component.getSize());
    g2d.setClip(clip.intersection(componentBounds));
    g2d.translate(-targetRect.x,-targetRect.y);
    painter.paint(component,g2d);
    g2d.translate(targetRect.x,targetRect.y);
  }
}
