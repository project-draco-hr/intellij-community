{
  @NonNls StringBuffer argument=new StringBuffer("-javaagent:");
  argument.append(PathManager.getLibPath()).append(File.separator);
  argument.append("cobertura.jar=");
  if (patterns != null && patterns.length > 0) {
    for (    String coveragePattern : patterns) {
      coveragePattern=coveragePattern.replace("$","\\$").replace(".","\\.").replaceAll("\\*",".*");
      if (!coveragePattern.endsWith(".*")) {
        coveragePattern+="(\\$.*)*";
      }
      argument.append("--includeClasses ").append(coveragePattern).append(" ");
    }
  }
  if (SystemInfo.isWindows) {
    argument.append("--datafile ").append("\\\"").append(sessionDataFilePath).append("\\\"");
  }
 else {
    argument.append("--datafile ").append(sessionDataFilePath);
  }
  javaParameters.getVMParametersList().add(argument.toString());
  javaParameters.getVMParametersList().defineProperty("net.sourceforge.cobertura.datafile",sessionDataFilePath);
  javaParameters.getClassPath().add(PathManager.getLibPath() + File.separator + "cobertura.jar");
}
