{
  PsiManager manager=owner.getManager();
  for (  PsiAnnotation annotation : annotations) {
    final PsiJavaCodeReferenceElement nameReferenceElement=annotation.getNameReferenceElement();
    if (nameReferenceElement == null)     continue;
    final PsiElement resolved=nameReferenceElement.resolve();
    boolean inferred=AnnotationUtil.isInferredAnnotation(annotation);
    if (resolved instanceof PsiClass) {
      final PsiClass annotationType=(PsiClass)resolved;
      if (isDocumentedAnnotationType(annotationType)) {
        if (inferred)         buffer.append("<i>");
        final PsiClassType type=JavaPsiFacade.getInstance(manager.getProject()).getElementFactory().createType(annotationType,PsiSubstitutor.EMPTY);
        buffer.append("@");
        generateType(buffer,type,owner,generateLink);
        final PsiNameValuePair[] attributes=annotation.getParameterList().getAttributes();
        if (attributes.length > 0) {
          buffer.append("(");
          boolean first=true;
          for (          PsiNameValuePair pair : attributes) {
            if (!first)             buffer.append("&nbsp;");
            first=false;
            final String name=pair.getName();
            if (name != null) {
              buffer.append(name);
              buffer.append(" = ");
            }
            final PsiAnnotationMemberValue value=pair.getValue();
            if (value != null) {
              buffer.append(XmlStringUtil.escapeString(value.getText()));
            }
          }
          buffer.append(")");
        }
        if (inferred)         buffer.append("</i>");
        buffer.append("&nbsp;");
      }
    }
 else     if (external) {
      if (inferred)       buffer.append("<i>");
      buffer.append(XmlStringUtil.escapeString(annotation.getText()));
      buffer.append("&nbsp;");
      if (inferred)       buffer.append("</i>");
    }
 else {
      buffer.append("<font color=red>");
      buffer.append(XmlStringUtil.escapeString(annotation.getText()));
      buffer.append("</font>");
      buffer.append("&nbsp;");
    }
    if (splitAnnotations)     buffer.append("\n");
  }
}
