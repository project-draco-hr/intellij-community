{
  if (doReplace) {
    Matcher m=LINE_PATTERN.matcher(text);
    m.region(start,end);
    while (m.find()) {
      to.append(text,m.start(1),m.end(1));
      if (m.start(2) != -1) {
        to.append(RETURN_SYMBOL);
      }
    }
  }
 else {
    to.append(text,start,end);
  }
}
