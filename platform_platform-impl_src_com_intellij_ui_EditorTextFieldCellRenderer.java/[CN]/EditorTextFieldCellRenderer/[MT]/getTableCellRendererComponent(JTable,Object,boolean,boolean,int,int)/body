{
  MyPanel panel=getEditorPanel(table);
  EditorEx editor=panel.myEditor;
  editor.getColorsScheme().setEditorFontSize(table.getFont().getSize());
  String text=getText(table,value,row,column);
  TextAttributes textAttributes=getTextAttributes(table,value,selected,focused,row,column);
  panel.setText(text,textAttributes);
  ((EditorImpl)editor).setPaintSelection(selected);
  editor.getSelectionModel().setSelection(0,selected ? editor.getDocument().getTextLength() : 0);
  editor.getColorsScheme().setColor(EditorColors.SELECTION_BACKGROUND_COLOR,table.getSelectionBackground());
  editor.getColorsScheme().setColor(EditorColors.SELECTION_FOREGROUND_COLOR,table.getSelectionForeground());
  editor.setBackgroundColor(getCellBackground(table,value,selected,focused,row,column));
  panel.setOpaque(!Comparing.equal(editor.getBackgroundColor(),table.getBackground()));
  panel.setBorder(null);
  return panel;
}
