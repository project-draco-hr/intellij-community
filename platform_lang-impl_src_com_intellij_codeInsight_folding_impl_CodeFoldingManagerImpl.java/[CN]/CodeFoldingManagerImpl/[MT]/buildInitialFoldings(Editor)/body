{
  final Project project=editor.getProject();
  if (project == null || !project.equals(myProject) || editor.isDisposed())   return;
  if (!((FoldingModelEx)editor.getFoldingModel()).isFoldingEnabled())   return;
  if (!EditorUtil.supportsDumbModeFolding(editor))   return;
  CodeFoldingState foldingState=buildInitialFoldings(editor.getDocument());
  if (foldingState != null) {
    foldingState.setToEditor(editor);
  }
}
