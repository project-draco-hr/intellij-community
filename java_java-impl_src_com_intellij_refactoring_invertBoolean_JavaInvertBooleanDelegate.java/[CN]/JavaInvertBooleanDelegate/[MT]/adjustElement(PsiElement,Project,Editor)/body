{
  if (element instanceof PsiVariable) {
    PsiVariable var=(PsiVariable)element;
    final PsiType returnType=var.getType();
    if (!PsiType.BOOLEAN.equals(returnType)) {
      CommonRefactoringUtil.showErrorHint(project,editor,RefactoringBundle.getCannotRefactorMessage(RefactoringBundle.message("invert.boolean.wrong.type")),InvertBooleanHandler.REFACTORING_NAME,InvertBooleanHandler.INVERT_BOOLEAN_HELP_ID);
      return null;
    }
    if (var instanceof PsiParameter && ((PsiParameter)var).getDeclarationScope() instanceof PsiMethod) {
      final PsiMethod method=(PsiMethod)((PsiParameter)var).getDeclarationScope();
      final PsiMethod superMethod=SuperMethodWarningUtil.checkSuperMethod(method,RefactoringBundle.message("to.refactor"));
      if (superMethod == null) {
        return null;
      }
      var=superMethod.getParameterList().getParameters()[method.getParameterList().getParameterIndex((PsiParameter)var)];
    }
    return var;
  }
 else   if (element instanceof PsiMethod) {
    final PsiMethod method=(PsiMethod)element;
    final PsiType returnType=method.getReturnType();
    if (!PsiType.BOOLEAN.equals(returnType)) {
      CommonRefactoringUtil.showErrorHint(project,editor,RefactoringBundle.getCannotRefactorMessage(RefactoringBundle.message("invert.boolean.wrong.type")),InvertBooleanHandler.REFACTORING_NAME,InvertBooleanHandler.INVERT_BOOLEAN_HELP_ID);
      return null;
    }
    return SuperMethodWarningUtil.checkSuperMethod(method,RefactoringBundle.message("to.refactor"));
  }
  return null;
}
