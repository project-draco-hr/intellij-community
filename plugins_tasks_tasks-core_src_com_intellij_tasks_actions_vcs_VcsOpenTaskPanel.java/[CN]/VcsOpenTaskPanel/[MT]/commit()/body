{
  myTaskManager.getState().createChangelist=myCreateChangelist.isSelected();
  myTaskManager.getState().createBranch=myCreateBranch.isSelected();
  LocalTask localTask=myTaskManager.getActiveTask();
  if (myCreateChangelist.isSelected()) {
    myTaskManager.createChangeList(localTask,myChangelistName.getText());
  }
  if (myCreateBranch.isSelected()) {
    VcsTaskHandler.TaskInfo branchFrom=(VcsTaskHandler.TaskInfo)myBranchFrom.getSelectedItem();
    Runnable createBranch=new Runnable(){
      @Override public void run(){
        myTaskManager.createBranch(localTask,myPreviousTask,myBranchName.getText(),branchFrom);
      }
    }
;
    if (branchFrom != null) {
      myVcsTaskHandler.switchToTask(branchFrom,createBranch);
    }
 else {
      createBranch.run();
    }
  }
}
