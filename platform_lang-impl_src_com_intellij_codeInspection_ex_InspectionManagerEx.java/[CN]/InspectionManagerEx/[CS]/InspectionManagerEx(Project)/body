{
  super(project);
  if (ApplicationManager.getApplication().isHeadlessEnvironment()) {
    myContentManager=new NotNullLazyValue<ContentManager>(){
      @NotNull @Override protected ContentManager compute(){
        ToolWindowManager toolWindowManager=ToolWindowManager.getInstance(project);
        toolWindowManager.registerToolWindow(ToolWindowId.INSPECTION,true,ToolWindowAnchor.BOTTOM,project);
        return ContentFactory.SERVICE.getInstance().createContentManager(new TabbedPaneContentUI(),true,project);
      }
    }
;
  }
 else {
    myContentManager=new NotNullLazyValue<ContentManager>(){
      @NotNull @Override protected ContentManager compute(){
        ToolWindowManager toolWindowManager=ToolWindowManager.getInstance(project);
        ToolWindow toolWindow=toolWindowManager.registerToolWindow(ToolWindowId.INSPECTION,true,ToolWindowAnchor.BOTTOM,project);
        ContentManager contentManager=toolWindow.getContentManager();
        toolWindow.setIcon(AllIcons.Toolwindows.ToolWindowInspection);
        new ContentManagerWatcher(toolWindow,contentManager);
        contentManager.addContentManagerListener(new ContentManagerAdapter(){
          private static final String PREFIX="of ";
          @Override public void contentAdded(          ContentManagerEvent event){
            handleContentSizeChanged();
          }
          @Override public void contentRemoved(          ContentManagerEvent event){
            handleContentSizeChanged();
          }
          private void handleContentSizeChanged(){
            final int count=contentManager.getContentCount();
            if (count == 1) {
              final Content content=contentManager.getContent(0);
              final String displayName=content.getDisplayName();
              if (!content.getDisplayName().startsWith(PREFIX)) {
                content.setDisplayName(PREFIX + displayName);
              }
            }
 else             if (count > 1) {
              for (              Content content : contentManager.getContents()) {
                if (content.getDisplayName().startsWith(PREFIX)) {
                  content.setDisplayName(content.getDisplayName().substring(PREFIX.length()));
                }
              }
            }
          }
        }
);
        return contentManager;
      }
    }
;
  }
}
