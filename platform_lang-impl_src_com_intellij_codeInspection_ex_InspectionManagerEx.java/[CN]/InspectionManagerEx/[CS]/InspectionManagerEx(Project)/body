{
  super(project);
  if (ApplicationManager.getApplication().isHeadlessEnvironment()) {
    myContentManager=new NotNullLazyValue<ContentManager>(){
      @NotNull @Override protected ContentManager compute(){
        ToolWindowManager toolWindowManager=ToolWindowManager.getInstance(project);
        toolWindowManager.registerToolWindow(ToolWindowId.INSPECTION,true,ToolWindowAnchor.BOTTOM,project);
        return ContentFactory.SERVICE.getInstance().createContentManager(new TabbedPaneContentUI(),true,project);
      }
    }
;
  }
 else {
    myContentManager=new NotNullLazyValue<ContentManager>(){
      @NotNull @Override protected ContentManager compute(){
        ToolWindowManager toolWindowManager=ToolWindowManager.getInstance(project);
        ToolWindow toolWindow=toolWindowManager.registerToolWindow(ToolWindowId.INSPECTION,true,ToolWindowAnchor.BOTTOM,project);
        ContentManager contentManager=toolWindow.getContentManager();
        toolWindow.setIcon(AllIcons.Toolwindows.ToolWindowInspection);
        new ContentManagerWatcher(toolWindow,contentManager);
        contentManager.addContentManagerListener(new ContentManagerAdapter(){
          @Override public void contentAdded(          ContentManagerEvent event){
            handleContentSizeChanged();
          }
          @Override public void contentRemoved(          ContentManagerEvent event){
            handleContentSizeChanged();
          }
          private void handleContentSizeChanged(){
            final int count=contentManager.getContentCount();
            String newStripeTitle=null;
            if (count == 1) {
              newStripeTitle=InspectionsBundle.message("inspection.tool.window.stripe.title.single.content");
            }
 else             if (count > 1) {
              newStripeTitle=InspectionsBundle.message("inspection.tool.window.stripe.title.multiple.content");
            }
            final String stripeTitle=toolWindow.getStripeTitle();
            if (newStripeTitle != null && !stripeTitle.equals(newStripeTitle)) {
              toolWindow.setStripeTitle(newStripeTitle);
            }
          }
        }
);
        return contentManager;
      }
    }
;
  }
}
