{
  PyIfStatement expression=PsiTreeUtil.getParentOfType(file.findElementAt(editor.getCaretModel().getOffset()),PyIfStatement.class);
  PyStatement firstStatement=null;
  while (expression != null) {
    firstStatement=expression.getIfPart().getStatementList().getStatements()[0];
    if (firstStatement instanceof PyIfStatement) {
      break;
    }
    expression=PsiTreeUtil.getParentOfType(expression,PyIfStatement.class);
  }
  if (firstStatement != null && firstStatement instanceof PyIfStatement) {
    PyExpression condition=((PyIfStatement)firstStatement).getIfPart().getCondition();
    PyElementGenerator elementGenerator=PyElementGenerator.getInstance(project);
    PyExpression newCondition=elementGenerator.createExpressionFromText(expression.getIfPart().getCondition().getText() + " and " + condition.getText());
    expression.getIfPart().getCondition().replace(newCondition);
    PyStatementList stList=((PyIfStatement)firstStatement).getIfPart().getStatementList();
    expression.getIfPart().getStatementList().replace(stList);
  }
}
