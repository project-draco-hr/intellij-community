{
  try {
    final Map<String,Set<PyPackage>> dependentPackages=collectDependents(packages,mySdk);
    final int[] warning={0};
    if (!dependentPackages.isEmpty()) {
      ApplicationManager.getApplication().invokeAndWait(new Runnable(){
        @Override public void run(){
          if (dependentPackages.size() == 1) {
            String message="You are attempting to uninstall ";
            List<String> dep=new ArrayList<String>();
            int size=1;
            for (            Map.Entry<String,Set<PyPackage>> entry : dependentPackages.entrySet()) {
              final Set<PyPackage> value=entry.getValue();
              size=value.size();
              dep.add(entry.getKey() + " package which is required for " + StringUtil.join(value,", "));
            }
            message+=StringUtil.join(dep,"\n");
            message+=size == 1 ? " package" : " packages";
            message+="\n\nDo you want to proceed?";
            warning[0]=Messages.showYesNoDialog(message,"Warning",AllIcons.General.BalloonWarning);
          }
 else {
            String message="You are attempting to uninstall packages which are required for another packages.\n\n";
            List<String> dep=new ArrayList<String>();
            for (            Map.Entry<String,Set<PyPackage>> entry : dependentPackages.entrySet()) {
              dep.add(entry.getKey() + " -> " + StringUtil.join(entry.getValue(),", "));
            }
            message+=StringUtil.join(dep,"\n");
            message+="\n\nDo you want to proceed?";
            warning[0]=Messages.showYesNoDialog(message,"Warning",AllIcons.General.BalloonWarning);
          }
        }
      }
,ModalityState.current());
    }
    if (warning[0] != Messages.YES)     return true;
  }
 catch (  PyExternalProcessException e) {
    LOG.info("Error loading packages dependents: " + e.getMessage(),e);
  }
  return false;
}
