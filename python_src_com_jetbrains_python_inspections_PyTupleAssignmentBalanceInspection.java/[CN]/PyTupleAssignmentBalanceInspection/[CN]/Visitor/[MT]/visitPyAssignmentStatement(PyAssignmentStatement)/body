{
  PyExpression lhsExpression=node.getLeftHandSideExpression();
  PyExpression assignedValue=node.getAssignedValue();
  if (assignedValue instanceof PyParenthesizedExpression)   assignedValue=((PyParenthesizedExpression)assignedValue).getContainedExpression();
  if (lhsExpression instanceof PyTupleExpression && assignedValue instanceof PyTupleExpression) {
    int valuesLength=((PyTupleExpression)assignedValue).getElements().length;
    PyExpression[] elements=((PyTupleExpression)lhsExpression).getElements();
    boolean containsStarExpression=false;
    VirtualFile virtualFile=node.getContainingFile().getVirtualFile();
    if (virtualFile != null && LanguageLevel.forFile(virtualFile).isPy3K()) {
      for (      PyExpression target : elements) {
        if (target instanceof PyStarExpression) {
          if (containsStarExpression) {
            registerProblem(target,"Only one starred expression allowed in assignment");
            return;
          }
          containsStarExpression=true;
          ++valuesLength;
        }
      }
    }
    int targetsLength=elements.length;
    if (targetsLength > valuesLength) {
      registerProblem(assignedValue,"Need more values to unpack");
    }
 else     if (!containsStarExpression && targetsLength < valuesLength) {
      registerProblem(assignedValue,"Too many values to unpack");
    }
  }
}
