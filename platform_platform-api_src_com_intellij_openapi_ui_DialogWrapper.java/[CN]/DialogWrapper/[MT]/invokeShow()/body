{
  Window window=myPeer.getWindow();
  if (window instanceof JDialog && ((JDialog)window).getModalityType() == Dialog.ModalityType.DOCUMENT_MODAL) {
    if (ApplicationManager.getApplication().isWriteAccessAllowed()) {
      LOG.error("Project-modal dialogs should not be shown under a write action.");
    }
  }
  final AsyncResult<Boolean> result=new AsyncResult<>();
  ensureEventDispatchThread();
  registerKeyboardShortcuts();
  final Disposable uiParent=Disposer.get("ui");
  if (uiParent != null) {
    Disposer.register(uiParent,myDisposable);
  }
  Disposer.register(myDisposable,new Disposable(){
    @Override public void dispose(){
      result.setDone(isOK());
    }
  }
);
  myPeer.show();
  return result;
}
