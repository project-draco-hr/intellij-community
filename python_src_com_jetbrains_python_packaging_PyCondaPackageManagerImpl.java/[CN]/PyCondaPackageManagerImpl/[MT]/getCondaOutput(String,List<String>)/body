{
  final Sdk sdk=getSdk();
  if (sdk == null) {
    throw new ExecutionException("Failed to find interpreter \"" + mySdkHomePath + "\"");
  }
  final String condaExecutable=PyCondaPackageService.getCondaExecutable(sdk.getHomeDirectory());
  if (condaExecutable == null)   throw new PyExecutionException("Cannot find conda","Conda",Collections.<String>emptyList(),new ProcessOutput());
  final String path=getCondaDirectory();
  if (path == null)   throw new PyExecutionException("Empty conda name for \"" + mySdkHomePath + "\"",command,arguments);
  final ArrayList<String> parameters=Lists.newArrayList(condaExecutable,command,"-p",path);
  parameters.addAll(arguments);
  final GeneralCommandLine commandLine=new GeneralCommandLine(parameters);
  final Process process=commandLine.createProcess();
  final CapturingProcessHandler handler=new CapturingProcessHandler(process);
  final ProgressIndicator indicator=ProgressManager.getInstance().getProgressIndicator();
  final ProcessOutput result;
  if (indicator != null) {
    result=handler.runProcessWithProgressIndicator(indicator);
  }
 else {
    result=handler.runProcess();
  }
  if (result.isCancelled()) {
    throw new RunCanceledByUserException();
  }
  final int exitCode=result.getExitCode();
  if (exitCode != 0) {
    final String message=StringUtil.isEmptyOrSpaces(result.getStdout()) && StringUtil.isEmptyOrSpaces(result.getStderr()) ? "Permission denied" : "Non-zero exit code";
    throw new PyExecutionException(message,"Conda",parameters,result);
  }
  return result;
}
