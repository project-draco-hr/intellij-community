{
  PsiExpression expr=getTopmostExpression(context);
  PsiElement parent=expr != null ? expr.getParent() : null;
  if (!(parent instanceof PsiExpressionStatement))   return;
  Project project=context.getProject();
  PsiElementFactory factory=JavaPsiFacade.getInstance(project).getElementFactory();
  CodeStyleManager codeStyleManager=CodeStyleManager.getInstance(project);
  PsiElement statement=codeStyleManager.reformat(factory.createStatementFromText(text + " (" + expr.getText()+ ") {\nst;\n}",context));
  statement=parent.replace(statement);
  PsiCodeBlock block=CodeInsightUtilCore.forcePsiPostprocessAndRestoreElement(PsiTreeUtil.getChildOfType(statement,PsiCodeBlock.class));
  TextRange range=block.getStatements()[0].getTextRange();
  editor.getDocument().deleteString(range.getStartOffset(),range.getEndOffset());
  editor.getCaretModel().moveToOffset(range.getStartOffset());
}
