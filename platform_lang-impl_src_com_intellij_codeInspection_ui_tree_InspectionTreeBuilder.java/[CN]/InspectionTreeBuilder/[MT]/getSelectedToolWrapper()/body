{
  final TreePath[] paths=getTree().getSelectionPaths();
  if (paths == null)   return null;
  InspectionToolWrapper toolWrapper=null;
  for (  TreePath path : paths) {
    Object[] nodes=path.getPath();
    for (int j=nodes.length - 1; j >= 0; j--) {
      DefaultMutableTreeNode nodeWrapper=(DefaultMutableTreeNode)nodes[j];
      Object userObject=nodeWrapper.getUserObject();
      if (!(userObject instanceof InspectionTreeNode))       continue;
      InspectionTreeNode node=(InspectionTreeNode)userObject;
      if (node instanceof InspectionGroupNode) {
        return null;
      }
      if (node instanceof InspectionNode) {
        InspectionToolWrapper wrapper=((InspectionNode)node).getToolWrapper();
        if (toolWrapper == null) {
          toolWrapper=wrapper;
        }
 else         if (toolWrapper != wrapper) {
          return null;
        }
        break;
      }
    }
  }
  return toolWrapper;
}
