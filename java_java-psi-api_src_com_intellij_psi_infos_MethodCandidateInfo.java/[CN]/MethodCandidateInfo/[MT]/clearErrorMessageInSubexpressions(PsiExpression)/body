{
  expression=PsiUtil.skipParenthesizedExprDown(expression);
  if (expression instanceof PsiConditionalExpression) {
    String message=clearErrorMessageInSubexpressions(((PsiConditionalExpression)expression).getThenExpression());
    if (message != null) {
      return message;
    }
    return clearErrorMessageInSubexpressions(((PsiConditionalExpression)expression).getElseExpression());
  }
 else   if (expression instanceof PsiCallExpression) {
    final JavaResolveResult result;
    if (expression instanceof PsiNewExpression) {
      PsiDiamondType diamondType=PsiDiamondType.getDiamondType((PsiNewExpression)expression);
      result=diamondType != null ? diamondType.getStaticFactory() : ((PsiCallExpression)expression).resolveMethodGenerics();
    }
 else {
      result=((PsiCallExpression)expression).resolveMethodGenerics();
    }
    if (result instanceof MethodCandidateInfo) {
      final String message=((MethodCandidateInfo)result).getInferenceErrorMessage();
      ((MethodCandidateInfo)result).setInferenceError(null);
      return message;
    }
  }
  return null;
}
