{
  File f=new File(myOlderDir,"Readme.txt");
  FileOutputStream s=new FileOutputStream(f,true);
  try {
    FileLock lock=s.getChannel().lock();
    try {
      String message=UtilsTest.mIsWindows ? "Locked by: Java(TM) Platform SE binary" : ValidationResult.ACCESS_DENIED_MESSAGE;
      ValidationResult.Option option=UtilsTest.mIsWindows ? ValidationResult.Option.KILL_PROCESS : ValidationResult.Option.IGNORE;
      List<ValidationResult> result=myPatch.validate(myOlderDir,TEST_UI);
      assertEquals(new HashSet<ValidationResult>(Arrays.asList(new ValidationResult(ValidationResult.Kind.ERROR,"Readme.txt",ValidationResult.Action.UPDATE,message,option))),new HashSet<ValidationResult>(result));
    }
  finally {
      lock.release();
    }
  }
  finally {
    s.close();
  }
}
