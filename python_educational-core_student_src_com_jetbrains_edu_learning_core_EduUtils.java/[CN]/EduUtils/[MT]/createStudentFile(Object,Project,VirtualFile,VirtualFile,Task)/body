{
  VirtualFile studentFile=copyFile(requestor,parentDir,answerFile);
  if (studentFile == null) {
    return null;
  }
  Document studentDocument=FileDocumentManager.getInstance().getDocument(studentFile);
  if (studentDocument == null) {
    return null;
  }
  if (task == null) {
    task=StudyUtils.getTaskForFile(project,answerFile);
    if (task == null) {
      return null;
    }
    task=task.copy();
  }
  TaskFile taskFile=task.getTaskFile(answerFile.getName());
  if (taskFile == null) {
    return null;
  }
  EduDocumentListener listener=new EduDocumentListener(taskFile,false);
  studentDocument.addDocumentListener(listener);
  for (  AnswerPlaceholder placeholder : taskFile.getAnswerPlaceholders()) {
    replaceAnswerPlaceholder(project,studentDocument,placeholder);
  }
  studentDocument.removeDocumentListener(listener);
  return Pair.create(studentFile,taskFile);
}
