{
  buffer.append(HEADER_PREFIX);
  buffer.append("{\\colortbl;");
  ColorRegistry colorRegistry=syntaxInfo.getColorRegistry();
  for (  int id : colorRegistry.getAllIds()) {
    Color color=colorRegistry.dataById(id);
    buffer.append(String.format("\\red%d\\green%d\\blue%d;",color.getRed(),color.getGreen(),color.getBlue()));
  }
  buffer.append("}\n");
  buffer.append("{\\fonttbl");
  FontNameRegistry fontNameRegistry=syntaxInfo.getFontNameRegistry();
  for (  int id : fontNameRegistry.getAllIds()) {
    String fontName=fontNameRegistry.dataById(id);
    buffer.append(String.format("{\\f%d %s;}",id,fontName));
  }
  buffer.append("}\n");
  next.run();
  buffer.append(HEADER_SUFFIX);
}
