{
  GraphicsEnvironment env=GraphicsEnvironment.getLocalGraphicsEnvironment();
  if (env.isHeadlessInstance()) {
    return key + ".headless";
  }
  JFrame frame=null;
  final Component owner=IdeFocusManager.findInstance().getFocusOwner();
  if (owner != null) {
    frame=UIUtil.getParentOfType(JFrame.class,owner);
  }
  if (frame == null) {
    frame=WindowManager.getInstance().findVisibleFrame();
  }
  if (project != null && (frame == null || (frame instanceof IdeFrame && project != ((IdeFrame)frame).getProject()))) {
    frame=WindowManager.getInstance().getFrame(project);
  }
  Rectangle screen=new Rectangle(0,0,0,0);
  GraphicsDevice device=null;
  if (frame != null) {
    device=ScreenUtil.getScreenDevice(frame.getBounds());
  }
  if (device == null) {
    device=env.getDefaultScreenDevice();
  }
  if (device != null) {
    screen=device.getDefaultConfiguration().getBounds();
  }
  String realKey=key + '.' + screen.x+ '.'+ screen.y+ '.'+ screen.width+ '.'+ screen.height;
  if (JBUI.isHiDPI()) {
    realKey+="@" + JBUI.scale(1) + "x";
  }
  return realKey;
}
