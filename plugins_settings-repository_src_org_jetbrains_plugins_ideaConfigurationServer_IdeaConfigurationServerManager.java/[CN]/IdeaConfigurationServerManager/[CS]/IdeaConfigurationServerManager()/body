{
  settings=new IdeaConfigurationServerSettings();
  myLocalCopyDir=new File(PathManager.getSystemPath(),"ideaConfigurationServer");
  myUpdateRequest=new Runnable(){
    @Override public void run(){
      myUpdateAlarm.cancelAllRequests();
      try {
        try {
          if (settings.getStatus() == IdeaServerStatus.CONNECTION_FAILED && settings.getUserName() != null && settings.getPassword() != null) {
            login();
          }
 else           if (settings.getStatus() == IdeaServerStatus.LOGGED_IN && settings.getUserName() != null && settings.getPassword() != null) {
            ping();
          }
        }
 catch (        Exception e) {
        }
      }
  finally {
        myUpdateAlarm.addRequest(myUpdateRequest,30 * 1000);
      }
    }
  }
;
  settings.addStatusListener(new StatusListener(){
    @Override public void statusChanged(    final IdeaServerStatus status){
      if (status == IdeaServerStatus.LOGGED_IN) {
        if (!settings.wereSettingsSynchronized()) {
          try {
            backupConfig();
          }
  finally {
            settings.settingsWereSynchronized();
          }
        }
        try {
          saveSettingsLocalCopy(myLocalCopyDir);
        }
 catch (        SocketTimeoutException timeout) {
        }
catch (        IOException e) {
          LOG.info(e);
        }
      }
    }
  }
);
}
