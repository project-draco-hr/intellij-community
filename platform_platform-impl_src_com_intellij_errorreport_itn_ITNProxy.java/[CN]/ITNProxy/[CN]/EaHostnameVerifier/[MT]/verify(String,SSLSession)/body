{
  try {
    Certificate[] certificates=session.getPeerCertificates();
    if (certificates.length > 0) {
      Certificate certificate=certificates[0];
      if (certificate instanceof X509Certificate) {
        String cn=CertificateUtil.getCommonName((X509Certificate)certificate);
        return myAllowedHosts.contains(cn);
      }
    }
  }
 catch (  SSLPeerUnverifiedException ignored) {
  }
  return false;
}
