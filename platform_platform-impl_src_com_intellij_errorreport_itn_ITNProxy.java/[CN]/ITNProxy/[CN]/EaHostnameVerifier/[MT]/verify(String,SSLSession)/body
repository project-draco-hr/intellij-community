{
  try {
    Certificate[] certificates=session.getPeerCertificates();
    if (certificates.length > 1) {
      Certificate certificate=certificates[0];
      if (certificate instanceof X509Certificate) {
        String cn=CertificateUtil.getCommonName((X509Certificate)certificate);
        if (cn.endsWith(".jetbrains.com") || cn.endsWith(".intellij.net")) {
          return true;
        }
      }
      Certificate ca=certificates[certificates.length - 1];
      if (ca instanceof X509Certificate) {
        String cn=CertificateUtil.getCommonName((X509Certificate)ca);
        byte[] digest=MessageDigest.getInstance("SHA-1").digest(ca.getEncoded());
        StringBuilder fp=new StringBuilder(2 * digest.length);
        for (        byte b : digest)         fp.append(Integer.toHexString(b & 0xFF));
        if (JB_CA_CN.equals(cn) && JB_CA_FP.equals(fp.toString())) {
          return true;
        }
      }
    }
  }
 catch (  SSLPeerUnverifiedException ignored) {
  }
catch (  NoSuchAlgorithmException ignored) {
  }
catch (  CertificateEncodingException ignored) {
  }
  return false;
}
