{
  TemplateManagerImpl.setTemplateTesting(myFixture.getProject(),getTestRootDisposable());
  myFixture.configureByText("a.java","class A {\n" + "  public String tes<caret>t() {\n" + "  }\n"+ "}");
  new WriteCommandAction.Simple<Void>(myFixture.getProject(),myFixture.getFile()){
    @Override protected void run() throws Throwable {
      TemplateBuilderFactory.getInstance().createTemplateBuilder(myFixture.getElementAtCaret()).run(myFixture.getEditor(),true);
    }
  }
.execute();
  myFixture.checkResult("class A {\n" + "  <caret>public String test() {\n" + "  }\n"+ "}");
}
