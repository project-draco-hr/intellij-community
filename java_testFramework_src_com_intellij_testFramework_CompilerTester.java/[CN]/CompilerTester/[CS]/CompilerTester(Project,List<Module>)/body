{
  myProject=project;
  myModules=modules;
  myMainOutput=new TempDirTestFixtureImpl();
  myMainOutput.setUp();
  new WriteCommandAction(getProject()){
    @Override protected void run(    @NotNull Result result) throws Throwable {
      CompilerProjectExtension.getInstance(getProject()).setCompilerOutputUrl(myMainOutput.findOrCreateDir("out").getUrl());
      CompilerTestUtil.enableExternalCompiler();
      for (      Module module : myModules) {
        ModuleRootModificationUtil.setModuleSdk(module,JavaAwareProjectJdkTableImpl.getInstanceEx().getInternalJdk());
      }
    }
  }
.execute();
}
