{
  PsiFile psiFile=myFixture.configureByFile("helloworld.py");
  Document document=myFixture.getDocument(psiFile);
  SAXBuilder builder=new SAXBuilder();
  org.jdom.Document xml=builder.build(getTestDataPath() + "/helloworld.xml");
  TaskFile taskFile=XmlSerializer.deserialize(xml,TaskFile.class);
  assertNotNull(taskFile);
  CCCreateCourseArchive.InsertionListener listener=new CCCreateCourseArchive.InsertionListener(taskFile);
  document.addDocumentListener(listener);
  List<TaskWindow> taskWindows=taskFile.getTaskWindows();
  for (  TaskWindow tw : taskWindows) {
    replaceTaskWindow(myFixture.getProject(),document,tw);
  }
  assertEquals(5,taskWindows.size());
  checkTaskWindowLocation(document,taskWindows.get(0),0,taskWindows.get(0).getLength());
  int startOffset=8 + taskWindows.get(0).getLength();
  checkTaskWindowLocation(document,taskWindows.get(1),startOffset,startOffset + taskWindows.get(1).getLength());
  checkTaskWindowLocation(document,taskWindows.get(4),document.getLineStartOffset(2),document.getLineStartOffset(2) + taskWindows.get(4).getLength());
}
