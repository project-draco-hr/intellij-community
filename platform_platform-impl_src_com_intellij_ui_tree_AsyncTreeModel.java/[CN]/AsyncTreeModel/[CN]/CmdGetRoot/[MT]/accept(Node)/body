{
  if (node != null) {
    Object object=node.getLastPathComponent();
    if (tree.root == object) {
      Node root=tree.map.get(object);
      if (root == null) {
        debug("ignore updating of changed root",object);
      }
 else {
        root.leaf=node.leaf;
        processor.process(new CmdGetChildren("Reload children",root,true));
      }
    }
 else {
      tree.root=object;
      tree.map.clear();
      tree.map.put(object,node);
      treeStructureChanged(node,null,null);
    }
  }
 else   if (tree.root != null) {
    tree.root=null;
    tree.map.clear();
    treeStructureChanged(null,null,null);
  }
}
