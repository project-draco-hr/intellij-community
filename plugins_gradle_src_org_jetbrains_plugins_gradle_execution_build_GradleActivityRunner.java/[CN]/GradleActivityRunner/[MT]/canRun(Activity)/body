{
  if (!GradleSystemRunningSettings.getInstance().isUseGradleAwareMake())   return false;
  if (activity instanceof ModuleBuildActivity) {
    return ExternalSystemApiUtil.isExternalSystemAwareModule(GradleConstants.SYSTEM_ID,((ModuleBuildActivity)activity).getModule());
  }
  if (activity instanceof ArtifactBuildActivity) {
    ArtifactBuildActivity artifactBuildActivity=(ArtifactBuildActivity)activity;
    for (    GradleArtifactBuildTasksProvider buildTasksProvider : GradleArtifactBuildTasksProvider.EP_NAME.getExtensions()) {
      if (buildTasksProvider.isApplicable(artifactBuildActivity))       return true;
    }
  }
  if (activity instanceof RunActivity) {
    if (!GradleSystemRunningSettings.getInstance().isUseGradleAwareMake())     return false;
    RunProfile runProfile=((RunActivity)activity).getRunProfile();
    if (runProfile instanceof ApplicationConfiguration) {
      JavaRunConfigurationModule module=((ApplicationConfiguration)runProfile).getConfigurationModule();
      return ExternalSystemApiUtil.isExternalSystemAwareModule(GradleConstants.SYSTEM_ID,module.getModule());
    }
  }
  return false;
}
