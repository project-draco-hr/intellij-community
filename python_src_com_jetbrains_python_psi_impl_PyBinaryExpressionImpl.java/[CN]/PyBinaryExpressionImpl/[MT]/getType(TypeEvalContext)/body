{
  final PyExpression lhs=getLeftExpression();
  final PyExpression rhs=getRightExpression();
  final PsiElement operator=getPsiOperator();
  if (lhs != null && rhs != null && operator != null) {
    final PsiReference ref=getReference(PyResolveContext.noImplicits().withTypeEvalContext(context));
    final PsiElement resolved=ref.resolve();
    if (resolved instanceof Callable) {
      context.trace("Binary operator reference resolved to %s",resolved);
      final PyType res=((Callable)resolved).getReturnType(context,this);
      context.trace("Binary operator reference resolve type is %s",res);
      if (!PyTypeChecker.isUnknown(res) && !(res instanceof PyNoneType)) {
        return res;
      }
    }
 else {
      context.trace("Failed to resolve binary operator reference %s",this);
    }
    if (PyNames.COMPARISON_OPERATORS.contains(getReferencedName())) {
      return PyBuiltinCache.getInstance(this).getBoolType();
    }
  }
  return null;
}
