{
  PsiDirectory result=null;
  final Project project=e.getData(CommonDataKeys.PROJECT);
  final VirtualFile vFile=e.getData(CommonDataKeys.VIRTUAL_FILE);
  if (project != null && vFile != null) {
    final PsiManager psiManager=PsiManager.getInstance(project);
    if (vFile.isDirectory()) {
      final PsiDirectory dir=psiManager.findDirectory(vFile);
      if (dir != null && PyUtil.isPackage(dir,null)) {
        result=dir;
      }
    }
 else {
      final PsiFile file=psiManager.findFile(vFile);
      if (file != null && PyUtil.isPackage(file)) {
        result=file.getParent();
      }
    }
  }
  if (result != null && isStrictlyUnderContentRoots(result) && isEmptyPackage(result)) {
    return result;
  }
  return null;
}
