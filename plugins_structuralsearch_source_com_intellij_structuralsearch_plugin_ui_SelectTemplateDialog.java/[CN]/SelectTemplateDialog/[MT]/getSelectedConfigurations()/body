{
  if (showHistory) {
    Object[] selectedValues=existingTemplatesComponent.getHistoryList().getSelectedValues();
    return selectedValues == null ? new Configuration[0] : (Configuration[])selectedValues;
  }
 else {
    TreePath[] paths=existingTemplatesComponent.getPatternTree().getSelectionModel().getSelectionPaths();
    if (paths == null) {
      return new Configuration[0];
    }
    Collection<Configuration> configurations=new ArrayList<Configuration>();
    for (    TreePath path : paths) {
      DefaultMutableTreeNode node=(DefaultMutableTreeNode)path.getLastPathComponent();
      final Object userObject=node.getUserObject();
      if (userObject instanceof Configuration) {
        configurations.add((Configuration)userObject);
      }
    }
    return configurations.toArray(new Configuration[configurations.size()]);
  }
}
