{
  if (downNodeIndex == myVisibleToReal.longSize()) {
    return myLayout.getLayoutIndex(upNodeIndex);
  }
  int upNodeLayoutIndex=myLayout.getLayoutIndex(upNodeIndex);
  int downNodeLayoutIndex=myLayout.getLayoutIndex(downNodeIndex);
  return Math.max(upNodeLayoutIndex,downNodeLayoutIndex);
}
