{
  CharSequence seq=document.getCharsSequence();
  int rangeEnd=rbrace.getTextRange().getStartOffset();
  int methodEndLine=document.getLineNumber(rangeEnd);
  int methodEndLineStart=document.getLineStartOffset(methodEndLine);
  if ("}".equals(seq.subSequence(methodEndLineStart,document.getLineEndOffset(methodEndLine)).toString().trim())) {
    int classEndStart=classRBrace.getTextRange().getStartOffset();
    int classEndCol=classEndStart - document.getLineStartOffset(document.getLineNumber(classEndStart));
    return classEndCol + methodEndLineStart;
  }
  return rangeEnd;
}
