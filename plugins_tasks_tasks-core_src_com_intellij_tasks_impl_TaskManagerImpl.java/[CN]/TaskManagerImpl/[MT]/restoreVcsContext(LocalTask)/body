{
  if (!isVcsEnabled())   return task;
  List<ChangeListInfo> changeLists=task.getChangeLists();
  if (!changeLists.isEmpty()) {
    ChangeListInfo info=changeLists.get(0);
    LocalChangeList changeList=myChangeListManager.getChangeList(info.id);
    if (changeList == null) {
      changeList=myChangeListManager.addChangeList(info.name,info.comment);
      info.id=changeList.getId();
    }
    myChangeListManager.setDefaultChangeList(changeList);
  }
  List<BranchInfo> branches=task.getBranches();
  MultiMap<String,String> map=new MultiMap<String,String>();
  for (  BranchInfo branch : branches) {
    map.putValue(branch.name,branch.repository);
  }
  VcsTaskHandler[] handlers=VcsTaskHandler.getAllHandlers(myProject);
  for (  VcsTaskHandler handler : handlers) {
    handler.switchToTask(new VcsTaskHandler.TaskInfo(map));
  }
  return task;
}
