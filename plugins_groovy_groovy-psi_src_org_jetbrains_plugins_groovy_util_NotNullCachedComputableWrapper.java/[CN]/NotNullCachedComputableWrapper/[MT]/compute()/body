{
  while (true) {
    T value=myValueRef.get();
    if (value != null)     return value;
    final NotNullComputable<T> computable=myComputable;
    if (computable == null)     continue;
    RecursionGuard.StackStamp stamp=RecursionManager.createGuard(computable.getClass().getName()).markStack();
    value=computable.compute();
    if (stamp.mayCacheNow()) {
      if (myValueRef.compareAndSet(null,value)) {
        myComputable=null;
        return value;
      }
    }
 else {
      return value;
    }
  }
}
