{
switch (state) {
case ALL_LOG_READER:
    throw new IllegalStateException("data was read");
case UNINITIALIZED:
  List<CommitParents> commitParentsList=partReader.readNextBlock(statusUpdater);
state=State.PART_LOG_READER;
List<Ref> allRefs=new RefReader().readAllRefs();
dataPack=DataPackImpl.buildDataPack(commitParentsList,allRefs,statusUpdater);
break;
case PART_LOG_READER:
List<CommitParents> nextPart=partReader.readNextBlock(statusUpdater);
dataPack.appendCommits(nextPart,statusUpdater);
break;
default :
throw new IllegalStateException();
}
}
