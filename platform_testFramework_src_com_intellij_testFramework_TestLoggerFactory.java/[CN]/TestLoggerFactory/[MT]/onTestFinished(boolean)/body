{
  if (!success && BUFFER.length() != 0) {
    if (UsefulTestCase.IS_UNDER_TEAMCITY) {
      BUFFER.insert(0,"##teamcity[blockOpened name='DEBUG log']\n");
      BUFFER.append("\n##teamcity[blockClosed name='DEBUG log']\n");
      System.err.println(BUFFER);
    }
 else {
      String[] lines=LineTokenizer.tokenize(BUFFER,false,false);
      String text=StringUtil.join(lines,FAILED_TEST_DEBUG_OUTPUT_MARKER + "\n");
      if (!text.startsWith("\n"))       text="\n" + text;
      System.err.println(text);
    }
  }
  BUFFER.setLength(0);
}
