{
  if (!success && BUFFER.length() != 0) {
    if (UsefulTestCase.IS_UNDER_TEAMCITY) {
      System.out.flush();
      System.out.println("##teamcity[blockOpened name='DEBUG log']\n");
      System.out.flush();
      System.out.println(BUFFER);
      System.out.flush();
      System.out.println("\n##teamcity[blockClosed name='DEBUG log']\n");
      System.out.flush();
    }
 else {
      String[] lines=LineTokenizer.tokenize(BUFFER,false,false);
      String text=StringUtil.join(lines,FAILED_TEST_DEBUG_OUTPUT_MARKER + "\n");
      if (!text.startsWith("\n"))       text="\n" + text;
      System.err.println(text);
    }
  }
  BUFFER.setLength(0);
}
