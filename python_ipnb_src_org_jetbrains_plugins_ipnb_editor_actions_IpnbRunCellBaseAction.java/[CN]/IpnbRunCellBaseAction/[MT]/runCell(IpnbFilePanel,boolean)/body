{
  final IpnbEditablePanel cell=ipnbFilePanel.getSelectedCell();
  if (cell == null)   return;
  cell.runCell();
  if (selectNext) {
    final int index=ipnbFilePanel.getSelectedIndex();
    if (ipnbFilePanel.getIpnbPanels().size() - 1 == index) {
      ipnbFilePanel.createAndAddCell(true);
      CommandProcessor.getInstance().executeCommand(ipnbFilePanel.getProject(),new Runnable(){
        public void run(){
          ApplicationManager.getApplication().runWriteAction(new Runnable(){
            public void run(){
              ipnbFilePanel.saveToFile();
            }
          }
);
        }
      }
,"Ipnb.runCell",new Object());
    }
    ipnbFilePanel.selectNext(cell);
  }
  ipnbFilePanel.revalidate();
  ipnbFilePanel.repaint();
  ipnbFilePanel.requestFocus();
}
