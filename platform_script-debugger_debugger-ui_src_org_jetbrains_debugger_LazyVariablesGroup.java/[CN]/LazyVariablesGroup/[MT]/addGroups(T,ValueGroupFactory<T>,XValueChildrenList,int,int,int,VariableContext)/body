{
  int to=Math.min(bucketSize,limit);
  boolean done=false;
  do {
    int groupFrom=from;
    int groupTo=to;
    from+=bucketSize;
    to=from + Math.min(bucketSize,limit - from);
    if (to - from == 1) {
      groupTo++;
      done=true;
    }
    groupList.addTopGroup(groupFactory.create(data,groupFrom,groupTo,context));
    if (from >= limit) {
      break;
    }
  }
 while (!done);
}
