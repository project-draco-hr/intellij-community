{
  if (module == null)   return;
  MavenProject mavenProject=MavenProjectsManager.getInstance(module.getProject()).findProject(module);
  if (mavenProject == null)   return;
  Element config=mavenProject.getPluginConfiguration("org.apache.maven.plugins","maven-surefire-plugin");
  if (config == null)   return;
  List<String> paths=MavenJDOMUtil.findChildrenValuesByPath(config,"additionalClasspathElements","additionalClasspathElement");
  if (paths.size() > 0) {
    MavenDomProjectModel domModel=MavenDomUtil.getMavenDomProjectModel(module.getProject(),mavenProject.getFile());
    for (    String path : paths) {
      if (domModel != null) {
        path=MavenPropertyResolver.resolve(path,domModel);
      }
      javaParameters.getClassPath().add(resolveSurefireProperties(path));
    }
  }
  Element systemPropertyVariables=config.getChild("systemPropertyVariables");
  if (systemPropertyVariables != null && isEnabled("systemPropertyVariables")) {
    for (    Element element : systemPropertyVariables.getChildren()) {
      String propertyName=element.getName();
      if (!javaParameters.getVMParametersList().hasProperty(propertyName)) {
        String value=resolveSurefireProperties(element.getValue());
        if (isResolved(value)) {
          javaParameters.getVMParametersList().addProperty(propertyName,value);
        }
      }
    }
  }
  Element environmentVariables=config.getChild("environmentVariables");
  if (environmentVariables != null && isEnabled("environmentVariables")) {
    for (    Element element : environmentVariables.getChildren()) {
      String variableName=element.getName();
      if (javaParameters.getEnv() == null || !javaParameters.getEnv().containsKey(variableName)) {
        String value=resolveSurefireProperties(element.getValue());
        if (isResolved(value)) {
          javaParameters.addEnv(variableName,value);
        }
      }
    }
  }
  Element argLine=config.getChild("argLine");
  if (argLine != null && isEnabled("argLine")) {
    String value=resolveSurefireProperties(argLine.getTextTrim());
    if (StringUtil.isNotEmpty(value) && isResolved(value)) {
      javaParameters.getVMParametersList().addParametersString(value);
    }
  }
}
