{
  final Boolean haveSelectedChanges=e.getData(VcsDataKeys.HAVE_SELECTED_CHANGES);
  Change[] changes;
  ChangeList[] changeLists=e.getData(VcsDataKeys.CHANGE_LISTS);
  List<ShelvedChangeList> shelveChangelists=ShelvedChangesViewManager.getShelvedLists(e.getDataContext());
  int changelistNum=changeLists == null ? 0 : changeLists.length;
  changelistNum+=shelveChangelists.size();
  e.getPresentation().setEnabled(Boolean.TRUE.equals(haveSelectedChanges) && (changelistNum == 1) && ((changes=e.getData(VcsDataKeys.CHANGES)) != null && changes.length > 0));
}
