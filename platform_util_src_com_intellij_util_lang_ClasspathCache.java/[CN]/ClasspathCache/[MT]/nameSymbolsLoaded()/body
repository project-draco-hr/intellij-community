{
  Name2LoaderFilter nameFilter=myNameFilter;
  Map<String,Set<Loader>> resources2LoadersTempMap=myResources2LoadersTempMap;
  if (nameFilter != null) {
    if (doDebug && registeredAfterClose > 0) {
      LOG.debug("Registered number of classes after close " + registeredAfterClose + " "+ toString());
    }
    return;
  }
  if (doDebug) {
    LOG.debug("Registered number of classes before classes " + registeredBeforeClose + " "+ toString());
  }
  int nBits=0;
  int uniques=0;
  for (  Map.Entry<String,Set<Loader>> e : resources2LoadersTempMap.entrySet()) {
    int size=e.getValue().size();
    if (size == 1) {
      ++uniques;
    }
    nBits+=size;
  }
  if (nBits > 20000) {
    nBits+=(int)(nBits * 0.03d);
  }
  nameFilter=new Name2LoaderFilter(nBits,PROBABILITY);
  for (  Map.Entry<String,Set<Loader>> e : resources2LoadersTempMap.entrySet()) {
    final String name=e.getKey();
    for (    Loader loader : e.getValue()) {
      nameFilter.add(name,loader);
    }
  }
  myNameFilter=nameFilter;
  if (!doDebug) {
    myResources2LoadersTempMap=null;
  }
}
