{
  Project project=elt.getProject();
  PsiFile psiFile=getContainingFile(elt);
  final Document doc=PsiDocumentManager.getInstance(project).getDocument(psiFile);
  if (doc == null)   return null;
  if (elt.getTextRange() == null) {
    return null;
  }
  final ImplementationTextSelectioner implementationTextSelectioner=LanguageImplementationTextSelectioner.INSTANCE.forLanguage(elt.getLanguage());
  int start=implementationTextSelectioner.getTextStartOffset(elt);
  CharSequence rawDefinition=doc.getCharsSequence().subSequence(start,implementationTextSelectioner.getTextEndOffset(elt));
  int end=CharArrayUtil.shiftBackward(rawDefinition,rawDefinition.length(),"\r\n");
  final int lineStart=doc.getLineStartOffset(doc.getLineNumber(start));
  final int lineEnd=end < doc.getTextLength() ? doc.getLineEndOffset(doc.getLineNumber(end)) : doc.getTextLength();
  return doc.getCharsSequence().subSequence(lineStart,lineEnd).toString();
}
