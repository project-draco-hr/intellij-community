{
  myShouldAddComma=false;
  if (!(file instanceof JsonFile) || !super.checkAvailable(editor,file,info,down)) {
    return false;
  }
  final Pair<PsiElement,PsiElement> movedElementRange=getElementRange(editor,file,info.toMove);
  final Pair<PsiElement,PsiElement> destElementRange=getElementRange(editor,file,info.toMove2);
  if (!isValidElementRange(movedElementRange) || !isValidElementRange(destElementRange)) {
    return false;
  }
  if (movedElementRange.getFirst().getParent() != destElementRange.getSecond().getParent()) {
    return false;
  }
  final PsiElement commonParent=movedElementRange.getFirst().getParent();
  final PsiElement lowerRightElement=down ? destElementRange.getSecond() : movedElementRange.getSecond();
  if (commonParent instanceof JsonArray) {
    if (PsiTreeUtil.getNextSiblingOfType(lowerRightElement,JsonValue.class) == null && TreeUtil.findSibling(lowerRightElement.getNode(),JsonElementTypes.COMMA) == null) {
      myShouldAddComma=true;
    }
  }
 else   if (commonParent instanceof JsonObject) {
    if (PsiTreeUtil.getNextSiblingOfType(lowerRightElement,JsonProperty.class) == null && TreeUtil.findSibling(lowerRightElement.getNode(),JsonElementTypes.COMMA) == null) {
      myShouldAddComma=true;
    }
  }
  info.indentSource=false;
  info.indentTarget=false;
  return true;
}
