{
  File foo=PlatformTestCase.createTempDir("foo");
  Project project=null;
  MyStartupActivity activity=new MyStartupActivity();
  PlatformTestUtil.registerExtension(POST_STARTUP_ACTIVITY,activity,getTestRootDisposable());
  try {
    ProjectManagerEx manager=ProjectManagerEx.getInstanceEx();
    project=manager.createProject(null,foo.getPath());
    assertFalse(manager.openProject(project));
    assertFalse(project.isOpen());
    assertTrue(activity.passed);
  }
  finally {
    closeProject(project);
  }
}
