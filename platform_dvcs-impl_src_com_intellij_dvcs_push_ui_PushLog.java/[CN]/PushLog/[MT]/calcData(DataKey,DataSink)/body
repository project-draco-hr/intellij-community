{
  if (VcsDataKeys.CHANGES.equals(key)) {
    DefaultMutableTreeNode[] selectedNodes=myTree.getSelectedNodes(DefaultMutableTreeNode.class,null);
    if (selectedNodes.length == 0) {
      return;
    }
    DefaultMutableTreeNode node=selectedNodes[0];
    Object object=node.getUserObject();
    Collection<Change> changes=null;
    if (object instanceof VcsFullCommitDetails) {
      changes=((VcsFullCommitDetails)object).getChanges();
    }
 else     if (node instanceof RepositoryNode) {
      changes=collectAllChanges((RepositoryNode)node);
    }
    if (changes != null) {
      sink.put(key,ArrayUtil.toObjectArray(changes,Change.class));
    }
  }
}
