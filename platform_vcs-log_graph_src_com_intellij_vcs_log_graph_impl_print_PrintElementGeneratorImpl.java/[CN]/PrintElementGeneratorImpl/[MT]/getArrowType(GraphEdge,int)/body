{
  NormalEdge normalEdge=asNormalEdge(edge);
  if (normalEdge != null) {
    int edgeSize=normalEdge.down - normalEdge.up;
    int upOffset=rowIndex - normalEdge.up;
    int downOffset=normalEdge.down - rowIndex;
    if (edgeSize >= myLongEdgeSize) {
      if (upOffset == myVisiblePartSize) {
        LOG.assertTrue(downOffset != myVisiblePartSize,"Both up and down arrow at row " + rowIndex);
        return RowElementType.DOWN_ARROW;
      }
      if (downOffset == myVisiblePartSize)       return RowElementType.UP_ARROW;
    }
    if (edgeSize >= myEdgeWithArrowSize) {
      if (upOffset == 1) {
        LOG.assertTrue(downOffset != 1,"Both up and down arrow at row " + rowIndex);
        return RowElementType.DOWN_ARROW;
      }
      if (downOffset == 1)       return RowElementType.UP_ARROW;
    }
  }
 else {
switch (edge.getType()) {
case DOTTED_ARROW_DOWN:
case NOT_LOAD_COMMIT:
      if (intEqual(edge.getUpNodeIndex(),rowIndex - 1)) {
        return RowElementType.DOWN_ARROW;
      }
    break;
case DOTTED_ARROW_UP:
  if (intEqual(edge.getDownNodeIndex(),rowIndex + 1)) {
    return RowElementType.UP_ARROW;
  }
break;
default :
LOG.error("Unknown special edge type " + edge.getType() + " at row "+ rowIndex);
}
}
return null;
}
