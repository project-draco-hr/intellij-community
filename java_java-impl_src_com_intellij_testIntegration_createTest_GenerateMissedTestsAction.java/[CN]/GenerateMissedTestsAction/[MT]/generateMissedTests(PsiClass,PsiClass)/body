{
  if (testClass != null) {
    final TestFramework framework=TestFrameworks.detectFramework(testClass);
    if (framework != null) {
      final Project project=testClass.getProject();
      final Editor editor=CodeInsightUtil.positionCursor(project,testClass.getContainingFile(),testClass.getLBrace());
      final MissedTestsDialog dialog=new MissedTestsDialog(project,srcClass,testClass,framework);
      if (dialog.showAndGet()) {
        WriteCommandAction.runWriteCommandAction(project,new Runnable(){
          @Override public void run(){
            JavaTestGenerator.addTestMethods(editor,testClass,framework,dialog.getSelectedMethods(),false,false);
          }
        }
);
      }
    }
  }
}
