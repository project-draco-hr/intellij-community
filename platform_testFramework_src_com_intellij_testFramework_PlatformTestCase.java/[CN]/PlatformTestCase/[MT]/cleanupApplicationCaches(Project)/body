{
  if (project != null && !project.isDisposed()) {
    UndoManagerImpl globalInstance=(UndoManagerImpl)UndoManager.getGlobalInstance();
    if (globalInstance != null) {
      globalInstance.dropHistoryInTests();
    }
    ((UndoManagerImpl)UndoManager.getInstance(project)).dropHistoryInTests();
    ((PsiManagerImpl)PsiManager.getInstance(project)).cleanupForNextTest();
  }
  ProjectManagerImpl projectManager=(ProjectManagerImpl)ProjectManager.getInstance();
  if (projectManager.isDefaultProjectInitialized()) {
    Project defaultProject=projectManager.getDefaultProject();
    ((PsiManagerImpl)PsiManager.getInstance(defaultProject)).cleanupForNextTest();
  }
  ((FileBasedIndexImpl)FileBasedIndex.getInstance()).cleanupForNextTest();
  LocalFileSystemImpl localFileSystem=(LocalFileSystemImpl)LocalFileSystem.getInstance();
  if (localFileSystem != null) {
    localFileSystem.cleanupForNextTest();
  }
}
