{
  final JBTextField textField=new JBTextField(10);
  final JBPopup popup=JBPopupFactory.getInstance().createComponentPopupBuilder(textField,textField).setCancelOnClickOutside(true).setCancelOnWindowDeactivation(true).setCancelKeyEnabled(true).setRequestFocus(true).createPopup();
  textField.addKeyListener(new KeyAdapter(){
    @Override public void keyPressed(    KeyEvent e){
      if (e.getKeyCode() == KeyEvent.VK_ENTER) {
        popup.closeOk(e);
      }
 else       if (e.getKeyCode() == KeyEvent.VK_ESCAPE) {
        popup.cancel(e);
      }
    }
  }
);
  popup.addListener(new JBPopupAdapter(){
    @Override public void onClosed(    LightweightWindowEvent event){
      if (event.isOk()) {
        String user=textField.getText();
        setValue(user);
        applyFilters();
      }
    }
  }
);
  popup.showUnderneathOf(UserFilterPopupComponent.this);
  textField.requestFocus();
}
