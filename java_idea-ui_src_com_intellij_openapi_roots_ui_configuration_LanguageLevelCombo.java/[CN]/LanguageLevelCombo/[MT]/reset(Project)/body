{
  removeAllItems();
  for (  LanguageLevel level : LanguageLevel.values()) {
    addItem(level);
  }
  myDefaultLevel=null;
  Sdk sdk=ProjectRootManagerEx.getInstanceEx(project).getProjectSdk();
  if (sdk != null) {
    JavaSdkVersion version=JavaSdk.getInstance().getVersion(sdk);
    if (version != null) {
      myDefaultLevel=version.getMaxLanguageLevel();
    }
  }
  String item=null;
  if (myDefaultLevel != null) {
    item=JavaCoreBundle.message("default.jdk.level.description",myDefaultLevel.getPresentableText());
    addItem(item);
  }
 else   if (project.isDefault()) {
    item=JavaCoreBundle.message("default.language.level.description");
    addItem(item);
    myDefaultLevel=LanguageLevelProjectExtension.getInstance(project).getLanguageLevel();
  }
  LanguageLevelProjectExtension extension=LanguageLevelProjectExtension.getInstance(project);
  Boolean aDefault=extension.isDefault();
  if (item != null && aDefault != null && aDefault) {
    setSelectedItem(item);
  }
 else {
    setSelectedItem(extension.getLanguageLevel());
  }
}
