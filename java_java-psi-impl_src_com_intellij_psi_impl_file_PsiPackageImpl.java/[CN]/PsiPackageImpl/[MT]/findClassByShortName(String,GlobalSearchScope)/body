{
  PsiClass[] allClasses=getCachedClassesByName(name,scope);
  if (allClasses.length == 0)   return allClasses;
  if (allClasses.length == 1) {
    return PsiSearchScopeUtil.isInScope(scope,allClasses[0]) ? allClasses : PsiClass.EMPTY_ARRAY;
  }
  PsiClass[] array=ContainerUtil.findAllAsArray(allClasses,new Condition<PsiClass>(){
    @Override public boolean value(    PsiClass aClass){
      return PsiSearchScopeUtil.isInScope(scope,aClass);
    }
  }
);
  Arrays.sort(array,new Comparator<PsiClass>(){
    @Override public int compare(    PsiClass o1,    PsiClass o2){
      VirtualFile file1=o1.getContainingFile().getVirtualFile();
      VirtualFile file2=o2.getContainingFile().getVirtualFile();
      if (file1 == null)       return file2 == null ? 0 : -1;
      if (file2 == null)       return 1;
      return scope.compare(file2,file1);
    }
  }
);
  return array;
}
