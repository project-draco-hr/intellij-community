{
  PsiClass[] allClasses=getCachedClassesByName(name);
  if (allClasses.length == 0)   return allClasses;
  if (allClasses.length == 1) {
    return PsiSearchScopeUtil.isInScope(scope,allClasses[0]) ? allClasses : PsiClass.EMPTY_ARRAY;
  }
  PsiClass[] array=ContainerUtil.findAllAsArray(allClasses,new Condition<PsiClass>(){
    @Override public boolean value(    PsiClass aClass){
      return PsiSearchScopeUtil.isInScope(scope,aClass);
    }
  }
);
  Arrays.sort(array,new Comparator<PsiClass>(){
    @Override public int compare(    PsiClass o1,    PsiClass o2){
      return scope.compare(o2.getContainingFile().getVirtualFile(),o1.getContainingFile().getVirtualFile());
    }
  }
);
  return array;
}
