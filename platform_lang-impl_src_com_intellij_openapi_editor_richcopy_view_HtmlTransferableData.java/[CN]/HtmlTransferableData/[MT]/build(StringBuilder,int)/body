{
  myResultBuffer=holder;
  myColorRegistry=mySyntaxInfo.getColorRegistry();
  myFontNameRegistry=mySyntaxInfo.getFontNameRegistry();
  myMaxLength=maxLength;
  try {
    buildColorMap();
    myResultBuffer.append("<pre style=\"background-color:");
    appendColor(myResultBuffer,mySyntaxInfo.getDefaultBackground());
    myResultBuffer.append(';');
    if (myFontNameRegistry.size() == 1) {
      appendFontFamilyRule(myResultBuffer,myFontNameRegistry.getAllIds()[0]);
      myFontNameRegistry=null;
    }
    appendFontSizeRule(myResultBuffer,mySyntaxInfo.getSingleFontSize());
    myResultBuffer.append("\" bgcolor=\"");
    appendColor(myResultBuffer,mySyntaxInfo.getDefaultBackground());
    myResultBuffer.append("\">");
    mySyntaxInfo.processOutputInfo(this);
    myResultBuffer.append("</pre>");
  }
  finally {
    myResultBuffer=null;
    myColorRegistry=null;
    myFontNameRegistry=null;
    myColors.clear();
  }
}
