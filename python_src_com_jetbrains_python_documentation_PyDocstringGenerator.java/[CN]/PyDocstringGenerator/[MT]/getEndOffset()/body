{
  final Couple<VisualPosition> range=getOffsets();
  return range == null ? -1 : visualPositionToOffset(range.getSecond());
}
