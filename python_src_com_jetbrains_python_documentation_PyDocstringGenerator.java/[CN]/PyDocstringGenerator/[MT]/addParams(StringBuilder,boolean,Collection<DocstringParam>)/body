{
  PsiWhiteSpace whitespace=null;
  if (myDocStringOwner instanceof PyFunction) {
    final PyStatementList statementList=((PyFunction)myDocStringOwner).getStatementList();
    final Document document=PsiDocumentManager.getInstance(myProject).getDocument(getFile());
    if (document != null && statementList != null && statementList.getStatements().length != 0 && document.getLineNumber(statementList.getTextOffset()) != document.getLineNumber(myFunction.getTextOffset())) {
      whitespace=PsiTreeUtil.getPrevSiblingOfType(statementList,PsiWhiteSpace.class);
    }
  }
  String ws="\n";
  if (whitespace != null) {
    String[] spaces=whitespace.getText().split("\n");
    if (spaces.length > 1) {
      ws+=whitespace.getText().split("\n")[1];
    }
  }
 else {
    ws+=StringUtil.repeat(" ",getIndentSize(myFunction));
  }
  if (replacementText.length() > 0) {
    replacementText.deleteCharAt(replacementText.length() - 1);
  }
  replacementText.append(ws);
  int i=0;
  if (paramsToAdd.size() == 0) {
    throw new IllegalArgumentException("At least one parameter should be added");
  }
  for (  DocstringParam param : paramsToAdd) {
    replacementText.append(getPrefix());
    replacementText.append(param.getKind());
    replacementText.append(" ");
    replacementText.append(param.getName());
    replacementText.append(": ");
    int startOffset=replacementText.length();
    int endOffset=startOffset;
    if (param.getType() != null) {
      replacementText.append(param.getType());
      endOffset+=param.getType().length();
    }
    myParamTypesOffset.put(param.getName(),Pair.create(startOffset,endOffset));
    i++;
    if (i < paramsToAdd.size()) {
      replacementText.append(ws);
    }
  }
  int offset=replacementText.length();
  if (addWS) {
    replacementText.append(ws);
  }
 else {
    replacementText.append("\n");
  }
  return offset;
}
