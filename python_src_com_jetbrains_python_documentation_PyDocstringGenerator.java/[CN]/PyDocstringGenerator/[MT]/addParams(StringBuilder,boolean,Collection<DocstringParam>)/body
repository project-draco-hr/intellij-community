{
  final String ws=getWhitespace();
  if (!StringUtil.containsAlphaCharacters(replacementText.toString())) {
    replacementText.append("\n");
  }
  replacementText.append(ws);
  final Module module=ModuleUtilCore.findModuleForPsiElement(myDocStringOwner);
  if (module != null) {
    PyDocumentationSettings documentationSettings=PyDocumentationSettings.getInstance(module);
    if (documentationSettings.isPlain(getFile()))     return replacementText.length() - 1;
  }
  int line=StringUtil.getLineBreakCount(replacementText);
  final List<String> unindentedLines=new ArrayList<String>();
  for (  DocstringParam param : paramsToAdd) {
    final StringBuilder lineBuilder=new StringBuilder();
    lineBuilder.append(getPrefix());
    lineBuilder.append(param.getKind());
    lineBuilder.append(" ");
    lineBuilder.append(param.getName());
    lineBuilder.append(": ");
    final int startOffset=lineBuilder.length();
    int endOffset=startOffset;
    if (param.getType() != null) {
      lineBuilder.append(param.getType());
      endOffset+=param.getType().length();
    }
    myParamTypesOffset.put(param.getName(),Couple.of(new VisualPosition(line,startOffset),new VisualPosition(line,endOffset)));
    unindentedLines.add(lineBuilder.toString());
    line++;
  }
  StringUtil.join(unindentedLines,ws,replacementText);
  if (myGenerateReturn && myDocStringOwner instanceof PyFunction) {
    PyFunction function=(PyFunction)myDocStringOwner;
    String returnType=PythonDocumentationProvider.generateRaiseOrReturn(function," ",getPrefix(),true);
    if (!returnType.isEmpty()) {
      replacementText.append(ws).append(returnType);
    }
  }
  int offset=replacementText.length();
  if (addWS) {
    replacementText.append(ws);
  }
 else {
    replacementText.append("\n");
  }
  return offset;
}
