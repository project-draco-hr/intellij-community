{
  VirtualFile baseDir=project.getBaseDir();
  VirtualFile folder=baseDir.findChild(GENERATED_FILES_FOLDER);
  if (folder != null) {
    return folder;
  }
  final Ref<VirtualFile> generatedRoot=new Ref<>();
  DumbService.allowStartingDumbModeInside(DumbModePermission.MAY_START_BACKGROUND,new Runnable(){
    @Override public void run(){
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        @Override public void run(){
          try {
            generatedRoot.set(baseDir.createChildDirectory(this,GENERATED_FILES_FOLDER));
            VirtualFile contentRootForFile=ProjectRootManager.getInstance(module.getProject()).getFileIndex().getContentRootForFile(generatedRoot.get());
            if (contentRootForFile == null) {
              return;
            }
            ModuleRootModificationUtil.updateExcludedFolders(module,contentRootForFile,Collections.emptyList(),Collections.singletonList(generatedRoot.get().getUrl()));
          }
 catch (          IOException e) {
            LOG.info("Failed to create folder for generated files",e);
          }
        }
      }
);
    }
  }
);
  return generatedRoot.get();
}
