{
  project=getProject(project);
  final ConfigurableGroup[] filteredGroups=filterEmptyGroups(groups);
  if (Registry.is("ide.new.settings.dialog")) {
    return ApplicationManager.getApplication().isInternal() && Registry.is("ide.new.settings.view") ? new SettingsDialog(project,filteredGroups,toSelect,null) : new IdeSettingsDialog(project,filteredGroups,toSelect);
  }
  return Registry.is("ide.perProjectModality") ? new OptionsEditorDialog(project,filteredGroups,toSelect,true) : new OptionsEditorDialog(project,filteredGroups,toSelect);
}
