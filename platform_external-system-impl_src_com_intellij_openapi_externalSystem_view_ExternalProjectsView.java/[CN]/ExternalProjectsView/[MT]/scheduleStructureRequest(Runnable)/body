{
  if (isUnitTestMode()) {
    r.run();
    return;
  }
  invokeLater(myProject,new Runnable(){
    public void run(){
      if (!myToolWindow.isVisible())       return;
      boolean shouldCreate=myStructure == null;
      if (shouldCreate) {
        initStructure();
      }
      myTree.setPaintBusy(true);
      try {
        r.run();
        if (shouldCreate) {
          restoreTreeState();
        }
      }
  finally {
        myTree.setPaintBusy(false);
      }
    }
  }
);
}
