{
  final String wrapId=wrapElement.getAttributeValue("id");
  if (myIdToWrap.containsKey(wrapId))   return myIdToWrap.get(wrapId);
  final String type=wrapElement.getAttributeValue("type");
  String parentId=wrapElement.getAttributeValue("parent");
  boolean wrapFirst="true".equals(wrapElement.getAttributeValue("ignoreParents"));
  if (myIdToWrap.containsKey(parentId)) {
    final Wrap wrap=Wrap.createChildWrap(myIdToWrap.get(parentId),readWrapType(type),wrapFirst);
    if ("true".equals(wrapElement.getAttributeValue("ignoreParents"))) {
      wrap.ignoreParentWraps();
    }
    myIdToWrap.put(wrapId,wrap);
    return wrap;
  }
 else {
    final Wrap wrap=Wrap.createWrap(readWrapType(type),wrapFirst);
    if ("true".equals(wrapElement.getAttributeValue("ignoreParents"))) {
      wrap.ignoreParentWraps();
    }
    myIdToWrap.put(wrapId,wrap);
    return wrap;
  }
}
