{
  Set<T> result=ContainerUtil.newHashSet();
  final MultiMap<VirtualFile,String> rootsAndHashes=MultiMap.create();
  commits.forEach(new TIntProcedure(){
    @Override public boolean execute(    int commit){
      CommitId commitId=myHashMap.getCommitId(commit);
      rootsAndHashes.putValue(commitId.getRoot(),commitId.getHash().asString());
      return true;
    }
  }
);
  for (  Map.Entry<VirtualFile,Collection<String>> entry : rootsAndHashes.entrySet()) {
    VcsLogProvider logProvider=myLogProviders.get(entry.getKey());
    if (logProvider != null) {
      List<? extends T> details=readDetails(logProvider,entry.getKey(),ContainerUtil.newArrayList(entry.getValue()));
      result.addAll(details);
      saveInCache(details);
    }
 else {
      LOG.error("No log provider for root " + entry.getKey().getPath() + ". All known log providers "+ myLogProviders);
    }
  }
  return result;
}
