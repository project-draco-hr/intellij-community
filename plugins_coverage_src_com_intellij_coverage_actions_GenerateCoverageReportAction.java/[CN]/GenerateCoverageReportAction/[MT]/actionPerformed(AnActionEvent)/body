{
  final DataContext dataContext=e.getDataContext();
  final Project project=PlatformDataKeys.PROJECT.getData(dataContext);
  final CoverageSuiteImpl currentSuite=(CoverageSuiteImpl)CoverageDataManager.getInstance(project).getCurrentSuite();
  final ExportToHTMLDialog dialog=new ExportToHTMLDialog(project,true);
  dialog.setTitle("Generate coverage report for: \'" + currentSuite.getPresentableName() + "\'");
  dialog.reset();
  dialog.show();
  if (!dialog.isOK())   return;
  dialog.apply();
  final ExportToHTMLSettings settings=ExportToHTMLSettings.getInstance(project);
  currentSuite.getRunner().generateReport(project,currentSuite.getCoverageDataFileName(),settings.OUTPUT_DIRECTORY,settings.OPEN_IN_BROWSER);
}
