{
  final String artifactName=getTestName(true);
  final String artifactFileName=artifactName + ".jar";
  final MockJavaFxPackager packager=new MockJavaFxPackager(artifactName + File.separator + artifactFileName);
  final String title=options.get(TITLE);
  if (title != null) {
    packager.setTitle(title);
  }
  final String version=options.get(VERSION);
  if (version != null) {
    packager.setVersion(version);
  }
  boolean isRelativeIconPath=Boolean.valueOf(options.get(RELATIVE_PATH));
  final String icon=options.get(ICONS);
  if (icon != null) {
    final String[] icons=icon.split(",");
    final JavaFxApplicationIcons appIcons=new JavaFxApplicationIcons();
    appIcons.setLinuxIcon(icons[0]);
    appIcons.setMacIcon(icons[1]);
    appIcons.setWindowsIcon(icons[2]);
    appIcons.setBaseDir(icons[3]);
    packager.setIcons(appIcons);
    packager.setNativeBundle(JavaFxPackagerConstants.NativeBundles.all);
  }
  final String preloaderClass=options.get(PRELOADER_CLASS);
  if (preloaderClass != null) {
    packager.setPreloaderClass(preloaderClass);
  }
  final String preloaderJar=options.get(PRELOADER_JAR);
  if (preloaderJar != null) {
    packager.setPreloaderJar(preloaderJar);
  }
  if (options.containsKey(SIGNED)) {
    packager.setSigned(true);
  }
  final List<JavaFxAntGenerator.SimpleTag> temp=JavaFxAntGenerator.createJarAndDeployTasks(packager,artifactFileName,artifactName,"temp",isRelativeIconPath);
  final StringBuilder buf=new StringBuilder();
  for (  JavaFxAntGenerator.SimpleTag tag : temp) {
    tag.generate(buf);
  }
  assertEquals(expected.replaceAll("temp/deploy","temp\\" + File.separator + "deploy").replaceAll("temp/" + artifactFileName,"temp\\" + File.separator + artifactFileName),buf.toString());
}
