{
  StringBuilder result=new StringBuilder(str.length());
  for (int i=0, len=str.length(); i < len; i++) {
    result.append(str.charAt(i));
    legalizeChar(result,result.length() - 1);
  }
  return result.toString();
}
