{
  PropertiesFile defaultPropertiesFile=null;
  final ResourceBundleManager bundleBaseNameManager=ResourceBundleManager.getInstance(baseDirectory.getProject());
  final PsiFile[] psiFiles=ApplicationManager.getApplication().runReadAction(new Computable<PsiFile[]>(){
    @Override public PsiFile[] compute(){
      return baseDirectory.getFiles();
    }
  }
);
  for (  final PsiFile psiFile : psiFiles) {
    if (baseName.equals(bundleBaseNameManager.getBaseName(psiFile))) {
      final PropertiesFile propertiesFile=getPropertiesFile(psiFile);
      if (propertiesFile != null) {
        if (defaultPropertiesFile == null) {
          defaultPropertiesFile=propertiesFile;
        }
 else {
          final int nameDiff=FileUtil.getNameWithoutExtension(defaultPropertiesFile.getName()).compareTo(FileUtil.getNameWithoutExtension(propertiesFile.getName()));
          if (nameDiff > 0) {
            defaultPropertiesFile=propertiesFile;
          }
 else           if (nameDiff == 0) {
            return null;
          }
        }
      }
    }
  }
  if (defaultPropertiesFile == null) {
    return null;
  }
  return new ResourceBundleImpl(defaultPropertiesFile);
}
