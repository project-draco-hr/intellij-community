{
  PropertiesFile defaultPropertiesFile=null;
  final PsiFile[] files=ApplicationManager.getApplication().runReadAction(new Computable<PsiFile[]>(){
    @Override public PsiFile[] compute(){
      return baseDirectory.getFiles();
    }
  }
);
  for (  final PsiFile psiFile : files) {
    if (baseName.equals(getBaseName(psiFile))) {
      final PropertiesFile propertiesFile=getPropertiesFile(psiFile);
      if (propertiesFile != null) {
        if (defaultPropertiesFile == null || defaultPropertiesFile.getName().compareTo(propertiesFile.getName()) > 0) {
          defaultPropertiesFile=propertiesFile;
        }
      }
    }
  }
  if (defaultPropertiesFile == null) {
    return null;
  }
  return new ResourceBundleImpl(defaultPropertiesFile);
}
