{
  if (isRunning()) {
    throw new IllegalStateException("server already started");
  }
  NioEventLoopGroup eventLoopGroup=new NioEventLoopGroup(workerCount,PooledThreadExecutor.INSTANCE);
  ServerBootstrap bootstrap=createServerBootstrap(eventLoopGroup,channelRegistrar,null);
  int port=bind(firstPort,portsCount,tryAnyPort,bootstrap);
  bindCustomPorts(firstPort,port,eventLoopGroup);
  return port;
}
