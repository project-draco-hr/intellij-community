{
  if (!shouldUpdate(comboBox,newItems)) {
    return;
  }
  Object selectedItem=comboBox.getSelectedItem();
  if (selectedItem != null && !newItems.contains(selectedItem)) {
    selectedItem=null;
  }
  if (selectedItem == null && newItems.contains(newSelectedItemIfSelectionCannotBePreserved)) {
    selectedItem=newSelectedItemIfSelectionCannotBePreserved;
  }
  comboBox.removeAllItems();
  for (  T newItem : newItems) {
    comboBox.addItem(newItem);
  }
  if (selectedItem != null) {
    int count=comboBox.getItemCount();
    for (int i=0; i < count; i++) {
      Object item=comboBox.getItemAt(i);
      if (selectedItem.equals(item)) {
        comboBox.setSelectedIndex(i);
        break;
      }
    }
  }
}
