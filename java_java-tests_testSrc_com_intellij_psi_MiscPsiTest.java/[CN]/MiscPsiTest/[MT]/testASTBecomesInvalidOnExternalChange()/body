{
  final String text="class A{}";
  final PsiJavaFile file=(PsiJavaFile)myFixture.addFileToProject("a.java",text);
  PsiElement leaf=file.findElementAt(5);
  PlatformTestUtil.tryGcSoftlyReachableObjects();
  assertNull(PsiDocumentManager.getInstance(getProject()).getCachedDocument(file));
  new WriteCommandAction.Simple(getProject()){
    @Override protected void run() throws Throwable {
      VfsUtil.saveText(file.getVirtualFile(),text + "   ");
    }
  }
.execute();
  assertTrue(file.isValid());
  assertFalse(leaf.isValid());
  assertNotSame(leaf,file.findElementAt(5));
}
