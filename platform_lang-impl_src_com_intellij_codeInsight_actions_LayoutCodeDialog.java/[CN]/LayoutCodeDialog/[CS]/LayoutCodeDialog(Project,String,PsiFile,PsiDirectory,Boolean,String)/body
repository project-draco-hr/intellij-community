{
  super(project,true);
  myFile=file;
  myProject=project;
  myDirectory=directory;
  myTextSelected=isTextSelected;
  if (myFile != null)   myCommonSettings=CodeStyleSettingsManager.getSettings(myProject).getCommonSettings(myFile.getLanguage());
  myRearrangeAlwaysEnabled=myCommonSettings != null && myCommonSettings.isForceArrangeMenuAvailable() && myCommonSettings.FORCE_REARRANGE_MODE == CommonCodeStyleSettings.REARRANGE_ALWAYS;
  myRearrangeEntriesKeyForLanguage=LayoutCodeConstants.REARRANGE_ENTRIES_KEY + (myFile == null ? "" : myFile.getLanguage().getDisplayName());
  setOKButtonText(CodeInsightBundle.message("reformat.code.accept.button.text"));
  setTitle(title);
  init();
  myHelpId=helpId;
}
