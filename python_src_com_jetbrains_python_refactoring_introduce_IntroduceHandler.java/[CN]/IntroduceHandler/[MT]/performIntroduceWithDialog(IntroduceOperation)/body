{
  final Project project=operation.getProject();
  if (operation.getName() == null) {
    PyIntroduceDialog dialog=new PyIntroduceDialog(project,myDialogTitle,myValidator,getHelpId(),operation);
    if (!dialog.showAndGet()) {
      return;
    }
    operation.setName(dialog.getName());
    operation.setReplaceAll(dialog.doReplaceAllOccurrences());
    operation.setInitPlace(dialog.getInitPlace());
  }
  PsiElement declaration=performRefactoring(operation);
  final Editor editor=operation.getEditor();
  editor.getCaretModel().moveToOffset(declaration.getTextRange().getEndOffset());
  editor.getSelectionModel().removeSelection();
}
