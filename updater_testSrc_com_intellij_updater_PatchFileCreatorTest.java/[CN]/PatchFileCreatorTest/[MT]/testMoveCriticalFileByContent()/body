{
  myPatchSpec.setStrict(true);
  myPatchSpec.setCriticalFiles(Collections.singletonList("a/deleted/file/that/is/a/copy/move.me"));
  FileUtil.writeToFile(new File(myOlderDir,"move/from/this/directory/move.me"),"oldcontent");
  FileUtil.writeToFile(new File(myOlderDir,"a/deleted/file/that/is/a/copy/move.me"),"newcontent");
  FileUtil.writeToFile(new File(myNewerDir,"move/to/this/directory/move.me"),"newcontent");
  Patch patch=PatchFileCreator.create(myPatchSpec,myFile,TEST_UI);
  PatchAction action=getAction(patch,"move/to/this/directory/move.me");
  assertTrue(action instanceof CreateAction);
  PatchFileCreator.PreparationResult preparationResult=PatchFileCreator.prepareAndValidate(myFile,myOlderDir,TEST_UI);
  assertAppliedAndRevertedCorrectly(patch,preparationResult);
}
