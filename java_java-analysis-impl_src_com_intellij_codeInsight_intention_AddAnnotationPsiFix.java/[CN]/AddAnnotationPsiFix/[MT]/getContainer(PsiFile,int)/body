{
  PsiReference reference=file.findReferenceAt(offset);
  if (reference != null) {
    PsiElement target=reference.resolve();
    if (target instanceof PsiMember) {
      return (PsiMember)target;
    }
  }
  PsiElement element=file.findElementAt(offset);
  PsiModifierListOwner listOwner=PsiTreeUtil.getParentOfType(element,PsiModifierListOwner.class,false);
  if (listOwner instanceof PsiParameter)   return listOwner;
  if (listOwner instanceof PsiNameIdentifierOwner) {
    PsiElement id=((PsiNameIdentifierOwner)listOwner).getNameIdentifier();
    if (id != null && id.getTextRange().containsOffset(offset)) {
      return listOwner;
    }
  }
  return null;
}
