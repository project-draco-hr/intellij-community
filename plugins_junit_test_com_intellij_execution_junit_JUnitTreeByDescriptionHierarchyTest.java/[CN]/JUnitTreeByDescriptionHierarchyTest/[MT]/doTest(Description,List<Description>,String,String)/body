{
  final StringBuffer buf=new StringBuffer();
  final SMTestSender sender=new SMTestSender(new PrintStream(new OutputStream(){
    @Override public void write(    int b) throws IOException {
      buf.append(new String(new byte[]{(byte)b}));
    }
  }
));
  sender.sendTree(root);
  Assert.assertEquals("output: " + buf,expectedTree,StringUtil.convertLineSeparators(buf.toString()));
  buf.setLength(0);
  sender.testRunStarted(root);
  for (  Description test : tests) {
    sender.testStarted(test);
    sender.testFinished(test);
  }
  sender.testRunFinished(new Result());
  Assert.assertEquals("output: " + buf,expectedStart,StringUtil.convertLineSeparators(buf.toString()));
}
