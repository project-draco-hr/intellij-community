{
  final Description root=Description.createSuiteDescription("root");
  final ArrayList<Description> tests=new ArrayList<Description>();
  for (  String className : new String[]{"a.TestA","a.TestB"}) {
    final Description aTestClass=Description.createSuiteDescription(className);
    root.addChild(aTestClass);
    final Description testDescription=Description.createTestDescription(className,"testName");
    aTestClass.addChild(testDescription);
    tests.add(testDescription);
  }
  final StringBuffer buf=new StringBuffer();
  final JUnit4TestListener sender=createListener(buf);
  sender.testRunStarted(root);
  for (  Description test : tests) {
    sender.testStarted(test);
    sender.testFinished(test);
  }
  sender.testRunFinished(new Result());
  Assert.assertEquals("output: " + buf,"##teamcity[enteredTheMatrix]\n" + "##teamcity[testSuiteStarted name='TestA' locationHint='java:suite://a.TestA']\n" + "\n"+ "##teamcity[testStarted name='TestA.testName' locationHint='java:test://a.TestA.testName']\n"+ "\n"+ "##teamcity[testFinished name='TestA.testName']\n"+ "##teamcity[testSuiteFinished name='TestA']\n"+ "##teamcity[testSuiteStarted name='TestB' locationHint='java:suite://a.TestB']\n"+ "\n"+ "##teamcity[testStarted name='TestB.testName' locationHint='java:test://a.TestB.testName']\n"+ "\n"+ "##teamcity[testFinished name='TestB.testName']\n"+ "##teamcity[testSuiteFinished name='TestB']\n",StringUtil.convertLineSeparators(buf.toString()));
}
