{
  int n=0;
  int failed=0;
  for (  String name : myMap.keySet()) {
    if (prefix == null && name.contains("/")) {
      continue;
    }
    if (prefix != null && !name.startsWith(prefix)) {
      continue;
    }
    System.out.print("filename = " + name);
    n++;
    final Test test=myMap.get(name);
    try {
      if (test.regExpHost != null) {
        final Class<RegExpLanguageHost> aClass=(Class<RegExpLanguageHost>)Class.forName(test.regExpHost);
        final RegExpLanguageHost host=aClass.newInstance();
        RegExpLanguageHosts.setRegExpHost(host);
      }
      try {
        myFixture.configureByText(RegExpFileType.INSTANCE,test.pattern);
        myFixture.testHighlighting(true,true,true);
      }
  finally {
        RegExpLanguageHosts.setRegExpHost(null);
      }
      if (test.expectedResult == Result.ERR) {
        System.out.println("  FAILED. Expression incorrectly parsed OK: " + test.pattern);
        failed++;
      }
 else {
        System.out.println("  OK");
      }
    }
 catch (    Throwable e) {
      if (test.expectedResult == Result.ERR) {
        System.out.println("  OK");
      }
 else {
        e.printStackTrace(System.out);
        System.out.println("  FAILED. Expression = " + test.pattern);
        if (myOut.size() > 0) {
          String line;
          final BufferedReader reader=new BufferedReader(new StringReader(myOut.toString()));
          do {
            line=reader.readLine();
          }
 while (line != null && (line.trim().length() == 0 || line.trim().equals("ERROR:")));
          if (line != null) {
            if (line.matches(".*java.lang.Error: junit.framework.AssertionFailedError:.*")) {
              System.out.println("ERROR: " + line.replace("java.lang.Error: junit.framework.AssertionFailedError:",""));
            }
          }
 else {
            System.out.println("ERROR: " + myOut);
          }
        }
        failed++;
      }
    }
    myOut.reset();
  }
  System.out.println("");
  System.out.println(n + " Tests executed, " + failed+ " failed");
  assertFalse(failed > 0);
}
