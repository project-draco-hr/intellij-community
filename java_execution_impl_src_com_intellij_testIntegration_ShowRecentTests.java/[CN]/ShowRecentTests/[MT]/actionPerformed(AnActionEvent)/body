{
  final Project project=e.getProject();
  if (project == null)   return;
  final TestStateStorage testStorage=TestStateStorage.getInstance(project);
  final TestLocator testLocator=new TestLocator(project);
  final RecentTestRunnerImpl testRunner=new RecentTestRunnerImpl();
  final Map<String,TestStateStorage.Record> records=testStorage.getRecentTests(TEST_LIMIT,getSinceDate());
  RecentTestsListProvider listProvider=new RecentTestsListProvider(records);
  List<String> urls=listProvider.getUrlsToShowFromHistory();
  Map<String,Icon> icons=ContainerUtil.map2Map(urls,new Function<String,Pair<String,Icon>>(){
    @Override public Pair<String,Icon> fun(    String url){
      return Pair.create(url,getIconFor(url,records));
    }
  }
);
  SelectTestStep selectStepTest=new SelectTestStep(urls,icons,testRunner,testLocator);
  RecentTestsListPopup popup=new RecentTestsListPopup(selectStepTest,testRunner,testLocator);
  popup.showCenteredInCurrentWindow(project);
  ApplicationManager.getApplication().executeOnPooledThread(new DeadTestsCleaner(testStorage,urls,testLocator));
}
