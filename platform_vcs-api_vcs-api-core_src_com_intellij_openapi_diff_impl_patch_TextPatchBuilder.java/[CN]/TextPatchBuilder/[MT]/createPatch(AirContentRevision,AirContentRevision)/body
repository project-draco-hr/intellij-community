{
  if (beforeRevision == null && afterRevision == null)   return null;
  if (beforeRevision != null && beforeRevision.getPath().isDirectory())   return null;
  if (afterRevision != null && afterRevision.getPath().isDirectory())   return null;
  if (beforeRevision != null && beforeRevision.isBinary() || afterRevision != null && afterRevision.isBinary()) {
    return buildBinaryPatch(beforeRevision,afterRevision);
  }
  if (beforeRevision == null) {
    return buildAddedFile(afterRevision);
  }
  if (afterRevision == null) {
    return buildDeletedFile(beforeRevision);
  }
  return buildModifiedFile(beforeRevision,afterRevision);
}
