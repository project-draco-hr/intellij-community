{
  myIndexId=indexId;
  myIndexer=indexer;
  myStorage=storage;
  myHasSnapshotMapping=snapshotIndexExternalizer != null;
  mySnapshotIndexExternalizer=snapshotIndexExternalizer;
  myValueExternalizer=valueDataExternalizer;
  final File saved=myHasSnapshotMapping && myIndexId != null ? new File(IndexInfrastructure.getPersistentIndexRootDir(myIndexId),"values") : null;
  if (saved != null) {
    try {
      myContents=new PersistentHashMap<Integer,ByteSequence>(saved,EnumeratorIntegerDescriptor.INSTANCE,ByteSequenceDataExternalizer.INSTANCE);
    }
 catch (    IOException ex) {
      IOUtil.deleteAllFilesStartingWith(saved);
      throw ex;
    }
  }
 else {
    myContents=null;
  }
}
