{
  try {
    getWriteLock().lock();
    myStorage.clear();
    if (myInputsIndex != null) {
      cleanMapping(myInputsIndex);
      myInputsIndex=createInputsIndex();
    }
    if (myInputsSnapshotMapping != null) {
      cleanMapping(myInputsSnapshotMapping);
      myInputsSnapshotMapping=createInputSnapshotMapping();
    }
    if (mySnapshotMapping != null) {
      cleanMapping(mySnapshotMapping);
      mySnapshotMapping=createSnapshotMappingIndex();
    }
  }
 catch (  StorageException e) {
    LOG.error(e);
  }
catch (  IOException e) {
    LOG.error(e);
  }
 finally {
    getWriteLock().unlock();
  }
}
