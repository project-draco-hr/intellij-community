{
  ApplicationManager.getApplication().assertIsDispatchThread();
  myActionGroup=new DefaultActionGroup();
  myAutoScrollFromSourceHandler.install();
  myContentManager=toolWindow.getContentManager();
  if (!ApplicationManager.getApplication().isUnitTestMode()) {
    toolWindow.setDefaultContentUiType(ToolWindowContentUiType.COMBO);
    ((ToolWindowEx)toolWindow).setAdditionalGearActions(myActionGroup);
    toolWindow.getComponent().putClientProperty(ToolWindowContentUi.HIDE_ID_LABEL,"true");
  }
  GuiUtils.replaceJSplitPaneWithIDEASplitter(myPanel);
  SwingUtilities.invokeLater(new Runnable(){
    @Override public void run(){
      splitterProportions.restoreSplitterProportions(myPanel);
    }
  }
);
  if (loadPaneExtensions) {
    ensurePanesLoaded();
  }
  isInitialized=true;
  doAddUninitializedPanes();
  myContentManager.addContentManagerListener(new ContentManagerAdapter(){
    @Override public void selectionChanged(    ContentManagerEvent event){
      if (event.getOperation() == ContentManagerEvent.ContentOperation.add) {
        viewSelectionChanged();
      }
    }
  }
);
  viewSelectionChanged();
}
