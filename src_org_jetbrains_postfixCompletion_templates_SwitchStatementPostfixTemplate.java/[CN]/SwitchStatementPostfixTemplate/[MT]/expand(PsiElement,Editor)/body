{
  PsiExpression expr=getTopmostExpression(context);
  PsiElement parent=expr != null ? expr.getParent() : null;
  if (!(parent instanceof PsiExpressionStatement))   return;
  Project project=context.getProject();
  PsiElementFactory factory=JavaPsiFacade.getInstance(project).getElementFactory();
  CodeStyleManager codeStyleManager=CodeStyleManager.getInstance(project);
  PsiSwitchStatement switchStatement=(PsiSwitchStatement)codeStyleManager.reformat(factory.createStatementFromText("switch (" + expr.getText() + ") {\nst;\n}",context));
  switchStatement=(PsiSwitchStatement)parent.replace(switchStatement);
  PsiCodeBlock block=CodeInsightUtilCore.forcePsiPostprocessAndRestoreElement(switchStatement.getBody());
  TextRange range=block.getStatements()[0].getTextRange();
  editor.getDocument().deleteString(range.getStartOffset(),range.getEndOffset());
  editor.getCaretModel().moveToOffset(range.getStartOffset());
}
