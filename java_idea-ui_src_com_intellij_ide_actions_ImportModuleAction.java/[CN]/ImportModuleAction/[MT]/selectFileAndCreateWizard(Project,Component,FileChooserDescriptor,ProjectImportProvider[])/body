{
  FileChooserDialog chooser=FileChooserFactory.getInstance().createFileChooser(descriptor,project,dialogParent);
  VirtualFile toSelect=null;
  String lastLocation=PropertiesComponent.getInstance().getValue(LAST_IMPORTED_LOCATION);
  if (lastLocation != null) {
    toSelect=LocalFileSystem.getInstance().refreshAndFindFileByPath(lastLocation);
  }
  VirtualFile[] files=chooser.choose(project,toSelect);
  if (files.length == 0) {
    return null;
  }
  final VirtualFile file=files[0];
  for (  Project p : ProjectManager.getInstance().getOpenProjects()) {
    if (ProjectUtil.isSameProject(file.getPath(),p)) {
      ProjectUtil.focusProjectWindow(p,false);
      return null;
    }
  }
  PropertiesComponent.getInstance().setValue(LAST_IMPORTED_LOCATION,file.getPath());
  return createImportWizard(project,dialogParent,file,providers);
}
