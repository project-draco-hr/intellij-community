{
  if (exportedDependencies != null) {
    final String exported=StringUtil.join(exportedDependencies,", ");
    return manager.createProblemDescriptor(InspectionsBundle.message("unnecessary.module.dependency.exported.problem.descriptor",module.getName(),dependency.getName(),exported));
  }
  if (scope.containsModule(dependency)) {
    final String allContainsMessage=InspectionsBundle.message("unnecessary.module.dependency.problem.descriptor",module.getName(),dependency.getName());
    return manager.createProblemDescriptor(allContainsMessage,new RemoveModuleDependencyFix(module,dependency));
  }
 else {
    String message=InspectionsBundle.message("suspected.module.dependency.problem.descriptor",module.getName(),dependency.getName(),scope.getDisplayName(),dependency.getName());
    return manager.createProblemDescriptor(message);
  }
}
