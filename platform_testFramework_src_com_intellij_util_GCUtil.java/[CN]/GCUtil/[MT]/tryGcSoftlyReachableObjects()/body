{
  ReferenceQueue<Object> q=new ReferenceQueue<Object>();
  SoftReference<Object> ref=new SoftReference<Object>(new Object(),q);
  List<Object> list=ContainerUtil.newArrayListWithCapacity(100 + useReference(ref));
  for (int i=0; i < 100; i++) {
    System.gc();
    if (q.poll() != null) {
      break;
    }
    TimeoutUtil.sleep(10);
    long bytes=Math.min(Runtime.getRuntime().freeMemory() / 2,Integer.MAX_VALUE);
    list.add(new SoftReference<byte[]>(new byte[(int)bytes]));
  }
}
