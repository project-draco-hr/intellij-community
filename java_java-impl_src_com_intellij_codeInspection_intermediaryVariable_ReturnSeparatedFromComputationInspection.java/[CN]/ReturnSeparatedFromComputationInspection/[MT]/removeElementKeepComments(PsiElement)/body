{
  List<PsiComment> keptComments=getComments(removedElement);
  if (!keptComments.isEmpty()) {
    PsiComment firstComment=keptComments.get(0);
    PsiElement lastComment=removedElement.replace(firstComment);
    PsiElement parent=lastComment.getParent();
    Project project=parent.getProject();
    CodeStyleManager styleManager=CodeStyleManager.getInstance(project);
    styleManager.reformat(lastComment,true);
    if (keptComments.size() > 1) {
      for (      PsiComment comment : keptComments.subList(1,keptComments.size())) {
        lastComment=parent.addAfter(comment,lastComment);
        styleManager.reformat(lastComment,true);
      }
    }
  }
 else {
    removedElement.delete();
  }
}
