{
  final List<TextRange> ranges=new SmartList<TextRange>();
  if (mySelectionModel != null && mySelectionModel.hasSelection()) {
    ranges.add(TextRange.create(mySelectionModel.getSelectionStart(),mySelectionModel.getSelectionEnd()));
  }
 else   if (mySelectionModel != null && mySelectionModel.hasBlockSelection()) {
    int[] starts=mySelectionModel.getBlockSelectionStarts();
    int[] ends=mySelectionModel.getBlockSelectionEnds();
    for (int i=0; i < starts.length; i++) {
      ranges.add(TextRange.create(starts[i],ends[i]));
    }
  }
 else {
    ranges.add(TextRange.create(0,file.getTextLength()));
  }
  return ranges;
}
