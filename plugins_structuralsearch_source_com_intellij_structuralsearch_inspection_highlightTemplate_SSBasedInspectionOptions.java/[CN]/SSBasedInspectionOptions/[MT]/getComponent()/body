{
  JPanel panel=new JPanel(new BorderLayout());
  panel.add(new JLabel(SSRBundle.message("SSRInspection.selected.templates")));
  panel.add(ToolbarDecorator.createDecorator(myTemplatesList).setAddAction(new AnActionButtonRunnable(){
    @Override public void run(    AnActionButton button){
      final AnAction[] children=new AnAction[]{new AnAction(SSRBundle.message("SSRInspection.add.search.template.button")){
        @Override public void actionPerformed(        AnActionEvent e){
          addTemplate(new SearchDialogFactory(){
            public SearchDialog createDialog(            SearchContext searchContext){
              return new SearchDialog(searchContext,false,false);
            }
          }
);
        }
      }
,new AnAction(SSRBundle.message("SSRInspection.add.replace.template.button")){
        @Override public void actionPerformed(        AnActionEvent e){
          addTemplate(new SearchDialogFactory(){
            public SearchDialog createDialog(            SearchContext searchContext){
              return new ReplaceDialog(searchContext,false,false);
            }
          }
);
        }
      }
};
      JBPopupFactory.getInstance().createActionGroupPopup(null,new DefaultActionGroup(children),DataManager.getInstance().getDataContext(button.getContextComponent()),JBPopupFactory.ActionSelectionAid.SPEEDSEARCH,true).show(button.getPreferredPopupPoint());
    }
  }
).setEditAction(new AnActionButtonRunnable(){
    @Override public void run(    AnActionButton button){
      final Configuration configuration=(Configuration)myTemplatesList.getSelectedValue();
      if (configuration == null)       return;
      SearchDialog dialog=createDialog(new SearchDialogFactory(){
        public SearchDialog createDialog(        SearchContext searchContext){
          return configuration instanceof SearchConfiguration ? new SearchDialog(searchContext,false,false){
            public Configuration createConfiguration(){
              SearchConfiguration newConfiguration=new SearchConfiguration();
              copyConfiguration(configuration,newConfiguration);
              return newConfiguration;
            }
          }
 : new ReplaceDialog(searchContext,false,false){
            public Configuration createConfiguration(){
              ReplaceConfiguration newConfiguration=new ReplaceConfiguration();
              copyConfiguration(configuration,newConfiguration);
              return newConfiguration;
            }
          }
;
        }
      }
);
      dialog.setValuesFromConfig(configuration);
      dialog.setUseLastConfiguration(true);
      dialog.show();
      if (!dialog.isOK())       return;
      Configuration newConfiguration=dialog.getConfiguration();
      copyConfiguration(newConfiguration,configuration);
      configurationsChanged(dialog.getSearchContext());
    }
  }
).setRemoveAction(new AnActionButtonRunnable(){
    @Override public void run(    AnActionButton button){
      Object[] selected=myTemplatesList.getSelectedValues();
      for (      Object o : selected) {
        Configuration configuration=(Configuration)o;
        Iterator<Configuration> iterator=myConfigurations.iterator();
        while (iterator.hasNext()) {
          Configuration configuration1=iterator.next();
          if (configuration1.getName().equals(configuration.getName())) {
            iterator.remove();
          }
        }
      }
      configurationsChanged(createSearchContext());
    }
  }
).disableUpDownActions().createPanel());
  return panel;
}
