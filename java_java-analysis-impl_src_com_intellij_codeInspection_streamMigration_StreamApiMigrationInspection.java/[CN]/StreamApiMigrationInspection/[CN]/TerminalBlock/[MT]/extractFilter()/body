{
  if (getSingleStatement() instanceof PsiIfStatement) {
    PsiIfStatement ifStatement=(PsiIfStatement)getSingleStatement();
    if (ifStatement.getElseBranch() == null && ifStatement.getCondition() != null) {
      replaceWith(ifStatement.getThenBranch());
      return new FilterOp(ifStatement.getCondition(),myVariable,false);
    }
  }
  if (myStatements.length >= 1) {
    PsiStatement first=myStatements[0];
    if (first instanceof PsiIfStatement) {
      PsiIfStatement ifStatement=(PsiIfStatement)first;
      if (ifStatement.getCondition() == null)       return null;
      PsiStatement branch=ifStatement.getThenBranch();
      if (branch instanceof PsiBlockStatement) {
        PsiStatement[] statements=((PsiBlockStatement)branch).getCodeBlock().getStatements();
        if (statements.length == 1)         branch=statements[0];
      }
      if (!(branch instanceof PsiContinueStatement) || ((PsiContinueStatement)branch).getLabelIdentifier() != null)       return null;
      if (ifStatement.getElseBranch() != null) {
        myStatements[0]=ifStatement.getElseBranch();
      }
 else {
        myStatements=Arrays.copyOfRange(myStatements,1,myStatements.length);
      }
      flatten();
      return new FilterOp(ifStatement.getCondition(),myVariable,true);
    }
  }
  return null;
}
