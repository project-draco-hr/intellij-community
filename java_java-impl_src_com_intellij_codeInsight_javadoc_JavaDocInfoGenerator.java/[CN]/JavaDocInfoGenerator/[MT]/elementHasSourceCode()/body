{
  VirtualFile[] files;
  if (myElement instanceof PsiDirectory) {
    final PsiPackage aPackage=JavaDirectoryService.getInstance().getPackage((PsiDirectory)myElement);
    if (aPackage == null)     return false;
    files=PackageIndex.getInstance(myProject).getDirectoriesByPackageName(aPackage.getQualifiedName(),true);
  }
 else   if (myElement instanceof PsiPackage) {
    files=PackageIndex.getInstance(myProject).getDirectoriesByPackageName(((PsiPackage)myElement).getQualifiedName(),true);
  }
 else {
    PsiFile containingFile=myElement.getNavigationElement().getContainingFile();
    if (containingFile == null)     return false;
    VirtualFile virtualFile=containingFile.getVirtualFile();
    if (virtualFile == null)     return false;
    files=new VirtualFile[]{virtualFile};
  }
  ProjectFileIndex projectFileIndex=ProjectFileIndex.SERVICE.getInstance(myProject);
  for (  VirtualFile file : files) {
    if (projectFileIndex.isInSource(file))     return true;
  }
  return false;
}
