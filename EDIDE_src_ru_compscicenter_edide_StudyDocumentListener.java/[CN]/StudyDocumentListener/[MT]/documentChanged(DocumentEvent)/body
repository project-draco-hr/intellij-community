{
  if (e instanceof DocumentEventImpl) {
    DocumentEventImpl event=(DocumentEventImpl)e;
    Document document=e.getDocument();
    int offset=e.getOffset();
    int change=event.getNewLength() - event.getOldLength();
    int line=document.getLineNumber(offset);
    int offsetInLine=offset - document.getLineStartOffset(line);
    LogicalPosition pos=new LogicalPosition(line,offsetInLine);
    Window window=myTaskFile.getTaskWindow(document,pos);
    if (window != null) {
      int newLength=window.getLength() + change;
      window.setLength(newLength);
    }
    int newEnd=offset + event.getNewLength();
    int newLine=document.getLineNumber(newEnd);
    int lineChange=newLine - oldLine;
    myTaskFile.incrementLines(oldLine + 1,lineChange);
    int newEndOffsetInLine=offset + e.getNewLength() - document.getLineStartOffset(newLine);
    int oldEndOffsetInLine=offset + e.getOldLength() - document.getLineStartOffset(oldLine);
    myTaskFile.updateLine(lineChange,oldLine,newEndOffsetInLine,oldEndOffsetInLine);
  }
}
