{
  HttpMethod method=null;
  try {
    method=doREST(auth,"",null,HttpVerb.GET);
    if (method.getStatusCode() >= 400 && method.getStatusCode() <= 404) {
      throw new AuthenticationException("Request response: " + method.getStatusText());
    }
    Header header=method.getResponseHeader("X-OAuth-Scopes");
    if (header == null) {
      return null;
    }
    Collection<String> scopes=new ArrayList<String>();
    for (    HeaderElement elem : header.getElements()) {
      scopes.add(elem.getName());
    }
    return scopes;
  }
  finally {
    if (method != null) {
      method.releaseConnection();
    }
  }
}
