{
  if (parent instanceof PsiDirectoryNode && children.isEmpty()) {
    VirtualFile virtualFile=((PsiDirectoryNode)parent).getVirtualFile();
    if (virtualFile == null)     return children;
    VirtualFile[] virtualFiles=virtualFile.getChildren();
    List<AbstractTreeNode> result=new ArrayList<>();
    for (    VirtualFile file : virtualFiles) {
      AbstractTreeNode child;
      if (file.isDirectory())       child=new PsiDirectoryNode(myProject,new PsiDirectoryImpl((PsiManagerImpl)PsiManager.getInstance(myProject),file),settings);
 else       child=new PsiFileNode(myProject,PsiUtilCore.getPsiFile(myProject,file),settings);
      child.setParent(parent);
      result.add(child);
    }
    return result;
  }
  return children;
}
