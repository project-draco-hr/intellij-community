{
  if (logDetails) {
    LOG.info("Finding files in PATH (base name=" + fileBaseName + ", PATH="+ StringUtil.notNullize(pathEnvVarValue)+ ").");
  }
  if (pathEnvVarValue == null) {
    return Collections.emptyList();
  }
  List<File> result=new SmartList<>();
  List<String> paths=StringUtil.split(pathEnvVarValue,File.pathSeparator,true,true);
  for (  String path : paths) {
    File dir=new File(path);
    if (logDetails) {
      File file=new File(dir,fileBaseName);
      LOG.info("path:" + path + ", path.isAbsolute:"+ dir.isAbsolute()+ ", path.isDirectory:"+ dir.isDirectory()+ ", file.isFile:"+ file.isFile()+ ", file.canExecute:"+ file.canExecute());
    }
    if (dir.isAbsolute() && dir.isDirectory()) {
      File exeFile=new File(dir,fileBaseName);
      if (exeFile.isFile() && exeFile.canExecute()) {
        if (filter == null || filter.accept(exeFile)) {
          result.add(exeFile);
          if (stopAfterFirstMatch) {
            return result;
          }
        }
      }
    }
  }
  return result;
}
