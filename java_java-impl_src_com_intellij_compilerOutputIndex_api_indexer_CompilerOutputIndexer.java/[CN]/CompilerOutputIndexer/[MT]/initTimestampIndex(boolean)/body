{
  if (needReindex) {
    FileUtil.delete(IndexInfrastructure.getIndexRootDir(getFileTimestampsIndexId()));
  }
  for (int attempts=0; attempts < 2; attempts++) {
    try {
      myFileTimestampsIndex=new PersistentHashMap<String,Long>(IndexInfrastructure.getStorageFile(getFileTimestampsIndexId()),new EnumeratorStringDescriptor(),new DataExternalizer<Long>(){
        @Override public void save(        final DataOutput out,        final Long value) throws IOException {
          out.writeLong(value);
        }
        @Override public Long read(        final DataInput in) throws IOException {
          return in.readLong();
        }
      }
);
    }
 catch (    IOException e) {
      FileUtil.delete(IndexInfrastructure.getIndexRootDir(getFileTimestampsIndexId()));
    }
    if (myFileTimestampsIndex != null) {
      return;
    }
  }
  throw new RuntimeException("Timestamps index not initialized");
}
