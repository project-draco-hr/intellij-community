{
  final List<ExternalSystemNode<?>> result=new SmartList<ExternalSystemNode<?>>();
  final MultiMap<Key<?>,DataNode<?>> groups=ExternalSystemApiUtil.group(dataNode.getChildren());
  for (  ExternalSystemViewContributor contributor : ExternalSystemViewContributor.EP_NAME.getExtensions()) {
    if (!contributor.getSystemId().equals(ProjectSystemId.IDE) && !contributor.getSystemId().equals(externalProjectsView.getSystemId())) {
      continue;
    }
    final MultiMap<Key<?>,DataNode<?>> dataNodes=new ContainerUtil.KeyOrderedMultiMap<Key<?>,DataNode<?>>();
    for (    Key<?> key : contributor.getKeys()) {
      ContainerUtil.putIfNotNull(key,groups.get(key),dataNodes);
    }
    if (dataNodes.isEmpty())     continue;
    final List<ExternalSystemNode<?>> childNodes=contributor.createNodes(externalProjectsView,dataNodes);
    result.addAll(childNodes);
    if (parent == null)     continue;
    for (    ExternalSystemNode childNode : childNodes) {
      childNode.setParent(parent);
    }
  }
  return result;
}
