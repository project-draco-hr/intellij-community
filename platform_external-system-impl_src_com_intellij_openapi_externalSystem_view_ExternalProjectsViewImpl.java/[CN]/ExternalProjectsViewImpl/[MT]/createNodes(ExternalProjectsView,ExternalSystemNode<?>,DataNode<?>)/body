{
  final List<ExternalSystemNode<?>> result=new SmartList<ExternalSystemNode<?>>();
  final MultiMap<Key<?>,DataNode<?>> groups=ExternalSystemApiUtil.group(dataNode.getChildren());
  for (  ExternalSystemViewContributor contributor : ExternalSystemViewContributor.EP_NAME.getExtensions()) {
    List<Key<?>> keys=contributor.getKeys();
    final MultiMap<Key<?>,DataNode<?>> dataNodes=MultiMap.create();
    for (    Key<?> key : keys) {
      final Collection<DataNode<?>> values=groups.get(key);
      if (key != null) {
        dataNodes.put(key,values);
      }
    }
    if (dataNodes.isEmpty())     continue;
    final List<ExternalSystemNode<?>> childNodes=contributor.createNodes(externalProjectsView,dataNodes);
    result.addAll(childNodes);
    if (parent == null)     continue;
    for (    ExternalSystemNode childNode : childNodes) {
      childNode.setParent(parent);
    }
  }
  return result;
}
