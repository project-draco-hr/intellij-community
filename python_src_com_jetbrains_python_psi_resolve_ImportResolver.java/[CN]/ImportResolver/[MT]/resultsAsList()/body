{
  if (myFoothold != null && !myFoothold.isValid()) {
    return Collections.emptyList();
  }
  PythonPathCache cache=findMyCache();
  if (cache != null) {
    final List<PsiElement> cachedResults=cache.get(myQualifiedName);
    if (cachedResults != null) {
      return cachedResults;
    }
  }
  if (myVisitAllModules) {
    for (    Module mod : ModuleManager.getInstance(myPsiManager.getProject()).getModules()) {
      RootVisitorHost.visitRoots(mod,false,this);
    }
  }
 else   if (myModule != null) {
    final boolean otherSdk=withOtherSdk();
    RootVisitorHost.visitRoots(myModule,otherSdk,this);
    if (otherSdk) {
      RootVisitorHost.visitSdkRoots(myWithSdk,this);
    }
  }
 else   if (myFoothold != null) {
    RootVisitorHost.visitSdkRoots(myFoothold,this);
  }
 else {
    throw new IllegalStateException();
  }
  final ArrayList<PsiElement> resultList=Lists.newArrayList(results);
  if (cache != null) {
    cache.put(myQualifiedName,resultList);
  }
  return resultList;
}
