{
  final SelectionModel model=myEditor.getSelectionModel();
  if (model.hasSelection()) {
    try {
      apply(getSettings());
    }
 catch (    ConfigurationException e) {
      LOG.debug("Cannot apply code style settings",e);
    }
    CodeStyleSettings clone=getSettings().clone();
    try {
      clone.getCommonSettings(myFile.getLanguage()).KEEP_LINE_BREAKS=false;
      CodeStyleSettingsManager.getInstance(myProject).setTemporarySettings(clone);
      reformatRange(myFile,getSelectedRange());
    }
  finally {
      CodeStyleSettingsManager.getInstance(myProject).dropTemporarySettings();
    }
  }
}
