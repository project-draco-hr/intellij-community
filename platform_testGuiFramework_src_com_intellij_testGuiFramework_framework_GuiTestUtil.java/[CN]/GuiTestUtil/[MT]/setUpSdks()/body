{
  String jdkHome=getSystemPropertyOrEnvironmentVariable(JDK_HOME_FOR_TESTS);
  if (isNullOrEmpty(jdkHome) || !checkForJdk(jdkHome)) {
    jdkHome=getBundledJdLocation();
  }
  final File jdkPath=new File(jdkHome);
  execute(new GuiTask(){
    @Override protected void executeInEDT() throws Throwable {
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        @Override public void run(){
          LOG.info(String.format("Setting JDK: '%1$s'",jdkPath.getPath()));
          setJdkPath(jdkPath);
        }
      }
);
    }
  }
);
}
