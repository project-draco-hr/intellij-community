{
  List<FoldingDescriptor> customRegions=new ArrayList<FoldingDescriptor>();
  if (CustomFoldingProvider.getAllProviders().length > 0) {
    myDefaultProvider=null;
    ASTNode rootNode=root.getNode();
    if (rootNode != null) {
      addCustomFoldingRegionsRecursively(new FoldingStack(rootNode),rootNode,customRegions,0);
    }
  }
  List<FoldingDescriptor> langRegions=new ArrayList<FoldingDescriptor>();
  buildLanguageFoldRegions(langRegions,root,document,quick);
  List<FoldingDescriptor> regions=addNonOverlappingRegions(customRegions,langRegions);
  return regions.toArray(new FoldingDescriptor[regions.size()]);
}
