{
  final Semaphore targetDone=new Semaphore();
  targetDone.down();
  final Ref<Boolean> result=Ref.create(Boolean.FALSE);
  SwingUtilities.invokeLater(new Runnable(){
    public void run(){
      try {
        final Project project=CommonDataKeys.PROJECT.getData(dataContext);
        if (project == null || project.isDisposed()) {
          targetDone.up();
        }
 else {
          target.run(dataContext,additionalProperties,new AntBuildListener(){
            public void buildFinished(            int state,            int errorCount){
              result.set((state == AntBuildListener.FINISHED_SUCCESSFULLY) && (errorCount == 0));
              targetDone.up();
            }
          }
);
        }
      }
 catch (      Throwable e) {
        targetDone.up();
        LOG.error(e);
      }
    }
  }
);
  targetDone.waitFor();
  return result.get();
}
