{
  final String name=getTestName(true);
  final Map<String,PsiElement> map=configureByFile("/refactoring/inlinelocal/" + name + ".before.py");
  try {
    PsiElement element=map.values().iterator().next().getParent();
    PyReferenceExpression ref=null;
    if (element instanceof PyReferenceExpression) {
      ref=(PyReferenceExpression)element;
      element=((PyReferenceExpression)element).getReference().resolve();
    }
    PyInlineLocalHandler.invoke(myFixture.getProject(),myFixture.getEditor(),(PyTargetExpression)element,ref);
    if (expectedError != null)     fail("expected error: '" + expectedError + "', got none");
  }
 catch (  Exception e) {
    assertEquals(expectedError,e.getMessage());
    return;
  }
  myFixture.checkResultByFile("/refactoring/inlinelocal/" + name + ".after.py");
}
