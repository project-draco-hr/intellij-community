{
  if (mavenProject.isAggregator())   return;
  try {
    String jdkVersion=null;
    Sdk sdk=ModuleRootManager.getInstance(module).getSdk();
    if (sdk != null && (jdkVersion=sdk.getVersionString()) != null) {
      final int quoteIndex=jdkVersion.indexOf('"');
      if (quoteIndex != -1) {
        jdkVersion=jdkVersion.substring(quoteIndex + 1,jdkVersion.length() - 1);
      }
    }
    Manifest manifest=new ManifestBuilder(mavenProject).withJdkVersion(jdkVersion).build();
    File manifestFile=new File(mavenProject.getBuildDirectory(),ManifestFileUtil.MANIFEST_FILE_NAME);
    FileUtil.createIfDoesntExist(manifestFile);
    OutputStream outputStream=new FileOutputStream(manifestFile);
    try {
      manifest.write(outputStream);
    }
  finally {
      StreamUtil.closeStream(outputStream);
    }
  }
 catch (  ManifestBuilder.ManifestBuilderException e) {
    LOG.error("Unable to generate artifact manifest",e);
  }
catch (  IOException e) {
    LOG.error("Unable to save generated artifact manifest",e);
  }
}
