{
  final UndoManager undoManager=new UndoManager();
  textComponent.getDocument().addUndoableEditListener(undoManager);
  textComponent.getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_Z,SystemInfo.isMac ? InputEvent.META_MASK : InputEvent.CTRL_MASK),"undoKeystroke");
  textComponent.getActionMap().put("undoKeystroke",new AbstractAction(){
    @Override public void actionPerformed(    ActionEvent e){
      if (undoManager.canUndo()) {
        undoManager.undo();
      }
    }
  }
);
  textComponent.getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_Z,(SystemInfo.isMac ? InputEvent.META_MASK : InputEvent.CTRL_MASK) | InputEvent.SHIFT_MASK),"redoKeystroke");
  textComponent.getActionMap().put("redoKeystroke",new AbstractAction(){
    @Override public void actionPerformed(    ActionEvent e){
      if (undoManager.canRedo()) {
        undoManager.redo();
      }
    }
  }
);
}
