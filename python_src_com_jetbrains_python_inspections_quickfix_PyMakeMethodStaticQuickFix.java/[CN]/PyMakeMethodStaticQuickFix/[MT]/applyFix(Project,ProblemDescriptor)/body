{
  final PsiElement element=descriptor.getPsiElement();
  final PyFunction problemFunction=PsiTreeUtil.getParentOfType(element,PyFunction.class);
  if (problemFunction == null)   return;
  final List<UsageInfo> usages=PyRefactoringUtil.findUsages(problemFunction,false);
  PyUtil.deleteParameter(problemFunction,0);
  final PyDecoratorList problemDecoratorList=problemFunction.getDecoratorList();
  List<String> decoTexts=new ArrayList<String>();
  decoTexts.add("@staticmethod");
  if (problemDecoratorList != null) {
    final PyDecorator[] decorators=problemDecoratorList.getDecorators();
    for (    PyDecorator deco : decorators) {
      decoTexts.add(deco.getText());
    }
  }
  PyElementGenerator generator=PyElementGenerator.getInstance(project);
  final PyDecoratorList decoratorList=generator.createDecoratorList(decoTexts.toArray(new String[decoTexts.size()]));
  if (problemDecoratorList != null) {
    problemDecoratorList.replace(decoratorList);
  }
 else {
    problemFunction.addBefore(decoratorList,problemFunction.getFirstChild());
  }
  for (  UsageInfo usage : usages) {
    final PsiElement usageElement=usage.getElement();
    if (usageElement instanceof PyReferenceExpression) {
      updateUsage((PyReferenceExpression)usageElement);
    }
  }
}
