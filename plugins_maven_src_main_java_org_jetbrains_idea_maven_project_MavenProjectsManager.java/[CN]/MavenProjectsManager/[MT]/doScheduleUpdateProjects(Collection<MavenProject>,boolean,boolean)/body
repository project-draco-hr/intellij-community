{
  final AsyncPromise<Void> promise=new AsyncPromise<Void>();
  MavenUtil.runWhenInitialized(myProject,new DumbAwareRunnable(){
    public void run(){
      if (projects == null) {
        myWatcher.scheduleUpdateAll(forceUpdate,forceImportAndResolve).processed(promise);
      }
 else {
        myWatcher.scheduleUpdate(MavenUtil.collectFiles(projects),Collections.<VirtualFile>emptyList(),forceUpdate,forceImportAndResolve).processed(promise);
      }
    }
  }
);
  return promise;
}
