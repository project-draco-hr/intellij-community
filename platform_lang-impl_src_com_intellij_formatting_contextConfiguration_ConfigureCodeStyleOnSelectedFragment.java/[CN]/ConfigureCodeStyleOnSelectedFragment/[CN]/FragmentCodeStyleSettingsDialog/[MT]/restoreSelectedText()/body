{
  final Document document=myEditor.getDocument();
  final int start=myEditor.getSelectionModel().getSelectionStart();
  final int end=myEditor.getSelectionModel().getSelectionEnd();
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      CommandProcessor.getInstance().executeCommand(myProject,new Runnable(){
        @Override public void run(){
          document.replaceString(start,end,myTextBefore);
        }
      }
,"Configure code style on selected fragment: restore text before",null);
    }
  }
);
  myEditor.getSelectionModel().setSelection(mySelectionStart,mySelectionEnd);
}
