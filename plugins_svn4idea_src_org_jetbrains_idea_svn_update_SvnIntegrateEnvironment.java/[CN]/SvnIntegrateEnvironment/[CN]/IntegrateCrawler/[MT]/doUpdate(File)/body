{
  final SvnConfiguration svnConfig=SvnConfiguration.getInstance(myVcs.getProject());
  MergeRootInfo info=svnConfig.getMergeRootInfo(root,myVcs);
  if (info.getUrlString1().equals(info.getUrlString2()) && info.getRevision1().equals(info.getRevision2())) {
    return 0;
  }
  MergeClient client=myVcs.getFactory(root).createMergeClient();
  SvnTarget source1=SvnTarget.fromURL(info.getUrl1(),info.getRevision1());
  SvnTarget source2=SvnTarget.fromURL(info.getUrl2(),info.getRevision2());
  client.merge(source1,source2,root,svnConfig.UPDATE_DEPTH,svnConfig.MERGE_DIFF_USE_ANCESTRY,svnConfig.MERGE_DRY_RUN,false,false,svnConfig.getMergeOptions(),myHandler);
  svnConfig.LAST_MERGED_REVISION=getLastMergedRevision(info.getRevision2(),info.getUrl2());
  return info.getResultRevision();
}
