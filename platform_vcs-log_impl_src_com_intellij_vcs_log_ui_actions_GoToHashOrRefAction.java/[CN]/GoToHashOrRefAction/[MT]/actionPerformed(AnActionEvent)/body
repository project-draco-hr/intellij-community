{
  Project project=e.getProject();
  final VcsLog log=e.getData(VcsLogDataKeys.VCS_LOG);
  final VcsLogUiImpl logUi=(VcsLogUiImpl)e.getData(VcsLogDataKeys.VCS_LOG_UI);
  if (project == null || log == null || logUi == null) {
    return;
  }
  GoToHashOrRefPopup popup=new GoToHashOrRefPopup(project,VcsLogUtil.getVisibleBranches(log,logUi),new Function<String,Future>(){
    @Override public Future fun(    String text){
      return log.jumpToReference(text);
    }
  }
,new Function<VcsRef,Future>(){
    @Override public Future fun(    VcsRef vcsRef){
      return logUi.jumpToCommit(vcsRef.getCommitHash(),vcsRef.getRoot());
    }
  }
,logUi.getColorManager(),new VcsRefComparator(logUi.getDataPack().getLogProviders()));
  popup.show(logUi.getTable());
}
