{
  if (!detectStartRevision())   return -1;
  final Ref<Long> latest=new Ref<Long>(myStartNumber);
  SVNRepository repository=null;
  try {
    repository=myVcs.getSvnKitManager().createRepository(myUrl.toString());
    if (myEndNumber == -1) {
      myEndNumber=repository.getLatestRevision();
    }
    final SVNURL existingParent=getExistingParent(myUrl,repository);
    if (existingParent == null) {
      return myStartNumber;
    }
    final SVNRevision startRevision=SVNRevision.create(myStartNumber);
    SvnTarget target=SvnTarget.fromURL(existingParent,startRevision);
    myVcs.getFactory(target).createHistoryClient().doLog(target,startRevision,SVNRevision.HEAD,false,true,false,0,null,createHandler(latest));
  }
 catch (  SVNException e) {
    LOG.info(e);
  }
catch (  VcsException e) {
    LOG.info(e);
  }
 finally {
    if (repository != null) {
      repository.closeSession();
    }
  }
  return latest.get().longValue();
}
