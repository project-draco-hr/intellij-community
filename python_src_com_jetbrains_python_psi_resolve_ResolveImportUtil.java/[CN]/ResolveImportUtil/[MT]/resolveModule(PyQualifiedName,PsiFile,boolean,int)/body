{
  if (qualifiedName == null)   return Collections.emptyList();
  String marker=StringUtil.join(qualifiedName.getComponents(),".") + "#" + Integer.toString(relative_level);
  Set<String> being_imported=ourBeingImported.get();
  if (being_imported.contains(marker))   return Collections.emptyList();
  try {
    being_imported.add(marker);
    if (relative_level > 0) {
      final PsiElement module=resolveModuleAt(stepBackFrom(source_file,relative_level),source_file,qualifiedName);
      return module != null ? Collections.singletonList(module) : Collections.<PsiElement>emptyList();
    }
 else {
      if (import_is_absolute) {
        return resolveModulesInRoots(qualifiedName,source_file);
      }
 else {
        PsiElement module=resolveModuleAt(source_file.getOriginalFile().getContainingDirectory(),source_file,qualifiedName);
        if (module != null) {
          return Collections.singletonList(module);
        }
        return resolveModulesInRoots(qualifiedName,source_file);
      }
    }
  }
  finally {
    being_imported.remove(marker);
  }
}
