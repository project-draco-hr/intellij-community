{
  if (qualifiedName == null)   return Collections.emptyList();
  String marker=StringUtil.join(qualifiedName.getComponents(),".") + "#" + Integer.toString(relativeLevel);
  Set<String> being_imported=ourBeingImported.get();
  if (being_imported.contains(marker))   return Collections.emptyList();
  try {
    being_imported.add(marker);
    ImportResolver visitor=new ImportResolver(qualifiedName,true).fromElement(source_file);
    if (relativeLevel > 0) {
      visitor.withRelative(relativeLevel).withoutRoots();
    }
 else {
      if (!importIsAbsolute) {
        visitor.withRelative(0);
      }
    }
    return visitor.resultsAsList();
  }
  finally {
    being_imported.remove(marker);
  }
}
