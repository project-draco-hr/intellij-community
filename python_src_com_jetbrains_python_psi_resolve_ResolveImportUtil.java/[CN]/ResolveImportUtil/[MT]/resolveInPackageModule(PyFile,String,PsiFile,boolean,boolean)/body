{
  final PsiElement moduleMember=resolveModuleMember(parent,referencedName);
  final PsiElement resolved=!fileOnly || PyUtil.instanceOf(moduleMember,PsiFile.class,PsiDirectory.class) ? moduleMember : null;
  if (resolved != null && !preferResolveInDirectoryOverModule(resolved)) {
    return resolved;
  }
  final PsiElement resolvedInDirectory=resolveInPackageDirectory(parent,referencedName,containingFile,fileOnly,checkForPackage);
  if (resolvedInDirectory != null) {
    return resolvedInDirectory;
  }
  return resolved;
}
