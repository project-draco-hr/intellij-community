{
  if (moduleRef == null || !moduleRef.isValid())   return null;
  if (foothold == null || !foothold.isValid())   return null;
  PsiFile foothold_file=foothold.getContainingFile();
  if (foothold_file == null || !foothold_file.isValid())   return null;
  List<PyReferenceExpression> module_path=PyResolveUtil.unwindQualifiers(moduleRef);
  if (module_path == null || module_path.size() < 1)   return null;
  Iterator<PyReferenceExpression> qualifier_sequence=module_path.iterator();
  String top_module_name=qualifier_sequence.next().getReferencedName();
  LookupRootVisitor visitor=new LookupRootVisitor(top_module_name,foothold.getManager());
  visitRoots(foothold,visitor);
  PsiElement module=visitor.getResult();
  while (module != null && qualifier_sequence.hasNext()) {
    module=resolveChild(module,qualifier_sequence.next().getReferencedName(),foothold_file,false);
  }
  return module;
}
