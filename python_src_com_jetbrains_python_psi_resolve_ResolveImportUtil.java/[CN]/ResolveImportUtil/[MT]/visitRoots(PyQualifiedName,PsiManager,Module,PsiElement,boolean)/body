{
  PsiFile footholdFile=foothold != null ? foothold.getContainingFile() : null;
  boolean has_djando_facet=false;
  if (module != null) {
    has_djando_facet=FacetManager.getInstance(module).getFacetByType(DjangoFacetType.ID) != null;
  }
  ResolveInRootVisitor visitor;
  if (has_djando_facet) {
    visitor=new ResolveInRootAsTopPackageVisitor(moduleQualifiedName,manager,footholdFile,checkForPackage);
  }
 else {
    visitor=new ResolveInRootVisitor(moduleQualifiedName,manager,footholdFile,checkForPackage);
  }
  if (module != null) {
    RootVisitorHost.visitRoots(module,visitor);
    return visitor.resultsAsList();
  }
 else   if (foothold != null) {
    RootVisitorHost.visitSdkRoots(foothold,visitor);
    return visitor.resultsAsList();
  }
 else {
    throw new IllegalStateException();
  }
}
