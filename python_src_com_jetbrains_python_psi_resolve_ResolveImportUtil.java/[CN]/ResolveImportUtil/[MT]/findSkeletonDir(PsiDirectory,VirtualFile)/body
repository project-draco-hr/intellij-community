{
  String relativeName;
  if (root != null) {
    relativeName=VfsUtil.getRelativePath(dir.getVirtualFile(),root,'/');
  }
 else {
    relativeName=findShortestImportableName(dir,dir.getVirtualFile());
    if (relativeName != null) {
      relativeName=relativeName.replace('.','/');
    }
  }
  VirtualFile skeletonsRoot=findSkeletonsRoot(dir);
  if (skeletonsRoot != null && relativeName != null) {
    VirtualFile skeletonsVFile=relativeName.length() == 0 ? skeletonsRoot : skeletonsRoot.findFileByRelativePath(relativeName.replace(".","/"));
    if (skeletonsVFile != null) {
      return dir.getManager().findDirectory(skeletonsVFile);
    }
  }
  return null;
}
