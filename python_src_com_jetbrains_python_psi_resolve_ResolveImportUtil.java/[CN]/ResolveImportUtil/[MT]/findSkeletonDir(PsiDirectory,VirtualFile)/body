{
  String relativeName=null;
  if (root != null) {
    relativeName=VfsUtil.getRelativePath(dir.getVirtualFile(),root,'/');
  }
 else {
    PyQualifiedName relativeQName=findShortestImportableQName(dir,dir.getVirtualFile());
    if (relativeQName != null) {
      relativeName=relativeQName.join("/");
    }
  }
  VirtualFile skeletonsRoot=findSkeletonsRoot(dir);
  if (skeletonsRoot != null && relativeName != null) {
    VirtualFile skeletonsVFile=relativeName.length() == 0 ? skeletonsRoot : skeletonsRoot.findFileByRelativePath(relativeName.replace(".","/"));
    if (skeletonsVFile != null) {
      return dir.getManager().findDirectory(skeletonsVFile);
    }
  }
  return null;
}
