{
  if (foothold == null || !foothold.isValid())   return Collections.emptyList();
  PsiFile footholdFile=foothold.getContainingFile();
  if (footholdFile == null || !footholdFile.isValid())   return Collections.emptyList();
  PythonPathCache cache=null;
  final Module module=ModuleUtil.findModuleForPsiElement(foothold);
  if (module != null) {
    cache=PythonModulePathCache.getInstance(module);
  }
 else {
    final Sdk sdk=PyBuiltinCache.findSdkForFile(footholdFile);
    if (sdk != null) {
      cache=PythonSdkPathCache.getInstance(foothold.getProject(),sdk);
    }
  }
  if (cache != null) {
    final List<PsiElement> cachedResults=cache.get(moduleQualifiedName);
    if (cachedResults != null) {
      return cachedResults;
    }
  }
  ResolveInRootVisitor visitor=new ResolveInRootVisitor(moduleQualifiedName,foothold.getManager(),footholdFile);
  visitRoots(foothold,visitor);
  if (cache != null) {
    cache.put(moduleQualifiedName,visitor.results);
  }
  return visitor.results;
}
