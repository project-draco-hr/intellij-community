{
  final SVNURL repositoryUrl=myExecutor.getCommand().getRepositoryUrl();
  final Project project=myRuntime.getVcs().getProject();
  final Ref<String> answer=new Ref<String>();
  Runnable command=new Runnable(){
    public void run(){
      SimpleCredentialsDialog dialog=new SimpleCredentialsDialog(project);
      dialog.setup(mode,repositoryUrl != null ? repositoryUrl.toDecodedString() : "",key,true);
      dialog.setTitle(SvnBundle.message("dialog.title.authentication.required"));
      dialog.show();
      if (dialog.isOK()) {
        answer.set(dialog.getPassword());
      }
    }
  }
;
  WaitForProgressToShow.runOrInvokeAndWaitAboveProgress(command);
  if (!answer.isNull()) {
    sendAnswer(answer.get());
  }
 else {
    myExecutor.destroyProcess("Authentication canceled for repository: " + repositoryUrl);
  }
  return !answer.isNull();
}
