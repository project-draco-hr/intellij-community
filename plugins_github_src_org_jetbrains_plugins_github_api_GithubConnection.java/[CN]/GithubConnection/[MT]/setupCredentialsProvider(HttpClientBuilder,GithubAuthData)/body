{
  CredentialsProvider provider=new BasicCredentialsProvider();
  GithubAuthData.BasicAuth basicAuth=auth.getBasicAuth();
  if (basicAuth != null) {
    AuthScope authScope=getBasicAuthScope(auth);
    provider.setCredentials(authScope,new UsernamePasswordCredentials(basicAuth.getLogin(),basicAuth.getPassword()));
    builder.addInterceptorFirst(new PreemptiveBasicAuthInterceptor(authScope));
  }
  builder.setDefaultCredentialsProvider(provider);
  if (auth.isUseProxy()) {
    IdeHttpClientHelpers.ApacheHttpClient4.setProxyCredentialsForUrlIfEnabled(provider,auth.getHost());
  }
  return provider;
}
