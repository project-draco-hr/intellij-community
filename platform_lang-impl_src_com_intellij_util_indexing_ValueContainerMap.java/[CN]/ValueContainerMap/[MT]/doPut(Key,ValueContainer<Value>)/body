{
synchronized (myEnumerator) {
    ChangeTrackingValueContainer<Value> valueContainer=(ChangeTrackingValueContainer<Value>)container;
    if (!valueContainer.needsCompacting() && !myKeyIsUniqueForIndexedFile) {
      appendData(key,new PersistentHashMap.ValueDataAppender(){
        @Override public void append(        @NotNull final DataOutput out) throws IOException {
          valueContainer.saveTo(out,myValueExternalizer);
        }
      }
);
    }
 else {
      super.doPut(key,valueContainer);
    }
  }
}
