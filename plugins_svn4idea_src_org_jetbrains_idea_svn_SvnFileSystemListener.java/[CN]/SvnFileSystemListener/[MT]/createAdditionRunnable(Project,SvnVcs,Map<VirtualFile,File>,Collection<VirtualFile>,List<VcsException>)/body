{
  return new Runnable(){
    @Override public void run(){
      for (      VirtualFile file : filesToProcess) {
        final File ioFile=new File(file.getPath());
        try {
          final File copyFrom=copyFromMap.get(file);
          if (copyFrom != null) {
            try {
              new ActionWithTempFile(ioFile){
                protected void executeInternal() throws VcsException {
                  new RepeatSvnActionThroughBusy(){
                    @Override protected void executeImpl() throws VcsException {
                      vcs.getFactory(copyFrom).createCopyMoveClient().copy(copyFrom,ioFile,true,false);
                    }
                  }
.execute();
                }
              }
.execute();
            }
 catch (            VcsException e) {
              exceptions.add(e);
            }
          }
 else {
            new RepeatSvnActionThroughBusy(){
              @Override protected void executeImpl() throws VcsException {
                vcs.getFactory(ioFile).createAddClient().add(ioFile,null,false,false,true,null);
              }
            }
.execute();
          }
          VcsDirtyScopeManager.getInstance(project).fileDirty(file);
        }
 catch (        VcsException e) {
          exceptions.add(e);
        }
      }
    }
  }
;
}
