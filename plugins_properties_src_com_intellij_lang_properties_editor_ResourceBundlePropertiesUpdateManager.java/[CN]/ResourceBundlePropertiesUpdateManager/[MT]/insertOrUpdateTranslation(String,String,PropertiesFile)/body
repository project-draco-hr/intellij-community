{
  final IProperty property=propertiesFile.findPropertyByKey(key);
  if (property != null) {
    final String oldValue=property.getValue();
    if (!Comparing.equal(oldValue,value)) {
      property.setValue(value);
      myCodeStyleManager.reformat(property.getPsiElement());
    }
    return;
  }
  if (myOrdered) {
    if (myAlphaSorted) {
      myCodeStyleManager.reformat(propertiesFile.addProperty(key,value).getPsiElement());
      return;
    }
    final Pair<IProperty,Integer> propertyAndPosition=findExistedPrevSiblingProperty(key,propertiesFile);
    myCodeStyleManager.reformat(propertiesFile.addPropertyAfter(key,value,propertyAndPosition == null ? null : (Property)propertyAndPosition.getFirst()).getPsiElement());
  }
 else {
    insertPropertyLast(key,value,propertiesFile);
  }
}
