{
  File realDir=myTempDir.newFolder("real");
  File symLink=IoTestUtil.createSymLink(realDir.getPath(),myTempDir.getRoot() + "/link");
  File mappedDir=new File(myTempDir.getRoot(),"mapped");
  CanonicalPathMap pathMap=new CanonicalPathMap(Collections.singletonList(symLink.getPath()),Collections.emptyList());
  pathMap.addMapping(Collections.singletonList(pair(mappedDir.getPath(),realDir.getPath())));
  Collection<String> watchedPaths=pathMap.getWatchedPaths(new File(mappedDir,"file.txt").getPath(),true);
  assertThat(watchedPaths).containsExactly(new File(symLink,"file.txt").getPath());
}
