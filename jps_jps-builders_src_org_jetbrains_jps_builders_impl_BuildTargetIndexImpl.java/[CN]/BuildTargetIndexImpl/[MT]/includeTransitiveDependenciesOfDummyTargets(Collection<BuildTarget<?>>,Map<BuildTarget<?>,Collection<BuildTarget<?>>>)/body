{
  ArrayList<BuildTarget<?>> realDependencies=new ArrayList<BuildTarget<?>>(dependencies.size());
  Set<BuildTarget<?>> processed=new HashSet<BuildTarget<?>>(dependencies);
  Queue<BuildTarget<?>> toProcess=new ArrayDeque<BuildTarget<?>>(dependencies);
  while (!toProcess.isEmpty()) {
    BuildTarget<?> dep=toProcess.poll();
    Collection<BuildTarget<?>> toInclude=dummyTargetDependencies.get(dep);
    if (toInclude != null) {
      for (      BuildTarget<?> target : toInclude) {
        if (processed.add(target)) {
          toProcess.add(target);
        }
      }
    }
 else {
      realDependencies.add(dep);
    }
  }
  realDependencies.trimToSize();
  return realDependencies;
}
