{
  if (myCertificate == null) {
    String stored=(String)manager.getRuntimeAuthStorage().getData("svn.ssl.server",myRealm);
    if (StringUtil.isEmptyOrSpaces(stored)) {
      throw new SVNException(SVNErrorMessage.create(SVNErrorCode.AUTHN_CREDS_UNAVAILABLE,"No stored server certificate was found in runtime"));
    }
    myCertificate=createCertificate(stored);
    myCertificateRealm=myRealm;
  }
  if (myAuthenticationService.getTempDirectory() != null && myCertificate != null) {
    storeServerCertificate();
    if (myAuthentication != null) {
      final String realm=myCredentialsRealm == null ? myCertificateRealm : myCredentialsRealm;
      return storeCredentials(manager,myAuthentication,realm);
    }
  }
  return true;
}
