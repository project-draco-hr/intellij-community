{
  loadProject(SAMPLE_PROJECT_PATH);
  String baseDirPath=getTestDataFileAbsolutePath(SAMPLE_PROJECT_PATH);
  assertTrue(FileUtil.filesEqual(new File(baseDirPath),JpsModelSerializationDataService.getBaseDirectory(myProject)));
  assertEquals("sampleProjectName",myProject.getName());
  List<JpsModule> modules=myProject.getModules();
  assertEquals(3,modules.size());
  JpsModule main=null;
  JpsModule xxx=null;
  JpsModule util=null;
  for (  JpsModule module : modules) {
    final String name=module.getName();
    if ("main".equals(name)) {
      main=module;
    }
 else     if ("util".equals(name)) {
      util=module;
    }
 else     if ("xxx".equals(name)) {
      xxx=module;
    }
 else {
      fail("Unexpected module name " + name);
    }
  }
  assertNotNull("module 'main' was not loaded",main);
  assertNotNull("module 'util' was not loaded",util);
  assertNotNull("module 'xxx' was not loaded",xxx);
  assertTrue(FileUtil.filesEqual(new File(baseDirPath,"util"),JpsModelSerializationDataService.getBaseDirectory(util)));
  List<JpsLibrary> libraries=myProject.getLibraryCollection().getLibraries();
  assertEquals(3,libraries.size());
  List<JpsDependencyElement> dependencies=util.getDependenciesList().getDependencies();
  assertEquals(4,dependencies.size());
  JpsSdkDependency sdkDependency=assertInstanceOf(dependencies.get(0),JpsSdkDependency.class);
  assertSame(JpsJavaSdkType.INSTANCE,sdkDependency.getSdkType());
  JpsSdkReference<?> reference=sdkDependency.getSdkReference();
  assertNotNull(reference);
  assertEquals("1.5",reference.getSdkName());
  assertInstanceOf(dependencies.get(1),JpsModuleSourceDependency.class);
  assertInstanceOf(dependencies.get(2),JpsLibraryDependency.class);
  assertInstanceOf(dependencies.get(3),JpsLibraryDependency.class);
  JpsSdkDependency inheritedSdkDependency=assertInstanceOf(main.getDependenciesList().getDependencies().get(0),JpsSdkDependency.class);
  JpsSdkReference<?> projectSdkReference=inheritedSdkDependency.getSdkReference();
  assertNotNull(projectSdkReference);
  assertEquals("1.6",projectSdkReference.getSdkName());
  assertEquals(getUrl("xxx/output"),JpsJavaExtensionService.getInstance().getOutputUrl(xxx,true));
  assertEquals(getUrl("xxx/output"),JpsJavaExtensionService.getInstance().getOutputUrl(xxx,false));
}
