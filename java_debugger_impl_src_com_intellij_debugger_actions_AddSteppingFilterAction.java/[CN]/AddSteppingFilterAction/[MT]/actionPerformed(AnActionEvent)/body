{
  final DebuggerContextImpl debuggerContext=DebuggerAction.getDebuggerContext(e.getDataContext());
  DebugProcessImpl process=debuggerContext.getDebugProcess();
  if (process == null) {
    return;
  }
  final StackFrameDescriptorImpl descriptor=PopFrameAction.getSelectedStackFrameDescriptor(e);
  process.getManagerThread().schedule(new DebuggerCommandImpl(){
    protected void action() throws Exception {
      final String name=getClassName(descriptor != null ? descriptor.getFrameProxy() : debuggerContext.getFrameProxy());
      if (name == null) {
        return;
      }
      final Project project=e.getData(CommonDataKeys.PROJECT);
      ApplicationManager.getApplication().invokeLater(new Runnable(){
        @Override public void run(){
          String filter=Messages.showInputDialog(project,"","Add Stepping Filter",null,name,null);
          if (filter != null) {
            ClassFilter[] newFilters=ArrayUtil.append(DebuggerSettings.getInstance().getSteppingFilters(),new ClassFilter(filter));
            DebuggerSettings.getInstance().setSteppingFilters(newFilters);
          }
        }
      }
);
    }
  }
);
}
