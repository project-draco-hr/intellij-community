{
  if (ApplicationManager.getApplication() != null) {
    WriteCommandAction.runWriteCommandAction(null,new Runnable(){
      @Override public void run(){
        myDocument.replaceString(textRange.getStartOffset(),textRange.getEndOffset(),whiteSpace);
      }
    }
);
  }
 else {
    myDocument.replaceString(textRange.getStartOffset(),textRange.getEndOffset(),whiteSpace);
  }
  return new TextRange(textRange.getStartOffset(),textRange.getStartOffset() + whiteSpace.length());
}
