{
  if (rootElement instanceof StubBasedPsiElement && ((StubBasedPsiElement)rootElement).getStub() != null) {
    return originalElements;
  }
  Collection<CustomRegionTreeElement> customRegions=collectCustomRegions(rootElement);
  if (customRegions.size() > 0) {
    List<StructureViewTreeElement> result=new ArrayList<>();
    result.addAll(customRegions);
    for (    StructureViewTreeElement element : originalElements) {
      boolean isInCustomRegion=false;
      for (      CustomRegionTreeElement customRegion : customRegions) {
        if (customRegion.containsElement(element)) {
          customRegion.addChild(element);
          isInCustomRegion=true;
          break;
        }
      }
      if (!isInCustomRegion)       result.add(element);
    }
    return result;
  }
  return originalElements;
}
