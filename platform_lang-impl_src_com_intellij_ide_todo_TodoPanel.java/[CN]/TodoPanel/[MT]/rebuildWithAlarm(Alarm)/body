{
  alarm.cancelAllRequests();
  alarm.addRequest(new Runnable(){
    @Override public void run(){
      final Set<VirtualFile> files=new HashSet<VirtualFile>();
      ApplicationManager.getApplication().runReadAction(new Runnable(){
        @Override public void run(){
          try {
            myTodoTreeBuilder.collectFiles(new Processor<VirtualFile>(){
              @Override public boolean process(              VirtualFile virtualFile){
                files.add(virtualFile);
                return true;
              }
            }
);
          }
 catch (          IndexNotReadyException ignore) {
          }
        }
      }
);
      final Runnable runnable=new Runnable(){
        @Override public void run(){
          myTodoTreeBuilder.rebuildCache(files);
          updateTree();
        }
      }
;
      ApplicationManager.getApplication().invokeLater(runnable);
    }
  }
,300);
}
