{
  myProject=project;
  ActionManagerEx.getInstanceEx().addAnActionListener(new MyAnActionListener(),myProject);
  DocumentListener documentListener=new DocumentAdapter(){
    @Override public void documentChanged(    DocumentEvent event){
      Document document=event.getDocument();
      Editor[] editors=EditorFactory.getInstance().getEditors(document);
      for (      Editor editor : editors) {
        Map<RangeHighlighter,HighlightInfo> map=getHighlightInfoMap(editor,false);
        if (map == null)         return;
        ArrayList<RangeHighlighter> highlightersToRemove=new ArrayList<>();
        for (        RangeHighlighter highlighter : map.keySet()) {
          HighlightInfo info=map.get(highlighter);
          if (!info.editor.getDocument().equals(document))           continue;
          if (BitUtil.isSet(info.flags,HIDE_BY_TEXT_CHANGE)) {
            highlightersToRemove.add(highlighter);
          }
        }
        for (        RangeHighlighter highlighter : highlightersToRemove) {
          removeSegmentHighlighter(editor,highlighter);
        }
      }
    }
  }
;
  EditorFactory.getInstance().getEventMulticaster().addDocumentListener(documentListener,myProject);
}
