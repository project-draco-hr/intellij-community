{
  super.setUp();
  try {
    myProjectFixture=IdeaTestFixtureFactory.getFixtureFactory().createFixtureBuilder(getTestName(true)).getFixture();
    myProjectFixture.setUp();
  }
 catch (  Exception e) {
    super.tearDown();
    throw e;
  }
  try {
    myProject=myProjectFixture.getProject();
    myProjectRoot=myProject.getBaseDir();
    cd(myProjectRoot);
    myVcs=new MockAbstractVcs(myProject);
    myProjectLevelVcsManager=(ProjectLevelVcsManagerImpl)ProjectLevelVcsManager.getInstance(myProject);
    myProjectLevelVcsManager.registerVcs(myVcs);
    READY_TO_READ=new CountDownLatch(1);
    CONTINUE_MODIFY=new CountDownLatch(1);
    myMockCreator=createMockRepositoryCreator();
    ExtensionPoint<VcsRepositoryCreator> point=getExtensionPoint();
    point.registerExtension(myMockCreator);
    myGlobalRepositoryManager=new VcsRepositoryManager(myProject,myProjectLevelVcsManager);
    myGlobalRepositoryManager.addListener(myProject);
  }
 catch (  Exception e) {
    tearDown();
    throw e;
  }
}
