{
  final BracePair pair=findPair(left,iterator,fileText,fileType);
  if (pair == null)   return false;
  final IElementType opposite=left ? JavaTokenType.GT : JavaTokenType.LT;
  if ((left ? pair.getRightBraceType() : pair.getLeftBraceType()) != opposite)   return true;
  if (fileType != JavaFileType.INSTANCE)   return false;
  final IElementType braceElementType=left ? JavaTokenType.LT : JavaTokenType.GT;
  int paired=1;
  int count=0;
  try {
    while (true) {
      count++;
      if (left) {
        iterator.advance();
      }
 else {
        iterator.retreat();
      }
      if (iterator.atEnd())       break;
      final IElementType tokenType=iterator.getTokenType();
      if (tokenType == opposite) {
        paired--;
        if (paired == 0)         return true;
        continue;
      }
      if (tokenType == braceElementType) {
        paired++;
        continue;
      }
      if (!TYPE_TOKENS.contains(tokenType)) {
        return false;
      }
    }
    return false;
  }
  finally {
    while (count-- > 0) {
      if (left) {
        iterator.retreat();
      }
 else {
        iterator.advance();
      }
    }
  }
}
