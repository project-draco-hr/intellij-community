{
  if (repositories.isEmpty()) {
    VcsBalloonProblemNotifier.showOverChangesView(myProject,"No Mercurial repositories in the project",MessageType.ERROR);
    return;
  }
  final AtomicReference<HgPushCommand> pushCommand=new AtomicReference<HgPushCommand>();
  final HgPushDialog dialog=new HgPushDialog(myProject,repositories,selectedRepo);
  dialog.show();
  if (dialog.isOK()) {
    dialog.rememberSettings();
    pushCommand.set(preparePushCommand(myProject,dialog));
    new Task.Backgroundable(myProject,"Pushing...",false){
      @Override public void run(      @NotNull ProgressIndicator indicator){
        if (pushCommand.get() != null) {
          push(myProject,pushCommand.get());
        }
      }
    }
.queue();
  }
}
