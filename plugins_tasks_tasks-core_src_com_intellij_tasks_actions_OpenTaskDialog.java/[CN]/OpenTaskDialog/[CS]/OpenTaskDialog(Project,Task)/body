{
  super(project,false);
  myProject=project;
  myTask=task;
  TaskManagerImpl taskManager=(TaskManagerImpl)TaskManager.getManager(myProject);
  setTitle("Open Task");
  myTaskNameLabel.setText(TaskUtil.getTrimmedSummary(task));
  TaskManagerImpl manager=(TaskManagerImpl)TaskManager.getManager(project);
  ControlBinder binder=new ControlBinder(manager.getState());
  binder.bindAnnotations(this);
  binder.reset();
  TaskRepository repository=task.getRepository();
  myMarkAsInProgressBox.setSelected(manager.getState().markAsInProgress);
  if (repository == null || !repository.getRepositoryType().getPossibleTaskStates().contains(TaskState.IN_PROGRESS)) {
    myMarkAsInProgressBox.setVisible(false);
  }
  TaskManagerImpl.Config state=taskManager.getState();
  myClearContext.setSelected(state.clearContext);
  myButtonEnumModel=RadioButtonEnumModel.bindEnum(TaskManager.VcsOperation.class,myVcsGroup);
  AbstractVcs vcs=manager.getActiveVcs();
  if (vcs == null) {
    myVcsPanel.setVisible(false);
  }
 else {
    if (vcs.getType() != VcsType.distributed) {
      myButtonEnumModel.getButton(TaskManager.VcsOperation.CREATE_BRANCH).setVisible(false);
      myBranchName.setVisible(false);
    }
    if (state.vcsOperation == -1) {
      state.vcsOperation=vcs.getType() == VcsType.distributed ? TaskManager.VcsOperation.CREATE_BRANCH.ordinal() : TaskManager.VcsOperation.CREATE_CHANGELIST.ordinal();
    }
    myVcsPanel.setBorder(IdeBorderFactory.createTitledBorder(vcs.getDisplayName() + " operations",false));
    myBranchName.setText(taskManager.suggestBranchName(task));
    myChangelistName.setText(taskManager.getChangelistName(task));
    myButtonEnumModel.addActionListener(new ActionListener(){
      @Override public void actionPerformed(      ActionEvent e){
        TaskManager.VcsOperation selected=myButtonEnumModel.getSelected();
        myChangelistName.setEnabled(false);
        myBranchName.setEnabled(false);
        if (selected == TaskManager.VcsOperation.CREATE_BRANCH) {
          myBranchName.setEnabled(true);
          myBranchName.requestFocus();
        }
 else         if (selected == TaskManager.VcsOperation.CREATE_CHANGELIST) {
          myChangelistName.setEnabled(true);
          IdeFocusManager.getInstance(myProject).requestFocus(myChangelistName,true);
          myChangelistName.requestFocus();
        }
      }
    }
);
    myButtonEnumModel.setSelected(state.vcsOperation);
  }
  init();
}
