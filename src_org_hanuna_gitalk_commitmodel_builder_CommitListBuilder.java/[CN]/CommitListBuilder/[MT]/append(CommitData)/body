{
  boolean hasChildren=true;
  int startCountCommits=this.countUniqueCommits;
  MutableCommit commit=getCommit(data.getHash());
  if (startCountCommits < this.countUniqueCommits) {
    hasChildren=false;
    startCountCommits=this.countUniqueCommits;
  }
  List<Commit> parents=new ArrayList<Commit>(data.getParentsHash().size());
  for (  Hash hash : data.getParentsHash()) {
    MutableCommit parent=getCommit(hash);
    parents.add(parent);
  }
  removeCommit(data.getHash());
  commit.set(data,new SimpleReadOnlyList<Commit>(parents),hasChildren,this.countUniqueCommits - startCountCommits,commits.size());
  commits.add(commit);
}
