{
  MutableCommit commit=cache.pop(data.getHash());
  List<Commit> parents=new ArrayList<Commit>(data.getParentsHash().size());
  for (  Hash hash : data.getParentsHash()) {
    parents.add(cache.get(hash));
  }
  commit.set(data,new SimpleReadOnlyList<Commit>(parents),commits.size());
  commits.add(commit);
}
