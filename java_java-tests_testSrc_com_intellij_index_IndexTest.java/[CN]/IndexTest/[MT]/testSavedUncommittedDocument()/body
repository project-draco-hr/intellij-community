{
  final VirtualFile vFile=myFixture.addFileToProject("Foo.java","").getVirtualFile();
  assertNull(findClass("Foo"));
  PsiFile psiFile=getPsiManager().findFile(vFile);
  assertNotNull(psiFile);
  long count=getPsiManager().getModificationTracker().getModificationCount();
  Document document=FileDocumentManager.getInstance().getDocument(vFile);
  document.insertString(0,"class Foo {}");
  FileDocumentManager.getInstance().saveDocument(document);
  assertTrue(count == getPsiManager().getModificationTracker().getModificationCount());
  assertNull(findClass("Foo"));
  PsiDocumentManager.getInstance(getProject()).commitAllDocuments();
  assertNotNull(findClass("Foo"));
  assertNotNull(findClass("Foo").getText());
  assertTrue(count != getPsiManager().getModificationTracker().getModificationCount());
}
