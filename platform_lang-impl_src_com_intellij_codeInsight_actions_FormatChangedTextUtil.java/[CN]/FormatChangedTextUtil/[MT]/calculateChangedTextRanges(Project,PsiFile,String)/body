{
  Document documentFromVcs=((EditorFactoryImpl)EditorFactory.getInstance()).createDocument(contentFromVcs,true,false);
  Document document=PsiDocumentManager.getInstance(project).getDocument(file);
  if (document == null) {
    return ContainerUtil.emptyList();
  }
  try {
    List<Range> changedRanges;
    LineStatusTracker tracker=LineStatusTrackerManager.getInstance(project).getLineStatusTracker(document);
    if (tracker != null) {
      changedRanges=tracker.getRanges();
    }
 else {
      changedRanges=new RangesBuilder(document,documentFromVcs).getRanges();
    }
    return getChangedTextRanges(document,changedRanges);
  }
 catch (  FilesTooBigForDiffException e) {
    LOG.error("Error while calculating changed ranges for: " + file.getVirtualFile(),e);
    return ContainerUtil.emptyList();
  }
}
