{
  String s;
  try {
    s=url.toURI().getSchemeSpecificPart();
  }
 catch (  URISyntaxException thisShouldNotHappen) {
    thisShouldNotHappen.printStackTrace();
    s=url.getFile();
  }
  if (s != null && s.length() > 0) {
    final String protocol=url.getProtocol();
    if (Loader.JRT_PROTOCOL.equals(protocol)) {
      final Loader jrtLoader=JrtClassHolder.create(url,index);
      if (jrtLoader != null) {
        return jrtLoader;
      }
    }
    if (new File(s).isDirectory()) {
      return Loader.FILE_PROTOCOL.equals(protocol) ? new FileLoader(url,index) : null;
    }
  }
  return new JarLoader(url,index);
}
