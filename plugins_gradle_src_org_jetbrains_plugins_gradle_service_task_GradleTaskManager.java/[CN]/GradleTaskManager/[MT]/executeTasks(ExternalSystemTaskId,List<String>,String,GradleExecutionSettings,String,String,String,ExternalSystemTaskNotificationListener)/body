{
  if (settings != null) {
    myHelper.ensureInstalledWrapper(id,projectPath,settings,listener);
  }
  final List<String> scriptParametersList;
  if (scriptParameters == null) {
    scriptParametersList=ContainerUtil.newArrayList();
  }
 else {
    scriptParametersList=ContainerUtil.mapNotNull(StringUtil.split(scriptParameters.trim()," "),new Function<String,String>(){
      @Override public String fun(      String s){
        return StringUtil.isEmpty(s) ? null : s.trim();
      }
    }
);
  }
  if (ExternalSystemApiUtil.isInProcessMode(GradleConstants.SYSTEM_ID)) {
    for (    GradleTaskManagerExtension gradleTaskManagerExtension : GradleTaskManagerExtension.EP_NAME.getExtensions()) {
      if (gradleTaskManagerExtension.executeTasks(id,taskNames,projectPath,settings,vmOptions,debuggerSetup,listener))       return;
    }
  }
  Function<ProjectConnection,Void> f=new Function<ProjectConnection,Void>(){
    @Override public Void fun(    ProjectConnection connection){
      BuildLauncher launcher=myHelper.getBuildLauncher(id,connection,settings,listener,vmOptions);
      if (!StringUtil.isEmpty(debuggerSetup)) {
        try {
          final File tempFile=FileUtil.createTempFile("init",".gradle");
          tempFile.deleteOnExit();
          final String[] lines={"gradle.taskGraph.beforeTask { Task task ->","    if (task instanceof JavaForkOptions) {","        task.jvmArgs '" + debuggerSetup.trim() + '\'',"}}"};
          FileUtil.writeToFile(tempFile,StringUtil.join(lines,SystemProperties.getLineSeparator()));
          scriptParametersList.add("--init-script");
          scriptParametersList.add(tempFile.getAbsolutePath());
        }
 catch (        IOException e) {
          throw new ExternalSystemException(e);
        }
      }
      if (!scriptParametersList.isEmpty()) {
        launcher.withArguments(ArrayUtil.toStringArray(scriptParametersList));
      }
      launcher.forTasks(ArrayUtil.toStringArray(taskNames));
      launcher.run();
      return null;
    }
  }
;
  myHelper.execute(projectPath,settings,f);
}
