{
  if (vcsLine1 == -1)   return;
  int forward=TrimUtil.expandForward(myVcs,myCurrent,vcsLine1,currentLine1,vcsLine2,currentLine2);
  vcsLine1+=forward;
  currentLine1+=forward;
  int backward=TrimUtil.expandBackward(myVcs,myCurrent,vcsLine1,currentLine1,vcsLine2,currentLine2);
  vcsLine2-=backward;
  currentLine2-=backward;
  List<String> vcs=myVcs.subList(vcsLine1,vcsLine2);
  List<String> current=myCurrent.subList(currentLine1,currentLine2);
  List<InnerRange> inner=calcInnerRanges(vcs,current,myCurrentShift + currentLine1);
  myResult.add(new Range(myCurrentShift + currentLine1,myCurrentShift + currentLine2,myVcsShift + vcsLine1,myVcsShift + vcsLine2,inner));
  currentLine1=-1;
  currentLine2=-1;
  vcsLine1=-1;
  vcsLine2=-1;
}
