{
  FairDiffIterable iwIterable=ByLine.compare(vcs,current,ComparisonPolicy.IGNORE_WHITESPACES,DumbProgressIndicator.INSTANCE);
  RangeBuilder rangeBuilder=new RangeBuilder(current,vcs,currentShift,vcsShift);
  for (  com.intellij.diff.util.Range range : iwIterable.iterateUnchanged()) {
    int count=range.end1 - range.start1;
    for (int i=0; i < count; i++) {
      int vcsIndex=range.start1 + i;
      int currentIndex=range.start2 + i;
      if (vcs.get(vcsIndex).equals(current.get(currentIndex))) {
        rangeBuilder.markEqual(vcsIndex,currentIndex);
      }
    }
  }
  return rangeBuilder.finish();
}
