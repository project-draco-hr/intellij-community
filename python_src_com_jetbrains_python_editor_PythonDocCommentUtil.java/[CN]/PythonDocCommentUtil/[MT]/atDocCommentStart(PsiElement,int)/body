{
  PyStringLiteralExpression string=PsiTreeUtil.getParentOfType(element,PyStringLiteralExpression.class);
  if (string != null) {
    PyElement func=PsiTreeUtil.getParentOfType(element,PyFunction.class,PyClass.class,PyFile.class);
    if (func != null) {
      final PyDocStringOwner docStringOwner=PsiTreeUtil.getParentOfType(element,PyDocStringOwner.class);
      if (docStringOwner == func) {
        PyStringLiteralExpression str=docStringOwner.getDocStringExpression();
        String text=element.getText();
        final int prefix=PyStringLiteralExpressionImpl.getPrefixLength(text);
        text=text.substring(prefix);
        if (str != null && text.equals(str.getText()) && (text.startsWith("\"\"\"") || text.startsWith("'''"))) {
          if (offset == str.getTextRange().getStartOffset()) {
            PsiErrorElement error=PsiTreeUtil.getNextSiblingOfType(string,PsiErrorElement.class);
            if (error != null)             return true;
            error=PsiTreeUtil.getNextSiblingOfType(string.getParent(),PsiErrorElement.class);
            if (error != null)             return true;
            if (text.length() < 6 || (!text.endsWith("\"\"\"") && !text.endsWith("'''")))             return true;
          }
        }
      }
    }
  }
  return false;
}
