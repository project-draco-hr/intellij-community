{
  Collection<Change> changes=commit.getChanges();
  String changeListName=createNameForChangeList(commitMessage,0).replace('\n',' ');
  final LocalChangeList changeList=((ChangeListManagerEx)myChangeListManager).addChangeList(changeListName,commitMessage,commit);
  if (!changes.isEmpty()) {
    myChangeListManager.moveChangesTo(changeList,changes.toArray(new Change[changes.size()]));
  }
  if (!changeList.getChanges().isEmpty()) {
    return changeList;
  }
  myChangeListManager.removeChangeList(changeList);
  return null;
}
