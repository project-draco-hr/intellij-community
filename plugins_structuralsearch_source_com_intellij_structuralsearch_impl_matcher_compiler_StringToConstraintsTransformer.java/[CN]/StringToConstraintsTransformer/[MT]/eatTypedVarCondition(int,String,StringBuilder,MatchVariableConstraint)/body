{
  final int length=pattern.length();
  if (index < length && pattern.charAt(index) == ':') {
    ++index;
    if (index >= length)     throw new MalformedPatternException(SSRBundle.message("error.expected.condition"));
    char ch=pattern.charAt(index);
    if (ch == '+' || ch == '*') {
switch (ch) {
case '+':
        constraint.setStrictlyWithinHierarchy(true);
      break;
case '*':
    constraint.setWithinHierarchy(true);
  break;
}
++index;
if (index >= length) throw new MalformedPatternException(SSRBundle.message("error.expected.condition"));
ch=pattern.charAt(index);
}
if (ch == '[') {
miscBuffer.setLength(0);
for (++index; index < length && ((ch=pattern.charAt(index)) != ']' || pattern.charAt(index - 1) == '\\'); ++index) {
miscBuffer.append(ch);
}
if (ch != ']') throw new MalformedPatternException(SSRBundle.message("error.expected.condition.or.bracket"));
++index;
parseCondition(constraint,miscBuffer.toString());
}
 else {
miscBuffer.setLength(0);
index=handleRegExp(index,pattern,miscBuffer,constraint);
}
}
return index;
}
