{
  EdtTestUtil.runInEdtAndWait(new ThrowableRunnable<Throwable>(){
    @Override public void run() throws Throwable {
      File tempDirectory=FileUtil.createTempDirectory(myName,"");
      PlatformTestCase.synchronizeTempDirVfs(LocalFileSystem.getInstance().refreshAndFindFileByIoFile(tempDirectory));
      myFilesToDelete.add(tempDirectory);
      String projectPath=FileUtil.toSystemIndependentName(tempDirectory.getPath()) + "/" + myName+ ProjectFileType.DOT_DEFAULT_EXTENSION;
      ByteArrayOutputStream buffer=new ByteArrayOutputStream();
      new Throwable(projectPath).printStackTrace(new PrintStream(buffer));
      myProject=PlatformTestCase.createProject(projectPath,buffer.toString());
      ProjectManagerEx.getInstanceEx().openTestProject(myProject);
      for (      ModuleFixtureBuilder moduleFixtureBuilder : myModuleFixtureBuilders) {
        moduleFixtureBuilder.getFixture().setUp();
      }
      LightPlatformTestCase.clearUncommittedDocuments(myProject);
      ((FileTypeManagerImpl)FileTypeManager.getInstance()).drainReDetectQueue();
    }
  }
);
}
