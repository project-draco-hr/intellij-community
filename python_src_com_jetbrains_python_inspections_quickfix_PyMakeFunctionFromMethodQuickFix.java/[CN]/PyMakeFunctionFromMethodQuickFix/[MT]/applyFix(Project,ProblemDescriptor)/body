{
  final PsiElement element=descriptor.getPsiElement();
  final PyFunction problemFunction=PsiTreeUtil.getParentOfType(element,PyFunction.class);
  if (problemFunction == null)   return;
  final PyClass containingClass=problemFunction.getContainingClass();
  if (containingClass == null)   return;
  final List<UsageInfo> usages=PyRefactoringUtil.findUsages(problemFunction,false);
  final PyParameter[] parameters=problemFunction.getParameterList().getParameters();
  if (parameters.length > 0) {
    parameters[0].delete();
  }
  PsiElement copy=problemFunction.copy();
  problemFunction.delete();
  final PsiElement parent=containingClass.getParent();
  PyClass aClass=PsiTreeUtil.getTopmostParentOfType(containingClass,PyClass.class);
  if (aClass == null)   aClass=containingClass;
  copy=parent.addBefore(copy,aClass);
  for (  UsageInfo usage : usages) {
    final PsiElement usageElement=usage.getElement();
    if (usageElement instanceof PyReferenceExpression) {
      final PsiFile usageFile=usageElement.getContainingFile();
      updateUsage(copy,(PyReferenceExpression)usageElement,usageFile,!usageFile.equals(parent));
    }
  }
}
