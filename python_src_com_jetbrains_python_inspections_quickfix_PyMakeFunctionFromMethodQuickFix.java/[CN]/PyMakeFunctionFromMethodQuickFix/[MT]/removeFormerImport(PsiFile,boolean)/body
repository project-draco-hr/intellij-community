{
  if (usageFile instanceof PyFile && addImport) {
    final LocalInspectionToolSession session=new LocalInspectionToolSession(usageFile,0,usageFile.getTextLength());
    final PyUnresolvedReferencesInspection.Visitor visitor=new PyUnresolvedReferencesInspection.Visitor(null,session,Collections.<String>emptyList());
    usageFile.accept(new PyRecursiveElementVisitor(){
      @Override public void visitPyElement(      PyElement node){
        super.visitPyElement(node);
        node.accept(visitor);
      }
    }
);
    visitor.optimizeImports();
  }
}
