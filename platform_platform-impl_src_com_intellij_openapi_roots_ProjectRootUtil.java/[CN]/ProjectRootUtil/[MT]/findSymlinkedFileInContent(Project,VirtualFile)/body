{
  GlobalSearchScope scope=GlobalSearchScope.allScope(project);
  if (scope.contains(forFile))   return forFile;
  VirtualFile canonicalForFile=forFile.getCanonicalFile();
  if (canonicalForFile == null)   canonicalForFile=forFile;
  Collection<VirtualFile> projectFiles=FilenameIndex.getVirtualFilesByName(project,canonicalForFile.getName(),true,scope);
  for (  VirtualFile eachContentFile : projectFiles) {
    if (canonicalForFile.equals(eachContentFile.getCanonicalFile()))     return eachContentFile;
  }
  return forFile;
}
