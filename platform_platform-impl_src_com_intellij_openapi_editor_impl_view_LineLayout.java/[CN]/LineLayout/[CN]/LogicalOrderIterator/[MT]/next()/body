{
  if (!hasNext()) {
    throw new NoSuchElementException();
  }
  BidiRun run=myBidiRunsInLogicalOrder[myRunIndex];
  myFragment.isRtl=run.isRtl();
  myFragment.delegate=run.fragments.get(myFragmentIndex);
  myFragment.startOffset=myOffset;
  myOffset+=myFragment.delegate.getLength();
  myFragmentIndex++;
  if (myFragmentIndex >= run.fragments.size()) {
    myFragmentIndex=0;
    myRunIndex++;
  }
  return myFragment;
}
