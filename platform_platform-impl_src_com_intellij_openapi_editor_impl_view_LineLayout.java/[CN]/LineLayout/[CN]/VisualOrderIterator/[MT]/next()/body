{
  if (!hasNext()) {
    throw new NoSuchElementException();
  }
  BidiRun run=myBidiRunsInLogicalOrder[myRunIndex];
  myFragment.isRtl=run.isRtl();
  myFragment.delegate=run.fragments.get(run.isRtl() ? run.fragments.size() - 1 - myFragmentIndex : myFragmentIndex);
  myFragment.startOffset=run.isRtl() ? run.endOffset - myOffsetInsideRun - myFragment.delegate.getLength() : run.startOffset + myOffsetInsideRun;
  myOffsetInsideRun+=myFragment.getLength();
  myFragmentIndex++;
  if (myFragmentIndex >= run.fragments.size()) {
    myFragmentIndex=0;
    myOffsetInsideRun=0;
    myRunIndex++;
  }
  return myFragment;
}
