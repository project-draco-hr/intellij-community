{
  if (lookForward) {
    boolean foundOrigin=false;
    boolean originIsRtl=false;
    for (    BidiRun run : myBidiRunsInLogicalOrder) {
      if (foundOrigin) {
        if (run.isRtl() != originIsRtl)         return run.startOffset;
      }
 else       if (run.endOffset > offset) {
        foundOrigin=true;
        originIsRtl=run.isRtl();
      }
    }
    return originIsRtl ? myBidiRunsInLogicalOrder[myBidiRunsInLogicalOrder.length - 1].endOffset : -1;
  }
 else {
    boolean foundOrigin=false;
    boolean originIsRtl=false;
    for (int i=myBidiRunsInLogicalOrder.length - 1; i >= 0; i--) {
      BidiRun run=myBidiRunsInLogicalOrder[i];
      if (foundOrigin) {
        if (run.isRtl() != originIsRtl)         return run.endOffset;
      }
 else       if (run.startOffset < offset) {
        foundOrigin=true;
        originIsRtl=run.isRtl();
      }
    }
    return originIsRtl ? 0 : -1;
  }
}
