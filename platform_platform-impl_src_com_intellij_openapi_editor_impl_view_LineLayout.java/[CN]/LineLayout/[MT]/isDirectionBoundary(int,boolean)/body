{
  boolean prevIsRtl=false;
  boolean found=offset == 0 && !leanForward;
  for (  BidiRun run : myBidiRunsInVisualOrder) {
    boolean curIsRtl=run.isRtl();
    if (found || offset == (curIsRtl ? run.endOffset : run.startOffset))     return curIsRtl != prevIsRtl;
    if (offset > run.startOffset && offset < run.endOffset)     return false;
    found=(offset == (curIsRtl ? run.startOffset : run.endOffset));
    prevIsRtl=curIsRtl;
  }
  return prevIsRtl;
}
