{
  if (runs.isEmpty())   return new Simple(null);
  if (runs.size() == 1) {
    BidiRun run=runs.get(0);
    if (run.level == 0 && run.getChunkCount() == 1) {
      Chunk chunk=run.chunks == null ? new Chunk(0,run.endOffset) : run.chunks[0];
      return new Simple(chunk);
    }
  }
  return new Complex(runs.toArray(new BidiRun[runs.size()]));
}
