{
  final VirtualFile file=fileSystemTree.getNewFileParent();
  if (file == null || !file.isDirectory())   return;
  final InputValidatorEx validator=new NewFolderValidator(file);
  final String newFolderName=Messages.showInputDialog(UIBundle.message("create.new.folder.enter.new.folder.name.prompt.text"),UIBundle.message("new.folder.dialog.title"),Messages.getQuestionIcon(),"",validator);
  if (newFolderName == null) {
    return;
  }
  Exception failReason=((FileSystemTreeImpl)fileSystemTree).createNewFolder(file,newFolderName);
  if (failReason != null) {
    Messages.showMessageDialog(UIBundle.message("create.new.folder.could.not.create.folder.error.message",newFolderName),UIBundle.message("error.dialog.title"),Messages.getErrorIcon());
  }
}
