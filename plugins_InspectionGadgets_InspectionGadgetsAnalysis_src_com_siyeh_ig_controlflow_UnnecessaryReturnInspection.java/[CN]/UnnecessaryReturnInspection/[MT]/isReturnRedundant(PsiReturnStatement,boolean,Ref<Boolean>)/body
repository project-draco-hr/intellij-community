{
  if (statement.getReturnValue() != null) {
    return false;
  }
  final PsiElement methodParent=PsiTreeUtil.getParentOfType(statement,PsiMethod.class,PsiLambdaExpression.class);
  PsiCodeBlock codeBlock=null;
  if (methodParent instanceof PsiMethod) {
    final PsiMethod method=(PsiMethod)methodParent;
    codeBlock=method.getBody();
    if (isInConstructorRef != null) {
      isInConstructorRef.set(method.isConstructor());
    }
  }
 else   if (methodParent instanceof PsiLambdaExpression) {
    isInConstructorRef.set(false);
    final PsiLambdaExpression lambdaExpression=(PsiLambdaExpression)methodParent;
    final PsiElement lambdaBody=lambdaExpression.getBody();
    if (lambdaBody instanceof PsiCodeBlock) {
      codeBlock=(PsiCodeBlock)lambdaBody;
    }
  }
 else {
    return false;
  }
  if (codeBlock == null) {
    return false;
  }
  if (!ControlFlowUtils.blockCompletesWithStatement(codeBlock,statement)) {
    return false;
  }
  if (ignoreInThenBranch && isInThenBranch(statement)) {
    return false;
  }
  return true;
}
