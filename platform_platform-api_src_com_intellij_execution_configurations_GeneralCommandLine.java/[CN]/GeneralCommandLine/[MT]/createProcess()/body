{
  if (LOG.isDebugEnabled()) {
    LOG.debug("Executing [" + getCommandLineString() + "]");
  }
  List<String> commands;
  try {
    checkWorkingDirectory();
    if (StringUtil.isEmptyOrSpaces(myExePath)) {
      throw new ExecutionException(IdeBundle.message("run.configuration.error.executable.not.specified"));
    }
    commands=CommandLineUtil.toCommandLine(myExePath,myProgramParams.getList());
  }
 catch (  ExecutionException e) {
    LOG.warn(e);
    throw e;
  }
  try {
    if (myStartProcessWithPty && SystemInfo.isUnix) {
      try {
        Map<String,String> env=Maps.newHashMap();
        setupEnvironment(env);
        if (myRedirectErrorStream) {
          LOG.error("Launching process with PTY and redirected error stream is unsupported yet");
        }
        return PtyProcessHolder.doExec(myWorkDirectory,commands,env);
      }
 catch (      Throwable e) {
        LOG.error("Couldn't run process with PTY",e);
      }
    }
    return startProcess(commands);
  }
 catch (  IOException e) {
    LOG.warn(e);
    throw new ProcessNotCreatedException(e.getMessage(),e,this);
  }
}
