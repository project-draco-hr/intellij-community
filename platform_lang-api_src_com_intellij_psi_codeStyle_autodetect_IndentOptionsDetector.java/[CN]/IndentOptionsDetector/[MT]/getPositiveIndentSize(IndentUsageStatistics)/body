{
  IndentUsageInfo maxUsedIndentInfo=stats.getMaxUsedIndentInfo(0);
  int maxIndentSize=maxUsedIndentInfo.getIndentSize();
  if (maxIndentSize == 0) {
    maxUsedIndentInfo=stats.getMaxUsedIndentInfo(1);
    maxIndentSize=maxUsedIndentInfo.getIndentSize();
  }
  if (maxIndentSize <= MAX_INDENT_TO_DETECT) {
    int totalUsagesWithoutZeroIndent=stats.getTotalLinesWithLeadingSpaces() - stats.getTimesUsedIndent(0);
    double usageRate=(double)maxUsedIndentInfo.getTimesUsed() / totalUsagesWithoutZeroIndent;
    if (usageRate > RATE_THRESHOLD) {
      return maxIndentSize;
    }
  }
  return -1;
}
