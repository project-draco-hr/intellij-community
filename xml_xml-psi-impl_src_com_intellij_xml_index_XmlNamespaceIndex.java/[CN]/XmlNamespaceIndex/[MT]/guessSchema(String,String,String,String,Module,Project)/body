{
  final List<IndexedRelevantResource<String,XsdNamespaceBuilder>> resources=getResourcesByNamespace(namespace,project,module);
  if (resources.isEmpty())   return null;
  if (resources.size() == 1)   return resources.get(0);
  final String fileName=schemaLocation == null ? null : new File(schemaLocation).getName();
  return Collections.max(resources,new Comparator<IndexedRelevantResource<String,XsdNamespaceBuilder>>(){
    @Override public int compare(    IndexedRelevantResource<String,XsdNamespaceBuilder> o1,    IndexedRelevantResource<String,XsdNamespaceBuilder> o2){
      int i=o1.compareTo(o2);
      if (i != 0)       return i;
      if (fileName != null) {
        i=Comparing.compare(fileName.equals(o1.getFile().getName()),fileName.equals(o2.getFile().getName()));
        if (i != 0)         return i;
      }
      return o1.getValue().getRating(tagName,version) - o2.getValue().getRating(tagName,version);
    }
  }
);
}
