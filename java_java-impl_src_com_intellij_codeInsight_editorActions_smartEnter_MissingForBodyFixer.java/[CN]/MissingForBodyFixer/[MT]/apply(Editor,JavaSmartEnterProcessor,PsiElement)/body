{
  PsiForStatement forStatement=getForStatementParent(psiElement);
  if (forStatement == null)   return;
  final Document doc=editor.getDocument();
  PsiElement body=forStatement.getBody();
  if (body instanceof PsiBlockStatement)   return;
  if (body != null && startLine(doc,body) == startLine(doc,forStatement))   return;
  PsiElement eltToInsertAfter=forStatement.getRParenth();
  String braces="{\n}";
  String text=braces;
  if (eltToInsertAfter == null) {
    eltToInsertAfter=forStatement;
    text=")" + text;
  }
  int offset=eltToInsertAfter.getTextRange().getEndOffset();
  doc.insertString(offset,text);
  editor.getCaretModel().moveToOffset(offset + text.length() - braces.length());
}
