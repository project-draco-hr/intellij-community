{
  ProjectManager.getInstance().addProjectManagerListener(new ProjectManagerAdapter(){
    @Override public boolean canCloseProject(    Project project){
      if (StudyTaskManager.getInstance(project).getCourse() != null) {
        FileEditorManagerImpl.getInstanceEx(project).closeAllFiles();
      }
      return super.canCloseProject(project);
    }
  }
);
}
