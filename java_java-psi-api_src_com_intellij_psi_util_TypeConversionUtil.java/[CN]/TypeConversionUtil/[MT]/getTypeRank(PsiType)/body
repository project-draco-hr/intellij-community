{
  if (type instanceof PsiCapturedWildcardType) {
    type=((PsiCapturedWildcardType)type).getUpperBound();
  }
  PsiPrimitiveType unboxedType=PsiPrimitiveType.getUnboxedType(type);
  if (unboxedType != null) {
    type=unboxedType;
  }
  int rank=TYPE_TO_RANK_MAP.get(type);
  if (rank != 0)   return rank;
  if (type.equalsToText(JAVA_LANG_STRING))   return STRING_RANK;
  return Integer.MAX_VALUE;
}
