{
  Presentation presentation=e.getPresentation();
  Pair<OpenInBrowserRequest,WebBrowserUrlProvider> result=BaseOpenInBrowserAction.doUpdate(e);
  if (result == null) {
    return;
  }
  WebBrowserUrlProvider browserUrlProvider=result.second;
  String text=getTemplatePresentation().getText();
  String description=getTemplatePresentation().getDescription();
  if (browserUrlProvider != null) {
    final String customText=browserUrlProvider.getOpenInBrowserActionText(result.first.getFile());
    if (customText != null) {
      text=customText;
    }
    final String customDescription=browserUrlProvider.getOpenInBrowserActionDescription(result.first.getFile());
    if (customDescription != null) {
      description=customDescription;
    }
    if (HtmlUtil.isHtmlFile(result.first.getFile())) {
      description+=" (hold Shift to open URL of local file)";
    }
  }
  presentation.setText(text);
  presentation.setDescription(description);
  GeneralSettings settings=GeneralSettings.getInstance();
  if (!settings.isUseDefaultBrowser()) {
    WebBrowser browser=WebBrowserManager.getInstance().findBrowserById(settings.getBrowserPath());
    if (browser != null) {
      presentation.setIcon(browser.getIcon());
    }
  }
  if (ActionPlaces.isPopupPlace(e.getPlace())) {
    presentation.setVisible(presentation.isEnabled());
  }
}
