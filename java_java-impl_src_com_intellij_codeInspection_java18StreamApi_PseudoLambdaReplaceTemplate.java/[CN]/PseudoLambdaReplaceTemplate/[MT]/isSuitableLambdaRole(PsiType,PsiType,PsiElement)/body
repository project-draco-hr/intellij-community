{
  if (lambdaReturnType == null) {
    return false;
  }
  if (myLambdaRole == LambdaRole.PREDICATE) {
    final PsiClassType boxedBoolean=PsiType.BOOLEAN.getBoxedType(context);
    if (!(PsiType.BOOLEAN.equals(lambdaReturnType) || (boxedBoolean != null && boxedBoolean.equals(lambdaReturnType)))) {
      return false;
    }
  }
 else {
    LOG.assertTrue(myLambdaRole == LambdaRole.FUNCTION);
    if (baseMethodReturnType instanceof PsiClassType) {
      final PsiClassType.ClassResolveResult resolveResult=((PsiClassType)baseMethodReturnType).resolveGenerics();
      final Map<PsiTypeParameter,PsiType> substitutionMap=resolveResult.getSubstitutor().getSubstitutionMap();
      if (substitutionMap.size() != 1) {
        return false;
      }
      final PsiType iterableParametrizedType=ContainerUtil.getFirstItem(substitutionMap.values());
      if (!lambdaReturnType.equals(iterableParametrizedType)) {
        return false;
      }
    }
 else     if (baseMethodReturnType instanceof PsiArrayType) {
      if (!lambdaReturnType.equals(((PsiArrayType)baseMethodReturnType).getComponentType())) {
        return false;
      }
    }
  }
  return true;
}
