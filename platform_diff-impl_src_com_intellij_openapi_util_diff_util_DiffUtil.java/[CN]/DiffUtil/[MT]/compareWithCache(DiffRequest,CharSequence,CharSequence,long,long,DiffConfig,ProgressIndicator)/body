{
  LineFragments lineFragments=doCompareWithCache(request,text1,text2,stamp1,stamp2,config,indicator);
  if (!config.squashFragments)   return lineFragments;
  indicator.checkCanceled();
  if (lineFragments.isFine()) {
    return LineFragments.createFine(ComparisonUtil.squashFine(lineFragments.getFineFragments()));
  }
 else {
    return LineFragments.create(ComparisonUtil.squash(lineFragments.getFragments()));
  }
}
