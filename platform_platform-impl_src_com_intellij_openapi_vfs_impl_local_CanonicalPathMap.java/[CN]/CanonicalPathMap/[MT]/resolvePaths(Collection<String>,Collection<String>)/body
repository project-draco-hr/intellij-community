{
  final Map<String,String> resolvedPaths=ContainerUtil.newConcurrentMap();
  final BoundedTaskExecutor executor=new BoundedTaskExecutor(PooledThreadExecutor.INSTANCE,Runtime.getRuntime().availableProcessors());
  Futures.invokeAll(JBIterable.from(recursiveRoots).append(flatRoots).transform(new Function<String,Future<?>>(){
    @Override public Future<?> fun(    final String root){
      return executor.submit(new Runnable(){
        @Override public void run(){
          String canonicalPath=FileSystemUtil.resolveSymLink(root);
          if (canonicalPath != null) {
            resolvedPaths.put(root,canonicalPath);
          }
        }
      }
);
    }
  }
).toList());
  return resolvedPaths;
}
