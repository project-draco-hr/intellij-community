{
  if (fragments == null)   return;
  if (range == -1)   return;
  final MyExpandSuggester suggester=new MyExpandSuggester(context.getUserData(CACHE_KEY),defaultExpanded);
  invokeBatchOperation(new Runnable(){
    @Override public void run(){
      int last1=Integer.MIN_VALUE;
      int last2=Integer.MIN_VALUE;
      int last3=Integer.MIN_VALUE;
      for (      MergeLineFragment fragment : fragments) {
        addRange(last1,fragment.getStartLine(ThreeSide.LEFT),last2,fragment.getStartLine(ThreeSide.BASE),last3,fragment.getStartLine(ThreeSide.RIGHT),range,suggester);
        last1=fragment.getEndLine(ThreeSide.LEFT);
        last2=fragment.getEndLine(ThreeSide.BASE);
        last3=fragment.getEndLine(ThreeSide.RIGHT);
      }
      addRange(last1,Integer.MAX_VALUE,last2,Integer.MAX_VALUE,last3,Integer.MAX_VALUE,range,suggester);
    }
  }
);
  updateLineNumbers();
}
