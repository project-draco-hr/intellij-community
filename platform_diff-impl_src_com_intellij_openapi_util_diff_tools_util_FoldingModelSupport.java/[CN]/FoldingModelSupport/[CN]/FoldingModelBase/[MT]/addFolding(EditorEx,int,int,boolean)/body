{
  if (end - start < 2)   return null;
  DocumentEx document=editor.getDocument();
  final int startOffset=document.getLineStartOffset(start);
  final int endOffset=document.getLineEndOffset(end - 1);
  final Ref<FoldRegion> ref=new Ref<FoldRegion>();
  editor.getFoldingModel().runBatchFoldingOperation(new Runnable(){
    @Override public void run(){
      FoldRegion value=editor.getFoldingModel().addFoldRegion(startOffset,endOffset,"");
      if (value != null)       value.setExpanded(expanded);
      ref.set(value);
    }
  }
);
  return ref.get();
}
