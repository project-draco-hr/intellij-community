{
  if (!Registry.is("editor.config.stop.at.project.root")) {
    return Collections.emptySet();
  }
  return CachedValuesManager.getManager(project).getCachedValue(project,new CachedValueProvider<Set<String>>(){
    @Nullable @Override public Result<Set<String>> compute(){
      final Set<String> dirs=new HashSet<String>();
      final VirtualFile projectBase=project.getBaseDir();
      if (projectBase != null) {
        dirs.add(project.getBasePath());
        for (        Module module : ModuleManager.getInstance(project).getModules()) {
          for (          VirtualFile root : ModuleRootManager.getInstance(module).getContentRoots()) {
            if (!VfsUtilCore.isAncestor(projectBase,root,false)) {
              dirs.add(root.getPath());
            }
          }
        }
      }
      return new Result<Set<String>>(dirs,ProjectRootModificationTracker.getInstance(project));
    }
  }
);
}
