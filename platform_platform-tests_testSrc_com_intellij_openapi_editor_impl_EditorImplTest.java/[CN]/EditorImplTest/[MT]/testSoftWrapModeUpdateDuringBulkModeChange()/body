{
  initText("long long line<caret>");
  configureSoftWraps(12);
  DocumentEx document=(DocumentEx)myEditor.getDocument();
  document.setInBulkUpdate(true);
  document.replaceString(4,5,"-");
  document.setInBulkUpdate(false);
  assertEquals(new VisualPosition(1,5),myEditor.getCaretModel().getVisualPosition());
}
