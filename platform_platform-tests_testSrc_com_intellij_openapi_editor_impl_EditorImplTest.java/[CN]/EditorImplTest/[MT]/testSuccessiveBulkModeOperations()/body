{
  initText("some text");
  DocumentEx document=(DocumentEx)myEditor.getDocument();
  new WriteCommandAction.Simple(getProject()){
    @Override protected void run() throws Throwable {
      document.setInBulkUpdate(true);
      document.replaceString(4,5,"-");
      document.setInBulkUpdate(false);
      myEditor.getCaretModel().moveToOffset(9);
      document.setInBulkUpdate(true);
      document.replaceString(4,5,"+");
      document.setInBulkUpdate(false);
    }
  }
.execute().throwException();
  checkResultByText("some+text<caret>");
}
