{
  initText("");
  ((DocumentImpl)myEditor.getDocument()).setAcceptSlashR(true);
  new WriteCommandAction.Simple(getProject()){
    @Override protected void run() throws Throwable {
      myEditor.getDocument().insertString(0,"abc\r\ndef");
    }
  }
.execute().throwException();
  myEditor.getCaretModel().moveToOffset(4);
  assertEquals(new LogicalPosition(0,3),myEditor.getCaretModel().getLogicalPosition());
  assertEquals(new VisualPosition(0,3),myEditor.getCaretModel().getVisualPosition());
}
