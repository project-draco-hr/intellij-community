{
  final PsiDirectory[] taskDirectory=new PsiDirectory[1];
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      taskDirectory[0]=DirectoryUtil.createSubdirectories(EduNames.TASK + item.getIndex(),parentDirectory,"\\/");
      if (taskDirectory[0] != null) {
        CCLanguageManager manager=CCUtils.getStudyLanguageManager(course);
        if (manager == null) {
          return;
        }
        createFromTemplateAndOpen(taskDirectory[0],manager.getTestsTemplate(project),view);
        createFromTemplateAndOpen(taskDirectory[0],FileTemplateManager.getInstance(project).getInternalTemplate("task.html"),view);
        String defaultExtension=manager.getDefaultTaskFileExtension();
        if (defaultExtension != null) {
          FileTemplate taskFileTemplate=manager.getTaskFileTemplateForExtension(project,defaultExtension);
          createFromTemplateAndOpen(taskDirectory[0],taskFileTemplate,view);
          if (taskFileTemplate != null) {
            String taskFileName=FileUtil.getNameWithoutExtension(taskFileTemplate.getName());
            ((Task)item).addTaskFile(taskFileName + "." + defaultExtension,1);
          }
        }
      }
    }
  }
);
  return taskDirectory[0];
}
