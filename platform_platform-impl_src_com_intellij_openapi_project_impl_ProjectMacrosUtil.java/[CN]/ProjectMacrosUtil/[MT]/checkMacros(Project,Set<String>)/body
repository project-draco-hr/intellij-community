{
  usedMacros.removeAll(getDefinedMacros());
  String pathMacroSystemPrefix="path.macro.";
  for (Iterator<String> it=usedMacros.iterator(); it.hasNext(); ) {
    String macro=it.next();
    String value=System.getProperty(pathMacroSystemPrefix + macro,null);
    if (value != null) {
      AccessToken token=WriteAction.start();
      try {
        PathMacros.getInstance().setMacro(macro,value);
      }
  finally {
        token.finish();
      }
      it.remove();
    }
  }
  if (usedMacros.isEmpty()) {
    return true;
  }
  final boolean[] result=new boolean[1];
  WaitForProgressToShow.runOrInvokeAndWaitAboveProgress(new Runnable(){
    @Override public void run(){
      result[0]=showMacrosConfigurationDialog(project,usedMacros);
    }
  }
,ModalityState.NON_MODAL);
  return result[0];
}
