{
  final Editor editor=CommonDataKeys.EDITOR.getData(dataContext);
  PsiFile file=CommonDataKeys.PSI_FILE.getData(dataContext);
  if (file == null && editor != null && ApplicationManager.getApplication().isUnitTestMode()) {
    final Project project=editor.getProject();
    if (project != null) {
      file=PsiDocumentManager.getInstance(project).getPsiFile(editor.getDocument());
    }
  }
  if (editor != null && file instanceof XmlFile && JavaFxFileTypeFactory.isFxml(file)) {
    final int offset=editor.getCaretModel().getOffset();
    final PsiReference reference=file.findReferenceAt(offset);
    if (reference instanceof PsiMultiReference) {
      final PsiReference[] references=((PsiMultiReference)reference).getReferences();
      for (      PsiReference ref : references) {
        if (isKnown(ref)) {
          return ref;
        }
      }
    }
    if (isKnown(reference))     return reference;
  }
  return null;
}
