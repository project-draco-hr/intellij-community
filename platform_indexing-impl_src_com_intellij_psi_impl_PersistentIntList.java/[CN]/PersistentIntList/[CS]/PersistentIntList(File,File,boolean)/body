{
  if (initial) {
    FileUtil.writeToFile(dataFile,ArrayUtil.EMPTY_BYTE_ARRAY);
  }
  PagedFileStorage.StorageLockContext context=new PagedFileStorage.StorageLockContext(true);
  context.lock();
  try {
    data=new RandomAccessDataFile(dataFile);
    index=new IntToIntBtree(4096,indexFile,context,initial);
    dataStart=persistsVarsTo(data,initial);
  }
  finally {
    context.unlock();
  }
}
