{
  Project project=e.getData(PlatformDataKeys.PROJECT);
  VirtualFile virtualFile=e.getData(PlatformDataKeys.VIRTUAL_FILE);
  if (project == null || virtualFile == null) {
    return null;
  }
  Document document=FileDocumentManager.getInstance().getDocument(virtualFile);
  if (document == null) {
    return null;
  }
  final UpToDateLineNumberProvider myGetUpToDateLineNumber=new UpToDateLineNumberProviderImpl(document,project);
  int corrected=myGetUpToDateLineNumber.getLineNumber(lineNumber);
  GitRepository repository=GitUtil.getRepositoryManager(project).getRepositoryForFile(virtualFile);
  if (repository == null) {
    return null;
  }
  return new EventData(project,repository,corrected);
}
