{
  myRegistrar=registrar;
  registerProvidedSeverities();
  SchemeProcessor<InspectionProfileImpl> processor=new BaseSchemeProcessor<InspectionProfileImpl>(){
    @NotNull @Override public InspectionProfileImpl readScheme(    @NotNull Element element){
      InspectionProfileImpl profile=new InspectionProfileImpl(InspectionProfileLoadUtil.getProfileName(element),myRegistrar,InspectionProfileManagerImpl.this);
      read(profile,element);
      return profile;
    }
    @Override public boolean shouldBeSaved(    @NotNull final InspectionProfileImpl scheme){
      return scheme.wasInitialized();
    }
    @Override public Element writeScheme(    @NotNull final InspectionProfileImpl scheme) throws WriteExternalException {
      return scheme.saveToDocument();
    }
    @Override public void onSchemeAdded(    @NotNull final InspectionProfileImpl scheme){
      updateProfileImpl(scheme);
      fireProfileChanged(scheme);
      onProfilesChanged();
    }
    @Override public void onSchemeDeleted(    @NotNull final InspectionProfileImpl scheme){
      onProfilesChanged();
    }
    @Override public void onCurrentSchemeChanged(    final Scheme oldCurrentScheme){
      Profile current=mySchemesManager.getCurrentScheme();
      if (current != null) {
        fireProfileChanged((Profile)oldCurrentScheme,current,null);
      }
      onProfilesChanged();
    }
  }
;
  mySchemesManager=schemesManagerFactory.createSchemesManager(FILE_SPEC,processor,RoamingType.PER_USER);
  mySeverityRegistrar=new SeverityRegistrar(messageBus);
}
