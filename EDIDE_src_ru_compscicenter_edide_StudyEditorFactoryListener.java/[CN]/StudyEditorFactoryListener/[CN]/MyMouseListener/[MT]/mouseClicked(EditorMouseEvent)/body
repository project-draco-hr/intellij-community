{
  Editor editor=e.getEditor();
  LogicalPosition pos=editor.xyToLogicalPosition(e.getMouseEvent().getPoint());
  StudyTaskWindow taskWindow=myTaskFile.getTaskWindow(editor,pos);
  if (taskWindow == null) {
    myTaskFile.drawAllWindows(editor);
    return;
  }
  StudyTaskManager taskManager=StudyTaskManager.getInstance(e.getEditor().getProject());
  if (taskManager.getSelectedTaskWindow() == null) {
    editor.getMarkupModel().removeAllHighlighters();
    taskManager.setSelectedTaskWindow(taskWindow);
    if (taskWindow.getResolveStatus()) {
      taskWindow.draw(editor,false);
    }
 else {
      taskWindow.draw(editor,true);
    }
  }
 else {
    if (!(taskManager.getSelectedTaskWindow() == taskWindow)) {
      DefaultActionGroup defaultActionGroup=new DefaultActionGroup();
      AnAction action=ActionManager.getInstance().getAction("ru.compscicenter.edide.CheckAction");
      defaultActionGroup.add(action);
      ListPopup popUp=JBPopupFactory.getInstance().createActionGroupPopup("What should we do with selected task window?",defaultActionGroup,DataManager.getInstance().getDataContext(e.getEditor().getComponent()),JBPopupFactory.ActionSelectionAid.MNEMONICS,true);
      popUp.showInBestPositionFor(DataManager.getInstance().getDataContext(e.getEditor().getComponent()));
    }
  }
}
