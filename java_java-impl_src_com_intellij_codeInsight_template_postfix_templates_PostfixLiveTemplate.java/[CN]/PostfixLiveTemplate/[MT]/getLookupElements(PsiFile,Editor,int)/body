{
  String key=computeTemplateKeyWithoutContextChecking(editor.getDocument().getCharsSequence(),offset);
  if (key != null && editor.getCaretModel().getCaretCount() == 1) {
    Map<String,CustomLiveTemplateLookupElement> result=ContainerUtil.newHashMap();
    Condition<PostfixTemplate> isApplicationTemplateFunction=createIsApplicationTemplateFunction(key,file,editor);
    for (    Map.Entry<String,PostfixTemplate> entry : myTemplates.entrySet()) {
      PostfixTemplate postfixTemplate=entry.getValue();
      if (entry.getKey().startsWith(key) && isApplicationTemplateFunction.value(postfixTemplate)) {
        result.put(postfixTemplate.getKey(),new PostfixTemplateLookupElement(this,postfixTemplate,entry.getKey(),false));
      }
    }
    return result.values();
  }
  return super.getLookupElements(file,editor,offset);
}
