{
  String key=computeTemplateKeyWithoutContextChecking(editor.getDocument().getCharsSequence(),offset);
  if (key != null && editor.getCaretModel().getCaretCount() == 1) {
    Collection<CustomLiveTemplateLookupElement> result=ContainerUtil.newHashSet();
    Condition<PostfixTemplate> isApplicationTemplateFunction=createIsApplicationTemplateFunction(key,file,editor);
    for (    Map.Entry<String,PostfixTemplate> entry : myTemplates.entrySet()) {
      PostfixTemplate postfixTemplate=entry.getValue();
      if (isApplicationTemplateFunction.value(postfixTemplate)) {
        result.add(new PostfixTemplateLookupElement(this,postfixTemplate,entry.getKey(),false));
      }
    }
    return result;
  }
  return super.getLookupElements(file,editor,offset);
}
