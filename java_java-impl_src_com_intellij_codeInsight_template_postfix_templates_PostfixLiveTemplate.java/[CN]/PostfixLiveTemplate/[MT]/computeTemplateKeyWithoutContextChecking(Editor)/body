{
  int currentOffset=editor.getCaretModel().getOffset();
  CharSequence documentContent=editor.getDocument().getCharsSequence();
  int startOffset=currentOffset;
  while (startOffset > 0) {
    char currentChar=documentContent.charAt(startOffset - 1);
    if (!Character.isJavaIdentifierPart(currentChar)) {
      if (currentChar != '.' && currentChar != '!') {
        return null;
      }
      startOffset--;
      break;
    }
    startOffset--;
  }
  return String.valueOf(documentContent.subSequence(startOffset,currentOffset));
}
