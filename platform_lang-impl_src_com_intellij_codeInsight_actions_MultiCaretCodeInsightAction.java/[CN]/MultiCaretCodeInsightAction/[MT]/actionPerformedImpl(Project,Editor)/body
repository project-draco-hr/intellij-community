{
  CommandProcessor.getInstance().executeCommand(project,new Runnable(){
    @Override public void run(){
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        @Override public void run(){
          MultiCaretCodeInsightActionHandler handler=getHandler();
          try {
            iterateOverCarets(project,hostEditor,handler);
          }
  finally {
            handler.postInvoke();
          }
        }
      }
);
    }
  }
,getCommandName(),DocCommandGroupId.noneGroupId(hostEditor.getDocument()));
  hostEditor.getScrollingModel().scrollToCaret(ScrollType.RELATIVE);
}
