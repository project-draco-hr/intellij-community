{
  final List<VirtualFile> templatesToReparse=Lists.newArrayList();
  ProjectRootManager.getInstance(project).getFileIndex().iterateContent(new ContentIterator(){
    @Override public boolean processFile(    VirtualFile fileOrDir){
      if (!fileOrDir.isDirectory() && DjangoTemplateFileType.getPossibleExtensions().contains(fileOrDir.getExtension())) {
        templatesToReparse.add(fileOrDir);
      }
      return true;
    }
  }
);
  FileContentUtil.reparseFiles(project,templatesToReparse,true);
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      for (      Editor editor : EditorFactoryImpl.getInstance().getAllEditors()) {
        if (editor instanceof EditorEx) {
          final VirtualFile vFile=((EditorEx)editor).getVirtualFile();
          if (vFile != null) {
            final EditorHighlighter highlighter=EditorHighlighterFactory.getInstance().createEditorHighlighter(project,vFile);
            ((EditorEx)editor).setHighlighter(highlighter);
          }
        }
      }
    }
  }
);
  DaemonCodeAnalyzer.getInstance(project).restart();
}
