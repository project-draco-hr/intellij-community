{
  ProperTextRange range=myRange;
  PersistentRangeMarker.LinesCols linesCols=myLinesCols;
  for (  DocumentEvent event : events) {
    if (linesCols != null) {
      Pair<ProperTextRange,PersistentRangeMarker.LinesCols> pair=PersistentRangeMarker.applyChange(event,range,range.getStartOffset(),range.getEndOffset(),myGreedyLeft,myGreedyRight,linesCols);
      if (pair == null)       return null;
      range=pair.first;
      linesCols=pair.second;
    }
 else {
      range=RangeMarkerImpl.applyChange(event,range.getStartOffset(),range.getEndOffset(),myGreedyLeft,myGreedyRight);
      if (range == null)       return null;
    }
  }
  return Pair.create(range,linesCols);
}
