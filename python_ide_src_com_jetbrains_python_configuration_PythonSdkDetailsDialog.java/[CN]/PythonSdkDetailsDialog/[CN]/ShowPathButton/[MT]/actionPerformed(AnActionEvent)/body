{
  Sdk sdk=getSelectedSdk();
  if (sdk instanceof PyDetectedSdk) {
    final String sdkName=sdk.getName();
    VirtualFile sdkHome=ApplicationManager.getApplication().runWriteAction(new Computable<VirtualFile>(){
      @Override public VirtualFile compute(){
        return LocalFileSystem.getInstance().refreshAndFindFileByPath(sdkName);
      }
    }
);
    sdk=SdkConfigurationUtil.setupSdk(ProjectJdkTable.getInstance().getAllJdks(),sdkHome,PythonSdkType.getInstance(),true,null,null);
  }
  final PythonPathEditor pathEditor=createPathEditor(sdk);
  final SdkModificator sdkModificator=myModificators.get(sdk);
  PythonPathDialog dialog=new PythonPathDialog(myProject,pathEditor);
  pathEditor.reset(sdk != null ? sdkModificator : null);
  if (dialog.showAndGet()) {
    if (pathEditor.isModified()) {
      pathEditor.apply(sdkModificator);
      myModifiedModificators.add(sdkModificator);
    }
  }
  updateOkButton();
}
