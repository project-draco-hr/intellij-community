{
  if (psiFile == null)   return;
  LocalSearchScope scope=new LocalSearchScope(psiFile);
  matchContext.clear();
  matchContext.setMatcher(visitor);
  MatchOptions options=context.getOptions();
  matchContext.setOptions(options);
  matchContext.setPattern(context.getPattern());
  matchContext.setShouldRecursivelyMatch(context.shouldRecursivelyMatch());
  visitor.setMatchContext(matchContext);
  matchContext.setSink(new DuplicateFilteringResultSink(new MatchResultSink(){
    @Override public void newMatch(    MatchResult result){
      processor.process(result,configuration);
    }
    @Override public void processFile(    PsiFile element){
    }
    @Override public void setMatchingProcess(    MatchingProcess matchingProcess){
    }
    @Override public void matchingFinished(){
    }
    @Override public ProgressIndicator getProgressIndicator(){
      return null;
    }
  }
));
  options.setScope(scope);
}
