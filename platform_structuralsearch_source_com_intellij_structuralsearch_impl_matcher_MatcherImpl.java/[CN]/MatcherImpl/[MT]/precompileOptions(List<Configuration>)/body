{
  final List<Pair<MatchContext,Configuration>> contexts=new ArrayList<Pair<MatchContext,Configuration>>();
  for (  final Configuration configuration : configurations) {
    final MatchContext matchContext=new MatchContext();
    matchContext.setMatcher(visitor);
    final MatchOptions matchOptions=configuration.getMatchOptions();
    matchContext.setOptions(matchOptions);
    ApplicationManager.getApplication().runReadAction(new Runnable(){
      @Override public void run(){
        try {
          CompiledPattern compiledPattern=PatternCompiler.compilePattern(project,matchOptions);
          matchContext.setPattern(compiledPattern);
          contexts.add(Pair.create(matchContext,configuration));
        }
 catch (        UnsupportedPatternException ignored) {
        }
catch (        MalformedPatternException ignored) {
        }
      }
    }
);
  }
  return new CompiledOptions(contexts);
}
