{
  PsiJavaFile file=(PsiJavaFile)configureByText(StdFileTypes.JAVA,"class Foo {\n" + "    void m() {\n" + "    }\n"+ "<caret>}\n");
  PsiMethod method=file.getClasses()[0].getMethods()[0];
  TextRange originalRange=method.getTextRange();
  SmartPsiElementPointer pointer=createPointer(method);
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      EditorModificationUtil.insertStringAtCaret(myEditor,"    void m() {\n" + "    }\n");
    }
  }
);
  PsiDocumentManager.getInstance(myProject).commitDocument(myEditor.getDocument());
  PsiElement element=pointer.getElement();
  assertNotNull(element);
  TextRange newRange=element.getTextRange();
  assertEquals(originalRange,newRange);
}
