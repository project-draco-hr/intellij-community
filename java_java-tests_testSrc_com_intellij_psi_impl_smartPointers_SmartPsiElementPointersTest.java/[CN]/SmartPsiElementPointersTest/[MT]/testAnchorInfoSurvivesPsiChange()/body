{
  PsiJavaFile file=(PsiJavaFile)configureByText(JavaFileType.INSTANCE,"class C1{}\nclass C2 {}");
  SmartPsiElementPointer<PsiClass> pointer=createPointer(file.getClasses()[1]);
  PlatformTestUtil.tryGcSoftlyReachableObjects();
  assertNull(((SmartPointerEx)pointer).getCachedElement());
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      file.getClasses()[1].delete();
    }
  }
);
  assertNotNull(pointer.getElement());
}
