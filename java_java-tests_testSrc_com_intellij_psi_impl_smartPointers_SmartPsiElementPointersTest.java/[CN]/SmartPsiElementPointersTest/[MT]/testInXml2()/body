{
  final PsiFile file=configureByText(XmlFileType.INSTANCE,"<html>\n" + "    <ul class=\"dropdown-menu\">\n" + "        <li><a href=\"#\">One more separated link</a></li>\n"+ "    </ul>\n"+ "<caret>\n"+ "</html>");
  final XmlTag ul=PsiTreeUtil.getParentOfType(file.findElementAt(file.getText().indexOf("ul")),XmlTag.class);
  assertNotNull(ul);
  assertEquals("ul",ul.getName());
  assertEquals("dropdown-menu",ul.getAttributeValue("class"));
  SmartPsiElementPointer<XmlTag> ulPointer=SmartPointerManager.getInstance(getProject()).createSmartPsiElementPointer(ul);
  WriteCommandAction.runWriteCommandAction(getProject(),new Runnable(){
    @Override public void run(){
      int offset=getEditor().getCaretModel().getOffset();
      getEditor().getDocument().insertString(offset,"    <ul class=\"nav navbar-nav navbar-right\">\n" + "    </ul>\n");
    }
  }
);
  PsiDocumentManager.getInstance(getProject()).commitAllDocuments();
  final XmlTag newUl=ulPointer.getElement();
  assertNotNull(newUl);
  assertEquals("ul",newUl.getName());
  assertEquals("dropdown-menu",newUl.getAttributeValue("class"));
}
