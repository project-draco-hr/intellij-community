{
  final PsiFile file=configureByText(JavaFileType.INSTANCE,"class S {\n" + "}");
  final SmartPointerManager manager=SmartPointerManager.getInstance(myProject);
  int hash1=((PsiJavaFile)file).getClasses()[0].hashCode();
  final SmartPsiElementPointer<PsiClass> pointer1=manager.createSmartPsiElementPointer(((PsiJavaFile)file).getClasses()[0]);
  assertNotNull(((PsiFileImpl)file).getStubTree());
  PlatformTestUtil.tryGcSoftlyReachableObjects();
  final FileASTNode node=file.getNode();
  final SmartPsiElementPointer<PsiClass> pointer2=manager.createSmartPsiElementPointer(((PsiJavaFile)file).getClasses()[0]);
  assertFalse(hash1 == ((PsiJavaFile)file).getClasses()[0].hashCode());
  assertEquals(pointer1,pointer2);
  assertEquals(pointer1.getRange(),pointer2.getRange());
  assertNotNull(node);
}
