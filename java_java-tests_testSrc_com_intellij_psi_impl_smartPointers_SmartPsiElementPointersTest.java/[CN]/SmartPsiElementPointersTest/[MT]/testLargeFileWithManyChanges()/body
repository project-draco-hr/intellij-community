{
  configureByText(PlainTextFileType.INSTANCE,StringUtil.repeat("foo foo \n",50000));
  final TextRange range=TextRange.from(10,10);
  final SmartPsiFileRange pointer=SmartPointerManager.getInstance(myProject).createSmartPsiFileRangePointer(myFile,range);
  final Document document=myFile.getViewProvider().getDocument();
  assertNotNull(document);
  for (int i=0; i < 10000; i++) {
    document.insertString(i * 20 + 100,"x\n");
    assertFalse(PsiDocumentManager.getInstance(myProject).isCommitted(document));
    if (i % 500 == 0) {
      assertEquals(range,pointer.getRange());
    }
  }
  PsiDocumentManager.getInstance(myProject).commitAllDocuments();
  assertEquals(range,pointer.getRange());
}
