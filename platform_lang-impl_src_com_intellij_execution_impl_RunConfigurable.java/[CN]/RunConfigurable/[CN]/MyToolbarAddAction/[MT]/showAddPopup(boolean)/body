{
  ConfigurationType[] allTypes=getRunManager().getConfigurationFactories(false);
  final List<ConfigurationType> configurationTypes=getTypesToShow(showApplicableTypesOnly,allTypes);
  Collections.sort(configurationTypes,new Comparator<ConfigurationType>(){
    @Override public int compare(    final ConfigurationType type1,    final ConfigurationType type2){
      return type1.getDisplayName().compareToIgnoreCase(type2.getDisplayName());
    }
  }
);
  final int hiddenCount=allTypes.length - configurationTypes.size();
  if (hiddenCount > 0) {
    configurationTypes.add(null);
  }
  final ListPopup popup=NewRunConfigurationPopup.createAddPopup(configurationTypes,hiddenCount + " items more (irrelevant)...",new Consumer<ConfigurationFactory>(){
    @Override public void consume(    ConfigurationFactory factory){
      createNewConfiguration(factory);
    }
  }
,getSelectedConfigurationType(),new Runnable(){
    @Override public void run(){
      showAddPopup(false);
    }
  }
,true);
  popup.showUnderneathOf(myToolbarDecorator.getActionsPanel());
}
