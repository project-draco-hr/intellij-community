{
  DebuggerInvocationUtil.invokeLater(getProject(),new Runnable(){
    @Override public void run(){
      if (!isHintHidden()) {
        JComponent component;
        if (!isActiveTooltipApplicable(descriptor.getValue())) {
          component=HintUtil.createInformationLabel(text);
        }
 else {
          component=createExpandableHintComponent(text,new Runnable(){
            @Override public void run(){
              final DebuggerContextImpl debuggerContext=DebuggerManagerEx.getInstanceEx(getProject()).getContext();
              final DebugProcessImpl debugProcess=debuggerContext.getDebugProcess();
              debugProcess.getManagerThread().schedule(new DebuggerContextCommandImpl(debuggerContext){
                @Override public void threadAction(){
                  descriptor.setRenderer(debugProcess.getAutoRenderer(descriptor));
                  final InspectDebuggerTree tree=getInspectTree(descriptor);
                  final String expressionText=ApplicationManager.getApplication().runReadAction(new Computable<String>(){
                    @Override public String compute(){
                      return myCurrentExpression.getText();
                    }
                  }
);
                  final AnAction setValueAction=ActionManager.getInstance().getAction(DebuggerActions.SET_VALUE);
                  setValueAction.registerCustomShortcutSet(new CustomShortcutSet(KeyStroke.getKeyStroke(KeyEvent.VK_F2,0)),tree);
                  Disposer.register(tree,new Disposable(){
                    @Override public void dispose(){
                      setValueAction.unregisterCustomShortcutSet(tree);
                    }
                  }
);
                  showTreePopup(tree,debuggerContext,expressionText,new ValueHintTreeComponent(ValueHint.this,tree,expressionText));
                }
              }
);
            }
          }
);
        }
        if (!showHint(component))         return;
        if (getType() == ValueHintType.MOUSE_CLICK_HINT) {
          HintUtil.createInformationLabel(text).requestFocusInWindow();
        }
      }
    }
  }
);
}
