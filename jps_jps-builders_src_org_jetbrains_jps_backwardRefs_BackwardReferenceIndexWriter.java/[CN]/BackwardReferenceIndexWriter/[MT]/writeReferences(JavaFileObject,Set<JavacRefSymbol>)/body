{
  final LightUsage[] usages=new LightUsage[refs.size()];
  int idx=0;
  final ByteArrayEnumerator byteSeqEum=myIndex.getByteSeqEum();
  for (  JavacRefSymbol ref : refs) {
    usages[idx++]=LightUsage.fromSymbol(ref.getSymbol(),byteSeqEum);
  }
  final int fileId=enumerateFile(file);
  if (myRebuild) {
    for (    LightUsage usage : usages) {
      myIndex.getBackwardReferenceMap().put(usage,fileId);
      myIndex.getReferenceMap().put(fileId,usage);
    }
  }
 else {
    updateReferenceIndicesIncrementally(fileId,usages);
  }
}
