{
  final ByteArrayEnumerator byteSeqEum=myIndex.getByteSeqEum();
  final List<LightUsage> usages=ContainerUtil.mapNotNull(refs,new Function<JavacRefSymbol,LightUsage>(){
    @Override public LightUsage fun(    JavacRefSymbol symbol){
      return LightUsage.fromSymbol(symbol,byteSeqEum);
    }
  }
);
  final int fileId=enumerateFile(file);
  if (myRebuild) {
    for (    LightUsage usage : usages) {
      myIndex.getBackwardReferenceMap().put(usage,fileId);
      myIndex.getReferenceMap().put(fileId,usage);
    }
  }
 else {
    updateReferenceIndicesIncrementally(fileId,usages);
  }
}
