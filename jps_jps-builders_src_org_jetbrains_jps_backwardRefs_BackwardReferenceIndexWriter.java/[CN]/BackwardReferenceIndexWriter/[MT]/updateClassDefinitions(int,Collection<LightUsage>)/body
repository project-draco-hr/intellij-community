{
  final Collection<LightUsage> oldDefs=myIndex.getClassDefinitionMap().get(fileId);
  final Collection<LightUsage> oldDefsCopy=oldDefs == null ? null : new THashSet<LightUsage>(oldDefs);
  myIndex.getClassDefinitionMap().replace(fileId,classes);
  for (  LightUsage aClass : classes) {
    if (oldDefsCopy == null || !oldDefsCopy.remove(aClass)) {
      myIndex.getBackwardClassDefinitionMap().put(aClass,fileId);
    }
  }
  removeClassesFromHierarchy(fileId,oldDefsCopy);
}
