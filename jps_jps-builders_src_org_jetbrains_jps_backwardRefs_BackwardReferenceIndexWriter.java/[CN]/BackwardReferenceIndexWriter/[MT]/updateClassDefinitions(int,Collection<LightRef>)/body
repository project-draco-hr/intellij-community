{
  final Collection<LightRef> oldDefs=myIndex.getClassDefinitionMap().get(fileId);
  final Collection<LightRef> oldDefsCopy=oldDefs == null ? null : new THashSet<LightRef>(oldDefs);
  myIndex.getClassDefinitionMap().replace(fileId,classes);
  for (  LightRef aClass : classes) {
    if (oldDefsCopy == null || !oldDefsCopy.remove(aClass)) {
      myIndex.getBackwardClassDefinitionMap().put(aClass,fileId);
    }
  }
  removeClassesFromHierarchy(fileId,oldDefsCopy);
}
