{
  final Collection<LightRef> rawOldSupers=myIndex.getHierarchyMap().get(classId);
  Set<LightRef> oldSuperClasses=rawOldSupers == null ? null : new THashSet<LightRef>(rawOldSupers);
  for (  LightRef.JavaLightClassRef superId : superIds) {
    if (oldSuperClasses == null || !oldSuperClasses.remove(superId)) {
      myIndex.getBackwardHierarchyMap().put(superId,classId);
      myIndex.getHierarchyMap().put(classId,superId);
    }
  }
  if (oldSuperClasses != null && !oldSuperClasses.isEmpty()) {
    myIndex.getHierarchyMap().removeAll(classId,oldSuperClasses);
    for (    LightRef anOldClass : oldSuperClasses) {
      myIndex.getBackwardHierarchyMap().put(anOldClass,classId);
    }
  }
}
