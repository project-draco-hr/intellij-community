{
  Editor editor=e.getData(CommonDataKeys.EDITOR);
  if (editor == null)   return null;
  String url=findUrl(editor,editor.getCaretModel().getOffset());
  if (url != null)   return url;
  Integer expectedCaretOffset=editor.getUserData(EditorActionUtil.EXPECTED_CARET_OFFSET);
  return expectedCaretOffset == null ? null : findUrl(editor,expectedCaretOffset);
}
