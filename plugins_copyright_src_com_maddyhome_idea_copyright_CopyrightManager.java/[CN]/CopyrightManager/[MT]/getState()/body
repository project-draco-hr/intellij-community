{
  try {
    Element state=new Element("settings");
    if (!myCopyrights.isEmpty()) {
      for (      CopyrightProfile copyright : myCopyrights.values()) {
        final Element copyrightElement=new Element(COPYRIGHT);
        copyright.writeExternal(copyrightElement);
        state.addContent(copyrightElement);
      }
    }
    if (!myModuleToCopyrights.isEmpty()) {
      final Element map=new Element(MODULE2COPYRIGHT);
      for (      String moduleName : myModuleToCopyrights.keySet()) {
        final Element setting=new Element(ELEMENT);
        setting.setAttribute(MODULE,moduleName);
        setting.setAttribute(COPYRIGHT,myModuleToCopyrights.get(moduleName));
        map.addContent(setting);
      }
      state.addContent(map);
    }
    boolean hasAttributes=myDefaultCopyright != null;
    state.setAttribute(DEFAULT,hasAttributes ? myDefaultCopyright.getName() : "");
    myOptions.writeExternal(state);
    return !hasAttributes && state.getChildren().isEmpty() ? null : state;
  }
 catch (  WriteExternalException e) {
    LOG.error(e);
    return null;
  }
}
