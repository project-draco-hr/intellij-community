{
  Element state=new Element("settings");
  try {
    if (!myCopyrights.isEmpty()) {
      for (      CopyrightProfile copyright : myCopyrights.values()) {
        final Element copyrightElement=new Element(COPYRIGHT);
        copyright.writeExternal(copyrightElement);
        state.addContent(copyrightElement);
      }
    }
    if (!myModuleToCopyrights.isEmpty()) {
      final Element map=new Element(MODULE2COPYRIGHT);
      for (      String moduleName : myModuleToCopyrights.keySet()) {
        final Element setting=new Element(ELEMENT);
        setting.setAttribute(MODULE,moduleName);
        setting.setAttribute(COPYRIGHT,myModuleToCopyrights.get(moduleName));
        map.addContent(setting);
      }
      state.addContent(map);
    }
    myOptions.writeExternal(state);
  }
 catch (  WriteExternalException e) {
    LOG.error(e);
    return null;
  }
  if (myDefaultCopyright != null) {
    state.setAttribute(DEFAULT,myDefaultCopyright.getName());
  }
 else   if (!state.getChildren().isEmpty()) {
    state.setAttribute(DEFAULT,"");
  }
  return state;
}
