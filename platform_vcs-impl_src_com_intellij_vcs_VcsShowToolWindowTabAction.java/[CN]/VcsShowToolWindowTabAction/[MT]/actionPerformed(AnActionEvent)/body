{
  final Project project=e.getRequiredData(CommonDataKeys.PROJECT);
  ToolWindow toolWindow=assertNotNull(getToolWindow(project));
  final ChangesViewContentManager changesViewContentManager=(ChangesViewContentManager)ChangesViewContentManager.getInstance(project);
  final String tabName=getTabName();
  if (toolWindow.isActive() && changesViewContentManager.isContentSelected(tabName)) {
    toolWindow.hide(null);
  }
 else {
    toolWindow.activate(new Runnable(){
      @Override public void run(){
        IdeFocusManager.getInstance(project).doWhenFocusSettlesDown(new Runnable(){
          @Override public void run(){
            changesViewContentManager.selectContent(tabName,true);
          }
        }
);
      }
    }
,true,true);
  }
}
