{
  final File templateFile=new File(parentDir,encodeFileName(template.getName(),template.getExtension()));
  FileOutputStream fileOutputStream;
  try {
    fileOutputStream=new FileOutputStream(templateFile);
  }
 catch (  FileNotFoundException e) {
    FileUtil.delete(templateFile);
    fileOutputStream=new FileOutputStream(templateFile);
  }
  OutputStreamWriter outputStreamWriter=new OutputStreamWriter(fileOutputStream,CharsetToolkit.UTF8_CHARSET);
  String content=template.getText();
  if (!lineSeparator.equals("\n")) {
    content=StringUtil.convertLineSeparators(content,lineSeparator);
  }
  outputStreamWriter.write(content);
  outputStreamWriter.close();
  fileOutputStream.close();
}
