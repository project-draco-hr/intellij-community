{
  myRangeMarker=document.createRangeMarker(range.getStartOffset(),range.getEndOffset());
  myListener=listener;
  if (listener != null) {
    final InvalidRangeDispatcher notifier=InvalidRangeDispatcher.addClient(document);
    document.addDocumentListener(new DocumentAdapter(){
      @Override public void beforeDocumentChange(      DocumentEvent e){
        if (myListener != null) {
          notifier.notify(new RangeInvalidListener(){
            @Override public void onRangeInvalidated(){
              if (!isValid() && myListener != null)               myListener.onRangeInvalidated();
            }
          }
);
        }
      }
    }
);
  }
}
