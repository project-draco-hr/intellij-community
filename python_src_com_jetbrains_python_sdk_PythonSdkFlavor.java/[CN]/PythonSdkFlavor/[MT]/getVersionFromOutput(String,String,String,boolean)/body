{
  Pattern pattern=Pattern.compile(version_regexp);
  String run_dir=new File(sdkHome).getParent();
  final ProcessOutput process_output=SdkUtil.getProcessOutput(run_dir,new String[]{sdkHome,version_opt});
  if (process_output.getExitCode() != 0) {
    throw new RuntimeException(process_output.getStderr() + " (exit code " + process_output.getExitCode()+ ")");
  }
  final List<String> lines=stdout ? process_output.getStdoutLines() : process_output.getStderrLines();
  return SdkUtil.getFirstMatch(lines,pattern);
}
