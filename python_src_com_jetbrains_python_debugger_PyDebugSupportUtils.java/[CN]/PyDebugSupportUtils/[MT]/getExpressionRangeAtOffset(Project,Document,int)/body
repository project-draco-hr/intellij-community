{
  return ApplicationManager.getApplication().runReadAction(new Computable<TextRange>(){
    @Nullable public TextRange compute(){
      final PsiFile psiFile=PsiDocumentManager.getInstance(project).getPsiFile(document);
      if (psiFile != null) {
        PsiElement element=psiFile.findElementAt(offset);
        if (!(element instanceof PyExpression) || element instanceof PyLiteralExpression) {
          element=PsiTreeUtil.getParentOfType(element,PyExpression.class);
        }
        if (element != null && element instanceof PyLiteralExpression) {
          return null;
        }
        if (element != null && isSimpleEnough(element)) {
          return element.getTextRange();
        }
      }
      return null;
    }
  }
);
}
