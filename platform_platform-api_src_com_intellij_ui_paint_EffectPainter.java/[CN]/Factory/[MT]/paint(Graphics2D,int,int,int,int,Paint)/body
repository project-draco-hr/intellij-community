{
  if (paint == null)   paint=g.getPaint();
  g=(Graphics2D)g.create(x,y,width,height);
  g.setComposite(AlphaComposite.SrcOver);
  BufferedImage image;
  if (paint instanceof Color) {
    Color color=(Color)paint;
    Long key=color.getRGB() ^ ((long)height << 32);
    image=myCache.get(key);
    boolean exists=image != null;
    if (!exists || UIUtil.isRetina(g) != (image instanceof JBHiDPIScaledImage)) {
      image=create(g,paint,height);
      myCache.put(key,image);
    }
  }
 else {
    image=create(g,paint,height);
  }
  int length=image.getWidth();
  int dx=-((x % length + length) % length);
  for (; dx < width; dx+=length) {
    UIUtil.drawImage(g,image,dx,0,null);
  }
  g.dispose();
}
