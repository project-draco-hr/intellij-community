{
  final DialogWrapper wrapper=getActiveWrapper();
  if (wrapper == null && !myFocusedCallback.isProcessed()) {
    myFocusedCallback.setRejected();
    myTypeAheadDone.setRejected();
    return;
  }
  if (myActivated) {
    return;
  }
  myActivated=true;
  JComponent toFocus=wrapper == null ? null : wrapper.getPreferredFocusedComponent();
  if (toFocus == null) {
    toFocus=getRootPane().getDefaultButton();
  }
  IJSwingUtilities.moveMousePointerOn(getRootPane().getDefaultButton());
  setupSelectionOnPreferredComponent(toFocus);
  if (toFocus != null) {
    final JComponent toRequest=toFocus;
    getFocusManager().requestFocus(toRequest,true);
    notifyFocused(wrapper);
  }
 else {
    if (isShowing()) {
      notifyFocused(wrapper);
    }
  }
  if (myTypeAheadCallback != null) {
    myTypeAheadCallback.setDone();
  }
}
