{
  String prepend="";
  File file=new File(fileName);
  if (file.exists()) {
    int result=Messages.showYesNoCancelDialog(project,IdeBundle.message("error.text.file.already.exists",fileName),IdeBundle.message("title.warning"),IdeBundle.message("action.overwrite"),IdeBundle.message("action.append"),CommonBundle.getCancelButtonText(),Messages.getWarningIcon());
    if (result != Messages.NO && result != Messages.YES) {
      return;
    }
    if (result == Messages.NO) {
      char[] buf=new char[(int)file.length()];
      try {
        FileReader reader=new FileReader(fileName);
        try {
          reader.read(buf,0,(int)file.length());
          prepend=new String(buf) + SystemProperties.getLineSeparator();
        }
  finally {
          reader.close();
        }
      }
 catch (      IOException ignored) {
      }
    }
  }
  try {
    FileWriter writer=new FileWriter(fileName);
    try {
      writer.write(prepend + textToExport);
    }
  finally {
      writer.close();
    }
  }
 catch (  IOException e) {
    Messages.showMessageDialog(project,IdeBundle.message("error.writing.to.file",fileName),CommonBundle.getErrorTitle(),Messages.getErrorIcon());
  }
}
