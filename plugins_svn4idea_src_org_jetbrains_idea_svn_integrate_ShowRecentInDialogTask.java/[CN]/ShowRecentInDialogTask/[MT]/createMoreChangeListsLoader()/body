{
  return new PairConsumer<Long,MergeDialogI>(){
    @Override public void consume(    @NotNull Long bunchSize,    @NotNull MergeDialogI dialog){
      LoadRecentBranchRevisions loader=new LoadRecentBranchRevisions(myMergeContext,dialog.getLastNumber(),bunchSize.intValue());
      TaskDescriptor updater=createUpdateDialogTask(dialog,loader);
      Continuation fragmented=Continuation.createFragmented(myMergeContext.getProject(),true);
      fragmented.addExceptionHandler(VcsException.class,new Consumer<VcsException>(){
        @Override public void consume(        VcsException e){
          PopupUtil.showBalloonForActiveComponent(e.getMessage() == null ? e.getClass().getName() : e.getMessage(),MessageType.ERROR);
        }
      }
);
      fragmented.run(loader,updater);
    }
  }
;
}
