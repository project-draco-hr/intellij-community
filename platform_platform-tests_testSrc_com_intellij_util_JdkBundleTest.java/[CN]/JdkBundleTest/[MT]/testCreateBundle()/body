{
  if (SystemInfo.isWindows)   return;
  File homeJDK=new File(System.getProperty("java.home")).getParentFile();
  if (!new File(homeJDK,"lib/tools.jar").exists())   return;
  File bootJDK=SystemInfo.isMac ? homeJDK.getParentFile().getParentFile() : homeJDK;
  String verStr=System.getProperty("java.version");
  boolean macNonStandardJDK=SystemInfo.isMac && !new File(bootJDK,"Contents/Home").exists();
  JdkBundle bundle=macNonStandardJDK ? JdkBundle.createBundle(homeJDK,"",true,true) : JdkBundle.createBundle(bootJDK,true,true);
  assertNotNull(bundle);
  assertTrue(bundle.isBoot());
  assertTrue(bundle.isBundled());
  assertTrue(FileUtil.filesEqual(bundle.getBundleAsFile(),macNonStandardJDK ? homeJDK : bootJDK));
  Pair<Version,Integer> verUpdate=bundle.getVersionUpdate();
  assertNotNull(verUpdate);
  assertEquals(verStr,verUpdate.first.toString() + "_" + verUpdate.second.toString());
}
