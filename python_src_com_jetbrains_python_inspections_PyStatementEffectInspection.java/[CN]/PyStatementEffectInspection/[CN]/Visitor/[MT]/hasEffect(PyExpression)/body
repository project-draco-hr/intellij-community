{
  if (expression == null) {
    return false;
  }
  if (expression instanceof PyCallExpression || expression instanceof PyYieldExpression) {
    return true;
  }
  if (expression instanceof PyStringLiteralExpression) {
    if (PyUtil.isDocString(expression))     return true;
  }
 else   if (expression instanceof PyListCompExpression) {
    if (hasEffect(((PyListCompExpression)expression).getResultExpression())) {
      return true;
    }
  }
 else   if (expression instanceof PyBinaryExpression) {
    PyBinaryExpression binary=(PyBinaryExpression)expression;
    final PyElementType operator=binary.getOperator();
    String method=operator == null ? null : operator.getSpecialMethodName();
    if (method != null) {
      PyType type=myTypeEvalContext.getType(binary.getLeftExpression());
      if (type != null && !type.isBuiltin(myTypeEvalContext) && type.resolveMember(method,null,AccessDirection.READ,resolveWithoutImplicits()) != null) {
        return true;
      }
      final PyExpression rhs=binary.getRightExpression();
      if (rhs != null) {
        type=myTypeEvalContext.getType(rhs);
        if (type != null) {
          String rmethod="__r" + method.substring(2);
          if (!type.isBuiltin(myTypeEvalContext) && type.resolveMember(rmethod,null,AccessDirection.READ,resolveWithoutImplicits()) != null) {
            return true;
          }
        }
      }
    }
  }
 else   if (expression instanceof PyConditionalExpression) {
    PyConditionalExpression conditionalExpression=(PyConditionalExpression)expression;
    return hasEffect(conditionalExpression.getTruePart()) || hasEffect(conditionalExpression.getFalsePart());
  }
 else   if (expression instanceof PyParenthesizedExpression) {
    PyParenthesizedExpression parenthesizedExpression=(PyParenthesizedExpression)expression;
    return hasEffect(parenthesizedExpression.getContainedExpression());
  }
 else   if (expression instanceof PyReferenceExpression) {
    PyReferenceExpression referenceExpression=(PyReferenceExpression)expression;
    ResolveResult[] results=referenceExpression.getReference(resolveWithoutImplicits()).multiResolve(true);
    for (    ResolveResult res : results) {
      if (res.getElement() instanceof PyFunction) {
        registerProblem(expression,"Statement seems to have no effect and can be replaced with function call to have effect",new StatementEffectFunctionCallQuickFix());
        return true;
      }
    }
  }
 else   if (expression instanceof PyTupleExpression) {
    PyExpression[] elements=((PyTupleExpression)expression).getElements();
    for (    PyExpression element : elements) {
      if (hasEffect(element)) {
        return true;
      }
    }
  }
  return false;
}
