{
  final String url="http://helpserver.labs.intellij.net/help/images.dtd";
  assertEquals(url,ExternalResourceManager.getInstance().getResourceLocation(url,getProject()));
  myFixture.configureByText(XmlFileType.INSTANCE,"<!DOCTYPE images SYSTEM \"http://helpserver.labs.intellij.net/help/ima<caret>ges.dtd\">");
  IntentionAction intention=myFixture.getAvailableIntention(XmlBundle.message("fetch.external.resource"));
  assertNotNull(intention);
  intention.invoke(getProject(),myFixture.getEditor(),myFixture.getFile());
  assertNotSame(url,ExternalResourceManager.getInstance().getResourceLocation(url,getProject()));
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      ExternalResourceManager.getInstance().removeResource(url);
    }
  }
);
}
