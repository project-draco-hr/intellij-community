{
  final List<String> arguments=new ArrayList<String>();
  arguments.add("-cvnudl");
  HgVcs vcs=HgVcs.getInstance(myProject);
  if (vcs != null && vcs.getProjectSettings().isWhitespacesIgnoredInAnnotations() && vcs.getVersion().isIgnoreWhitespaceDiffInAnnotationsSupported()) {
    arguments.add("-w");
  }
  if (revision != null) {
    arguments.add("-r");
    arguments.add(revision.getChangeset());
  }
  arguments.add(hgFile.getRelativePath());
  final HgCommandResult result=new HgCommandExecutor(myProject).executeInCurrentThread(hgFile.getRepo(),"annotate",arguments);
  if (result == null) {
    return Collections.emptyList();
  }
  List<String> outputLines=result.getOutputLines();
  return parse(outputLines);
}
