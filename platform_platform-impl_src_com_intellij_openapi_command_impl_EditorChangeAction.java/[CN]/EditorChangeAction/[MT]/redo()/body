{
  validateDocumentLength(myOldLength);
  DocumentUndoProvider.startDocumentUndo(getDocument());
  try {
    CharSequence oldString=CompressionUtil.uncompressStringRawBytes(myOldString);
    CharSequence newString=CompressionUtil.uncompressStringRawBytes(myNewString);
    exchangeStrings(oldString,newString);
  }
  finally {
    DocumentUndoProvider.finishDocumentUndo(getDocument());
  }
  getDocument().setModificationStamp(myNewTimeStamp);
  refreshFileStatus();
}
