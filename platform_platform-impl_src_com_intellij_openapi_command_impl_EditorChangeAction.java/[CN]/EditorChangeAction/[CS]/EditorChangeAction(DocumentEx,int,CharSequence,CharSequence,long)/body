{
  super(document);
  Charset charset=EncodingManager.getInstance().getEncoding(FileDocumentManager.getInstance().getFile(document),true);
  if (charset == null)   charset=EncodingManager.getInstance().getDefaultCharset();
  if (charset == null)   charset=Charset.defaultCharset();
  myCharset=charset;
  myOffset=offset;
  myOldString=oldString == null ? "" : compressCharSequence(oldString,myCharset);
  myNewString=newString == null ? "" : compressCharSequence(newString,myCharset);
  myOldTimeStamp=oldTimeStamp;
  myNewTimeStamp=document.getModificationStamp();
}
