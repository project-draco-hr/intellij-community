{
  final Collection<VirtualFile> sourceRoots=PyUtil.getSourceRoots(directory);
  for (PsiDirectory dir=directory; dir != null; dir=dir.getParentDirectory()) {
    if (sourceRoots.contains(dir.getVirtualFile())) {
      return true;
    }
    if (!PyNames.isIdentifier(dir.getName()) || !PyUtil.isPackage(dir,false,null)) {
      return false;
    }
  }
  return false;
}
