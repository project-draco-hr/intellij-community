{
  @NonNls String text="public class Test {\n" + "    public void test() {\n" + "        int i = 1;\n"+ "    }\n"+ "}";
  init(text,TestFileType.TEXT);
  addBookmark(2);
  List<Bookmark> bookmarksBefore=getManager().getValidBookmarks();
  assertEquals(1,bookmarksBefore.size());
  new WriteCommandAction.Simple(getProject()){
    @Override protected void run() throws Throwable {
      myEditor.getDocument().setText(text);
    }
  }
.execute().throwException();
  List<Bookmark> bookmarksAfter=getManager().getValidBookmarks();
  assertEquals(1,bookmarksAfter.size());
  assertSame(bookmarksBefore.get(0),bookmarksAfter.get(0));
  for (  Bookmark bookmark : bookmarksAfter) {
    checkBookmarkNavigation(bookmark);
  }
}
