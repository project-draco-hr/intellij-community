{
  final String finalText=!text.contains("<selection>") ? "<selection>" + text + "</selection>" : text;
  PlatformTestUtil.withEncoding("UTF8",new Runnable(){
    @Override public void run(){
      myFixture.configureByText(getTestName(true) + "." + extension,finalText);
      myFixture.performEditorAction("EscapeEntities");
      myFixture.checkResult(expected);
    }
  }
);
}
