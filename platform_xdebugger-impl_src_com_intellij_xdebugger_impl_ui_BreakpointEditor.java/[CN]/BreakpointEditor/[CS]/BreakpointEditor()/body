{
  myDoneButton.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent actionEvent){
      done();
    }
  }
);
  final AnAction doneAction=new DumbAwareAction(){
    @Override public void update(    AnActionEvent e){
      super.update(e);
      Project project=getEventProject(e);
      Editor editor=e.getData(CommonDataKeys.EDITOR);
      boolean disabled=project != null && (LookupManager.getInstance(project).getActiveLookup() != null || (editor != null && TemplateManager.getInstance(project).getActiveTemplate(editor) != null));
      final Component owner=IdeFocusManager.findInstance().getFocusOwner();
      if (owner != null) {
        final JComboBox comboBox=UIUtil.getParentOfType(JComboBox.class,owner);
        if (comboBox != null && comboBox.isPopupVisible()) {
          disabled=true;
        }
      }
      e.getPresentation().setEnabled(!disabled && (editor == null || StringUtil.isEmpty(editor.getSelectionModel().getSelectedText())));
    }
    public void actionPerformed(    AnActionEvent e){
      done();
    }
  }
;
  doneAction.registerCustomShortcutSet(new CompositeShortcutSet(CommonShortcuts.ESCAPE,CommonShortcuts.ENTER,CommonShortcuts.CTRL_ENTER),myMainPanel);
}
