{
  String head=getToDetachedHead();
  git("branch -D master");
  GitBranchState state=readState();
  assertEquals("Detached HEAD is not detected",GitRepository.State.DETACHED,state.getState());
  assertEquals("Detached HEAD hash is incorrect",head,state.getCurrentRevision());
  assertTrue("There should be no local branches",state.getLocalBranches().isEmpty());
}
