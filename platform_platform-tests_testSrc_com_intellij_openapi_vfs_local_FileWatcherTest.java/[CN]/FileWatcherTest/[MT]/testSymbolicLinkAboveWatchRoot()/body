{
  File topDir=createTestDir("top");
  File topLink=createSymLink(topDir.getPath(),"link");
  File subDir=createTestDir(topDir,"sub");
  File file=createTestFile(subDir,"test.txt");
  File fileLink=new File(new File(topLink,subDir.getName()),file.getName());
  refresh(topDir);
  refresh(topLink);
  final LocalFileSystem.WatchRequest request=watch(topLink);
  try {
    myAccept=true;
    FileUtil.writeToFile(file,"new content");
    assertEvent(VFileContentChangeEvent.class,fileLink.getPath());
    myAccept=true;
    FileUtil.delete(file);
    assertEvent(VFileDeleteEvent.class,fileLink.getPath());
    myAccept=true;
    FileUtil.writeToFile(file,"re-creation");
    assertEvent(VFileCreateEvent.class,fileLink.getPath());
  }
  finally {
    unwatch(request);
    delete(topLink);
    delete(topDir);
  }
}
