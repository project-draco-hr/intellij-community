{
  File rootDir=createTestDir("root");
  File aDir=createTestDir(rootDir,"A");
  File bDir=createTestDir(aDir,"B");
  File cDir=createTestDir(bDir,"C");
  File aLink=createSymLink(aDir.getPath(),rootDir.getPath() + "/aLink");
  File flatWatchedFile=createTestFile(aLink,"test.txt");
  File fileOutsideFlatWatchRoot=createTestFile(cDir,"test.txt");
  refresh(rootDir);
  LocalFileSystem.WatchRequest aLinkRequest=watch(aLink,false);
  LocalFileSystem.WatchRequest cDirRequest=watch(cDir,false);
  try {
    myAccept=true;
    FileUtil.writeToFile(flatWatchedFile,"new content");
    assertEvent(VFileContentChangeEvent.class,flatWatchedFile.getPath());
    myAccept=true;
    FileUtil.writeToFile(fileOutsideFlatWatchRoot,"new content");
    assertEvent(VFileContentChangeEvent.class,fileOutsideFlatWatchRoot.getPath());
  }
  finally {
    unwatch(aLinkRequest,cDirRequest);
    delete(rootDir);
  }
}
