{
  File targetFile=myTempDir.newFile("target");
  File targetDir=myTempDir.newFolder("targetDir");
  File link=createSymLink(targetFile.getPath(),myTempDir.getRoot() + "/link");
  VirtualFile vFile1=refreshAndFind(link);
  assertTrue("link=" + link + ", vLink="+ vFile1,vFile1 != null && !vFile1.isDirectory() && vFile1.is(VFileProperty.SYMLINK));
  assertTrue(link.getPath(),link.delete() && link.mkdir() && link.isDirectory());
  VirtualFile vFile2=refreshAndFind(link);
  assertTrue("link=" + link + ", vLink="+ vFile2,!vFile1.isValid() && vFile2 != null && vFile2.isDirectory() && !vFile2.is(VFileProperty.SYMLINK));
  assertTrue(link.getPath(),link.delete());
  link=createSymLink(targetDir.getPath(),myTempDir.getRoot() + "/link");
  vFile1=refreshAndFind(link);
  assertTrue("link=" + link + ", vLink="+ vFile1,!vFile2.isValid() && vFile1 != null && vFile1.isDirectory() && vFile1.is(VFileProperty.SYMLINK));
  assertTrue(link.getPath(),link.delete() && link.createNewFile() && link.isFile());
  vFile2=refreshAndFind(link);
  assertTrue("link=" + link + ", vLink="+ vFile1,!vFile1.isValid() && vFile2 != null && !vFile2.isDirectory() && !vFile2.is(VFileProperty.SYMLINK));
  assertTrue(link.getPath(),link.delete());
  link=createSymLink(targetFile.getPath(),myTempDir.getRoot() + "/link");
  vFile1=refreshAndFind(link);
  assertTrue("link=" + link + ", vLink="+ vFile1,!vFile2.isValid() && vFile1 != null && !vFile1.isDirectory() && vFile1.is(VFileProperty.SYMLINK));
}
