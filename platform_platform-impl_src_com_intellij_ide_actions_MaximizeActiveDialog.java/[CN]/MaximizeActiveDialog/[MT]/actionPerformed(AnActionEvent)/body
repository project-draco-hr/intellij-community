{
  Window window=FocusManager.getCurrentManager().getActiveWindow();
  if (window instanceof JDialog && ((JDialog)window).isResizable()) {
    JDialog d=(JDialog)window;
    JRootPane rootPane=d.getRootPane();
    if (rootPane == null)     return;
    Rectangle screenRectangle=ScreenUtil.getScreenRectangle(d);
    if (d.getBounds().equals(screenRectangle)) {
      Object value=rootPane.getClientProperty("NORMAL_BOUNDS");
      if (value instanceof Rectangle) {
        Rectangle bounds=(Rectangle)value;
        ScreenUtil.fitToScreen(bounds);
        d.setBounds(bounds);
        rootPane.putClientProperty("NORMAL_BOUNDS",null);
      }
    }
 else {
      rootPane.putClientProperty("NORMAL_BOUNDS",d.getBounds());
      d.setBounds(screenRectangle);
    }
  }
}
