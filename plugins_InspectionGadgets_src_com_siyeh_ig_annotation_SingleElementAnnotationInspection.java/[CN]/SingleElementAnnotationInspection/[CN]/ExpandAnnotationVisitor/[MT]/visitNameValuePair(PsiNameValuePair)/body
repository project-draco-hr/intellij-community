{
  super.visitNameValuePair(pair);
  if (pair.getName() == null) {
    final PsiElement parent=pair.getParent();
    if (parent instanceof PsiAnnotationParameterList) {
      final Set<String> usedNames=AddAnnotationAttributeNameFix.getUsedAttributeNames((PsiAnnotationParameterList)parent);
      if (!usedNames.contains(PsiAnnotation.DEFAULT_REFERENCED_METHOD_NAME)) {
        final PsiReference reference=pair.getReference();
        if (reference != null) {
          final PsiElement resolved=reference.resolve();
          if (resolved instanceof PsiMethod) {
            final PsiAnnotationMemberValue value=pair.getValue();
            final PsiType valueType=CreateAnnotationMethodFromUsageFix.getAnnotationValueType(value);
            if (AddAnnotationAttributeNameFix.isCompatibleReturnType((PsiMethod)resolved,valueType)) {
              registerError(pair);
            }
          }
        }
      }
    }
  }
}
