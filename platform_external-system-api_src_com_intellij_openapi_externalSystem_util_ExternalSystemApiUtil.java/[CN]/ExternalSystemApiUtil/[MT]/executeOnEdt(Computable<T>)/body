{
  final Application app=ApplicationManager.getApplication();
  if (app.isDispatchThread()) {
    return task.compute();
  }
  final Ref<T> result=Ref.create();
  app.invokeAndWait(new Runnable(){
    @Override public void run(){
      result.set(task.compute());
    }
  }
,ModalityState.defaultModalityState());
  return result.get();
}
