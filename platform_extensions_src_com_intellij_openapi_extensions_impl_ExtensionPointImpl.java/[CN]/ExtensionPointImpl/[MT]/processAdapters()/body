{
  int totalSize=myExtensionAdapters.size() + myLoadedAdapters.size();
  if (totalSize != 0) {
    List<ExtensionComponentAdapter> adapters=ContainerUtil.newArrayListWithCapacity(totalSize);
    adapters.addAll(myExtensionAdapters);
    adapters.addAll(myLoadedAdapters);
    LoadingOrder.sort(adapters);
    myExtensionAdapters.clear();
    myExtensionAdapters.addAll(adapters);
    Set<ExtensionComponentAdapter> loaded=ContainerUtil.newHashOrEmptySet(myLoadedAdapters);
    myExtensions.clear();
    myLoadedAdapters.clear();
    for (    ExtensionComponentAdapter adapter : adapters) {
      @SuppressWarnings("unchecked") T extension=(T)adapter.getExtension();
      registerExtension(extension,adapter,myExtensions.size(),!loaded.contains(adapter));
      myExtensionAdapters.remove(adapter);
    }
  }
}
