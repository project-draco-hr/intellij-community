{
  if (resultRef == null) {
    DataPackUtils du=getDataPackUtils();
    if (position == InsertPosition.BELOW) {
      insertAfter=base.getRowIndex() + 1;
      base=getParent(base);
    }
 else {
      insertAfter=base.getRowIndex();
    }
    Node lowestInserted=nodesToInsert.get(nodesToInsert.size() - 1);
    if (du.isAncestorOf(base,lowestInserted)) {
      this.base=base;
    }
 else {
      this.base=getParent(lowestInserted);
    }
    List<Node> inputNodes=du.getCommitsInBranchAboveBase(this.base,du.getNodeByHash(subjectRef.getCommitHash()));
    inputNodes.removeAll(nodesToInsert);
    inputNodes.addAll(nodesToInsert);
    this.fakeBranch=createFakeCommits(this.base,inputNodes);
    setResultRef(subjectRef);
  }
}
