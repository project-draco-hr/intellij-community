{
  final List<PyPackage> currentPackages=myPackagesCache;
  if (alwaysRefresh || currentPackages == null) {
    myUpdatingCache=true;
    try {
      final List<PyPackage> packages=collectPackages();
      LOG.debug("Packages installed in " + mySdk.getName() + ": "+ packages);
      myPackagesCache=packages;
      return Collections.unmodifiableList(packages);
    }
 catch (    ExecutionException e) {
      myPackagesCache=Collections.emptyList();
      throw e;
    }
 finally {
      myUpdatingCache=false;
    }
  }
  return Collections.unmodifiableList(currentPackages);
}
