{
synchronized (myCacheLock) {
    if (myPackagesCache != null) {
      return new ArrayList<PyPackage>(myPackagesCache);
    }
    if (myExceptionCache != null) {
      throw myExceptionCache;
    }
    if (cachedOnly) {
      return null;
    }
  }
  try {
    final String output=getHelperResult(PACKAGING_TOOL,Arrays.asList("list"),false,false,null);
    final List<PyPackage> packages=parsePackagingToolOutput(output);
synchronized (myCacheLock) {
      myPackagesCache=packages;
      return new ArrayList<PyPackage>(myPackagesCache);
    }
  }
 catch (  ExecutionException e) {
synchronized (myCacheLock) {
      myExceptionCache=e;
    }
    throw e;
  }
}
