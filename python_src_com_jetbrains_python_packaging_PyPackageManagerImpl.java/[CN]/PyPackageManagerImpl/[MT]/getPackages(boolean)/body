{
synchronized (myCacheLock) {
    if (myPackagesCache != null) {
      return new ArrayList<PyPackage>(myPackagesCache);
    }
    if (myExceptionCache != null) {
      throw myExceptionCache;
    }
    if (cachedOnly) {
      return null;
    }
  }
  try {
    final List<PyPackage> packages=getPackages();
    if (LOG.isDebugEnabled()) {
      LOG.debug("Packages installed in " + mySdk.getName() + ": "+ packages);
    }
synchronized (myCacheLock) {
      myPackagesCache=packages;
      return new ArrayList<PyPackage>(myPackagesCache);
    }
  }
 catch (  ExecutionException e) {
synchronized (myCacheLock) {
      myExceptionCache=e;
    }
    throw e;
  }
}
