{
synchronized (this) {
    final Document document=e.getDocument();
    Lexer l=getLexer();
    if (l instanceof LayeredLexer) {
      Lexer delegate=((LayeredLexer)l).getDelegate();
      if (delegate instanceof PythonHighlightingLexer && (((PythonHighlightingLexer)delegate).getImportOffset() > e.getOffset() || ((PythonHighlightingLexer)delegate).getImportOffset() == -1)) {
        ((PythonHighlightingLexer)delegate).clearState(e.getDocument().getTextLength());
        setText(document.getCharsSequence());
      }
 else       super.documentChanged(e);
    }
 else     super.documentChanged(e);
  }
}
