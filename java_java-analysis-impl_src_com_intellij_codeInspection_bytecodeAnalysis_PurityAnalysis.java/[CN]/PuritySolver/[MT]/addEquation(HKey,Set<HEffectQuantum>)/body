{
  Set<HKey> callKeys=new HashSet<HKey>();
  for (  HEffectQuantum effect : effects) {
    if (effect instanceof HEffectQuantum.CallQuantum) {
      callKeys.add(((HEffectQuantum.CallQuantum)effect).key);
    }
  }
  if (callKeys.isEmpty()) {
    solved.put(key,effects);
    moving.add(key);
  }
 else {
    pending.put(key,effects);
    for (    HKey callKey : callKeys) {
      Set<HKey> deps=dependencies.get(callKey);
      if (deps == null) {
        deps=new HashSet<HKey>();
        dependencies.put(callKey,deps);
      }
      deps.add(key);
    }
  }
}
