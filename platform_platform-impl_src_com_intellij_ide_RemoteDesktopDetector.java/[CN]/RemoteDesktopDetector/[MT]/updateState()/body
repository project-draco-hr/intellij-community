{
  if (!myFailureDetected) {
    try {
      myRemoteDesktopConnected=User32.INSTANCE.GetSystemMetrics(0x1000) != 0;
      LOG.debug("Detected remote desktop: ",myRemoteDesktopConnected);
    }
 catch (    Throwable e) {
      myRemoteDesktopConnected=false;
      myFailureDetected=true;
      LOG.warn("Error while calling GetSystemMetrics",e);
    }
  }
}
