{
  final List<String> updatedParamNames=new ArrayList<String>();
  for (  String name : newParams) {
    final Collection<PyReferenceExpression> reads=myAttrReferences.get(name);
    final PsiElement anchor=ContainerUtil.getFirstItem(reads);
    if (!isValidName(name,anchor)) {
      final String indexedName=appendNumberUntilValid(name,anchor);
      updatedParamNames.add(indexedName);
      for (      PyReferenceExpression read : reads) {
        read.replace(myGenerator.createExpressionFromText(LanguageLevel.forElement(read),indexedName));
      }
    }
 else {
      updatedParamNames.add(name);
      for (      PyReferenceExpression read : reads) {
        removeQualifier(read);
      }
    }
  }
  final PyFunction copied=(PyFunction)myFunction.copy();
  final PyParameter[] params=copied.getParameterList().getParameters();
  if (params.length > 0) {
    params[0].delete();
  }
  addParameters(copied.getParameterList(),updatedParamNames);
  return copied;
}
