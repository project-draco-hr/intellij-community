{
  ID pool=invoke(invoke("NSAutoreleasePool","alloc"),"init");
  try {
    final ID buttonsArray=invoke("NSMutableArray","array");
    for (    String s : buttons) {
      ID s1=nsString(UIUtil.removeMnemonic(s));
      invoke(buttonsArray,"addObject:",s1);
    }
    HashMap params=new HashMap();
    params.put(COMMON_DIALOG_PARAM_TYPE.title,nsString(title));
    params.put(COMMON_DIALOG_PARAM_TYPE.message,nsString(StringUtil.stripHtml(message == null ? "" : message,true).replace("%","%%")));
    params.put(MESSAGE_DIALOG_PARAM_TYPE.errorStyle,nsString(errorStyle ? "error" : "-1"));
    params.put(COMMON_DIALOG_PARAM_TYPE.doNotAskDialogOption1,nsString(doNotAskDialogOption == null || !doNotAskDialogOption.canBeHidden() ? "-1" : doNotAskDialogOption.getDoNotShowMessage()));
    params.put(COMMON_DIALOG_PARAM_TYPE.doNotAskDialogOption2,nsString(doNotAskDialogOption != null && !doNotAskDialogOption.isToBeShown() ? "checked" : "-1"));
    params.put(MESSAGE_DIALOG_PARAM_TYPE.defaultOptionIndex,Integer.toString(defaultOptionIndex));
    params.put(MESSAGE_DIALOG_PARAM_TYPE.focusedOptionIndex,Integer.toString(focusedOptionIndex));
    params.put(MESSAGE_DIALOG_PARAM_TYPE.buttonsArray,buttonsArray);
    return convertReturnCodeFromNativeMessageDialog(showDialog(window,"showVariableButtonsSheet:",new DialogParamsWrapper(DialogParamsWrapper.DialogType.message,params)));
  }
  finally {
    invoke(pool,"release");
  }
}
