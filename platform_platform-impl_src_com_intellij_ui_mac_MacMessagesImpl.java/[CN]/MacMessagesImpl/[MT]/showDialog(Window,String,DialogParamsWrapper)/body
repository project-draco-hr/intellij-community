{
  Window foremostWindow=getForemostWindow(window);
  String foremostWindowTitle=getWindowTitle(foremostWindow);
  Window documentRoot=getDocumentRootFromWindow(foremostWindow);
  final ID nativeFocusedWindow=invoke(MacUtil.findWindowForTitle(foremostWindowTitle),"retain");
  paramsWrapper.setNativeWindow(nativeFocusedWindow);
  final ID paramsArray=paramsWrapper.getParamsAsID();
  final ID delegate=invoke(invoke(getObjcClass("NSAlertDelegate_"),"alloc"),"init");
  IdeFocusManager.getGlobalInstance().setTypeaheadEnabled(false);
  runOrPostponeForWindow(documentRoot,new Runnable(){
    @Override public void run(){
      invoke(delegate,"performSelectorOnMainThread:withObject:waitUntilDone:",createSelector(methodName),paramsArray,false);
    }
  }
);
  startModal(documentRoot,nativeFocusedWindow);
  invoke(nativeFocusedWindow,"release");
  IdeFocusManager.getGlobalInstance().setTypeaheadEnabled(true);
  return documentRoot;
}
