{
  if (window == null) {
    Window _window=KeyboardFocusManager.getCurrentKeyboardFocusManager().getFocusedWindow();
    if (_window == null) {
      Component focusOwner=IdeFocusManager.findInstance().getFocusOwner();
      if (focusOwner != null) {
        _window=SwingUtilities.getWindowAncestor(focusOwner);
      }
      if (_window == null) {
        _window=WindowManager.getInstance().findVisibleFrame();
      }
    }
    window=_window;
  }
  return findDocumentRoot(window);
}
