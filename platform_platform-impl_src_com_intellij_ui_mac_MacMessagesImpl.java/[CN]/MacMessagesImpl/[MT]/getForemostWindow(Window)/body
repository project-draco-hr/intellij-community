{
  Window _window=null;
  Component focusOwner=null;
  if (window != null) {
    focusOwner=window.getMostRecentFocusOwner();
    if (focusOwner != null) {
      _window=SwingUtilities.getWindowAncestor(focusOwner);
      if (_window == null) {
      }
    }
  }
  if (_window == null) {
    focusOwner=IdeFocusManager.findInstance().getFocusOwner();
    if (focusOwner != null) {
      _window=SwingUtilities.getWindowAncestor(focusOwner);
    }
  }
  if (_window == null) {
    focusOwner=KeyboardFocusManager.getCurrentKeyboardFocusManager().getFocusedWindow();
    if (focusOwner != null) {
      _window=SwingUtilities.getWindowAncestor(focusOwner);
    }
  }
  if (_window == null) {
    _window=WindowManager.getInstance().findVisibleFrame();
  }
  return _window;
}
