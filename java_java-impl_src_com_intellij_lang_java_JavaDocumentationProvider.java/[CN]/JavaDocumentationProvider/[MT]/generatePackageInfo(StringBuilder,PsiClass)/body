{
  PsiFile file=aClass.getContainingFile();
  final ProjectFileIndex fileIndex=ProjectRootManager.getInstance(aClass.getProject()).getFileIndex();
  VirtualFile vFile=file.getVirtualFile();
  if (vFile != null && (fileIndex.isInLibrarySource(vFile) || fileIndex.isInLibraryClasses(vFile))) {
    final List<OrderEntry> orderEntries=fileIndex.getOrderEntriesForFile(vFile);
    OrderEntry orderEntry=ContainerUtil.find(orderEntries,Conditions.instanceOf(LibraryOrSdkOrderEntry.class));
    if (orderEntry != null) {
      buffer.append("[").append(StringUtil.escapeXml(orderEntry.getPresentableName())).append("] ");
    }
  }
 else {
    final Module module=ModuleUtilCore.findModuleForPsiElement(file);
    if (module != null) {
      buffer.append('[').append(module.getName()).append("] ");
    }
  }
  if (file instanceof PsiJavaFile) {
    String packageName=((PsiJavaFile)file).getPackageName();
    if (packageName.length() > 0) {
      buffer.append(packageName);
      newLine(buffer);
    }
  }
}
