{
  ObjectIntHashMap<String> result=new ObjectIntHashMap<String>();
  long lastTimeSent=UsageStatisticsPersistenceComponent.getInstance().getLastTimeSent();
  for (  CollectedUsages usageDescriptors : persistence.getApplicationData(getGroupId()).values()) {
    if (!usageDescriptors.usages.isEmpty() && usageDescriptors.collectionTime > lastTimeSent) {
      result.ensureCapacity(usageDescriptors.usages.size());
      for (      UsageDescriptor usageDescriptor : usageDescriptors.usages) {
        String key=usageDescriptor.getKey();
        result.put(key,result.get(key,0) + usageDescriptor.getValue());
      }
    }
  }
  if (result.isEmpty()) {
    return Collections.emptySet();
  }
 else {
    final THashSet<UsageDescriptor> descriptors=new THashSet<UsageDescriptor>(result.size());
    result.forEachEntry(new TObjectIntProcedure<String>(){
      @Override public boolean execute(      String key,      int value){
        descriptors.add(new UsageDescriptor(key,value));
        return true;
      }
    }
);
    return descriptors;
  }
}
