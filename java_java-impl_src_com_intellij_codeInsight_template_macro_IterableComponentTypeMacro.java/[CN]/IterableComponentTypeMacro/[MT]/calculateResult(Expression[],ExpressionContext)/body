{
  if (params.length != 1)   return null;
  final Result result=params[0].calculateResult(context);
  if (result == null)   return null;
  Project project=context.getProject();
  PsiExpression expr=MacroUtil.resultToPsiExpression(result,context);
  if (expr == null)   return null;
  PsiType type=expr.getType();
  if (type instanceof PsiArrayType) {
    return new PsiTypeResult(((PsiArrayType)type).getComponentType(),project);
  }
  if (type instanceof PsiClassType) {
    PsiClassType.ClassResolveResult resolveResult=((PsiClassType)type).resolveGenerics();
    PsiClass aClass=resolveResult.getElement();
    if (aClass != null) {
      PsiType component=PsiUtil.substituteTypeParameter(type,CommonClassNames.JAVA_LANG_ITERABLE,0,false);
      if (component != null) {
        return new PsiTypeResult(GenericsUtil.eliminateWildcards(component,false,true),project);
      }
    }
  }
  return null;
}
