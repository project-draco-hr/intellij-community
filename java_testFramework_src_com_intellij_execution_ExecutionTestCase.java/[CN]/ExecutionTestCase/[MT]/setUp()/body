{
  if (ourOutputRoot == null) {
    ourOutputRoot=FileUtil.createTempDirectory("ExecutionTestCase",null,true);
  }
  myModuleOutputDir=new File(ourOutputRoot,PathUtil.getFileName(getTestAppPath()));
  myChecker=initOutputChecker();
  EdtTestUtil.runInEdtAndWait(new ThrowableRunnable<Throwable>(){
    @Override public void run() throws Throwable {
      ExecutionTestCase.super.setUp();
    }
  }
);
  if (!myModuleOutputDir.exists()) {
    VirtualFile vDir=LocalFileSystem.getInstance().refreshAndFindFileByIoFile(ourOutputRoot);
    assertNotNull(ourOutputRoot.getAbsolutePath(),vDir);
    vDir.getChildren();
    myCompilerTester=new CompilerTester(myProject,Arrays.asList(ModuleManager.getInstance(myProject).getModules()));
    List<CompilerMessage> messages=myCompilerTester.rebuild();
    for (    CompilerMessage message : messages) {
      if (message.getCategory() == CompilerMessageCategory.ERROR) {
        FileUtil.delete(myModuleOutputDir);
        fail("Compilation failed: " + message);
      }
    }
  }
}
