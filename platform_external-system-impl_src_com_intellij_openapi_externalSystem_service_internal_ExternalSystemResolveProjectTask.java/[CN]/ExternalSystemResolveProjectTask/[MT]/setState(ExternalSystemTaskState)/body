{
  super.setState(state);
  if (state.isStopped()) {
    InternalExternalProjectInfo projectInfo=new InternalExternalProjectInfo(getExternalSystemId(),getExternalProjectPath(),getExternalProject());
    final long currentTimeMillis=System.currentTimeMillis();
    projectInfo.setLastImportTimestamp(currentTimeMillis);
    projectInfo.setLastSuccessfulImportTimestamp(state == ExternalSystemTaskState.FAILED ? -1 : currentTimeMillis);
    ProjectDataManager.getInstance().updateExternalProjectData(getIdeProject(),projectInfo);
  }
}
