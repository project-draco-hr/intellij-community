{
  myProjectSettings=projectSettings;
  myVcs=HgVcs.getInstance(project);
  loadSettings();
  myTestButton.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      String executable=getCurrentPath();
      HgVersion version;
      try {
        version=HgVersion.identifyVersion(executable);
      }
 catch (      Exception exception) {
        Messages.showErrorDialog(myMainPanel,exception.getMessage(),HgVcsMessages.message("hg4idea.run.failed.title"));
        return;
      }
      Messages.showInfoMessage(myMainPanel,String.format("Mercurial version is %s",version.toString()),HgVcsMessages.message("hg4idea.run.success.title"));
    }
  }
);
  if (!project.isDefault()) {
    final HgRepositoryManager repositoryManager=ServiceManager.getService(project,HgRepositoryManager.class);
    mySyncControl.setVisible(repositoryManager != null && repositoryManager.moreThanOneRoot());
  }
 else {
    mySyncControl.setVisible(true);
  }
  mySyncControl.setToolTipText(DvcsBundle.message("sync.setting.description","Mercurial"));
}
