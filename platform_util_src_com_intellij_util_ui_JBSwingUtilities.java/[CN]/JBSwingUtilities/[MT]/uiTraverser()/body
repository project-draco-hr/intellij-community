{
  return new TreeTraverser<Component>(){
    @NotNull @Override public JBIterable<Component> children(    @NotNull Component c){
      JBIterable<Component> result;
      if (c instanceof JMenu) {
        result=JBIterable.of(((JMenu)c).getMenuComponents());
      }
 else       if (c instanceof Container) {
        result=JBIterable.of(((Container)c).getComponents());
      }
 else {
        result=JBIterable.empty();
      }
      if (c instanceof JComponent) {
        JComponent jc=(JComponent)c;
        Iterable<? extends Component> orphans=UIUtil.getClientProperty(jc,NOT_IN_HIERARCHY_COMPONENTS);
        if (orphans != null) {
          result=result.append(orphans);
        }
        JPopupMenu jpm=jc.getComponentPopupMenu();
        if (jpm != null && jpm.isVisible() && jpm.getInvoker() == jc) {
          result=result.append(Collections.singletonList(jpm));
        }
      }
      return result;
    }
  }
;
}
