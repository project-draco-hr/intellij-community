{
  int wordIndex=bitIndex >> SHIFT;
  if (wordIndex >= myBitMask.length) {
    return -1;
  }
  long word=myBitMask[wordIndex] & (-1L << bitIndex);
  while (true) {
    if (word != 0) {
      int i=(wordIndex * BITS_PER_WORD) + Long.numberOfTrailingZeros(word);
      if (myShadowSet != null && i != myShadowSet.nextSetBit(bitIndex)) {
        myShadowSet.nextSetBit(bitIndex);
      }
      return i;
    }
    if (++wordIndex == myBitMask.length) {
      return -1;
    }
    word=myBitMask[wordIndex];
  }
}
