{
  super(null,cause);
  myElementReference=new SoftReference<PsiElement>(element);
  if (element == null) {
    myMessage=message;
    myDiagnostic=Attachment.EMPTY_ARRAY;
  }
 else {
    Object trace=findInvalidationTrace(element.getNode());
    String reason="Element: " + element.getClass() + " because: "+ reason(element)+ "\ninvalidated at: "+ (!isTrackingInvalidation() ? "disabled" : trace != null ? "see attachment" : "no info");
    myMessage=reason + (message == null ? "" : "; " + message);
    if (trace == null) {
      myDiagnostic=Attachment.EMPTY_ARRAY;
    }
 else {
      String diagnostic=trace instanceof Throwable ? ExceptionUtil.getThrowableText((Throwable)trace) : trace.toString();
      myDiagnostic=new Attachment[]{new Attachment("diagnostic.txt",diagnostic)};
    }
  }
}
