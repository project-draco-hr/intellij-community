{
  if (!frame.getVirtualMachine().canGetBytecodes()) {
    return Collections.emptyList();
  }
  try {
    final Location location=frame.location();
    LOG.assertTrue(location != null);
    final com.sun.jdi.Method method=location.method();
    final Location methodLocation=method.location();
    if (methodLocation == null || methodLocation.codeIndex() < 0) {
      return Collections.emptyList();
    }
    final byte[] bytecodes=method.bytecodes();
    if (bytecodes != null && bytecodes.length > 0) {
      final int firstLocalVariableSlot=getFirstLocalsSlot(method);
      final HashMap<Integer,DecompiledLocalVariable> usedVars=new HashMap<Integer,DecompiledLocalVariable>();
      new InstructionParser(bytecodes,location.codeIndex()){
        @Override protected void localVariableInstructionFound(        int opcode,        int slot,        String typeSignature){
          if (slot >= firstLocalVariableSlot) {
            DecompiledLocalVariable variable=usedVars.get(slot);
            if (variable == null || !typeSignature.equals(variable.getSignature())) {
              variable=new DecompiledLocalVariable(slot,false,typeSignature,namesMap.get(slot));
              usedVars.put(slot,variable);
            }
          }
        }
      }
.parse();
      if (usedVars.isEmpty()) {
        return Collections.emptyList();
      }
      List<DecompiledLocalVariable> vars=new ArrayList<DecompiledLocalVariable>(usedVars.values());
      Collections.sort(vars,DecompiledLocalVariable.COMPARATOR);
      return vars;
    }
  }
 catch (  UnsupportedOperationException ignored) {
  }
catch (  Exception e) {
    LOG.info(e);
  }
  return Collections.emptyList();
}
