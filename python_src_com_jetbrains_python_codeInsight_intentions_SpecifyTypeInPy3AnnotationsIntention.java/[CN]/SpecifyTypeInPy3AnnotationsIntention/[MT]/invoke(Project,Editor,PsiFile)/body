{
  PyExpression problemElement=PyUtil.findProblemElement(editor,file,PyNamedParameter.class,PyQualifiedExpression.class);
  PyParameter parameter=null;
  PsiReference reference=null;
  String name=null;
  if (problemElement != null) {
    name=problemElement.getName();
    reference=problemElement.getReference();
    if (problemElement instanceof PyQualifiedExpression) {
      final PyExpression qualifier=((PyQualifiedExpression)problemElement).getQualifier();
      if (qualifier != null) {
        reference=qualifier.getReference();
        name=qualifier.getText();
      }
    }
  }
  final PsiElement resolvedReference=reference != null ? reference.resolve() : null;
  if (problemElement instanceof PyParameter)   parameter=(PyParameter)problemElement;
 else {
    if (resolvedReference instanceof PyParameter) {
      parameter=(PyParameter)resolvedReference;
    }
  }
  PyExpression defaultParamValue=null;
  if (parameter instanceof PyNamedParameter)   defaultParamValue=parameter.getDefaultValue();
  if (parameter != null && name != null) {
    annotateParameter(project,editor,parameter,name,defaultParamValue);
  }
 else {
    annotateReturnType(project,editor,file,resolvedReference);
  }
}
