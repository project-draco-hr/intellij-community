{
  if (initVisibility == null) {
    initVisibility=new UnsignedBitSet();
    for (int i=0; i < delegateGraph.nodesCount(); i++) {
      initVisibility.set(delegateGraph.getNodeId(i),true);
    }
  }
  UnsignedBitSet visibleNodesId=initVisibility.clone();
  GraphNodesVisibility delegateNodesVisibility=new GraphNodesVisibility(delegateGraph,visibleNodesId);
  UpdatableIntToIntMap nodesMap=ListIntToIntMap.newInstance(delegateNodesVisibility.asFlags());
  GraphAdditionalEdges graphAdditionalEdges=GraphAdditionalEdges.newInstance(createGetNodeIndexById(delegateGraph,visibleNodesId,nodesMap),createGetNodeIdByIndex(delegateGraph,nodesMap));
  return new CollapsedGraph(delegateGraph,delegateNodesVisibility,nodesMap,graphAdditionalEdges);
}
