{
  UnsignedBitSet visibleNodesId=prevCollapsedGraph.myVisibleNodesId;
  Flags delegateNodesVisibility=createDelegateNodesVisibility(delegateGraph,visibleNodesId);
  UpdatableIntToIntMap nodesMap=ListIntToIntMap.newInstance(delegateNodesVisibility);
  GraphAdditionEdges graphAdditionEdges=GraphAdditionEdges.updateInstance(prevCollapsedGraph.myGraphAdditionEdges,createGetNodeIndexById(delegateGraph,visibleNodesId,nodesMap),createGetNodeIdByIndex(delegateGraph,nodesMap));
  return new CollapsedGraph(delegateGraph,visibleNodesId,delegateNodesVisibility,nodesMap,graphAdditionEdges);
}
