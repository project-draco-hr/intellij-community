{
  final Document document=editor.getDocument();
  if (document instanceof DocumentImpl) {
    DocumentImpl documentImpl=(DocumentImpl)document;
    List<RangeMarker> blocks=documentImpl.getGuardedBlocks();
    for (    TaskWindow taskWindow : taskWindows) {
      if (!taskWindow.isValid(document)) {
        return;
      }
      int start=taskWindow.getRealStartOffset(document);
      int end=start + taskWindow.getLength();
      if (start != 0) {
        createGuardedBlock(editor,blocks,start - 1,start);
      }
      if (end != document.getTextLength()) {
        createGuardedBlock(editor,blocks,end,end + 1);
      }
    }
  }
}
