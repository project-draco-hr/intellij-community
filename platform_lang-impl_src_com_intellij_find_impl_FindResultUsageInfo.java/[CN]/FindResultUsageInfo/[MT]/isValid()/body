{
  if (!super.isValid())   return false;
  Segment segment=super.getSegment();
  if (segment == null)   return false;
  VirtualFile file=getPsiFile().getVirtualFile();
  Document document=PsiDocumentManager.getInstance(getProject()).getDocument(getPsiFile());
  if (document == null)   return false;
  Segment searchOffset;
  if (myAnchor != null) {
    searchOffset=myAnchor.getRange();
    if (searchOffset == null)     return false;
  }
 else {
    searchOffset=segment;
  }
  int offset=searchOffset.getStartOffset();
  FindResult result;
  do {
    result=myFindManager.findString(document.getCharsSequence(),offset,myFindModel,file);
    offset=result.getEndOffset() == offset ? offset + 1 : result.getEndOffset();
    if (!result.isStringFound())     return false;
  }
 while (result.getStartOffset() < segment.getStartOffset());
  return segment.getStartOffset() == result.getStartOffset() && segment.getEndOffset() == result.getEndOffset();
}
