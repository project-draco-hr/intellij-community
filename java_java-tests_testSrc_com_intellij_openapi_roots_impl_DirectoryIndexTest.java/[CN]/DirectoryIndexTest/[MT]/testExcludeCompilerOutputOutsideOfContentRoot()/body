{
  assertTrue(myFileIndex.isExcluded(myOutputDir));
  assertFalse(myFileIndex.isUnderIgnored(myOutputDir));
  assertTrue(myFileIndex.isExcluded(myModule1OutputDir));
  assertFalse(myFileIndex.isExcluded(myOutputDir.getParent()));
  assertExcludedFromProject(myOutputDir);
  assertExcludedFromProject(myModule1OutputDir);
  String moduleOutputUrl=myModule1OutputDir.getUrl();
  VfsTestUtil.deleteFile(myOutputDir);
  PsiTestUtil.setCompilerOutputPath(myModule,moduleOutputUrl,false);
  myOutputDir=createChildDirectory(myRootVFile,"out");
  myModule1OutputDir=createChildDirectory(myOutputDir,"module1");
  assertExcludedFromProject(myOutputDir);
  assertExcludedFromProject(myModule1OutputDir);
  assertTrue(myFileIndex.isExcluded(myModule1OutputDir));
  PsiTestUtil.setCompilerOutputPath(myModule,moduleOutputUrl,true);
  PsiTestUtil.setCompilerOutputPath(myModule2,moduleOutputUrl,false);
  PsiTestUtil.setCompilerOutputPath(myModule2,moduleOutputUrl,true);
  PsiTestUtil.setCompilerOutputPath(myModule3,moduleOutputUrl,false);
  PsiTestUtil.setCompilerOutputPath(myModule3,moduleOutputUrl,true);
  assertExcludedFromProject(myOutputDir);
  VirtualFile projectOutputUnderContent=createChildDirectory(myModule1Dir,"projectOutputUnderContent");
  getCompilerProjectExtension().setCompilerOutputUrl(projectOutputUnderContent.getUrl());
  fireRootsChanged();
  assertNotExcluded(myOutputDir);
  assertExcluded(projectOutputUnderContent,myModule);
  VfsTestUtil.deleteFile(projectOutputUnderContent);
  projectOutputUnderContent=createChildDirectory(myModule1Dir,"projectOutputUnderContent");
  assertNotExcluded(myOutputDir);
  assertExcluded(projectOutputUnderContent,myModule);
}
