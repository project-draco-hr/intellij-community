{
  VirtualFile newDir=myModule1Dir.createChildDirectory(this,"newDir");
  myIndex.checkConsistency();
  assertInProject(newDir);
  final FileTypeManagerEx fileTypeManager=(FileTypeManagerEx)FileTypeManager.getInstance();
  final String list=fileTypeManager.getIgnoredFilesList();
  final String list1=list + ";" + "newDir";
  try {
    ApplicationManager.getApplication().runWriteAction(new Runnable(){
      @Override public void run(){
        fileTypeManager.setIgnoredFilesList(list1);
      }
    }
);
    myIndex.checkConsistency();
    assertNotInProject(newDir);
  }
  finally {
    ApplicationManager.getApplication().runWriteAction(new Runnable(){
      @Override public void run(){
        fileTypeManager.setIgnoredFilesList(list);
      }
    }
);
    assertInProject(newDir);
  }
}
