{
  final VirtualFile dir=createChildDirectory(myModule1Dir,"dir");
  final VirtualFile excluded=createChildDirectory(dir,"excluded");
  PsiTestUtil.addExcludedRoot(myModule,excluded);
  VfsTestUtil.deleteFile(dir);
  boolean created=new File(myModule1Dir.getPath(),"dir/excluded/foo").mkdirs();
  assertTrue(created);
  VirtualFileListener l=new VirtualFileAdapter(){
    @Override public void fileCreated(    @NotNull VirtualFileEvent e){
      assertEquals("dir",e.getFileName());
      VirtualFile file=e.getFile();
      assertInProject(file);
      assertExcluded(file.findFileByRelativePath("excluded"),myModule);
      assertExcluded(file.findFileByRelativePath("excluded/foo"),myModule);
    }
  }
;
  VirtualFileManager.getInstance().addVirtualFileListener(l,getTestRootDisposable());
  VirtualFileManager.getInstance().syncRefresh();
}
