{
  ProjectFileIndex fileIndex=ProjectRootManager.getInstance(myProject).getFileIndex();
  VirtualFile fileRoot=myRootVFile.createChildData(this,"fileRoot.txt");
  VirtualFile fileSourceRoot=myRootVFile.createChildData(this,"fileSourceRoot.txt");
  VirtualFile fileTestSourceRoot=myRootVFile.createChildData(this,"fileTestSourceRoot.txt");
  checkInfoNull(fileRoot);
  assertFalse(fileIndex.isInContent(fileRoot));
  assertIteratedContent(fileIndex,null,Arrays.asList(fileRoot,fileSourceRoot,fileTestSourceRoot));
  ContentEntry contentEntry=PsiTestUtil.addContentRoot(myModule,fileRoot);
  assertSame(fileRoot,contentEntry.getFile());
  checkInfo(fileRoot,myModule,false,false,"",null);
  assertTrue(fileIndex.isInContent(fileRoot));
  assertFalse(fileIndex.isInSource(fileRoot));
  PsiTestUtil.addContentRoot(myModule,fileSourceRoot);
  PsiTestUtil.addSourceRoot(myModule,fileSourceRoot);
  checkInfo(fileSourceRoot,myModule,false,false,"",JavaSourceRootType.SOURCE,myModule);
  assertTrue(fileIndex.isInContent(fileSourceRoot));
  assertTrue(fileIndex.isInSource(fileSourceRoot));
  PsiTestUtil.addContentRoot(myModule,fileTestSourceRoot);
  PsiTestUtil.addSourceRoot(myModule,fileTestSourceRoot,true);
  checkInfo(fileTestSourceRoot,myModule,false,false,"",JavaSourceRootType.TEST_SOURCE,myModule);
  assertTrue(fileIndex.isInContent(fileTestSourceRoot));
  assertTrue(fileIndex.isInSource(fileTestSourceRoot));
  assertIteratedContent(fileIndex,Arrays.asList(fileRoot,fileSourceRoot,fileTestSourceRoot),null);
  PsiTestUtil.removeSourceRoot(myModule,fileTestSourceRoot);
  checkInfo(fileTestSourceRoot,myModule,false,false,"",null);
  assertTrue(fileIndex.isInContent(fileTestSourceRoot));
  assertFalse(fileIndex.isInSource(fileTestSourceRoot));
  assertIteratedContent(fileIndex,Arrays.asList(fileRoot,fileSourceRoot,fileTestSourceRoot),null);
  PsiTestUtil.removeContentEntry(myModule,contentEntry);
  checkInfoNull(fileRoot);
  assertFalse(fileIndex.isInContent(fileRoot));
  assertFalse(fileIndex.isInSource(fileRoot));
  assertIteratedContent(fileIndex,Arrays.asList(fileSourceRoot,fileTestSourceRoot),Arrays.asList(fileRoot));
}
