{
  final VirtualFile ignored=myRootVFile.createChildDirectory(this,"RCS");
  assertTrue(FileTypeManager.getInstance().isFileIgnored(ignored));
  assertTrue(ProjectRootManager.getInstance(myProject).getFileIndex().isExcluded(ignored));
  final VirtualFile module4=ignored.createChildDirectory(this,"module4");
  assertFalse(FileTypeManager.getInstance().isFileIgnored(module4));
  assertTrue(ProjectRootManager.getInstance(myProject).getFileIndex().isExcluded(module4));
  new WriteCommandAction.Simple(getProject()){
    @Override protected void run() throws Throwable {
      ModuleManager moduleManager=ModuleManager.getInstance(myProject);
      Module module=moduleManager.newModule(myRootVFile.getPath() + "/newModule.iml",StdModuleTypes.JAVA.getId());
      PsiTestUtil.addContentRoot(module,module4);
      assertNotInProject(ignored);
      checkInfo(module4,module,false,false,null,null);
    }
  }
.execute().throwException();
}
