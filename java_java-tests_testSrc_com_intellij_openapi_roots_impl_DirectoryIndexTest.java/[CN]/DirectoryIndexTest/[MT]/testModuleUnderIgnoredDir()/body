{
  final VirtualFile ignored=createChildDirectory(myRootVFile,".git");
  assertTrue(FileTypeManager.getInstance().isFileIgnored(ignored));
  assertTrue(myFileIndex.isExcluded(ignored));
  assertTrue(myFileIndex.isUnderIgnored(ignored));
  final VirtualFile module4=createChildDirectory(ignored,"module4");
  assertFalse(FileTypeManager.getInstance().isFileIgnored(module4));
  assertTrue(myFileIndex.isExcluded(module4));
  assertTrue(myFileIndex.isUnderIgnored(module4));
  new WriteCommandAction.Simple(getProject()){
    @Override protected void run() throws Throwable {
      ModuleManager moduleManager=ModuleManager.getInstance(myProject);
      Module module=moduleManager.newModule(myRootVFile.getPath() + "/newModule.iml",StdModuleTypes.JAVA.getId());
      PsiTestUtil.addContentRoot(module,module4);
      assertNotInProject(ignored);
      checkInfo(module4,module,false,false,null,null);
    }
  }
.execute().throwException();
}
