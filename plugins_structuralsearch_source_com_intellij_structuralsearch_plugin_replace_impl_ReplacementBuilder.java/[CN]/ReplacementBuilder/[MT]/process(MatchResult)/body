{
  if (parameterizations == null) {
    return replacement;
  }
  final StringBuffer result=new StringBuffer(replacement);
  map=new HashMap<String,MatchResult>();
  fill(match,map);
  int offset=0;
  for (int i=0; i < parameterizations.size(); ++i) {
    final ParameterInfo info=parameterizations.get(i);
    MatchResult r=map.get(info.name);
    if (r != null) {
      offset=handleSubstitution(info,r,result,offset);
    }
 else {
      if (info.hasCommaBefore) {
        result.delete(info.beforeDelimiterPos + offset,info.beforeDelimiterPos + 1 + offset);
        --offset;
      }
 else       if (info.hasCommaAfter) {
        result.delete(info.afterDelimiterPos + offset,info.afterDelimiterPos + 1 + offset);
        --offset;
      }
 else       if (info.variableInitialContext) {
        result.delete(info.beforeDelimiterPos + offset,info.afterDelimiterPos + offset - 1);
        offset-=(info.afterDelimiterPos - info.beforeDelimiterPos - 1);
      }
      offset=insertSubstitution(result,offset,info,"");
    }
  }
  map.clear();
  return result.toString();
}
