{
  final CoverageEnabledConfiguration coverageEnabledConfiguration=CoverageEnabledConfiguration.get(configuration);
  if (coverageEnabledConfiguration.isCoverageEnabled()) {
    handler.addProcessListener(new ProcessAdapter(){
      public void processTerminated(      final ProcessEvent event){
        handler.removeProcessListener(this);
        final Project project=configuration.getProject();
        if (!project.isDisposed()) {
          final CoverageDataManager coverageDataManager=CoverageDataManager.getInstance(project);
          final CoverageEnabledConfiguration coverageEnabledConfiguration=CoverageEnabledConfiguration.get(configuration);
          final CoverageSuite coverageSuite=coverageEnabledConfiguration.getCurrentCoverageSuite();
          if (coverageSuite != null) {
            coverageDataManager.coverageGathered(coverageSuite);
          }
        }
      }
    }
);
  }
}
