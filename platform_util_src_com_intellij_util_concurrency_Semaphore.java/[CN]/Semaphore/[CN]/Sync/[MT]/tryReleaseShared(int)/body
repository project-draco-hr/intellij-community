{
  while (true) {
    int c=getState();
    if (c == 0)     return false;
    int next=c - 1;
    if (compareAndSetState(c,next))     return next == 0;
  }
}
