{
  int bytesToRead=buffer.length;
  int bytesSoFar=0;
  while (bytesSoFar < buffer.length) {
    int bytesRead=inputStream.read(buffer,bytesSoFar,bytesToRead);
    if (bytesRead <= 0) {
      throw new EOFException();
    }
    bytesSoFar+=bytesRead;
    bytesToRead-=bytesRead;
  }
}
