{
  final List<VcsException> exception=new ArrayList<VcsException>();
  final List<File> committables=getCommitables(paths);
  final SVNCommitClient committer=mySvnVcs.createCommitClient();
  final ProgressIndicator progress=ProgressManager.getInstance().getProgressIndicator();
  IdeaCommitHandler handler=new IdeaCommitHandler(progress,true,true);
  if (progress != null) {
    committer.setEventHandler(handler);
  }
  if (progress != null) {
    doCommit(committables,committer,comment,force,exception,feedback);
  }
 else   if (ApplicationManager.getApplication().isDispatchThread()) {
    ProgressManager.getInstance().runProcessWithProgressSynchronously(new Runnable(){
      public void run(){
        doCommit(committables,committer,comment,force,exception,feedback);
      }
    }
,SvnBundle.message("progress.title.commit"),false,mySvnVcs.getProject());
  }
 else {
    doCommit(committables,committer,comment,force,exception,feedback);
  }
  for (  VirtualFile f : handler.getDeletedFiles()) {
    f.putUserData(VirtualFile.REQUESTOR_MARKER,this);
  }
  return exception;
}
