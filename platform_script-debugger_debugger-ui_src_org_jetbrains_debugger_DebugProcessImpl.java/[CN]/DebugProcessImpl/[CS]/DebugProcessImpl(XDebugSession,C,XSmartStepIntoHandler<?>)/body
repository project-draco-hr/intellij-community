{
  super(session);
  this.connection=connection;
  this.smartStepIntoHandler=smartStepIntoHandler;
  connection.addListener(new SocketConnectionListener(){
    @Override public void statusChanged(    @NotNull ConnectionStatus status){
      if (status == ConnectionStatus.DISCONNECTED || status == ConnectionStatus.DETACHED) {
        if (status == ConnectionStatus.DETACHED) {
          ProcessHandler processHandler=doGetProcessHandler();
          if (processHandler != null) {
            processHandler.detachProcess();
          }
        }
        getSession().stop();
      }
 else {
        getSession().rebuildViews();
      }
    }
  }
);
}
