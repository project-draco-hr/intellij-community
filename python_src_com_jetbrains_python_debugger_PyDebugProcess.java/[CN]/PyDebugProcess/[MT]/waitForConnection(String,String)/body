{
  ProgressManager.getInstance().run(new Task.Backgroundable(getSession().getProject(),connectionTitle,false){
    public void run(    @NotNull final ProgressIndicator indicator){
      indicator.setText(connectionMessage);
      try {
        beforeConnect();
        myWaitingForConnection=true;
        myDebugger.waitForConnect();
        myWaitingForConnection=false;
        afterConnect();
        handshake();
        init();
        myDebugger.run();
      }
 catch (      final Exception e) {
        myWaitingForConnection=false;
        if (myProcessHandler != null) {
          myProcessHandler.destroyProcess();
        }
        if (!myClosing) {
          invokeLater(new Runnable(){
            public void run(){
              Messages.showErrorDialog("Unable to establish connection with debugger:\n" + e.getMessage(),getConnectionTitle());
            }
          }
);
        }
      }
    }
  }
);
}
