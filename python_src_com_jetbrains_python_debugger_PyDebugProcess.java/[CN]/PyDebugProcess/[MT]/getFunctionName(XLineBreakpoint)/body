{
  final VirtualFile file=breakpoint.getSourcePosition().getFile();
  AccessToken lock=ApplicationManager.getApplication().acquireReadActionLock();
  try {
    final Document document=FileDocumentManager.getInstance().getDocument(file);
    final Project project=getSession().getProject();
    final String[] funcName=new String[1];
    if (document != null) {
      if (file.getFileType() == PythonFileType.INSTANCE) {
        PsiElement psiElement=XDebuggerUtil.getInstance().findContextElement(file,breakpoint.getSourcePosition().getOffset(),project,false);
        PyFunction function=PsiTreeUtil.getParentOfType(psiElement,PyFunction.class);
        if (function != null) {
          funcName[0]=function.getName();
        }
      }
    }
    return funcName[0];
  }
  finally {
    lock.finish();
  }
}
