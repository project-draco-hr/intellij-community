{
  super(session);
  session.setPauseActionSupported(true);
  if (multiProcess) {
    myDebugger=createMultiprocessDebugger(serverSocket);
  }
 else {
    myDebugger=new RemoteDebugger(this,serverSocket,getConnectTimeout());
  }
  myBreakpointHandlers=new XBreakpointHandler[]{new PyLineBreakpointHandler(this),new PyExceptionBreakpointHandler(this),new DjangoLineBreakpointHandler(this),new DjangoExceptionBreakpointHandler(this)};
  myEditorsProvider=new PyDebuggerEditorsProvider();
  mySmartStepIntoHandler=new PySmartStepIntoHandler(this);
  myProcessHandler=processHandler;
  myExecutionConsole=executionConsole;
  if (myProcessHandler != null) {
    myProcessHandler.addProcessListener(this);
  }
  if (processHandler instanceof RemoteProcessHandlerBase) {
    myPositionConverter=new PyRemotePositionConverter(this,((RemoteProcessHandlerBase)processHandler).getMappingSettings());
  }
 else {
    myPositionConverter=new PyLocalPositionConverter();
  }
  myDebugger.addCloseListener(new RemoteDebuggerCloseListener(){
    @Override public void closed(){
      handleStop();
    }
    @Override public void communicationError(){
      detachDebuggedProcess();
    }
    @Override public void detached(){
      detachDebuggedProcess();
    }
  }
);
  session.addSessionListener(new XDebugSessionAdapter(){
    @Override public void beforeSessionResume(){
      if (session.getCurrentStackFrame() instanceof PyStackFrame) {
        myStackFrameBeforeResume=(PyStackFrame)session.getCurrentStackFrame();
      }
 else {
        myStackFrameBeforeResume=null;
      }
    }
  }
);
}
