{
  RunnerAndConfigurationSettings settings;
  Module module=location.getModule();
  if (module != null) {
    for (    RunnableUnitTestFilter f : Extensions.getExtensions(RunnableUnitTestFilter.EP_NAME)) {
      if (f.isRunnableUnitTest(location.getPsiElement().getContainingFile(),module)) {
        return null;
      }
    }
  }
  settings=createConfigurationFromFolder(location);
  if (settings != null)   return (RunnerAndConfigurationSettingsImpl)settings;
  final PyElement pyElement=PsiTreeUtil.getParentOfType(location.getPsiElement(),PyElement.class);
  if (pyElement != null) {
    settings=createConfigurationFromFunction(location,pyElement);
    if (settings != null)     return (RunnerAndConfigurationSettingsImpl)settings;
    settings=createConfigurationFromClass(location,pyElement);
    if (settings != null)     return (RunnerAndConfigurationSettingsImpl)settings;
  }
  settings=createConfigurationFromFile(location,location.getPsiElement());
  if (settings != null)   return (RunnerAndConfigurationSettingsImpl)settings;
  return null;
}
