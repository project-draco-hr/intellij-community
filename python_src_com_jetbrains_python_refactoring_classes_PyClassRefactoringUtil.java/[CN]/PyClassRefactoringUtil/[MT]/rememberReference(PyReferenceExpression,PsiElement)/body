{
  final PyExpression qualifier=node.getQualifier();
  if (qualifier != null && !(resolveExpression(qualifier) instanceof PyImportedModule)) {
    return;
  }
  final PsiElement target=resolveExpression(node);
  if (target instanceof PsiNamedElement && !PsiTreeUtil.isAncestor(element,target,false)) {
    final PyImportElement importElement=getImportElement(node);
    if (!inSameFile(element,target) && importElement == null && !(target instanceof PsiFileSystemItem)) {
      return;
    }
    node.putCopyableUserData(ENCODED_IMPORT,(PsiNamedElement)target);
    if (importElement != null) {
      node.putCopyableUserData(ENCODED_IMPORT_AS,importElement.getAsName());
    }
    node.putCopyableUserData(ENCODED_USE_FROM_IMPORT,qualifier == null);
  }
}
