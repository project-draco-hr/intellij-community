{
  if (PyBuiltinCache.getInstance(element).isBuiltin(element))   return false;
  final PsiFileSystemItem elementSource=element instanceof PsiDirectory ? (PsiFileSystemItem)element : element.getContainingFile();
  final PsiFile file=anchor.getContainingFile();
  if (elementSource == file)   return false;
  final QualifiedName qname=QualifiedNameFinder.findCanonicalImportPath(element,anchor);
  if (qname == null || !isValidQualifiedName(qname)) {
    return false;
  }
  final QualifiedName containingQName;
  final String importedName;
  if (element instanceof PyFile || element instanceof PsiDirectory) {
    containingQName=qname.removeLastComponent();
    importedName=qname.getLastComponent();
  }
 else {
    containingQName=qname;
    importedName=getOriginalName(element);
  }
  final AddImportHelper.ImportPriority priority=AddImportHelper.getImportPriority(anchor,elementSource);
  if (preferFromImport && !containingQName.getComponents().isEmpty()) {
    return AddImportHelper.addOrUpdateFromImportStatement(file,containingQName.toString(),importedName,asName,priority,anchor);
  }
 else {
    return AddImportHelper.addImportStatement(file,containingQName.append(importedName).toString(),asName,priority,anchor);
  }
}
