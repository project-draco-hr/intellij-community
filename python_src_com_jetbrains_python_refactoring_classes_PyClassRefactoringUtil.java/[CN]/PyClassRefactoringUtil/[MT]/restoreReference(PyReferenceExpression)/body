{
  PsiNamedElement target=node.getCopyableUserData(ENCODED_IMPORT);
  if (target instanceof PsiDirectory) {
    target=(PsiNamedElement)PyUtil.turnDirIntoInit(target);
  }
  if (target instanceof PyFunction) {
    final PyFunction f=(PyFunction)target;
    final PyClass c=f.getContainingClass();
    if (c != null && c.findInitOrNew(false) == f) {
      target=c;
    }
  }
  if (target == null)   return;
  if (PyBuiltinCache.getInstance(target).hasInBuiltins(target))   return;
  if (PsiTreeUtil.isAncestor(node.getContainingFile(),target,false))   return;
  AddImportHelper.addImport(target,node.getContainingFile(),node);
  node.putCopyableUserData(ENCODED_IMPORT,null);
}
