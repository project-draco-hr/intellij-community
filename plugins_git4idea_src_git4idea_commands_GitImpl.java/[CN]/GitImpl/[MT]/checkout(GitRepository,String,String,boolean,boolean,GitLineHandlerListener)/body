{
  final GitLineHandler h=new GitLineHandler(repository.getProject(),repository.getRoot(),GitCommand.CHECKOUT);
  h.setSilent(false);
  h.setStdoutSuppressed(false);
  if (force) {
    h.addParameters("--force");
  }
  if (newBranch == null) {
    h.addParameters(detach ? reference + "^0" : reference);
  }
 else {
    h.addParameters("-b",newBranch,reference);
  }
  h.endOptions();
  for (  GitLineHandlerListener listener : listeners) {
    h.addLineListener(listener);
  }
  return run(h);
}
