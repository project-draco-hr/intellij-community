{
  Project project=expression.getProject();
  final ReplaceOptions options=new ReplaceOptions();
  final MatchOptions matchOptions=options.getMatchOptions();
  matchOptions.setFileType(StdFileTypes.JAVA);
  final Replacer replacer=new Replacer(project,null);
  final String replacement=replacer.testReplace(expression.getText(),stringToReplace,replaceByString,options);
  return (PsiExpression)JavaCodeStyleManager.getInstance(project).shortenClassReferences(expression.replace(JavaPsiFacade.getInstance(project).getElementFactory().createExpressionFromText(replacement,expression)));
}
