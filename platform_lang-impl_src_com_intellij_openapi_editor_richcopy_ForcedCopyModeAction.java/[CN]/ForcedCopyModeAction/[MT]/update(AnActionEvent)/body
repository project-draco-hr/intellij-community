{
  Presentation p=e.getPresentation();
  Editor editor=CommonDataKeys.EDITOR.getData(e.getDataContext());
  p.setVisible(RichCopySettings.getInstance().isEnabled() != myRichCopyEnabled && (!e.getPlace().equals(ActionPlaces.EDITOR_POPUP) || editor != null && editor.getSelectionModel().hasSelection(true)));
  p.setEnabled(true);
}
