{
  configureByFile("/codeInsight/slice/backward/" + name + ".java");
  PsiDocumentManager.getInstance(getProject()).commitAllDocuments();
  PsiElement element=new SliceHandler(true).getExpressionAtCaret(getEditor(),getFile());
  assertNotNull(element);
  Collection<HighlightInfo> errors=highlightErrors();
  assertEmpty(errors);
  SliceAnalysisParams params=new SliceAnalysisParams();
  params.scope=new AnalysisScope(getProject());
  params.dataFlowToThis=true;
  SliceUsage usage=LanguageSlicing.getProvider(element).createRootUsage(element,params);
  ToolWindowHeadlessManagerImpl.MockToolWindow toolWindow=new ToolWindowHeadlessManagerImpl.MockToolWindow(myProject);
  SlicePanel panel=new SlicePanel(getProject(),true,new SliceRootNode(getProject(),new DuplicateMap(),usage),false,toolWindow){
    @Override protected void close(){
    }
    @Override public boolean isAutoScroll(){
      return false;
    }
    @Override public void setAutoScroll(    boolean autoScroll){
    }
    @Override public boolean isPreview(){
      return false;
    }
    @Override public void setPreview(    boolean preview){
    }
  }
;
  Disposer.register(getProject(),panel);
  return (SliceTreeStructure)panel.getBuilder().getTreeStructure();
}
