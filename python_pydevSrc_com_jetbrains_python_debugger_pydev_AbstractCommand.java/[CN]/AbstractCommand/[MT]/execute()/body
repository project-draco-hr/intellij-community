{
  final int sequence=myDebugger.getNextSequence();
  final ResponseProcessor<T> processor=getResponseProcessor();
  if (processor != null || isResponseExpected()) {
    myDebugger.placeResponse(sequence,null);
  }
  ProtocolFrame frame=new ProtocolFrame(myCommandCode,sequence,getPayload());
  boolean frameSent=myDebugger.sendFrame(frame);
  if (processor == null && !isResponseExpected())   return;
  if (!frameSent) {
    throw new PyDebuggerException("Couldn't send frame " + myCommandCode);
  }
  frame=myDebugger.waitForResponse(sequence);
  if (frame == null) {
    if (!myDebugger.isConnected()) {
      throw new PyDebuggerException("No connection (command:  " + myCommandCode + " )");
    }
    throw new PyDebuggerException("Timeout waiting for response on " + myCommandCode);
  }
  if (processor != null) {
    processor.processResponse(frame);
  }
 else {
    processResponse(frame);
  }
}
