{
  if (diffPanel.hasDifferences() || data.getHints().contains(HINT_ALLOW_NO_DIFFERENCES)) {
    return false;
  }
  DiffManagerImpl manager=(DiffManagerImpl)DiffManager.getInstance();
  ComparisonPolicy oldPolicy=manager.getComparisonPolicy();
  if (oldPolicy != ComparisonPolicy.DEFAULT) {
    manager.setComparisonPolicy(ComparisonPolicy.DEFAULT);
    Disposable parentDisposable=Disposer.newDisposable();
    DiffPanel maybeDiffPanel=DiffManagerImpl.createDiffPanel(data,window,parentDisposable,this);
    manager.setComparisonPolicy(oldPolicy);
    boolean hasDiffs=maybeDiffPanel.hasDifferences();
    Disposer.dispose(parentDisposable);
    if (hasDiffs) {
      return false;
    }
  }
  return !showMessage || !askForceOpenDiff(data);
}
