{
  File foo=PlatformTestCase.createTempDir("foo");
  Project reloaded=null;
  final Project project=ProjectManager.getInstance().createProject("foo",foo.getPath());
  ;
  try {
    assertNotNull(project);
    FileTemplateManager manager=FileTemplateManager.getInstance(project);
    manager.setCurrentScheme(manager.getProjectScheme());
    FileTemplate template=manager.getTemplate(TEST_TEMPLATE_TXT);
    assertEquals(HI_THERE,template.getText());
    String newText="good bye";
    template.setText(newText);
    assertEquals(newText,manager.getTemplate(TEST_TEMPLATE_TXT).getText());
    PlatformTestUtil.saveProject(project);
    closeProject(project);
    reloaded=ProjectManager.getInstance().loadAndOpenProject(foo.getPath());
    assertNotNull(reloaded);
    manager=FileTemplateManager.getInstance(reloaded);
    assertEquals(manager.getProjectScheme(),manager.getCurrentScheme());
    assertEquals(newText,manager.getTemplate(TEST_TEMPLATE_TXT).getText());
  }
  finally {
    closeProject(project);
    closeProject(reloaded);
  }
}
