{
  myTemplateManager.addTemplate("foo","txt");
  myTemplateManager.setTemplates(FileTemplateManager.DEFAULT_TEMPLATES_CATEGORY,Arrays.asList(myTemplateManager.getAllTemplates()));
  assertNotNull(myTemplateManager.getTemplate("foo.txt"));
  File foo=PlatformTestCase.createTempDir("foo");
  final Project project=ProjectManager.getInstance().createProject("foo",foo.getPath());
  ;
  try {
    assertNotNull(project);
    assertNotNull(FileTemplateManager.getInstance(project).getTemplate("foo.txt"));
  }
  finally {
    if (project != null) {
      ProjectManager.getInstance().closeProject(project);
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        @Override public void run(){
          Disposer.dispose(project);
        }
      }
);
    }
  }
}
