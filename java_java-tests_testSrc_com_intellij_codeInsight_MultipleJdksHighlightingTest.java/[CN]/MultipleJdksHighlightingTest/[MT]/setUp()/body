{
  super.setUp();
  TestFixtureBuilder<IdeaProjectTestFixture> projectBuilder=IdeaTestFixtureFactory.getFixtureFactory().createFixtureBuilder(getName());
  myFixture=JavaTestFixtureFactory.getFixtureFactory().createCodeInsightFixture(projectBuilder.getFixture());
  myFixture.setTestDataPath(PathManagerEx.getTestDataPath() + "/codeInsight/multipleJdks");
  final JavaModuleFixtureBuilder[] builders=new JavaModuleFixtureBuilder[3];
  builders[0]=projectBuilder.addModule(JavaModuleFixtureBuilder.class);
  builders[0].setLanguageLevel(LanguageLevel.JDK_1_3);
  builders[1]=projectBuilder.addModule(JavaModuleFixtureBuilder.class);
  builders[2]=projectBuilder.addModule(JavaModuleFixtureBuilder.class);
  myFixture.setUp();
  myJava3Module=builders[0].getFixture().getModule();
  myJava7Module=builders[1].getFixture().getModule();
  myJava8Module=builders[2].getFixture().getModule();
  ModuleRootModificationUtil.updateModel(myJava3Module,new Consumer<ModifiableRootModel>(){
    @Override public void consume(    ModifiableRootModel model){
      model.addModuleOrderEntry(myJava7Module);
      model.setSdk(IdeaTestUtil.getMockJdk17());
      String contentUrl=VfsUtilCore.pathToUrl(myFixture.getTempDirPath()) + "/java3";
      model.addContentEntry(contentUrl).addSourceFolder(contentUrl,false);
    }
  }
);
  ModuleRootModificationUtil.updateModel(myJava7Module,new Consumer<ModifiableRootModel>(){
    @Override public void consume(    ModifiableRootModel model){
      model.addModuleOrderEntry(myJava8Module);
      model.setSdk(IdeaTestUtil.getMockJdk17());
      String contentUrl=VfsUtilCore.pathToUrl(myFixture.getTempDirPath()) + "/java7";
      model.addContentEntry(contentUrl).addSourceFolder(contentUrl,false);
    }
  }
);
  ModuleRootModificationUtil.updateModel(myJava8Module,new Consumer<ModifiableRootModel>(){
    @Override public void consume(    ModifiableRootModel model){
      model.setSdk(IdeaTestUtil.getMockJdk18());
      String contentUrl=VfsUtilCore.pathToUrl(myFixture.getTempDirPath()) + "/java8";
      model.addContentEntry(contentUrl).addSourceFolder(contentUrl,false);
    }
  }
);
}
