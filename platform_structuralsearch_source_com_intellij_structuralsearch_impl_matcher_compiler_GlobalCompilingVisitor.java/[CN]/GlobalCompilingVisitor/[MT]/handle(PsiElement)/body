{
  if ((!ourFilter.accepts(element) || StructuralSearchUtil.isIdentifier(element)) && context.getPattern().isRealTypedVar(element) && context.getPattern().getHandlerSimple(element) == null) {
    String name=context.getPattern().getTypedVarString(element);
    final SubstitutionHandler handler=(SubstitutionHandler)context.getPattern().getHandler(name);
    if (handler == null)     return;
    context.getPattern().setHandler(element,handler);
    if (context.getOptions().getVariableConstraint(handler.getName()).isPartOfSearchResults()) {
      handler.setTarget(true);
      context.getPattern().setTargetNode(element);
    }
  }
}
