{
  DebuggerManagerThreadImpl.assertIsManagerThread();
  checkValid();
  if (myFrameCount == -1) {
    final ThreadReference threadReference=getThreadReference();
    try {
      myFrameCount=threadReference.frameCount();
    }
 catch (    ObjectCollectedException ignored) {
      myFrameCount=0;
    }
catch (    IncompatibleThreadStateException e) {
      final boolean isSuspended;
      try {
        isSuspended=threadReference.isSuspended();
      }
 catch (      Throwable ignored) {
        throw EvaluateExceptionUtil.createEvaluateException(e);
      }
      if (!isSuspended) {
        throw EvaluateExceptionUtil.createEvaluateException(e);
      }
 else {
        myFrameCount=0;
      }
    }
catch (    InternalException e) {
      LOG.info(e);
      myFrameCount=0;
    }
  }
  return myFrameCount;
}
