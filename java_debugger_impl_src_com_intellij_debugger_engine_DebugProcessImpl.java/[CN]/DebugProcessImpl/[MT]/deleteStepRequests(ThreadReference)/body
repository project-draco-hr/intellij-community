{
  EventRequestManager requestManager=getVirtualMachineProxy().eventRequestManager();
  List<StepRequest> stepRequests=requestManager.stepRequests();
  if (!stepRequests.isEmpty()) {
    final List<StepRequest> toDelete=new ArrayList<>(stepRequests.size());
    for (    final StepRequest request : stepRequests) {
      ThreadReference threadReference=request.thread();
      try {
        if (threadReference.status() != ThreadReference.THREAD_STATUS_UNKNOWN && (stepThread == null || stepThread.equals(threadReference))) {
          toDelete.add(request);
        }
      }
 catch (      IllegalThreadStateException e) {
        LOG.info(e);
      }
catch (      ObjectCollectedException ignored) {
      }
    }
    requestManager.deleteEventRequests(toDelete);
  }
}
