{
  if (!(o instanceof PsiCapturedWildcardType)) {
    return false;
  }
  final PsiCapturedWildcardType captured=(PsiCapturedWildcardType)o;
  if (!myContext.equals(captured.myContext) || myExistential.isSuper() && !myExistential.equals(captured.myExistential)) {
    return false;
  }
  if ((myContext instanceof PsiReferenceExpression || myContext instanceof PsiMethodCallExpression) && !Comparing.equal(myParameter,captured.myParameter)) {
    return false;
  }
  if (myParameter != null) {
    final Boolean sameUpperBounds=guard.doPreventingRecursion(myContext,true,new Computable<Boolean>(){
      @Override public Boolean compute(){
        return Comparing.equal(myUpperBound,captured.myUpperBound);
      }
    }
);
    if (sameUpperBounds != null && sameUpperBounds) {
      return true;
    }
  }
  return myExistential.equals(captured.myExistential);
}
