{
  if (!(o instanceof PsiCapturedWildcardType)) {
    return false;
  }
  final PsiCapturedWildcardType captured=(PsiCapturedWildcardType)o;
  final PsiManager manager=myContext.getManager();
  if (!manager.areElementsEquivalent(myContext,captured.myContext)) {
    return false;
  }
  if ((myExistential.isSuper() || captured.myExistential.isSuper()) && !myExistential.equals(captured.myExistential)) {
    return false;
  }
  if ((myContext instanceof PsiReferenceExpression || myContext instanceof PsiMethodCallExpression) && !manager.areElementsEquivalent(myParameter,captured.myParameter)) {
    return false;
  }
  if (myParameter != null) {
    final Boolean sameUpperBounds=guard.doPreventingRecursion(myContext,true,new Computable<Boolean>(){
      @Override public Boolean compute(){
        return Comparing.equal(myUpperBound,captured.myUpperBound);
      }
    }
);
    if (sameUpperBounds == null || sameUpperBounds) {
      return true;
    }
  }
  return myExistential.equals(captured.myExistential);
}
