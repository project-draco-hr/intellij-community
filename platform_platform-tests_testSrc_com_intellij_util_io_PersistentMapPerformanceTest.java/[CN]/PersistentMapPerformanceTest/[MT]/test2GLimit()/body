{
  File file=FileUtil.createTempFile("persistent","map");
  FileUtil.createParentDirs(file);
  PersistentHashMap<String,String> map=null;
  try {
    map=new PersistentHashMap<>(file,EnumeratorStringDescriptor.INSTANCE,EnumeratorStringDescriptor.INSTANCE);
    for (int i=0; i < 12000; i++) {
      map.put("abc" + i,StringUtil.repeat("0123456789",10000));
    }
    map.close();
    map=new PersistentHashMap<>(file,EnumeratorStringDescriptor.INSTANCE,EnumeratorStringDescriptor.INSTANCE);
    long len=0;
    for (    String key : map.getAllKeysWithExistingMapping()) {
      len+=map.get(key).length();
    }
    assertEquals(1200000000L,len);
  }
  finally {
    clearMap(file,map);
  }
}
