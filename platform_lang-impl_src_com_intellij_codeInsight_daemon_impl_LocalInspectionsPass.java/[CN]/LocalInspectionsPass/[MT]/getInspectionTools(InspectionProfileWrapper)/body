{
  final InspectionToolWrapper[] toolWrappers=profile.getInspectionProfile().getInspectionTools(getFile());
  InspectionProfileWrapper.checkInspectionsDuplicates(toolWrappers);
  List<LocalInspectionToolWrapper> enabled=new ArrayList<>();
  for (  InspectionToolWrapper toolWrapper : toolWrappers) {
    ProgressManager.checkCanceled();
    final HighlightDisplayKey key=HighlightDisplayKey.find(toolWrapper.getShortName());
    if (!profile.isToolEnabled(key,getFile()))     continue;
    if (HighlightDisplayLevel.DO_NOT_SHOW.equals(profile.getErrorLevel(key,getFile())))     continue;
    LocalInspectionToolWrapper wrapper=null;
    if (toolWrapper instanceof LocalInspectionToolWrapper) {
      wrapper=(LocalInspectionToolWrapper)toolWrapper;
    }
 else     if (toolWrapper instanceof GlobalInspectionToolWrapper) {
      final GlobalInspectionToolWrapper globalInspectionToolWrapper=(GlobalInspectionToolWrapper)toolWrapper;
      wrapper=globalInspectionToolWrapper.getSharedLocalInspectionToolWrapper();
    }
    if (wrapper == null)     continue;
    String language=wrapper.getLanguage();
    if (language != null && Language.findLanguageByID(language) == null) {
      continue;
    }
    if (myIgnoreSuppressed && SuppressionUtil.inspectionResultSuppressed(getFile(),wrapper.getTool())) {
      continue;
    }
    enabled.add(wrapper);
  }
  return enabled;
}
