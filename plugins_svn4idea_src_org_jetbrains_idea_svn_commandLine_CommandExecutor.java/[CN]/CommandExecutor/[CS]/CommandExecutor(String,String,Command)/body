{
  myCommand=command;
  myResultBuilder=command.getResultBuilder();
  if (myResultBuilder != null) {
    myListeners.addListener(myResultBuilder);
    myListeners.addListener(new CommandCancelTracker());
  }
  myLock=new Object();
  myTempFiles=ContainerUtil.newArrayList();
  myCommandLine=createCommandLine();
  myCommandLine.setExePath(exePath);
  myCommandLine.setWorkDirectory(command.getWorkingDirectory());
  if (command.getConfigDir() != null) {
    myCommandLine.addParameters("--config-dir",command.getConfigDir().getPath());
  }
  myCommandLine.addParameter(command.getName().getName());
  myCommandLine.addParameters(prepareParameters(command));
  myLocale=locale;
  myExitCodeReference=new AtomicReference<Integer>();
}
