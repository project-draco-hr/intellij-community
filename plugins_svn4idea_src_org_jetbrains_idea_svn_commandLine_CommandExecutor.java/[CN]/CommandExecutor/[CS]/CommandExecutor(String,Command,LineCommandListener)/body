{
  myCommand=command;
  myResultBuilder=resultBuilder;
  if (resultBuilder != null) {
    myListeners.addListener(resultBuilder);
    myListeners.addListener(new CommandCancelTracker());
  }
  myLock=new Object();
  myCommandLine=new GeneralCommandLine();
  myCommandLine.setExePath(exePath);
  myCommandLine.setWorkDirectory(command.getWorkingDirectory());
  if (command.getConfigDir() != null) {
    myCommandLine.addParameters("--config-dir",command.getConfigDir().getPath());
  }
  myCommandLine.addParameter(command.getName().getName());
  myCommandLine.addParameters(command.getParameters());
  myExitCodeReference=new AtomicReference<Integer>();
  myExceptionRef=new AtomicReference<Throwable>();
}
