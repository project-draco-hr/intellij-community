{
  List<String> attributes=StringUtil.split(line,HgChangesetUtil.ITEM_SEPARATOR,true,false);
  int numAttributes=attributes.size();
  if (numAttributes <= AUTHOR_INDEX) {
    LOG.info("Hg Log Command was cancelled or failed");
    return null;
  }
  try {
    String revisionString=attributes.get(REVISION_INDEX);
    String changeset=attributes.get(CHANGESET_INDEX);
    String parentsString=attributes.get(PARENTS_INDEX);
    SmartList<HgRevisionNumber> parents=parseParentRevisions(parentsString,revisionString);
    Date revisionDate=DATE_FORMAT.parse(attributes.get(DATE_INDEX));
    Pair<String,String> authorAndEmail=HgUtil.parseUserNameAndEmail(attributes.get(AUTHOR_INDEX));
    return convertDetails(revisionString,changeset,parents,revisionDate,authorAndEmail.first,authorAndEmail.second,attributes);
  }
 catch (  ParseException e) {
    LOG.warn("Error parsing date in line " + line);
    return null;
  }
}
