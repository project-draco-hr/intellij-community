{
  final List<OrderRoot> roots=filterAlreadyAdded(chosenRoots,moduleLibrariesModel);
  if (roots.isEmpty()) {
    return Collections.emptyList();
  }
  final List<Library> addedLibraries=new ArrayList<Library>();
  boolean onlyClasses=true;
  for (  OrderRoot root : roots) {
    onlyClasses&=root.getType() == OrderRootType.CLASSES;
  }
  if (onlyClasses) {
    for (    OrderRoot root : roots) {
      addedLibraries.add(createLibraryFromRoots(Collections.singletonList(root),libraryType,moduleLibrariesModel,defaultPropertiesFactory));
    }
  }
 else {
    addedLibraries.add(createLibraryFromRoots(roots,libraryType,moduleLibrariesModel,defaultPropertiesFactory));
  }
  return addedLibraries;
}
