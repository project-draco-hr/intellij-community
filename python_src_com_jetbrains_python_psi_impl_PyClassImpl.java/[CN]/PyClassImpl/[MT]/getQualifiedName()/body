{
  String name=getName();
  final PyClassStub stub=getStub();
  PsiElement ancestor=stub != null ? stub.getParentStub().getPsi() : getParent();
  while (!(ancestor instanceof PsiFile)) {
    if (ancestor == null)     return name;
    if (ancestor instanceof PyClass) {
      name=((PyClass)ancestor).getName() + "." + name;
    }
    ancestor=stub != null ? ((StubBasedPsiElement)ancestor).getStub().getParentStub().getPsi() : ancestor.getParent();
  }
  final String packageName=ResolveImportUtil.findShortestImportableName(this,((PsiFile)ancestor).getVirtualFile());
  return packageName + "." + name;
}
