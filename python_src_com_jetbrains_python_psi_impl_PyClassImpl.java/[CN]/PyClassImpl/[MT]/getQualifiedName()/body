{
  String name=getName();
  final PyClassStub stub=getStub();
  PsiElement ancestor=stub != null ? stub.getParentStub().getPsi() : getParent();
  while (!(ancestor instanceof PsiFile)) {
    if (ancestor == null)     return name;
    if (ancestor instanceof PyClass) {
      name=((PyClass)ancestor).getName() + "." + name;
    }
    ancestor=stub != null ? ((StubBasedPsiElement)ancestor).getStub().getParentStub().getPsi() : ancestor.getParent();
  }
  PsiFile psiFile=((PsiFile)ancestor).getOriginalFile();
  VirtualFile vFile=psiFile.getVirtualFile();
  if (vFile != null) {
    final String packageName=ResolveImportUtil.findShortestImportableName(this,vFile);
    return packageName + "." + name;
  }
  return name;
}
