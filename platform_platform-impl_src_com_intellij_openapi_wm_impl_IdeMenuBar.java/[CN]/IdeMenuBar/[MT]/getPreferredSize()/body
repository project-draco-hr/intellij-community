{
  Dimension dimension=super.getPreferredSize();
  if (getState().isInProgress()) {
    dimension.height=COLLAPSED_HEIGHT + (int)((getState() == State.COLLAPSING ? (1 - myProgress) : myProgress) * (dimension.height - COLLAPSED_HEIGHT));
  }
 else   if (getState() == State.COLLAPSED) {
    dimension.height=COLLAPSED_HEIGHT;
  }
  return dimension;
}
