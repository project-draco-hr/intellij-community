{
  GitLineHandler handler=new GitLineHandler(project,root,GitCommand.CHERRY);
  handler.addParameters(currentBranch,comparedBranch);
  final TIntHashSet pickedCommits=new TIntHashSet();
  handler.addLineListener(new GitLineHandlerAdapter(){
    @Override public void onLineAvailable(    String line,    Key outputType){
      if (line.startsWith("+")) {
        try {
          line=line.substring(2).trim();
          int firstSpace=line.indexOf(' ');
          if (firstSpace > 0) {
            line=line.substring(0,firstSpace);
          }
          Hash hash=HashImpl.build(line);
          pickedCommits.add(dataProvider.getCommitIndex(hash,root));
        }
 catch (        Exception e) {
          LOG.error("Couldn't parse line [" + line + "]");
        }
      }
    }
  }
);
  handler.runInCurrentThread(null);
  return pickedCommits;
}
