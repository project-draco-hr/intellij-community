{
  PsiElement[] children=element.getChildren();
  boolean stopOnFields=Registry.is("ide.structural.navigation.visit.fields");
  for (  PsiElement child : children) {
    if (child instanceof PsiMethod || child instanceof PsiClass || stopOnFields && child instanceof PsiField) {
      array.add(child);
      addNavigationElements(array,child);
    }
    if (element instanceof PsiClass && child instanceof PsiJavaToken && child.getText().equals("}")) {
      array.add(child);
    }
  }
}
