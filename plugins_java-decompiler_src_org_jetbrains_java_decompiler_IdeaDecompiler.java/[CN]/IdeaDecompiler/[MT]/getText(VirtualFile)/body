{
  if (!canHandle(file)) {
    return ClsFileImpl.decompile(file);
  }
  try {
    Map<String,VirtualFile> files=ContainerUtil.newLinkedHashMap();
    files.put(file.getPath(),file);
    String mask=file.getNameWithoutExtension() + "$";
    for (    VirtualFile child : file.getParent().getChildren()) {
      if (child.getNameWithoutExtension().startsWith(mask) && file.getFileType() == StdFileTypes.CLASS) {
        files.put(child.getPath(),child);
      }
    }
    MyBytecodeProvider provider=new MyBytecodeProvider(files);
    MyResultSaver saver=new MyResultSaver();
    BaseDecompiler decompiler=new BaseDecompiler(provider,saver,myOptions,myLogger);
    for (    String path : files.keySet()) {
      decompiler.addSpace(new File(path),true);
    }
    decompiler.decompileContext();
    return BANNER + saver.myResult;
  }
 catch (  Exception e) {
    LOG.error(file.getUrl(),e);
    return ClsFileImpl.decompile(file);
  }
}
