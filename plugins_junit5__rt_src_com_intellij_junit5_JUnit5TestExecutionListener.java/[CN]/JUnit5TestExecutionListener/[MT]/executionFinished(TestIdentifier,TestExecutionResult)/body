{
  final String displayName=testIdentifier.getDisplayName();
  if (testIdentifier.isTest()) {
    final TestExecutionResult.Status status=testExecutionResult.getStatus();
    final long duration=System.currentTimeMillis() - myCurrentTestStart;
    final Optional<Throwable> throwableOptional=testExecutionResult.getThrowable();
    if (status == TestExecutionResult.Status.FAILED) {
      testFailure(throwableOptional,MapSerializerUtil.TEST_FAILED,testIdentifier,duration);
    }
 else     if (status == TestExecutionResult.Status.ABORTED) {
      testFailure(throwableOptional,MapSerializerUtil.TEST_IGNORED,testIdentifier,duration);
    }
    testFinished(testIdentifier,duration);
  }
 else {
    myPrintStream.println("##teamcity[testSuiteFinished " + idAndName(testIdentifier,displayName) + "\']");
  }
}
