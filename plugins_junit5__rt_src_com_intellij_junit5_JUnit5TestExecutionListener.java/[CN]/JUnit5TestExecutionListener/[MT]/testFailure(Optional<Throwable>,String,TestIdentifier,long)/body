{
  final Map<String,String> attrs=new HashMap<>();
  attrs.put("name",testIdentifier.getDisplayName());
  attrs.put("id",testIdentifier.getUniqueId().toString());
  if (duration > 0) {
    attrs.put("duration",Long.toString(duration));
  }
  try {
    if (failure.isPresent()) {
      final Throwable ex=failure.get();
      final StringWriter stringWriter=new StringWriter();
      final PrintWriter writer=new PrintWriter(stringWriter);
      ex.printStackTrace(writer);
      ComparisonFailureData.registerSMAttributes(null,stringWriter.toString(),ex.getMessage(),attrs,ex);
    }
  }
  finally {
    myPrintStream.println("\n" + MapSerializerUtil.asString(messageName,attrs));
  }
}
