{
  final Project project=CommonDataKeys.PROJECT.getData(dataContext);
  if (project != null && !project.isDefault()) {
    PostprocessReformattingAspect.getInstance(project).disablePostprocessFormattingInside(new Runnable(){
      @Override public void run(){
        executeWriteActionInner(editor,caret,getExtendedContext(dataContext,project,caret),project);
      }
    }
);
  }
 else {
    executeWriteActionInner(editor,caret,dataContext,project);
  }
}
