{
  GlobalSearchScope scope=getSearchScope(klass,false);
  PsiShortNamesCache cache=PsiShortNamesCache.getInstance(klass.getProject());
  String klassName=klass.getName();
  Pattern pattern=Pattern.compile(".*" + StringUtil.escapeToRegexp(klassName) + ".*",Pattern.CASE_INSENSITIVE);
  HashSet<String> names=new HashSet<String>();
  cache.getAllClassNames(names);
  final TestFrameworks frameworks=TestFrameworks.getInstance();
  for (  String eachName : names) {
    if (pattern.matcher(eachName).matches()) {
      for (      PsiClass eachClass : cache.getClassesByName(eachName,scope)) {
        if (eachClass.isPhysical() && (frameworks.isTestClass(eachClass) || frameworks.isPotentialTestClass(eachClass))) {
          if (!processor.process(Pair.create(eachClass,TestFinderHelper.calcTestNameProximity(klassName,eachName)))) {
            return true;
          }
        }
      }
    }
  }
  return false;
}
