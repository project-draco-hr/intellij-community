{
  try {
    if (!migratedType.isValid()) {
      migratedType=JavaPsiFacade.getElementFactory(project).createTypeByFQClassName(migratedType.getCanonicalText());
    }
    final PsiTypeElement typeElement=JavaPsiFacade.getInstance(project).getElementFactory().createTypeElement(migratedType);
    if (element instanceof PsiMethod) {
      final PsiTypeElement returnTypeElement=((PsiMethod)element).getReturnTypeElement();
      if (returnTypeElement != null) {
        final PsiElement replaced=returnTypeElement.replace(typeElement);
        JavaCodeStyleManager.getInstance(project).shortenClassReferences(replaced);
      }
    }
 else     if (element instanceof PsiVariable) {
      final PsiTypeElement varTypeElement=((PsiVariable)element).getTypeElement();
      if (varTypeElement != null) {
        final PsiElement replaced=varTypeElement.replace(typeElement);
        JavaCodeStyleManager.getInstance(project).shortenClassReferences(replaced);
      }
    }
 else {
      LOG.error("Must not happen: " + element.getClass().getName());
    }
  }
 catch (  IncorrectOperationException e) {
    LOG.error(e);
  }
}
