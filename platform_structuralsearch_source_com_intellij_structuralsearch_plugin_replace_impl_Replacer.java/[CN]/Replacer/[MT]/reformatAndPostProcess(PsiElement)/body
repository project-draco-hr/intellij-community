{
  if (elementParent == null)   return;
  final Runnable action=new Runnable(){
    public void run(){
      final PsiFile containingFile=elementParent.getContainingFile();
      if (containingFile != null && options.isToReformatAccordingToStyle()) {
        if (containingFile.getVirtualFile() != null) {
          PsiDocumentManager.getInstance(project).commitDocument(FileDocumentManager.getInstance().getDocument(containingFile.getVirtualFile()));
        }
        final int parentOffset=elementParent.getTextRange().getStartOffset();
        CodeStyleManager.getInstance(project).reformatRange(containingFile,parentOffset,parentOffset + elementParent.getTextLength(),true);
      }
      if (replaceHandler != null) {
        replaceHandler.postProcess(elementParent,options);
      }
    }
  }
;
  CommandProcessor.getInstance().executeCommand(project,new Runnable(){
    public void run(){
      ApplicationManager.getApplication().runWriteAction(action);
    }
  }
,"reformat and shorten refs after ssr","test");
}
