{
  if (getOperator() == PyTokenTypes.NOT_KEYWORD) {
    return PyBuiltinCache.getInstance(this).getBoolType();
  }
  final boolean isAwait=getOperator() == PyTokenTypes.AWAIT_KEYWORD;
  if (isAwait) {
    final PyExpression operand=getOperand();
    if (operand != null) {
      final PyType operandType=context.getType(operand);
      final PyType type=getGeneratorReturnType(operandType,context);
      if (type != null) {
        return type;
      }
    }
  }
  final PsiReference ref=getReference(PyResolveContext.noImplicits().withTypeEvalContext(context));
  final PsiElement resolved=ref.resolve();
  if (resolved instanceof PyCallable) {
    final PyType returnType=((PyCallable)resolved).getReturnType(context,key);
    return isAwait ? getGeneratorReturnType(returnType,context) : returnType;
  }
  return null;
}
