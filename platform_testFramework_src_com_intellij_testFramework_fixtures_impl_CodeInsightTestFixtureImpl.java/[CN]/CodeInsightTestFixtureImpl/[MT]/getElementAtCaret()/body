{
  assertInitialized();
  Editor editor=getCompletionEditor();
  int findTargetFlags=TargetElementUtil.REFERENCED_ELEMENT_ACCEPTED | TargetElementUtil.ELEMENT_NAME_ACCEPTED;
  PsiElement element=TargetElementUtil.findTargetElement(editor,findTargetFlags);
  if (element == null && editor instanceof EditorWindow) {
    element=TargetElementUtil.findTargetElement(((EditorWindow)editor).getDelegate(),findTargetFlags);
  }
  if (element == null) {
    Assert.fail("element not found in file " + myFile.getName() + " at caret position offset "+ myEditor.getCaretModel().getOffset()+ ","+ " psi structure:\n"+ DebugUtil.psiToString(getFile(),true,true));
  }
  return element;
}
