{
  assertInitialized();
  Editor editor=getCompletionEditor();
  int findTargetFlags=TargetElementUtilBase.REFERENCED_ELEMENT_ACCEPTED | TargetElementUtilBase.ELEMENT_NAME_ACCEPTED;
  PsiElement element=TargetElementUtilBase.findTargetElement(editor,findTargetFlags);
  if (element == null && editor instanceof EditorWindow) {
    element=TargetElementUtilBase.findTargetElement(((EditorWindow)editor).getDelegate(),findTargetFlags);
  }
  if (element == null) {
    Assert.fail("element not found in file " + myFile.getName() + " at caret position, offset "+ myEditor.getCaretModel().getOffset()+ "\""+ " psi structure: "+ DebugUtil.psiToString(getFile(),true,true));
  }
  return element;
}
