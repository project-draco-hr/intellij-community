{
  init("aa bb cc dd ee<caret> ff gg hh ii jj",TestFileType.TEXT);
  EditorTestUtil.configureSoftWraps(myEditor,8);
  verifySoftWrapPositions(6,12,18,24);
  final IncrementalCacheUpdateEvent[] event=new IncrementalCacheUpdateEvent[1];
  ((SoftWrapModelImpl)myEditor.getSoftWrapModel()).getApplianceManager().addListener(new SoftWrapAwareDocumentParsingListenerAdapter(){
    @Override public void onRecalculationEnd(    @NotNull IncrementalCacheUpdateEvent e){
      assertNull(event[0]);
      event[0]=e;
    }
  }
);
  type(' ');
  verifySoftWrapPositions(6,12,19,25);
  assertNotNull(event[0]);
  assertEquals(6,event[0].getStartOffset());
  assertEquals(19,event[0].getActualEndOffset());
}
