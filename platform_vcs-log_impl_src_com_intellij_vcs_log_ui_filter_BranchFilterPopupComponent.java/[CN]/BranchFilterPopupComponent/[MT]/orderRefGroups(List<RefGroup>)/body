{
  DefaultActionGroup singletonGroup=new DefaultActionGroup();
  DefaultActionGroup expandedGroup=new DefaultActionGroup();
  DefaultActionGroup collapsedGroup=new DefaultActionGroup();
  for (  RefGroup group : groups) {
    if (group.getRefs().size() == 1) {
      singletonGroup.add(new SetValueAction(group.getRefs().iterator().next().getName(),this));
    }
 else     if (group.isExpanded()) {
      expandedGroup.addSeparator(group.getName());
      expandedGroup.add(createActionGroup(group,false));
    }
 else {
      collapsedGroup.add(createActionGroup(group,true));
    }
  }
  return Arrays.asList(singletonGroup,expandedGroup,Separator.getInstance(),collapsedGroup);
}
