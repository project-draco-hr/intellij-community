{
  Editor editor=e.getData(CommonDataKeys.EDITOR);
  final ThreeSide side=getEditorSide(editor);
  if (editor == null || side == null)   return;
  final List<TextMergeChange> selectedChanges=getSelectedChanges(side);
  if (selectedChanges.isEmpty())   return;
  DocumentEx document=getEditor(ThreeSide.BASE).getDocument();
  String title=e.getPresentation().getText() + " in merge";
  getEditor(ThreeSide.BASE).getDocument().setInBulkUpdate(true);
  enterBulkChangeUpdateBlock();
  try {
    DiffUtil.executeWriteCommand(document,e.getProject(),title,new Runnable(){
      @Override public void run(){
        apply(side,selectedChanges);
      }
    }
);
  }
  finally {
    exitBulkChangeUpdateBlock();
    getEditor(ThreeSide.BASE).getDocument().setInBulkUpdate(false);
  }
}
