{
  Editor editor=e.getData(CommonDataKeys.EDITOR);
  final ThreeSide side=getEditorSide(editor);
  if (editor == null || side == null)   return;
  final List<TextMergeChange> selectedChanges=getSelectedChanges(side);
  if (selectedChanges.isEmpty())   return;
  String title=e.getPresentation().getText() + " in merge";
  getEditor(ThreeSide.BASE).getDocument().setInBulkUpdate(true);
  try {
    executeMergeCommand(title,selectedChanges,new Runnable(){
      @Override public void run(){
        apply(side,selectedChanges);
      }
    }
);
  }
  finally {
    getEditor(ThreeSide.BASE).getDocument().setInBulkUpdate(false);
  }
}
