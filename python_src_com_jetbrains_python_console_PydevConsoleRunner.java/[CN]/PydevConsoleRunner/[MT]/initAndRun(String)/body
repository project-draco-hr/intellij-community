{
  super.initAndRun();
  if (handshake()) {
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      @Override public void run(){
        final PydevLanguageConsoleView consoleView=(PydevLanguageConsoleView)getConsoleView();
        consoleView.setConsoleCommunication(myPydevConsoleCommunication);
        consoleView.setExecutionHandler(getConsoleExecuteActionHandler());
        myProcessHandler.addProcessListener(new ProcessAdapter(){
          @Override public void onTextAvailable(          ProcessEvent event,          Key outputType){
            String text=event.getText();
            PyConsoleHighlightingUtil.processOutput(consoleView.getConsole(),text,outputType);
          }
        }
);
        enableConsoleExecuteAction();
        consoleView.executeStatement(PYTHON_ENV_COMMAND,ProcessOutputTypes.SYSTEM);
        for (        String statement : statements2execute) {
          consoleView.executeStatement(statement + "\n",ProcessOutputTypes.SYSTEM);
        }
        consoleView.flushUIUpdates();
        fireConsoleInitializedEvent();
      }
    }
);
  }
 else {
    final LanguageConsoleImpl console=getConsoleView().getConsole();
    PyConsoleHighlightingUtil.processOutput(console,"Couldn't connect to console process.",ProcessOutputTypes.STDERR);
    myProcessHandler.destroyProcess();
    finishConsole();
  }
}
