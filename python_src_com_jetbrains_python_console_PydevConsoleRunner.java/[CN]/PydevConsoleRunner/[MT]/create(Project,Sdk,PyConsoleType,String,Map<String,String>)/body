{
  final int[] ports;
  try {
    ports=NetUtils.findAvailableSocketPorts(2);
  }
 catch (  IOException e) {
    ExecutionHelper.showErrors(project,Arrays.<Exception>asList(e),consoleType.getTitle(),null);
    return null;
  }
  final ArrayList<String> args=new ArrayList<String>();
  args.add(sdk.getHomePath());
  final String versionString=sdk.getVersionString();
  if (versionString == null || !versionString.toLowerCase().contains("jython")) {
    args.add("-u");
  }
  args.add(FileUtil.toSystemDependentName(PythonHelpersLocator.getHelperPath(PYDEV_PYDEVCONSOLE_PY)));
  for (  int port : ports) {
    args.add(String.valueOf(port));
  }
  final CommandLineArgumentsProvider provider=new CommandLineArgumentsProvider(){
    public String[] getArguments(){
      return ArrayUtil.toStringArray(args);
    }
    public boolean passParentEnvs(){
      return false;
    }
    public Map<String,String> getAdditionalEnvs(){
      return environmentVariables;
    }
  }
;
  return new PydevConsoleRunner(project,sdk,consoleType,provider,workingDirectory,ports);
}
