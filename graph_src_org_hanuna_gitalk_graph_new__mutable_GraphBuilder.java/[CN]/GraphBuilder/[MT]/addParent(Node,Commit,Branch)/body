{
  UnderdoneNode underdoneNode=notAddedNodes.remove(parentCommit);
  if (underdoneNode == null) {
    notAddedNodes.put(parentCommit,new UnderdoneNode(branch,node));
  }
 else {
    underdoneNode.setSecondUpNode(node);
    underdoneNode.setSecondEdgeBranch(branch);
    int parentRowIndex=getLogIndexOfCommit(parentCommit);
    if (nextRow.getRowIndex() != parentRowIndex) {
      Node edgeNode=new MutableNode(nextRow,underdoneNode.getBranch(),parentCommit,Node.Type.EDGE_NODE);
      createUpEdges(edgeNode,underdoneNode);
      nextRow.addNode(edgeNode);
      notAddedNodes.put(parentCommit,new UnderdoneNode(underdoneNode.getBranch(),edgeNode));
    }
 else {
      notAddedNodes.put(parentCommit,underdoneNode);
    }
  }
}
