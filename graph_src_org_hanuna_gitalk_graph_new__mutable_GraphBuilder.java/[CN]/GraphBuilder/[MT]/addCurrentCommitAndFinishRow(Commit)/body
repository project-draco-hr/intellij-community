{
  UnderdoneNode underdoneNode=notAddedNodes.remove(commit);
  Node node;
  if (underdoneNode == null) {
    node=new SimpleNode(nextRow,new Branch(commit),commit,Node.Type.COMMIT_NODE);
  }
 else {
    node=new SimpleNode(nextRow,underdoneNode.getBranch(),commit,Node.Type.COMMIT_NODE);
    createUpEdges(node,underdoneNode);
  }
  nextRow.addNode(node);
  graph.addRow(nextRow);
  nextRow=new MutableNodeRow(graph,nextRow.getRowIndex() + 1);
  return node;
}
