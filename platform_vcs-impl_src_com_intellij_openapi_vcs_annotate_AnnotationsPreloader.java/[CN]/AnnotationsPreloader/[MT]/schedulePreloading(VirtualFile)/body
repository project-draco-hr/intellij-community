{
  if (myProject.isDisposed() || file.getFileType().isBinary())   return;
  myUpdateQueue.queue(new Update(file){
    @Override public void run(){
      try {
        long start=0;
        if (LOG.isDebugEnabled()) {
          start=System.currentTimeMillis();
        }
        if (!FileEditorManager.getInstance(myProject).isFileOpen(file))         return;
        FileStatus fileStatus=FileStatusManager.getInstance(myProject).getStatus(file);
        if (fileStatus == FileStatus.UNKNOWN || fileStatus == FileStatus.ADDED || fileStatus == FileStatus.IGNORED) {
          return;
        }
        AbstractVcs vcs=ProjectLevelVcsManager.getInstance(myProject).getVcsFor(file);
        if (vcs == null)         return;
        AnnotationProvider annotationProvider=vcs.getAnnotationProvider();
        if (annotationProvider == null || !annotationProvider.isCaching())         return;
        annotationProvider.annotate(file);
        if (LOG.isDebugEnabled()) {
          LOG.debug("Preloaded VCS annotations for ",file.getName()," in ",String.valueOf(System.currentTimeMillis() - start),"ms");
        }
      }
 catch (      VcsException e) {
        LOG.warn(e);
      }
    }
  }
);
}
