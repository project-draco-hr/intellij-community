{
  myEditor=editor;
  myEditor.addPropertyChangeListener(new PropertyChangeListener(){
    @Override public void propertyChange(    PropertyChangeEvent evt){
      if (EditorEx.PROP_COLUMN_MODE.equals(evt.getPropertyName()) && !myEditor.isColumnMode()) {
        for (        CaretImpl caret : myCarets) {
          caret.resetVirtualSelection();
        }
      }
    }
  }
,this);
  myCarets.add(new CaretImpl(myEditor));
  mySelectionMarkerTree=new RangeMarkerTree<>(myEditor.getDocument());
}
