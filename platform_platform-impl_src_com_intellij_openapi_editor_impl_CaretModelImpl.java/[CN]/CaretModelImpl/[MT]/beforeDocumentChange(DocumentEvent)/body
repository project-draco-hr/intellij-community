{
  myIsInUpdate=true;
  if (!myEditor.getDocument().isInBulkUpdate() && e.isWholeTextReplaced()) {
    for (    CaretImpl caret : myCarets) {
      caret.updateCachedStateIfNeeded();
    }
  }
}
