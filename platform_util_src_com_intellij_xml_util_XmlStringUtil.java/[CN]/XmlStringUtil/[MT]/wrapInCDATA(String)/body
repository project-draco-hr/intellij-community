{
  StringBuilder sb=new StringBuilder();
  int cur=0, next, len=str.length();
  while (cur < len) {
    next=StringUtil.indexOf(str,CDATA_END,cur);
    sb.append(CDATA_START).append(str.subSequence(cur,next=next < 0 ? len : next)).append(CDATA_END);
    if (next < len)     sb.append(escapeString(CDATA_END));
    cur=next + CDATA_END.length();
  }
  return sb.toString();
}
