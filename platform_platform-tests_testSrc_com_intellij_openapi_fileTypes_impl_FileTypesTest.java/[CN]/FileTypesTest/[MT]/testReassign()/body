{
  myFileTypeManager.clearForTests();
  myFileTypeManager.initStandardFileTypes();
  myFileTypeManager.initComponent();
  Element element=JDOMUtil.loadDocument("<component name=\"FileTypeManager\" version=\"13\">\n" + "   <extensionMap>\n" + "      <mapping ext=\"zip\" type=\"Velocity Template files\" />\n"+ "   </extensionMap>\n"+ "</component>").getRootElement();
  myFileTypeManager.loadState(element);
  myFileTypeManager.initComponent();
  Map<FileNameMatcher,Pair<FileType,Boolean>> mappings=myFileTypeManager.getRemovedMappings();
  assertEquals(1,mappings.size());
  assertEquals(ArchiveFileType.INSTANCE,mappings.values().iterator().next().first);
  mappings.clear();
  assertEquals(ArchiveFileType.INSTANCE,myFileTypeManager.getFileTypeByExtension("zip"));
  Element map=myFileTypeManager.getState().getChild("extensionMap");
  if (map != null) {
    fail(JDOMUtil.writeElement(map));
  }
}
