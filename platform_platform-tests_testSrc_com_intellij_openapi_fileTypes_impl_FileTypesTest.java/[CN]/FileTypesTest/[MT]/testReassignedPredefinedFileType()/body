{
  final FileType perlFileType=myFileTypeManager.getFileTypeByFileName("foo.pl");
  assertEquals("Perl",perlFileType.getName());
  assertEquals(PlainTextFileType.INSTANCE,myFileTypeManager.getFileTypeByFileName("foo.cgi"));
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      myFileTypeManager.associatePattern(perlFileType,"*.cgi");
    }
  }
);
  assertEquals(perlFileType,myFileTypeManager.getFileTypeByFileName("foo.cgi"));
  Element element=myFileTypeManager.getState();
  myFileTypeManager.loadState(element);
  myFileTypeManager.initComponent();
  assertEquals(perlFileType,myFileTypeManager.getFileTypeByFileName("foo.cgi"));
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      myFileTypeManager.removeAssociatedExtension(perlFileType,"*.cgi");
    }
  }
);
  myFileTypeManager.clearForTests();
  myFileTypeManager.initStandardFileTypes();
  myFileTypeManager.initComponent();
}
