{
  final String[] substrings=element.getText().split("\n");
  if (substrings.length != 1) {
    final StringBuilder replacement=new StringBuilder();
    for (int i=0; i < substrings.length; i++) {
      String string=substrings[i];
      if (trim) {
        string=StringUtil.trimLeading(string);
      }
      if (string.trim().endsWith("\\")) {
        replacement.append(string.substring(0,string.length() - 1));
      }
 else {
        replacement.append(string);
      }
      if (i != substrings.length - 1 && !(element instanceof PyReferenceExpression) && !(element instanceof PyStringLiteralExpression)) {
        replacement.append(" ");
      }
    }
    document.replaceString(element.getTextOffset(),element.getTextOffset() + element.getTextLength(),replacement);
    return true;
  }
  return false;
}
