{
  VcsContext context=VcsContextFactory.SERVICE.getInstance().createContextOn(e);
  Project project=context.getProject();
  if (project == null || project.isDisposed())   return false;
  VirtualFile file=context.getSelectedFile();
  if (file == null || file.isDirectory() || file.getFileType().isBinary())   return false;
  final AbstractVcs vcs=ProjectLevelVcsManager.getInstance(project).getVcsFor(file);
  if (vcs == null)   return false;
  final AnnotationProvider annotationProvider=vcs.getAnnotationProvider();
  if (annotationProvider == null)   return false;
  final FileStatus fileStatus=FileStatusManager.getInstance(project).getStatus(file);
  if (fileStatus == FileStatus.UNKNOWN || fileStatus == FileStatus.ADDED || fileStatus == FileStatus.IGNORED) {
    return false;
  }
  return true;
}
