{
  final PsiFile containingFile=element.getContainingFile();
  if (!(element instanceof PsiQualifiedNamedElement) && !(element instanceof PsiDirectory))   return null;
  final String oldName=getQualifiedName(element);
  RefactoringElementListenerComposite composite=null;
  for (  final NamedScopesHolder holder : NamedScopesHolder.getAllNamedScopeHolders(element.getProject())) {
    final NamedScope[] scopes=holder.getEditableScopes();
    for (int i=0; i < scopes.length; i++) {
      final NamedScope scope=scopes[i];
      final PackageSet packageSet=scope.getValue();
      if (packageSet != null && (containingFile == null || packageSet.contains(containingFile,holder))) {
        composite=traverse(new OldScopeDescriptor(oldName,scope,i,holder),composite,packageSet);
      }
    }
  }
  return composite;
}
