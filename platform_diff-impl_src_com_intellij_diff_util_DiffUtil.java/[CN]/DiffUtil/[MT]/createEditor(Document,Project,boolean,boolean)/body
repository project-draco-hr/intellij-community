{
  EditorFactory factory=EditorFactory.getInstance();
  EditorEx editor=(EditorEx)(isViewer ? factory.createViewer(document,project) : factory.createEditor(document,project));
  editor.putUserData(DiffManagerImpl.EDITOR_IS_DIFF_KEY,Boolean.TRUE);
  editor.setSoftWrapAppliancePlace(SoftWrapAppliancePlaces.VCS_DIFF);
  editor.getSettings().setLineNumbersShown(true);
  ((EditorMarkupModel)editor.getMarkupModel()).setErrorStripeVisible(true);
  editor.getGutterComponentEx().setShowDefaultGutterPopup(false);
  if (enableFolding) {
    editor.getSettings().setFoldingOutlineShown(true);
    editor.getSettings().setCodeFoldingEnabled(false);
  }
 else {
    editor.getSettings().setFoldingOutlineShown(false);
    editor.getFoldingModel().setFoldingEnabled(false);
  }
  UIUtil.removeScrollBorder(editor.getComponent());
  return editor;
}
