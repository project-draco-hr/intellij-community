{
  try {
    try {
      File patchFile=Utils.createTempFile();
      ZipFile zipFile=new ZipFile(jarFile);
      logger.info("Extracting patch file...");
      ui.startProcess("Extracting patch file...");
      ui.setProgressIndeterminate();
      try {
        InputStream in=Utils.getEntryInputStream(zipFile,PATCH_FILE_NAME);
        OutputStream out=new BufferedOutputStream(new FileOutputStream(patchFile));
        try {
          Utils.copyStream(in,out);
        }
  finally {
          in.close();
          out.close();
        }
      }
  finally {
        zipFile.close();
      }
      ui.checkCancelled();
      File destDir=new File(destFolder);
      PatchFileCreator.PreparationResult result=PatchFileCreator.prepareAndValidate(patchFile,destDir,ui);
      Map<String,ValidationResult.Option> options=ui.askUser(result.validationResults);
      return PatchFileCreator.apply(result,options,ui);
    }
 catch (    IOException e) {
      ui.showError(e);
      printStackTrace(e);
    }
  }
  finally {
    try {
      System.gc();
      cleanup(ui);
    }
 catch (    IOException e) {
      ui.showError(e);
      printStackTrace(e);
    }
  }
  return false;
}
