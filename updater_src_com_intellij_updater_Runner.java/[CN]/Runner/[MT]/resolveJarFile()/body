{
  URL url=Runner.class.getResource("");
  if (url == null)   throw new IOException("Cannot resolve JAR file path");
  if (!"jar".equals(url.getProtocol()))   throw new IOException("Patch file is not a JAR file");
  String path=url.getPath();
  int start=path.indexOf("file:/");
  int end=path.indexOf("!/");
  if (start == -1 || end == -1)   throw new IOException("Unknown protocol: " + url);
  String jarFileUrl=path.substring(start,end);
  try {
    return new File(new URI(jarFileUrl)).getAbsolutePath();
  }
 catch (  URISyntaxException e) {
    printStackTrace(e);
    throw new IOException(e.getMessage());
  }
}
