{
  if (logger == null) {
    String logFolder=getLogDir();
    System.out.println("Log dir: " + logFolder);
    FileAppender update=new FileAppender();
    update.setFile(new File(logFolder,"idea_updater.log").getAbsolutePath());
    update.setLayout(new PatternLayout("%d{dd MMM yyyy HH:mm:ss} %-5p %C{1}.%M - %m%n"));
    update.setThreshold(Level.ALL);
    update.setAppend(true);
    update.activateOptions();
    FileAppender updateError=new FileAppender();
    updateError.setFile(new File(logFolder,"idea_updater_error.log").getAbsolutePath());
    updateError.setLayout(new PatternLayout("%d{dd MMM yyyy HH:mm:ss} %-5p %C{1}.%M - %m%n"));
    updateError.setThreshold(Level.ERROR);
    updateError.setAppend(false);
    updateError.activateOptions();
    logger=Logger.getLogger("com.intellij.updater");
    logger.addAppender(updateError);
    logger.addAppender(update);
    logger.setLevel(Level.ALL);
    logger.info("--- Updater started ---");
  }
}
