{
  File gitDirFile=virtualToIoFile(gitDir);
  File commonDir=new File(gitDirFile,"commondir");
  if (!commonDir.exists())   return null;
  String pathToMain;
  try {
    pathToMain=FileUtil.loadFile(commonDir).trim();
  }
 catch (  IOException e) {
    LOG.error("Couldn't load " + commonDir,e);
    return null;
  }
  String mainDir=FileUtil.toCanonicalPath(gitDirFile.getPath() + File.separator + pathToMain,true);
  LocalFileSystem lfs=LocalFileSystem.getInstance();
  VirtualFile mainDirVF=lfs.refreshAndFindFileByPath(mainDir);
  if (mainDirVF != null)   return mainDirVF;
  return lfs.refreshAndFindFileByPath(pathToMain);
}
