{
  final VirtualFile patchFile=filePresentation.getVf();
  if (patchFile == null)   return null;
  patchFile.refresh(false,false);
  if (!patchFile.isValid()) {
    return null;
  }
  PatchReader reader;
  try {
    reader=PatchVirtualFileReader.create(patchFile);
  }
 catch (  IOException e) {
    return null;
  }
  try {
    reader.parseAllPatches();
  }
 catch (  PatchSyntaxException e) {
    return null;
  }
  return reader;
}
