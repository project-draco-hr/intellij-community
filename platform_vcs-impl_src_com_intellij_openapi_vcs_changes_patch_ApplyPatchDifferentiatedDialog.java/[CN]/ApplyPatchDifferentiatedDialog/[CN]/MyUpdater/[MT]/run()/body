{
  final FilePresentation filePresentation=myRecentPathFileChange.get();
  if ((filePresentation == null) || (filePresentation.getVf() == null)) {
    ApplicationManager.getApplication().invokeLater(myReset);
    return;
  }
  final VirtualFile file=filePresentation.getVf();
  final PatchReader patchReader=loadPatches(filePresentation);
  if (patchReader == null)   return;
  List<TextFilePatch> textPatches=patchReader.getPatches();
  final List<FilePatchInProgress> matchedPatches=textPatches != null ? new MatchPatchPaths(myProject).execute(textPatches) : ContainerUtil.<FilePatchInProgress>emptyList();
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    public void run(){
      myChangeListChooser.setDefaultName(file.getNameWithoutExtension().replace('_',' ').trim());
      myPatches.clear();
      myPatches.addAll(matchedPatches);
      myReader=patchReader;
      updateTree(true);
      paintBusy(false);
    }
  }
);
}
