{
  if (ChangeListManager.getInstance(myProject).isFreezedWithNotification(null))   return;
  if (myPatches.isEmpty() || (!myContainBasedChanges))   return;
  final List<AbstractFilePatchInProgress.PatchChange> changes=getAllChanges();
  Collections.sort(changes,myMyChangeComparator);
  List<AbstractFilePatchInProgress.PatchChange> selectedChanges=myChangesTreeList.getSelectedChanges();
  int selectedIdx=0;
  final List<DiffRequestProducer> diffRequestPresentableList=new ArrayList<DiffRequestProducer>(changes.size());
  final List<Change> diffRequestChangeList=new ArrayList<Change>(changes.size());
  if (selectedChanges.isEmpty()) {
    selectedChanges=changes;
  }
  if (!selectedChanges.isEmpty()) {
    final AbstractFilePatchInProgress.PatchChange c=selectedChanges.get(0);
    for (    AbstractFilePatchInProgress.PatchChange change : changes) {
      final AbstractFilePatchInProgress patchInProgress=change.getPatchInProgress();
      if (!patchInProgress.baseExistsOrAdded())       continue;
      diffRequestPresentableList.add(patchInProgress.getDiffRequestProducers(myProject,myReader));
      diffRequestChangeList.add(change);
      if (change.equals(c)) {
        selectedIdx=diffRequestPresentableList.size() - 1;
      }
    }
  }
  if (diffRequestPresentableList.isEmpty())   return;
  MyDiffRequestChain chain=new MyDiffRequestChain(diffRequestPresentableList,diffRequestChangeList,selectedIdx);
  DiffManager.getInstance().showDiff(myProject,chain,DiffDialogHints.DEFAULT);
}
