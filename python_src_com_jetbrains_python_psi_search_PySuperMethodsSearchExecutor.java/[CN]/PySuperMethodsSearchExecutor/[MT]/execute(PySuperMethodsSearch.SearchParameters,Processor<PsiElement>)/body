{
  final PyFunction func=queryParameters.getDerivedMethod();
  final String name=func.getName();
  final PyClass containingClass=func.getContainingClass();
  final Set<PyClass> foundMethodContainingClasses=new HashSet<PyClass>();
  final TypeEvalContext context=queryParameters.getContext();
  if (name != null && containingClass != null) {
    for (    PyClass superClass : containingClass.getAncestorClasses(context)) {
      if (!queryParameters.isDeepSearch()) {
        boolean isAlreadyFound=false;
        for (        PyClass alreadyFound : foundMethodContainingClasses) {
          if (alreadyFound.isSubclass(superClass,context)) {
            isAlreadyFound=true;
          }
        }
        if (isAlreadyFound) {
          continue;
        }
      }
      PyFunction superMethod=superClass.findMethodByName(name,false,null);
      if (superMethod != null) {
        final Property property=func.getProperty();
        final Property superProperty=superMethod.getProperty();
        if (property != null && superProperty != null) {
          final AccessDirection direction=PyUtil.getPropertyAccessDirection(func);
          final PyCallable callable=superProperty.getByDirection(direction).valueOrNull();
          superMethod=(callable instanceof PyFunction) ? (PyFunction)callable : null;
        }
      }
      if (superMethod == null && context != null) {
        final PyClassLikeType classLikeType=PyUtil.as(context.getType(superClass),PyClassLikeType.class);
        if (classLikeType != null) {
          for (          final PyFunction function : PyTypeUtil.getMembersOfType(classLikeType,PyFunction.class,true,context)) {
            final String elemName=function.getName();
            if (elemName != null && elemName.equals(func.getName())) {
              consumer.process(function);
            }
          }
        }
      }
      if (superMethod != null) {
        foundMethodContainingClasses.add(superClass);
        if (!consumer.process(superMethod)) {
          return false;
        }
      }
    }
  }
  return true;
}
