{
  final PsiDirectory taskDir=file.getContainingDirectory();
  final CCProjectService service=CCProjectService.getInstance(file.getProject());
  Course course=service.getCourse();
  if (course == null) {
    return;
  }
  if (taskDir == null || !taskDir.getName().contains("task")) {
    return;
  }
  PsiDirectory lessonDir=taskDir.getParent();
  if (lessonDir == null || !lessonDir.getName().contains("lesson")) {
    return;
  }
  Lesson lesson=service.getLesson(lessonDir.getName());
  if (lesson == null) {
    return;
  }
  Task task=service.getTask(taskDir.getVirtualFile().getPath());
  if (task == null) {
    return;
  }
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      CCRunTestsAction.clearTestEnvironment(taskDir.getVirtualFile(),taskDir.getProject());
    }
  }
);
  Map<String,TaskFile> taskFiles=task.getTaskFiles();
  TaskFile taskFile=task.getTaskFile(oldName);
  String realTaskFileName=CCProjectService.getRealTaskFileName(oldName);
  taskFiles.remove(realTaskFileName);
  taskFiles.put(CCProjectService.getRealTaskFileName(file.getName()),taskFile);
}
