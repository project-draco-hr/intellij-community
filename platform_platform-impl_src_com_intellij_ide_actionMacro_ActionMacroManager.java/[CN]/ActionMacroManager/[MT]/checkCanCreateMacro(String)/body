{
  final ActionManagerEx actionManager=(ActionManagerEx)ActionManager.getInstance();
  final String actionId=ActionMacro.MACRO_ACTION_PREFIX + name;
  if (actionManager.getAction(actionId) != null) {
    if (Messages.showYesNoDialog(IdeBundle.message("message.macro.exists",name),IdeBundle.message("title.macro.name.already.used"),Messages.getWarningIcon()) != Messages.YES) {
      return false;
    }
    actionManager.unregisterAction(actionId);
    removeMacro(name);
  }
  return true;
}
