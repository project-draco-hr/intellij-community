{
  if (!streamProvider.isApplicable(myFileSpec,RoamingType.PER_USER)) {
    return;
  }
  Document document=getDocumentToSave();
  Element rootElement=document.getRootElement();
  if (rootElement.getChildren().isEmpty()) {
    return;
  }
  if (!myFileSpec.equals(StoragePathMacros.WORKSPACE_FILE) && rootElement.getContent(new RoamingElementFilter(RoamingType.DISABLED)).iterator().hasNext()) {
    return;
  }
  RoamingElementFilter perPlatformFilter=new RoamingElementFilter(RoamingType.PER_PLATFORM);
  if (rootElement.getContent(perPlatformFilter).iterator().hasNext()) {
    doSaveForProvider(rootElement,new RoamingElementFilter(RoamingType.PER_USER));
    doSaveForProvider(rootElement,perPlatformFilter);
  }
 else {
    doSaveForProvider(document,RoamingType.PER_USER,streamProvider);
  }
}
