{
  CharSequence text=myDocument.getImmutableCharSequence();
  EditorImpl.LineWhitespacePaintingStrategy whitespacePaintingStrategy=myEditor.new LineWhitespacePaintingStrategy();
  for (int line=startLine; line <= endLine; line++) {
    Graphics2D window=(Graphics2D)g.create(0,myEditor.visibleLineToY(line),clip.x + clip.width,myEditor.getLineHeight());
    try {
      if (line == 0 && myPrefixLayout != null) {
        paintTextLayoutWithEffect(window,myPrefixLayout,myPrefixAttributes.getEffectColor(),myPrefixAttributes.getEffectType());
        window.translate(getPrefixTextWidthInPixels(),0);
      }
      if (line >= myLines.size())       break;
      LineView lineView=getLineRenderer(line);
      int lineStartOffset=myDocument.getLineStartOffset(line);
      int lineEndOffset=myDocument.getLineEndOffset(line);
      whitespacePaintingStrategy.update(text,lineStartOffset,lineEndOffset);
      lineView.paintTextAndEffects(window,myEditor,lineStartOffset,lineEndOffset,whitespacePaintingStrategy,myPlainSpaceWidth);
      window.translate(lineView.getWidthInPixels(),0);
      paintLineExtensions(window,line);
    }
  finally {
      window.dispose();
    }
  }
}
