{
  int line=myEditor.yPositionToVisibleLine(Math.max(p.y,0));
  int prefixShift=line == 0 ? getPrefixTextWidthInPixels() : 0;
  if (line < myLines.size()) {
    LineView lineView=getLineRenderer(line);
    return new VisualPosition(line,lineView.xToColumn(p.x - prefixShift,myPlainSpaceWidth,myEditor.getSettings().isCaretInsideTabs()));
  }
  return new VisualPosition(line,LineView.spacePixelsToColumns(p.x - prefixShift,myPlainSpaceWidth));
}
