{
  int line=pos.line;
  if (line >= getDocumentLineCount()) {
    return myDocument.getTextLength();
  }
 else {
    return myDocument.getLineStartOffset(line) + (line < myLines.size() ? getLineRenderer(line).columnToOffset(pos.column,myPlainSpaceWidth)[0] : pos.column);
  }
}
