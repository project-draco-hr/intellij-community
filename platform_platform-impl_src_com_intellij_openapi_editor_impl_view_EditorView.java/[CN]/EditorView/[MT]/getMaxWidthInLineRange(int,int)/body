{
  int maxWidth=0;
  for (int i=startVisualLine; i <= endVisualLine; i++) {
    int logicalLine=visualToLogicalPosition(new VisualPosition(i,0),false).line;
    if (logicalLine >= myDocument.getLineCount())     break;
    int startOffset=myDocument.getLineStartOffset(logicalLine);
    float x=0;
    for (    VisualLineFragmentsIterator.Fragment fragment : VisualLineFragmentsIterator.create(this,startOffset)) {
      x=fragment.getEndX();
    }
    maxWidth=Math.max(maxWidth,(int)x);
  }
  return maxWidth;
}
