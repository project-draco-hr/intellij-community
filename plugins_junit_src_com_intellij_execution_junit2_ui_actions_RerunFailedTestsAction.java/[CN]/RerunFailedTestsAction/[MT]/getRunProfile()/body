{
  final JUnitConfiguration configuration=(JUnitConfiguration)getModel().getProperties().getConfiguration();
  final TestMethods testMethods=new TestMethods(configuration.getProject(),configuration,myEnvironment,getFailedTests(configuration.getProject()));
  return new MyRunProfile(configuration){
    @Override @NotNull public Module[] getModules(){
      return testMethods.getModulesToCompile();
    }
    @Override public RunProfileState getState(    @NotNull Executor executor,    @NotNull ExecutionEnvironment env){
      testMethods.clear();
      return testMethods;
    }
    @Override public void clear(){
      testMethods.clear();
      super.clear();
    }
  }
;
}
