{
  if (Toolkit.getDefaultToolkit().getSystemEventQueue() instanceof IdeEventQueue) {
    return;
  }
  if (SwingUtilities.isEventDispatchThread()) {
    throw new RuntimeException("must not call under EDT");
  }
  AWTAutoShutdown.getInstance().notifyThreadBusy(Thread.currentThread());
  UIUtil.pump();
  try {
    SwingUtilities.invokeAndWait(new Runnable(){
      @Override public void run(){
        IdeEventQueue.getInstance();
      }
    }
);
    SwingUtilities.invokeAndWait(EmptyRunnable.getInstance());
    SwingUtilities.invokeAndWait(EmptyRunnable.getInstance());
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
