{
  if (Toolkit.getDefaultToolkit().getSystemEventQueue() instanceof IdeEventQueue) {
    return;
  }
  if (SwingUtilities.isEventDispatchThread()) {
    throw new RuntimeException("must not call under EDT");
  }
  SwingUtilities.invokeAndWait(new Runnable(){
    @Override public void run(){
      IdeEventQueue.getInstance();
    }
  }
);
  SwingUtilities.invokeAndWait(EmptyRunnable.getInstance());
  SwingUtilities.invokeAndWait(EmptyRunnable.getInstance());
}
