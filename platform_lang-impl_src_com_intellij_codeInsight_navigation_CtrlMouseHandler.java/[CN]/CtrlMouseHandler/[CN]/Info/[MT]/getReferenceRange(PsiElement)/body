{
  int textOffset=elementAtPointer.getTextOffset();
  final TextRange range=elementAtPointer.getTextRange();
  if (textOffset < range.getStartOffset() || textOffset < 0) {
    LOG.error("Invalid text offset " + textOffset + " of element "+ elementAtPointer+ " of "+ elementAtPointer.getClass());
    textOffset=range.getStartOffset();
  }
  return new TextRange(textOffset,range.getEndOffset());
}
