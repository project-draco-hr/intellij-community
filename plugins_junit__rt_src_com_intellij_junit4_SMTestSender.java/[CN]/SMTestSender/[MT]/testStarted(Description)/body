{
  final String methodName=JUnit4ReflectionUtil.getMethodName(description);
  final String classFQN=JUnit4ReflectionUtil.getClassName(description);
  final int paramStart=methodName.indexOf('[');
  if (myParamName != null) {
    myPrintStream.println("##teamcity[testSuiteFinished name=\'" + escapeName(myParamName) + "\']");
    myParamName=null;
  }
  final List suites=(List)myParents.get(description);
  if (suites != null && !suites.isEmpty()) {
    String currentSuite=(String)suites.get(0);
    List descriptors=(List)mySuites.get(currentSuite);
    if (descriptors.isEmpty()) {
      currentSuite=(String)suites.get(1);
      descriptors=(List)mySuites.get(currentSuite);
    }
    if (!currentSuite.equals(myCurrentSuiteName)) {
      finishCurrentSuite();
      myCurrentSuiteName=currentSuite;
      myPrintStream.println("##teamcity[testSuiteStarted name =\'" + escapeName(getShortName(myCurrentSuiteName)) + "\']");
    }
    descriptors.remove(description);
  }
 else   if (myCurrentSuiteName != null) {
    finishCurrentSuite();
    myCurrentSuiteName=null;
  }
  String className=getShortName(classFQN);
  if (!myEmptyTests.isEmpty() && isWarning(methodName,classFQN)) {
    className=(String)myEmptyTests.remove(0);
  }
  if (!className.equals(myCurrentClassName)) {
    if (myCurrentClassName != null) {
      myPrintStream.println("##teamcity[testSuiteFinished name=\'" + escapeName(myCurrentClassName) + "\']");
    }
    myCurrentClassName=className;
    myPrintStream.println("##teamcity[testSuiteStarted name =\'" + escapeName(myCurrentClassName) + "\']");
  }
  if (paramStart > -1) {
    final String paramName=methodName.substring(paramStart,methodName.length());
    if (!paramName.equals(myParamName)) {
      myParamName=paramName;
      myPrintStream.println("##teamcity[testSuiteStarted name =\'" + escapeName(myParamName) + "\']");
    }
  }
  myPrintStream.println("##teamcity[testStarted name=\'" + escapeName(methodName) + "\' "+ getTestMethodLocation(methodName,classFQN)+ "]");
}
