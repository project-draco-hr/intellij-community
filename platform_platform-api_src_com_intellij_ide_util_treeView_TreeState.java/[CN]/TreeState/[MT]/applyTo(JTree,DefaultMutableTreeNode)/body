{
  final TreeFacade facade=getFacade(tree);
  ActionCallback callback=facade.getInitialized().doWhenDone(new TreeRunnable("TreeState.applyTo: on done facade init"){
    @Override public void perform(){
      facade.batch(new Progressive(){
        @Override public void run(        @NotNull ProgressIndicator indicator){
          applyExpanded(facade,node,indicator);
        }
      }
);
    }
  }
);
  if (tree.getSelectionCount() == 0) {
    callback.doWhenDone(new TreeRunnable("TreeState.applyTo: on done"){
      @Override public void perform(){
        applySelected(tree,node);
      }
    }
);
  }
}
