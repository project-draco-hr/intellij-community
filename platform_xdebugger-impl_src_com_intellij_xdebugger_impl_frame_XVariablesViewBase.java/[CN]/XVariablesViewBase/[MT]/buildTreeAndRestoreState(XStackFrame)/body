{
  XDebuggerTree tree=myDebuggerTreePanel.getTree();
  tree.setSourcePosition(stackFrame.getSourcePosition());
  tree.setRoot(new XStackFrameNode(tree,stackFrame),false);
  tree.getProject().putUserData(XVariablesView.DEBUG_VARIABLES,new HashMap<Pair<VirtualFile,Integer>,Set<XValueNodeImpl>>());
  Object newEqualityObject=stackFrame.getEqualityObject();
  if (myFrameEqualityObject != null && newEqualityObject != null && myFrameEqualityObject.equals(newEqualityObject) && myTreeState != null) {
    disposeTreeRestorer();
    myTreeRestorer=myTreeState.restoreState(tree);
  }
}
