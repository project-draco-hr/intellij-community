{
  final Collection<TaskData> tasks=ContainerUtil.newArrayList();
  final String moduleConfigPath=ideModule.getData().getLinkedExternalProjectPath();
  ExternalProject externalProject=resolverCtx.getExtraProject(gradleModule,ExternalProject.class);
  final String rootProjectPath=ideProject.getData().getLinkedExternalProjectPath();
  final boolean isFlatProject=!FileUtil.isAncestor(rootProjectPath,moduleConfigPath,false);
  if (externalProject != null) {
    for (    ExternalTask task : externalProject.getTasks().values()) {
      String taskName=isFlatProject ? task.getQName() : task.getName();
      String taskGroup=task.getGroup();
      if (taskName.trim().isEmpty() || isIdeaTask(taskName,taskGroup)) {
        continue;
      }
      final String taskPath=isFlatProject ? rootProjectPath : moduleConfigPath;
      TaskData taskData=new TaskData(GradleConstants.SYSTEM_ID,taskName,taskPath,task.getDescription());
      taskData.setGroup(taskGroup);
      taskData.setType(task.getType());
      ideModule.createChild(ProjectKeys.TASK,taskData);
      taskData.setInherited(StringUtil.equals(task.getName(),task.getQName()));
      tasks.add(taskData);
    }
    return tasks;
  }
  for (  GradleTask task : gradleModule.getGradleProject().getTasks()) {
    String taskName=task.getName();
    String taskGroup=getTaskGroup(task);
    if (taskName == null || taskName.trim().isEmpty() || isIdeaTask(taskName,taskGroup)) {
      continue;
    }
    TaskData taskData=new TaskData(GradleConstants.SYSTEM_ID,taskName,moduleConfigPath,task.getDescription());
    taskData.setGroup(taskGroup);
    ideModule.createChild(ProjectKeys.TASK,taskData);
    tasks.add(taskData);
  }
  return tasks;
}
