{
  DataContext dataContext=event.getDataContext();
  final Navigatable target=findTargetForUpdate(dataContext);
  boolean enabled=target != null;
  if (ActionPlaces.isPopupPlace(event.getPlace())) {
    event.getPresentation().setVisible(enabled);
    if (!(this instanceof OpenModuleSettingsAction) && OpenModuleSettingsAction.isModuleInProjectViewPopup(event)) {
      event.getPresentation().setVisible(false);
      return;
    }
  }
 else {
    event.getPresentation().setEnabled(enabled);
  }
  if (!myFocusEditor)   event.getPresentation().setVisible(false);
  String navigateActionText=myFocusEditor && target instanceof NavigatableWithText ? ((NavigatableWithText)target).getNavigateActionText(true) : null;
  event.getPresentation().setText(navigateActionText == null ? getTemplatePresentation().getText() : navigateActionText);
}
