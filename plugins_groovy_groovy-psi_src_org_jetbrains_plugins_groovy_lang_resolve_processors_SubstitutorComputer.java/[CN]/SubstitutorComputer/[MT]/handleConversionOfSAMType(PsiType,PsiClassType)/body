{
  if (samType instanceof PsiClassType) {
    PsiClassType.ClassResolveResult resolveResult=((PsiClassType)samType).resolveGenerics();
    PsiClass samClass=resolveResult.getElement();
    if (samClass != null && samClass.getTypeParameters().length != 0) {
      MethodSignature samSignature=ClosureToSamConverter.findSingleAbstractMethod(samClass,PsiSubstitutor.EMPTY);
      if (samSignature != null) {
        PsiMethod samMethod=MethodSignatureUtil.findMethodBySignature(samClass,samSignature,true);
        if (samMethod != null) {
          PsiType[] closureArgs=closure.getParameters();
          if (closureArgs.length == 1 && samMethod.getReturnType() != null) {
            PsiSubstitutor substitutor=myHelper.inferTypeArguments(samClass.getTypeParameters(),new PsiType[]{samMethod.getReturnType()},closureArgs,LanguageLevel.JDK_1_7);
            if (!substitutor.getSubstitutionMap().isEmpty()) {
              return JavaPsiFacade.getElementFactory(myPlace.getProject()).createType(samClass,substitutor);
            }
          }
        }
      }
    }
  }
  return null;
}
