{
  if (toolWrapper instanceof GlobalInspectionToolWrapper) {
    final LocalInspectionToolWrapper localWrapper=((GlobalInspectionToolWrapper)toolWrapper).getSharedLocalInspectionToolWrapper();
    if (localWrapper != null)     return createFixAllIntention(localWrapper,action);
  }
  if (toolWrapper instanceof LocalInspectionToolWrapper) {
    Class aClass=action.getClass();
    if (action instanceof QuickFixWrapper) {
      aClass=((QuickFixWrapper)action).getFix().getClass();
    }
    return new CleanupInspectionIntention(toolWrapper,aClass,action.getText());
  }
 else   if (toolWrapper instanceof GlobalInspectionToolWrapper) {
    GlobalInspectionTool wrappedTool=((GlobalInspectionToolWrapper)toolWrapper).getTool();
    if (wrappedTool instanceof GlobalSimpleInspectionTool && (action instanceof LocalQuickFix || action instanceof QuickFixWrapper)) {
      Class aClass=action.getClass();
      if (action instanceof QuickFixWrapper) {
        aClass=((QuickFixWrapper)action).getFix().getClass();
      }
      return new CleanupInspectionIntention(toolWrapper,aClass,action.getText());
    }
  }
 else {
    throw new AssertionError("unknown tool: " + toolWrapper);
  }
  return null;
}
