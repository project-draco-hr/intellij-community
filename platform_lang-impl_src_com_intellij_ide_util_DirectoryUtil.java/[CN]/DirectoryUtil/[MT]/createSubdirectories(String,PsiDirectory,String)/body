{
  StringTokenizer tokenizer=new StringTokenizer(subDirName,delim);
  PsiDirectory dir=baseDirectory;
  while (tokenizer.hasMoreTokens()) {
    String dirName=tokenizer.nextToken();
    if (tokenizer.hasMoreTokens()) {
      if ("..".equals(dirName)) {
        dir=dir.getParentDirectory();
        if (dir == null)         throw new IncorrectOperationException("Not a valid directory");
        continue;
      }
 else       if (".".equals(dirName)) {
        continue;
      }
      PsiDirectory existingDir=dir.findSubdirectory(dirName);
      if (existingDir != null) {
        dir=existingDir;
        continue;
      }
    }
    dir=dir.createSubdirectory(dirName);
  }
  return dir;
}
