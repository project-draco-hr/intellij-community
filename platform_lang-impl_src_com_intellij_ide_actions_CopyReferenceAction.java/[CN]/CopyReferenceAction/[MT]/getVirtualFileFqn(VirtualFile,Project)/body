{
  final LogicalRoot logicalRoot=LogicalRootsManager.getLogicalRootsManager(project).findLogicalRoot(virtualFile);
  if (logicalRoot != null && logicalRoot.getVirtualFile() != null) {
    return ObjectUtils.assertNotNull(VfsUtilCore.getRelativePath(virtualFile,logicalRoot.getVirtualFile(),'/'));
  }
  final VirtualFile contentRoot=ProjectRootManager.getInstance(project).getFileIndex().getContentRootForFile(virtualFile);
  if (contentRoot != null) {
    return ObjectUtils.assertNotNull(VfsUtilCore.getRelativePath(virtualFile,contentRoot,'/'));
  }
  return virtualFile.getPath();
}
