{
  DebuggerManagerThreadImpl.assertIsManagerThread();
  List<DebuggerTreeNode> children=new ArrayList<DebuggerTreeNode>();
  NodeManagerImpl nodeManager=(NodeManagerImpl)builder.getNodeManager();
  NodeDescriptorFactory descriptorFactory=builder.getDescriptorManager();
  if (!myForced) {
    builder.initChildrenArrayRenderer(this);
  }
  ArrayReference array=(ArrayReference)value;
  if (array.length() > 0) {
    int added=0;
    if (ENTRIES_LIMIT > END_INDEX - START_INDEX + 1) {
      ENTRIES_LIMIT=END_INDEX - START_INDEX;
    }
    if (ENTRIES_LIMIT <= 0) {
      ENTRIES_LIMIT=1;
    }
    if (array.length() - 1 >= START_INDEX) {
      int start=START_INDEX;
      int end=array.length() - 1 < END_INDEX ? array.length() - 1 : END_INDEX;
      int idx;
      for (idx=start; idx <= end; idx++) {
        if (ViewsGeneralSettings.getInstance().HIDE_NULL_ARRAY_ELEMENTS && elementIsNull(array,idx))         continue;
        DebuggerTreeNode arrayItemNode=nodeManager.createNode(descriptorFactory.getArrayItemDescriptor(builder.getParentDescriptor(),array,idx),evaluationContext);
        if (arrayItemNode == null)         continue;
        children.add(arrayItemNode);
        added++;
      }
      start=idx;
    }
    if (added == 0) {
      if (START_INDEX == 0 && array.length() - 1 <= END_INDEX) {
        children.add(nodeManager.createMessageNode(MessageDescriptor.ALL_ELEMENTS_IN_RANGE_ARE_NULL));
      }
 else {
        children.add(nodeManager.createMessageNode(DebuggerBundle.message("message.node.all.array.elements.null",START_INDEX,END_INDEX)));
      }
    }
 else {
      if (!myForced && END_INDEX < array.length() - 1) {
        builder.setRemaining(array.length() - 1 - END_INDEX);
      }
    }
  }
  builder.setChildren(children);
}
