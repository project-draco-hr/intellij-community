{
  DfaMemoryStateImpl other=(DfaMemoryStateImpl)_other;
  if (myEphemeral != other.myEphemeral || !myStack.equals(other.myStack) || !myOffsetStack.equals(other.myOffsetStack)) {
    return null;
  }
  Set<DfaVariableValue> differentVars=ContainerUtil.newHashSet();
  addDifferentlyValuedVariables(other,differentVars);
  other.addDifferentlyValuedVariables(this,differentVars);
  for (  DfaVariableValue differentVar : differentVars) {
    DfaMemoryStateImpl copy1=createCopy();
    DfaMemoryStateImpl copy2=other.createCopy();
    copy1.flushVariable(differentVar);
    copy2.flushVariable(differentVar);
    copy1.myUnknownVariables.addAll(copy2.myUnknownVariables);
    copy2.myUnknownVariables.addAll(copy1.myUnknownVariables);
    if (!copy1.equals(copy2)) {
      continue;
    }
    if (isNull(differentVar) || other.isNull(differentVar)) {
      copy1.getVariableState(differentVar).setNullable(true);
    }
    return copy1;
  }
  return null;
}
