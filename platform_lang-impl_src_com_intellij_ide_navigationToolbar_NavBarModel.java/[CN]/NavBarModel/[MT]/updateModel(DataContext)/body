{
  if (LaterInvocator.isInModalContext() || (updated && !isFixedComponent))   return;
  if (PlatformDataKeys.CONTEXT_COMPONENT.getData(dataContext) instanceof NavBarPanel)   return;
  PsiElement psiElement=CommonDataKeys.PSI_FILE.getData(dataContext);
  if (psiElement == null) {
    psiElement=CommonDataKeys.PSI_ELEMENT.getData(dataContext);
  }
  psiElement=normalize(psiElement);
  if (!myModel.isEmpty() && myModel.get(myModel.size() - 1).equals(psiElement) && !myChanged)   return;
  if (psiElement != null && psiElement.isValid()) {
    updateModel(psiElement);
  }
 else {
    if (UISettings.getInstance().SHOW_NAVIGATION_BAR && !myModel.isEmpty())     return;
    Object root=LangDataKeys.MODULE.getData(dataContext);
    if (root == null) {
      Project project=CommonDataKeys.PROJECT.getData(dataContext);
      if (project != null) {
        Module[] modules=getProjectChildren(project);
        if (modules.length == 1) {
          Module soleModule=modules[0];
          List<Object> contentRoots=getModuleChildren(soleModule);
          if (contentRoots.size() == 1) {
            root=contentRoots.get(0);
          }
 else {
            root=soleModule;
          }
        }
 else {
          root=project;
        }
      }
    }
    if (root != null) {
      setModel(Collections.singletonList(root));
    }
  }
  setChanged(false);
  updated=true;
}
