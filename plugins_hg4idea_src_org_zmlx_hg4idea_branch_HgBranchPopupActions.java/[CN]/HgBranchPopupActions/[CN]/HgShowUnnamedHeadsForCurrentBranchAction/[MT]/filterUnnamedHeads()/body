{
  Collection<Hash> branchWithHashes=myRepository.getBranches().get(myCurrentBranchName);
  if (branchWithHashes == null) {
    return Collections.emptySet();
  }
 else {
    List<HgRevisionNumber> parents=new HgWorkingCopyRevisionsCommand(myRepository.getProject()).parents(myRepository.getRoot());
    if (parents.size() == 1) {
      Collection<Hash> bookmarkHashes=ContainerUtil.map(myRepository.getBookmarks(),new Function<HgNameWithHashInfo,Hash>(){
        @Override public Hash fun(        HgNameWithHashInfo info){
          return info.getHash();
        }
      }
);
      branchWithHashes.removeAll(bookmarkHashes);
      branchWithHashes.remove(HashImpl.build(parents.get(0).getChangeset()));
    }
  }
  return branchWithHashes;
}
