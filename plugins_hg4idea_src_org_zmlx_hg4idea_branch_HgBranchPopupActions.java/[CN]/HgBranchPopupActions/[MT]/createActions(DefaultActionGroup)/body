{
  DefaultActionGroup popupGroup=new DefaultActionGroup(null,false);
  popupGroup.addAction(new HgNewBranchAction(myProject,Collections.singletonList(myRepository),myRepository));
  popupGroup.addAction(new HgNewBookmarkAction(Collections.singletonList(myRepository),myRepository));
  popupGroup.addAction(new HgBranchPopupActions.HgCloseBranchAction(Collections.singletonList(myRepository),myRepository));
  popupGroup.addAction(new HgShowUnnamedHeadsForCurrentBranchAction(myRepository));
  if (toInsert != null) {
    popupGroup.addAll(toInsert);
  }
  popupGroup.addSeparator("Bookmarks");
  List<String> bookmarkNames=getNamesWithoutHashes(myRepository.getBookmarks());
  String currentBookmark=myRepository.getCurrentBookmark();
  for (  String bookmark : bookmarkNames) {
    AnAction bookmarkAction=new BookmarkActions(myProject,Collections.singletonList(myRepository),bookmark);
    if (bookmark.equals(currentBookmark)) {
      bookmarkAction.getTemplatePresentation().setIcon(PlatformIcons.CHECK_ICON);
    }
    popupGroup.add(bookmarkAction);
  }
  popupGroup.addSeparator("Branches");
  List<String> branchNamesList=new ArrayList<String>(myRepository.getOpenedBranches());
  Collections.sort(branchNamesList);
  for (  String branch : branchNamesList) {
    if (!branch.equals(myRepository.getCurrentBranch())) {
      popupGroup.add(new HgCommonBranchActions(myProject,Collections.singletonList(myRepository),branch));
    }
  }
  return popupGroup;
}
