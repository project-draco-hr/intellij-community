{
  if (!psiFile.isValid())   return false;
  boolean isAffected=false;
  SearchScope scope=myScopes.getSelectedScope();
  if (scope instanceof GlobalSearchScope) {
    isAffected=((GlobalSearchScope)scope).contains(psiFile.getVirtualFile());
  }
  return isAffected && (myTodoFilter != null && myTodoFilter.accept(mySearchHelper,psiFile) || (myTodoFilter == null && mySearchHelper.getTodoItemsCount(psiFile) > 0));
}
