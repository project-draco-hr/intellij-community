{
  SelectionModel selectionModel=editor.getSelectionModel();
  if (!selectionModel.hasSelection() && !selectionModel.hasBlockSelection()) {
    selectionModel.selectLineAtCaret();
  }
  ZenCodingTemplate emmetCustomTemplate=CustomLiveTemplate.EP_NAME.findExtension(ZenCodingTemplate.class);
  if (emmetCustomTemplate != null) {
    new WrapWithCustomTemplateAction(emmetCustomTemplate,editor,file,Collections.<Character>emptySet()).actionPerformed(null);
  }
 else   if (!ApplicationManager.getApplication().isUnitTestMode()) {
    HintManager.getInstance().showErrorHint(editor,"Cannot invoke Surround with Emmet in the current context");
  }
}
