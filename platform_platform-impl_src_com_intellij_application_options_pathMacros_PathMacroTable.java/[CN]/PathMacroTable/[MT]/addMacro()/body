{
  final String title=ApplicationBundle.message("title.add.variable");
  final PathMacroEditor macroEditor=new PathMacroEditor(title,"","",new AddValidator(title));
  if (macroEditor.showAndGet()) {
    final String name=macroEditor.getName();
    myMacros.add(Couple.of(name,macroEditor.getValue()));
    Collections.sort(myMacros,MACRO_COMPARATOR);
    final int index=indexOfMacroWithName(name);
    LOG.assertTrue(index >= 0);
    myTableModel.fireTableDataChanged();
    setRowSelectionInterval(index,index);
  }
}
