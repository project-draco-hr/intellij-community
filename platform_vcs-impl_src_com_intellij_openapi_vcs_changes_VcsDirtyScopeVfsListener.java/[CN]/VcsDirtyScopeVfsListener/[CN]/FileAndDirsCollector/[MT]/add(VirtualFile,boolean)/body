{
  if (file == null) {
    return;
  }
  final boolean isDirectory=file.isDirectory();
  FilePath path=VcsUtil.getFilePath(file.getPath(),isDirectory);
  final Collection<VcsDirtyScopeManager> managers=getManagers(file);
  for (  VcsDirtyScopeManager manager : managers) {
    Couple<HashSet<FilePath>> filesAndDirs=map.get(manager);
    if (filesAndDirs == null) {
      filesAndDirs=Couple.of(new HashSet<FilePath>(),new HashSet<FilePath>());
      map.put(manager,filesAndDirs);
    }
    if (addToFiles || !isDirectory) {
      filesAndDirs.first.add(path);
    }
 else {
      filesAndDirs.second.add(path);
    }
  }
}
