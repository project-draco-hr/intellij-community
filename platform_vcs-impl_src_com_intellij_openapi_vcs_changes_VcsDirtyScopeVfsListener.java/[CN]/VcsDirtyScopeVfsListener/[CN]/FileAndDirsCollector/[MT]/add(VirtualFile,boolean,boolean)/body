{
  if (file == null) {
    return;
  }
  final boolean isDirectory=file.isDirectory();
  final FilePathImpl path=forDelete ? new FilePathImpl(new File(file.getPath()),isDirectory) : new FilePathImpl(file);
  final Collection<VcsDirtyScopeManager> managers=getManagers(file);
  for (  VcsDirtyScopeManager manager : managers) {
    Couple<HashSet<FilePath>> filesAndDirs=map.get(manager);
    if (filesAndDirs == null) {
      filesAndDirs=Couple.newOne(new HashSet<FilePath>(),new HashSet<FilePath>());
      map.put(manager,filesAndDirs);
    }
    if (addToFiles || !isDirectory) {
      filesAndDirs.first.add(path);
    }
 else {
      filesAndDirs.second.add(path);
    }
  }
}
