{
  final JTree tree=getCurrentTree();
  if (tree == null) {
    return PsiElement.EMPTY_ARRAY;
  }
  final TreeModel model=tree.getModel();
  final Object root=model.getRoot();
  if (!(root instanceof DefaultMutableTreeNode)) {
    return PsiElement.EMPTY_ARRAY;
  }
  final DefaultMutableTreeNode node=(DefaultMutableTreeNode)root;
  final HierarchyNodeDescriptor descriptor=getDescriptor(node);
  final Set<PsiElement> result=new HashSet<PsiElement>();
  collectElements(descriptor,result);
  return result.toArray(PsiElement.EMPTY_ARRAY);
}
