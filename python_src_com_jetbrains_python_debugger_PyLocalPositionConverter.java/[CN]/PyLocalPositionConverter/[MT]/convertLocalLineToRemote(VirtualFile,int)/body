{
  AccessToken lock=ApplicationManager.getApplication().acquireReadActionLock();
  try {
    final Document document=FileDocumentManager.getInstance().getDocument(file);
    if (document != null) {
      while (PyDebugSupportUtils.isContinuationLine(document,line)) {
        line++;
      }
    }
    return line + 1;
  }
  finally {
    lock.finish();
  }
}
