{
  final PsiElementFactory elementFactory=JavaPsiFacade.getElementFactory(project);
  return ApplicationManager.getApplication().runWriteAction(new Computable<PsiElement>(){
    @Override public PsiElement compute(){
      final PsiElement newDeclaration=moveDeclaration(elementFactory,localName,variable,initializer,action,references);
      if (delete) {
        beforeDelete(project,variable,newDeclaration);
        variable.normalizeDeclaration();
        variable.delete();
      }
      return newDeclaration;
    }
  }
);
}
