{
  final PsiElement element=descriptor.getPsiElement();
  final PsiElement parent=element.getParent();
  if (!(parent instanceof PsiMethod)) {
    return;
  }
  final PsiMethod method=(PsiMethod)parent;
  final Collection<PsiElement> writtenElements=new ArrayList<PsiElement>();
  final Collection<PsiReferenceExpression> methodCalls=new ArrayList<PsiReferenceExpression>();
  writtenElements.add(method);
  for (  final PsiReference reference : ReferencesSearch.search(method,method.getUseScope(),false)) {
    final PsiElement referenceElement=reference.getElement();
    if (referenceElement instanceof PsiReferenceExpression) {
      writtenElements.add(referenceElement);
      methodCalls.add((PsiReferenceExpression)referenceElement);
    }
  }
  if (!FileModificationService.getInstance().preparePsiElementsForWrite(writtenElements)) {
    return;
  }
  makeMethodVarargs(method);
  makeMethodCallsVarargs(methodCalls);
}
