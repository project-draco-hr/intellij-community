{
  final DebuggerSession debuggerSession=DebuggerManagerEx.getInstanceEx(myProject).attachVirtualMachine(DefaultDebugExecutor.getDebugExecutorInstance(),runner,new MockConfiguration(),state,remoteConnection,pollConnection);
  XDebuggerManager.getInstance(myProject).startSession(runner,environment,null,new XDebugProcessStarter(){
    @Override @NotNull public XDebugProcess start(    @NotNull XDebugSession session){
      return new JavaDebugProcess(session,debuggerSession);
    }
  }
);
  return debuggerSession;
}
