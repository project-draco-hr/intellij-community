{
  final RunnerSettings<JDOMExternalizable> runnerSettings=new RunnerSettings<JDOMExternalizable>(null,null);
  final RemoteState remoteState=new RemoteStateState(myProject,remoteConnection,runnerSettings,null);
  final DebuggerSession[] debuggerSession=new DebuggerSession[1];
  UIUtil.invokeAndWaitIfNeeded(new Runnable(){
    @Override public void run(){
      try {
        debuggerSession[0]=attachVirtualMachine(remoteState,remoteConnection,pollConnection);
      }
 catch (      ExecutionException e) {
        fail(e.getMessage());
      }
    }
  }
);
  debuggerSession[0].getProcess().getExecutionResult().getProcessHandler().addProcessListener(new ProcessAdapter(){
    @Override public void onTextAvailable(    ProcessEvent event,    Key outputType){
      print(event.getText(),outputType);
    }
  }
);
  return debuggerSession[0];
}
