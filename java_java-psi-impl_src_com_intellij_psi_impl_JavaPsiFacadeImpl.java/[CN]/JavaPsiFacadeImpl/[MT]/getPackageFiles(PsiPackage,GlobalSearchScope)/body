{
  Condition<PsiFile> filter=null;
  for (  PsiElementFinder finder : filteredFinders()) {
    Condition<PsiFile> finderFilter=finder.getPackageFilesFilter(psiPackage,scope);
    if (finderFilter != null) {
      if (filter == null) {
        filter=finderFilter;
      }
 else {
        filter=Conditions.and(filter,finderFilter);
      }
    }
  }
  Set<PsiFile> result=new LinkedHashSet<PsiFile>();
  PsiDirectory[] directories=psiPackage.getDirectories(scope);
  for (  PsiDirectory directory : directories) {
    for (    PsiFile file : directory.getFiles()) {
      if (filter == null || filter.value(file)) {
        result.add(file);
      }
    }
  }
  for (  PsiElementFinder finder : filteredFinders()) {
    Collections.addAll(result,finder.getPackageFiles(psiPackage,scope));
  }
  return result.toArray(new PsiFile[result.size()]);
}
