{
  myBuilder=builder;
  myStep=step;
  Disposer.register(this,myLoadingIcon);
  myArchetypesTree=new Tree();
  myArchetypesTree.setModel(new DefaultTreeModel(new DefaultMutableTreeNode()));
  JScrollPane archetypesScrollPane=ScrollPaneFactory.createScrollPane(myArchetypesTree);
  myArchetypesPanel.add(archetypesScrollPane,"archetypes");
  JPanel loadingPanel=new JPanel(new GridBagLayout());
  JPanel bp=new JPanel(new BorderLayout(10,10));
  bp.add(new JLabel("Loading archetype list..."),BorderLayout.NORTH);
  bp.add(myLoadingIcon,BorderLayout.CENTER);
  loadingPanel.add(bp,new GridBagConstraints());
  myArchetypesPanel.add(ScrollPaneFactory.createScrollPane(loadingPanel),"loading");
  ((CardLayout)myArchetypesPanel.getLayout()).show(myArchetypesPanel,"archetypes");
  myUseArchetypeCheckBox.addItemListener(new ItemListener(){
    @Override public void itemStateChanged(    ItemEvent e){
      updateComponents();
      archetypeMayBeChanged();
    }
  }
);
  myAddArchetypeButton.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      doAddArchetype();
    }
  }
);
  myArchetypesTree.setRootVisible(false);
  myArchetypesTree.setShowsRootHandles(true);
  myArchetypesTree.setCellRenderer(new MyRenderer());
  myArchetypesTree.getSelectionModel().setSelectionMode(TreeSelectionModel.SINGLE_TREE_SELECTION);
  myArchetypesTree.getSelectionModel().addTreeSelectionListener(new TreeSelectionListener(){
    public void valueChanged(    TreeSelectionEvent e){
      updateArchetypeDescription();
      archetypeMayBeChanged();
    }
  }
);
  new TreeSpeedSearch(myArchetypesTree,new Convertor<TreePath,String>(){
    public String convert(    TreePath path){
      MavenArchetype info=getArchetypeInfoFromPathComponent(path.getLastPathComponent());
      return info.groupId + ":" + info.artifactId+ ":"+ info.version;
    }
  }
).setComparator(new SpeedSearchComparator(false));
  myArchetypeDescriptionField.setEditable(false);
  myArchetypeDescriptionField.setBackground(UIUtil.getPanelBackground());
  requestUpdate();
  updateComponents();
}
