{
  String projectId=getProjectId(project);
  if (projectId == null) {
    return;
  }
  Change[] changes=context.getSelectedChanges();
  ProjectChangeCollectConsumer collectConsumer=new ProjectChangeCollectConsumer(project);
  if (changes != null && changes.length > 0) {
    for (    Change change : changes) {
      collectConsumer.consume(change);
    }
  }
 else {
    ChangeListManager manager=ChangeListManager.getInstance(project);
    FilePath[] paths=getRoots(context);
    for (    FilePath path : paths) {
      collectProjectChanges(manager.getChangesIn(path),collectConsumer);
    }
  }
  showDialog(project,collectConsumer,projectId);
}
