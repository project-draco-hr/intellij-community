{
  final Dimension size=myParent.getSize();
  size.width-=myInsets.left + myInsets.right;
  size.height-=myInsets.top + myInsets.bottom;
  final Rectangle layoutRec=new Rectangle(new Point(myInsets.left,myInsets.top),size);
  List<ArrayList<Balloon>> columns=createColumns(layoutRec);
  while (columns.size() > 1) {
    myBalloons.remove(0);
    columns=createColumns(layoutRec);
  }
  List<Integer> columnWidths=computeWidths(columns);
  int eachCoumnX=(int)layoutRec.getMaxX();
  for (int i=0; i < columns.size(); i++) {
    final ArrayList<Balloon> eachColumn=columns.get(i);
    final Integer eachWidth=columnWidths.get(i);
    eachCoumnX-=eachWidth.intValue();
    int eachY=layoutRec.y + 47;
    for (    Balloon eachBalloon : eachColumn) {
      final Rectangle eachRec=new Rectangle();
      final Dimension eachPrefSize=eachBalloon.getPreferredSize();
      eachRec.setSize(eachPrefSize);
      if (((BalloonImpl)eachBalloon).hasShadow()) {
        final int shadowSize=((BalloonImpl)eachBalloon).getShadowBorderSize();
        eachRec.width+=2 * shadowSize;
        eachRec.height+=2 * shadowSize;
      }
      eachY+=2;
      eachRec.setLocation(eachCoumnX + eachWidth.intValue() - eachRec.width - 14,eachY);
      eachBalloon.setBounds(eachRec);
      eachY+=eachRec.height;
    }
  }
}
