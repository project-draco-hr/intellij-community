{
  TLongObjectHashMap<ManualRangeMarker> updated=getUpdatedMarkers(frozen,events);
  for (  SmartPsiElementPointerImpl pointer : myPointers.getAlivePointers()) {
    SmartPointerElementInfo info=pointer.getElementInfo();
    if (info instanceof SelfElementInfo) {
      long key=((SelfElementInfo)info).markerCacheKey();
      if (key != 0) {
        ManualRangeMarker newRangeMarker=updated.get(key);
        ProperTextRange newRange=newRangeMarker == null ? null : newRangeMarker.getRange();
        ((SelfElementInfo)info).setRange(newRange);
        if (newRange != null && !(pointer instanceof SmartPsiFileRangePointerImpl)) {
          updatePointerTarget(pointer,newRange);
        }
      }
    }
  }
  myUpdatedRanges=null;
}
