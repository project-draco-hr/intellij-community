{
  final CompileScope scope=context.getScope();
  final FilesDelta delta=getEffectiveFilesDelta(context,target);
  delta.lockData();
  try {
    for (    Map.Entry<BuildRootDescriptor,Set<File>> entry : delta.getSourcesToRecompile().entrySet()) {
      R root=(R)entry.getKey();
      if (!target.equals(root.getTarget())) {
        continue;
      }
      for (      File file : entry.getValue()) {
        if (!scope.isAffected(target,file)) {
          continue;
        }
        if (!processor.apply(target,file,root)) {
          return false;
        }
      }
    }
    return true;
  }
  finally {
    delta.unlockData();
  }
}
