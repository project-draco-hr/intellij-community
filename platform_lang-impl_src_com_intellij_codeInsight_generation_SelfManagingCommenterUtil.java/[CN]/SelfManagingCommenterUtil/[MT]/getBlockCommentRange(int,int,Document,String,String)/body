{
  CharSequence sequence=document.getCharsSequence();
  selectionStart=CharArrayUtil.shiftForward(sequence,selectionStart," \t\n");
  selectionEnd=CharArrayUtil.shiftBackward(sequence,selectionEnd - 1," \t\n") + 1;
  if (selectionEnd < selectionStart) {
    selectionEnd=selectionStart;
  }
  if (CharArrayUtil.regionMatches(sequence,selectionEnd - suffix.length(),suffix) && CharArrayUtil.regionMatches(sequence,selectionStart,prefix)) {
    return new TextRange(selectionStart,selectionEnd);
  }
  return null;
}
