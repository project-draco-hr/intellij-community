{
  Project project=getEventProject(e);
  if (project == null)   return;
  ToolWindowManager windowManager=ToolWindowManager.getInstance(project);
  final ToolWindow window=windowManager.getToolWindow(myToolWindowId);
  InputEvent event=e.getInputEvent();
  Runnable run=null;
  if (event instanceof KeyEvent && event.isShiftDown()) {
    final Content[] contents=window.getContentManager().getContents();
    if (contents.length > 0 && window.getContentManager().getSelectedContent() != contents[0]) {
      run=new Runnable(){
        public void run(){
          window.getContentManager().setSelectedContent(contents[0],true,true);
        }
      }
;
    }
  }
  if (windowManager.isEditorComponentActive() || !myToolWindowId.equals(windowManager.getActiveToolWindowId()) || run != null) {
    if (run != null && window.isActive()) {
      run.run();
    }
 else {
      window.activate(run);
    }
  }
 else {
    windowManager.getToolWindow(myToolWindowId).hide(null);
  }
}
