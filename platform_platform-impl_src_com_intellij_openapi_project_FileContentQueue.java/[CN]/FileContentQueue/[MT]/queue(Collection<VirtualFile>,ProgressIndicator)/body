{
  myFilesToLoadQueue.addAll(files);
  final Runnable contentLoadingRunnable=new Runnable(){
    public void run(){
      try {
        VirtualFile file=myFilesToLoadQueue.poll();
        while (file != null) {
          indicator.checkCanceled();
          addLast(file,indicator);
          file=myFilesToLoadQueue.poll();
        }
        try {
          myLoadedContentsQueue.put(new FileContent(null));
        }
 catch (        InterruptedException e) {
          LOG.error(e);
        }
      }
 catch (      ProcessCanceledException e) {
      }
catch (      InterruptedException e) {
        LOG.error(e);
      }
 finally {
        myContentLoadingThreadTerminated=true;
      }
    }
  }
;
  ApplicationManager.getApplication().executeOnPooledThread(contentLoadingRunnable);
}
