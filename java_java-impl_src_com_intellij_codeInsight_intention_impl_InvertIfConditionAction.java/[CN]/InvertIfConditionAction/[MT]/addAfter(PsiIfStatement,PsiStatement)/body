{
  if (thenBranch instanceof PsiBlockStatement) {
    PsiBlockStatement blockStatement=(PsiBlockStatement)thenBranch;
    final PsiCodeBlock block=blockStatement.getCodeBlock();
    final PsiElement firstBodyElement=block.getFirstBodyElement();
    final PsiElement lastBodyElement=block.getLastBodyElement();
    if (firstBodyElement != null && lastBodyElement != null) {
      ifStatement.getParent().addRangeAfter(firstBodyElement,lastBodyElement,ifStatement);
    }
  }
 else {
    ifStatement.getParent().addAfter(thenBranch,ifStatement);
  }
}
