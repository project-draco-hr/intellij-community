{
  if (!provider.isEnabled()) {
    return;
  }
  BufferExposingByteArrayOutputStream content=documentToBytes(copy,false);
  BufferExposingByteArrayInputStream in=new BufferExposingByteArrayInputStream(content.getInternalBuffer(),content.size());
  try {
    provider.saveContent(fileSpec,in,content.size(),type,async);
  }
  finally {
    in.close();
  }
}
