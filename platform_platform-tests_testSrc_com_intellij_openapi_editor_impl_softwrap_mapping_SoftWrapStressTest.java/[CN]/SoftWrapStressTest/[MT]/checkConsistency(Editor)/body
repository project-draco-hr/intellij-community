{
  DocumentEx document=((EditorEx)editor).getDocument();
  if (document.isInBulkUpdate())   return;
  Set<Integer> softWrapOffsets=checkSoftWraps(editor);
  List<CacheEntry> cache=((SoftWrapModelImpl)editor.getSoftWrapModel()).getDataMapper().getCache();
  CacheEntry prevEntry=null;
  for (  CacheEntry entry : cache) {
    boolean currentLineStartsWithSoftWrap=checkRelationBetweenNeighbourEntries(entry,prevEntry,softWrapOffsets);
    checkConsistencyWithinEntry(entry,currentLineStartsWithSoftWrap);
    checkConsistencyWithFoldingsAndTabs(editor,entry);
    prevEntry=entry;
  }
  assertTrue(softWrapOffsets.isEmpty());
}
