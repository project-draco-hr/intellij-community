{
  final VcsLogObjectsFactory factory=ServiceManager.getService(project,VcsLogObjectsFactory.class);
  return ContainerUtil.map(getCommittedChangeList(project,root,-1,false,""),new Function<HgCommittedChangeList,TimedVcsCommit>(){
    @Override public TimedVcsCommit fun(    HgCommittedChangeList record){
      HgRevisionNumber revNumber=(HgRevisionNumber)record.getRevisionNumber();
      List<Hash> parents=new SmartList<Hash>();
      for (      HgRevisionNumber parent : revNumber.getParents()) {
        parents.add(factory.createHash(parent.getChangeset()));
      }
      userRegistry.consume(factory.createUser(record.getRevision().getAuthor(),revNumber.getEmail()));
      return factory.createTimedCommit(factory.createHash(revNumber.getChangeset()),parents,record.getCommitDate().getTime());
    }
  }
);
}
