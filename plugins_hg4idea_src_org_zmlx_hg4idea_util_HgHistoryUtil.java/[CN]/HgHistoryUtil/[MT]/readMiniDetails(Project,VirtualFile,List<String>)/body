{
  final VcsLogObjectsFactory factory=ServiceManager.getService(VcsLogObjectsFactory.class);
  return ContainerUtil.map(getCommittedChangeList(project,root,-1,false,prepareHashes(hashes)),new Function<HgCommittedChangeList,VcsShortCommitDetails>(){
    @Override public VcsShortCommitDetails fun(    HgCommittedChangeList record){
      HgRevisionNumber revNumber=(HgRevisionNumber)record.getRevisionNumber();
      List<Hash> parents=new SmartList<Hash>();
      for (      HgRevisionNumber parent : revNumber.getParents()) {
        parents.add(factory.createHash(parent.getChangeset()));
      }
      return factory.createShortDetails(factory.createHash(revNumber.getChangeset()),parents,record.getCommitDate().getTime(),root,revNumber.getSubject(),revNumber.getAuthor());
    }
  }
);
}
