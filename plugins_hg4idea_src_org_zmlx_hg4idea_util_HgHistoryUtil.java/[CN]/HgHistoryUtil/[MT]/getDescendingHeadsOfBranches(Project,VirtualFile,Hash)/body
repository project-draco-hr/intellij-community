{
  Set<String> branchHeads=new HashSet<String>();
  List<String> params=new ArrayList<String>();
  params.add("-r");
  params.add("descendants(" + hash.asString() + ") and head()");
  HgFile hgFile=new HgFile(root,VcsUtil.getFilePath(root.getPath()));
  HgLogCommand hgLogCommand=new HgLogCommand(project);
  hgLogCommand.setLogFile(false);
  String template=HgChangesetUtil.makeTemplate("{branch}","{bookmarks}");
  HgCommandResult logResult=hgLogCommand.execute(root,template,-1,hgFile,params);
  if (logResult == null || logResult.getExitValue() != 0) {
    throw new VcsException("Couldn't get commit details: log command execution error.");
  }
  String output=logResult.getRawOutput();
  String[] changeSets=output.split(HgChangesetUtil.CHANGESET_SEPARATOR);
  for (  String line : changeSets) {
    String[] attributes=line.split(HgChangesetUtil.ITEM_SEPARATOR);
    branchHeads.addAll(Arrays.asList(attributes));
  }
  return branchHeads;
}
