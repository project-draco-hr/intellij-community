{
  initFixtureBuilder();
  final TestFixtureBuilder<IdeaProjectTestFixture> fixtureBuilder=IdeaTestFixtureFactory.getFixtureFactory().createFixtureBuilder(testName);
  myFixture=IdeaTestFixtureFactory.getFixtureFactory().createCodeInsightFixture(fixtureBuilder.getFixture());
  ModuleFixtureBuilder moduleFixtureBuilder=fixtureBuilder.addModule(MyModuleFixtureBuilder.class);
  moduleFixtureBuilder.addSourceContentRoot(myFixture.getTempDirPath());
  final String testDataPath=getTestDataPath();
  final boolean customTestData=!testDataPath.equals(getDefaultTestDataPath());
  if (customTestData || shouldAddDataPathToContentRoots()) {
    moduleFixtureBuilder.addSourceContentRoot(testDataPath);
  }
  final List<String> contentRoots=getContentRoots();
  for (  String contentRoot : contentRoots) {
    moduleFixtureBuilder.addContentRoot(testDataPath + contentRoot);
  }
  myFixture.setUp();
  myFixture.setTestDataPath(testDataPath);
}
