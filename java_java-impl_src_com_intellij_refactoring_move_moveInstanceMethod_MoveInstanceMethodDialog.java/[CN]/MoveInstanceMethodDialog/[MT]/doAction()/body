{
  Map<PsiClass,String> parameterNames=new LinkedHashMap<PsiClass,String>();
  for (  final PsiClass aClass : myThisClassesMap.keySet()) {
    EditorTextField field=myOldClassParameterNameFields.get(aClass);
    if (field.isEnabled()) {
      String parameterName=field.getText().trim();
      if (!PsiNameHelper.getInstance(myMethod.getProject()).isIdentifier(parameterName)) {
        Messages.showErrorDialog(getProject(),RefactoringBundle.message("move.method.enter.a.valid.name.for.parameter"),myRefactoringName);
        return;
      }
      parameterNames.put(aClass,parameterName);
    }
  }
  final PsiVariable targetVariable=(PsiVariable)myList.getSelectedValue();
  if (targetVariable == null)   return;
  final MoveInstanceMethodProcessor processor=new MoveInstanceMethodProcessor(myMethod.getProject(),myMethod,targetVariable,myVisibilityPanel.getVisibility(),isOpenInEditor(),parameterNames);
  if (!verifyTargetClass(processor.getTargetClass()))   return;
  saveOpenInEditorOption();
  invokeRefactoring(processor);
}
