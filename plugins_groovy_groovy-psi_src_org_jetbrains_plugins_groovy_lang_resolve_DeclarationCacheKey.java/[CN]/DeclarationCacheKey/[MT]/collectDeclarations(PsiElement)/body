{
  final List<DeclarationHolder> result=ContainerUtil.newSmartList();
  PsiTreeUtil.treeWalkUp(place,null,new PairProcessor<PsiElement,PsiElement>(){
    @Override public boolean process(    PsiElement scope,    PsiElement lastParent){
      result.add(collectScopeDeclarations(scope,lastParent));
      if (nonCode && scope instanceof GrClosableBlock)       return false;
      return true;
    }
  }
);
  return result;
}
