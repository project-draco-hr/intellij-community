{
  final Graph<Chunk<Node>> chunkGraph=toChunkGraph(graph);
  final List<Chunk<Node>> chunks=new ArrayList<>(chunkGraph.getNodes().size());
  for (  final Chunk<Node> chunk : chunkGraph.getNodes()) {
    chunks.add(chunk);
  }
  DFSTBuilder<Chunk<Node>> builder=new DFSTBuilder<>(chunkGraph);
  if (!builder.isAcyclic()) {
    LOG.error("Acyclic graph expected");
    return null;
  }
  Collections.sort(chunks,builder.comparator());
  return chunks;
}
