{
  for (  ASTNode node : pyString.getStringNodes()) {
    final StringNodeInfo nodeInfo=new StringNodeInfo(node);
    if (nodeInfo.isFormatted()) {
      final int nodeOffset=node.getTextRange().getStartOffset();
      final List<FragmentOffsets> fragments=FStringParser.parse(node.getText());
      boolean hasUnclosedBrace=false;
      for (      FragmentOffsets fragment : fragments) {
        if (fragment.getLeftBraceOffset() + 1 >= fragment.getContentEndOffset()) {
          report(fragment.getContentRange().shiftRight(nodeOffset),"Empty expressions are not allowed inside f-strings");
        }
        if (fragment.getRightBraceOffset() == -1) {
          hasUnclosedBrace=true;
        }
      }
      if (hasUnclosedBrace) {
        report(TextRange.from(nodeInfo.getContentRange().getEndOffset(),0).shiftRight(nodeOffset),"'}' is expected");
      }
    }
  }
}
