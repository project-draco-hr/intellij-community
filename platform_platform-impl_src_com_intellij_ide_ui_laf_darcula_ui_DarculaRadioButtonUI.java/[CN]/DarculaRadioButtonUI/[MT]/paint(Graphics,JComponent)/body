{
  Graphics2D g=(Graphics2D)g2d;
  Dimension size=c.getSize();
  Rectangle viewRect=new Rectangle(size);
  Rectangle iconRect=new Rectangle();
  Rectangle textRect=new Rectangle();
  AbstractButton b=(AbstractButton)c;
  Font f=c.getFont();
  g.setFont(f);
  FontMetrics fm=SwingUtilities2.getFontMetrics(c,g,f);
  String text=SwingUtilities.layoutCompoundLabel(c,fm,b.getText(),getDefaultIcon(),b.getVerticalAlignment(),b.getHorizontalAlignment(),b.getVerticalTextPosition(),b.getHorizontalTextPosition(),viewRect,iconRect,textRect,b.getIconTextGap());
  if (c.isOpaque()) {
    g.setColor(c.getBackground());
    g.fillRect(0,0,size.width,size.height);
  }
  paintIcon(c,g,viewRect,iconRect);
  drawText(b,g,text,textRect,fm);
}
