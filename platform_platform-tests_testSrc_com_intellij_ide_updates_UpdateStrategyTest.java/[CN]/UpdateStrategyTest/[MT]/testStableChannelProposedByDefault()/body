{
  BuildNumber currentBuild=BuildNumber.fromString("IU-143.381");
  TestUpdateSettings settings=new TestUpdateSettings(ChannelStatus.RELEASE);
  UpdateStrategyCustomization customization=new UpdateStrategyCustomization();
  UpdateStrategy strategy=new UpdateStrategy(15,currentBuild,InfoReader.read("idea-123280.xml"),settings,customization);
  CheckForUpdateResult result=strategy.checkForUpdates();
  assertEquals(UpdateStrategy.State.LOADED,result.getState());
  UpdateChannel channelToPropose=result.getChannelToPropose();
  assertNotNull(channelToPropose);
  assertEquals("IDEA_Release",channelToPropose.getId());
  settings.setKnownChannelIds(Collections.singletonList(channelToPropose.getId()));
  result=strategy.checkForUpdates();
  assertEquals(UpdateStrategy.State.LOADED,result.getState());
  assertNull(result.getChannelToPropose());
}
