{
  if (sourcePosition != null) {
    final Document document=FileDocumentManager.getInstance().getDocument(sourcePosition.getFile());
    final PsiFile psiFile=PsiDocumentManager.getInstance(project).getPsiFile(document);
    if (psiFile != null) {
      int offset=sourcePosition.getOffset();
      if (offset >= 0 && offset < document.getTextLength()) {
        final int lineEndOffset=document.getLineEndOffset(document.getLineNumber(offset));
        do {
          PsiElement element=psiFile.findElementAt(offset);
          if (element != null && !(element instanceof PsiWhiteSpace || element instanceof PsiComment)) {
            return PyPsiUtils.getStatement(element);
          }
          offset=element.getTextRange().getEndOffset();
        }
 while (offset < lineEndOffset);
      }
    }
  }
  return null;
}
