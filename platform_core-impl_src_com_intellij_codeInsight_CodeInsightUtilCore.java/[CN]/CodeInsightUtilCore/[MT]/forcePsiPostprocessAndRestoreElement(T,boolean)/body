{
  final PsiFile psiFile=element.getContainingFile();
  final Document document=psiFile.getViewProvider().getDocument();
  final Language language=useFileLanguage ? psiFile.getLanguage() : PsiUtilCore.getDialect(element);
  final PsiDocumentManager documentManager=PsiDocumentManager.getInstance(psiFile.getProject());
  final RangeMarker rangeMarker=document.createRangeMarker(element.getTextRange());
  documentManager.doPostponedOperationsAndUnblockDocument(document);
  documentManager.commitDocument(document);
  T elementInRange=findElementInRange(psiFile,rangeMarker.getStartOffset(),rangeMarker.getEndOffset(),(Class<? extends T>)element.getClass(),language,element);
  rangeMarker.dispose();
  return elementInRange;
}
