{
  Editor editor=event.getEditor();
  if (editor.isOneLineMode()) {
    return;
  }
  alarm.cancelAllRequests();
  Point point=event.getMouseEvent().getPoint();
  if (elementsRef == null && event.getMouseEvent().isShiftDown()) {
    alarm.addRequest(new PreviewRequest(point,editor,false),100);
  }
 else {
    Collection<PsiElement> elements=SoftReference.dereference(elementsRef);
    if (!getPsiElementsAt(point,editor).equals(elements)) {
      elementsRef=null;
      for (      ElementPreviewProvider provider : Extensions.getExtensions(ElementPreviewProvider.EP_NAME)) {
        try {
          if (elements != null) {
            for (            PsiElement element : elements) {
              provider.hide(element,editor);
            }
          }
 else {
            provider.hide(null,editor);
          }
        }
 catch (        Exception e) {
          LOG.error(e);
        }
      }
    }
  }
}
