{
  editorFactory.addEditorFactoryListener(new EditorFactoryListener(){
    @Override public void editorCreated(    @NotNull EditorFactoryEvent event){
      registerListeners(event.getEditor());
    }
    @Override public void editorReleased(    @NotNull EditorFactoryEvent event){
      Editor editor=event.getEditor();
      if (editor.isOneLineMode()) {
        return;
      }
      KeyListener keyListener=editor.getUserData(EDITOR_LISTENER_ADDED);
      if (keyListener != null) {
        editor.getContentComponent().removeKeyListener(keyListener);
        editor.removeEditorMouseMotionListener(ImageOrColorPreviewManager.this);
      }
    }
  }
,this);
}
