{
  XTestValueNode node=computePresentation(var);
  if (value == null) {
    assertNull("full value evaluator should be null",node.myFullValueEvaluator);
  }
 else {
    final FutureResult<String> result=new FutureResult<>();
    node.myFullValueEvaluator.startEvaluation(new XFullValueEvaluator.XFullValueEvaluationCallback(){
      @Override public void evaluated(      @NotNull String fullValue){
        result.set(fullValue);
      }
      @Override public void evaluated(      @NotNull String fullValue,      @Nullable Font font){
        result.set(fullValue);
      }
      @Override public void errorOccurred(      @NotNull String errorMessage){
        result.set(errorMessage);
      }
      @Override public boolean isObsolete(){
        return false;
      }
    }
);
    assertEquals(value,result.get(TIMEOUT,TimeUnit.MILLISECONDS));
  }
}
