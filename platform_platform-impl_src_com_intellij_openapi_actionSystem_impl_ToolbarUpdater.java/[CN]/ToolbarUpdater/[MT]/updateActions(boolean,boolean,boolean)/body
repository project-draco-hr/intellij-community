{
  final IdRunnable updateRunnable=new IdRunnable(this){
    @Override public void run(){
      if (!myComponent.isVisible()) {
        return;
      }
      updateActionsImpl(transparentOnly,forced);
    }
  }
;
  if (now) {
    updateRunnable.run();
  }
 else {
    final Application app=ApplicationManager.getApplication();
    final IdeFocusManager fm=IdeFocusManager.getInstance(null);
    if (!app.isUnitTestMode() && !app.isHeadlessEnvironment()) {
      if (app.isDispatchThread()) {
        fm.doWhenFocusSettlesDown(updateRunnable);
      }
 else {
        UiNotifyConnector.doWhenFirstShown(myComponent,new Runnable(){
          @Override public void run(){
            fm.doWhenFocusSettlesDown(updateRunnable);
          }
        }
);
      }
    }
  }
}
