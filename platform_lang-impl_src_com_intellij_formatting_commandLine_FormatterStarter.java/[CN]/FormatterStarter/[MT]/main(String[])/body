{
  @SuppressWarnings("UseOfSystemOutOrSystemErr") MessageOutput messageOutput=new MessageOutput(new PrintWriter(System.out),new PrintWriter(System.err));
  messageOutput.info(getAppInfo() + " Formatter\n");
  CodeStyleSettings settings=null;
  logArgs(args);
  if (args.length < 2) {
    showUsageInfo(messageOutput);
  }
  for (int i=1; i < args.length; i++) {
    if (args[i].startsWith("-")) {
      if (checkOption(args[i],"-h","--help")) {
        showUsageInfo(messageOutput);
      }
      if (checkOption(args[i],"-s","--settings")) {
        i++;
        if (i >= args.length) {
          fatalError(messageOutput,"Mising settings file path.");
        }
        try {
          settings=readSettings(args[i]);
        }
 catch (        SchemeImportException e) {
          fatalError(messageOutput,e.getLocalizedMessage() + "\n");
        }
      }
 else {
        fatalError(messageOutput,"Unknown option " + args[i]);
      }
    }
 else {
      FileSetFormatter fileSetFormatter=new FileSetFormatter(args[i],settings,messageOutput);
      try {
        fileSetFormatter.processFiles();
        messageOutput.info("\n" + fileSetFormatter.getProcessedFiles() + " files formatted.\n");
      }
 catch (      IOException e) {
        fatalError(messageOutput,e.getLocalizedMessage());
      }
    }
  }
  ((ApplicationEx)ApplicationManager.getApplication()).exit(true,true);
}
