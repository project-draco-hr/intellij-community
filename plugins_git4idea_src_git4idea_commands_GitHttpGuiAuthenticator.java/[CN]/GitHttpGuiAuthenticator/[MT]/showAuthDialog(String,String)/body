{
  final Ref<AuthDialog> dialog=Ref.create();
  ApplicationManager.getApplication().invokeAndWait(new Runnable(){
    @Override public void run(){
      dialog.set(new AuthDialog(myProject,myTitle,"Enter credentials for " + url,login,null,true));
      dialog.get().show();
    }
  }
,myModalityState == null ? ModalityState.defaultModalityState() : myModalityState);
  return dialog.get();
}
