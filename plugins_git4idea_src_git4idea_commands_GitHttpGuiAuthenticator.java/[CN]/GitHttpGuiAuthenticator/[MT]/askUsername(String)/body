{
  url=adjustUrl(url);
  Pair<GitHttpAuthDataProvider,AuthData> authData=findBestAuthData(url);
  String login=null;
  String password=null;
  if (authData != null) {
    login=authData.second.getLogin();
    password=authData.second.getPassword();
    myDataProvider=authData.first;
  }
  if (login != null && password != null) {
    myPassword=password;
    return login;
  }
  final AuthDialog dialog=new AuthDialog(myProject,myTitle,"Enter credentials for " + url,login,null,true);
  ApplicationManager.getApplication().invokeAndWait(new Runnable(){
    @Override public void run(){
      dialog.show();
    }
  }
,myModalityState == null ? ModalityState.defaultModalityState() : myModalityState);
  if (!dialog.isOK()) {
    return "";
  }
  myPassword=dialog.getPassword();
  myLogin=dialog.getUsername();
  myUrl=url;
  myRememberOnDisk=dialog.isRememberPassword();
  myPasswordKey=makeKey(myUrl,myLogin);
  return myLogin;
}
