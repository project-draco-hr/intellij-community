{
  url=adjustUrl(url);
  Pair<GitHttpAuthDataProvider,AuthData> authData=findBestAuthData(url,myModalityState);
  String login=null;
  String password=null;
  if (authData != null) {
    login=authData.second.getLogin();
    password=authData.second.getPassword();
    myDataProvider=authData.first;
  }
  if (login != null && password != null) {
    myPassword=password;
    return login;
  }
  AuthDialog dialog=showAuthDialog(url,login);
  if (dialog == null || !dialog.isOK()) {
    myWasCancelled=true;
    return "";
  }
  myPassword=dialog.getPassword();
  myLogin=dialog.getUsername();
  myUrl=url;
  mySaveOnDisk=dialog.isRememberPassword();
  myPasswordKey=makeKey(myUrl,myLogin);
  return myLogin;
}
