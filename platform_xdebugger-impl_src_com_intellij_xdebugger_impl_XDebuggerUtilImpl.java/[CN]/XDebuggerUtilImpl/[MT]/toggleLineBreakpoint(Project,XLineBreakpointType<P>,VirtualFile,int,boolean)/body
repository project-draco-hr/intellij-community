{
  final Ref<XLineBreakpoint> res=new Ref<XLineBreakpoint>();
  new WriteAction(){
    @Override protected void run(    @NotNull final Result result){
      XBreakpointManager breakpointManager=XDebuggerManager.getInstance(project).getBreakpointManager();
      XLineBreakpoint<P> breakpoint=breakpointManager.findBreakpointAtLine(type,file,line);
      if (breakpoint != null) {
        breakpointManager.removeBreakpoint(breakpoint);
      }
 else {
        P properties=type.createBreakpointProperties(file,line);
        res.set(breakpointManager.addLineBreakpoint(type,file.getUrl(),line,properties,temporary));
      }
    }
  }
.execute();
  return res.get();
}
