{
  PsiElement scope=context.getScope();
  final PsiClass targetClass=scope instanceof GroovyFileBase ? ((GroovyFileBase)scope).getScriptClass() : (PsiClass)scope;
  if (targetClass == null)   return null;
  final GrVariableDeclaration declaration=insertField(targetClass);
  final GrVariable field=declaration.getVariables()[0];
switch (settings.initializeIn()) {
case CUR_METHOD:
    initializeInMethod(field);
  break;
case FIELD_DECLARATION:
field.setInitializerGroovy(getInitializer());
break;
case CONSTRUCTOR:
initializeInConstructor(field);
break;
case SETUP_METHOD:
initializeInSetup(field);
break;
}
JavaCodeStyleManager.getInstance(declaration.getProject()).shortenClassReferences(declaration);
if (settings.removeLocalVar()) {
GrIntroduceHandlerBase.deleteLocalVar(context);
}
processOccurrences(targetClass,field);
return field;
}
