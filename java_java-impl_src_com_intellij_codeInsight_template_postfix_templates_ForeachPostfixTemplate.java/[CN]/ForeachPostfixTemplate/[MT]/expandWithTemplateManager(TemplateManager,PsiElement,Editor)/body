{
  String finalPart=JavaCodeStyleSettingsFacade.getInstance(expression.getProject()).isGenerateFinalLocals() ? "final " : "";
  Template template=manager.createTemplate("","","for (" + finalPart + "$type$ $name$ : $variable$) {\n    $END$\n}");
  MacroCallNode type=new MacroCallNode(new IterableComponentTypeMacro());
  MacroCallNode name=new MacroCallNode(new SuggestVariableNameMacro());
  String variable="variable";
  type.addParameter(new VariableNode(variable,null));
  template.addVariable("type",type,type,false);
  template.addVariable("name",name,name,true);
  template.addVariable(variable,new TextExpression(expression.getText()),false);
  manager.startTemplate(editor,template);
}
