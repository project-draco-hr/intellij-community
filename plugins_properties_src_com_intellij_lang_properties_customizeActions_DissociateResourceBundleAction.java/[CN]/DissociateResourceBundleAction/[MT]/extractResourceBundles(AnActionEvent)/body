{
  final Set<ResourceBundle> targetResourceBundles=new HashSet<ResourceBundle>();
  final ResourceBundle[] chosenResourceBundles=event.getData(ResourceBundle.ARRAY_DATA_KEY);
  if (chosenResourceBundles != null) {
    for (    ResourceBundle resourceBundle : chosenResourceBundles) {
      if (resourceBundle.getPropertiesFiles().size() > 1) {
        targetResourceBundles.add(resourceBundle);
      }
    }
  }
  final PsiElement[] psiElements=event.getData(LangDataKeys.PSI_ELEMENT_ARRAY);
  if (psiElements != null) {
    for (    PsiElement element : psiElements) {
      if (element instanceof PsiFile) {
        final PropertiesFile propertiesFile=PropertiesImplUtil.getPropertiesFile((PsiFile)element);
        if (propertiesFile != null) {
          final ResourceBundle bundle=propertiesFile.getResourceBundle();
          if (bundle.getPropertiesFiles().size() > 1) {
            targetResourceBundles.add(bundle);
          }
        }
      }
    }
  }
  return targetResourceBundles;
}
