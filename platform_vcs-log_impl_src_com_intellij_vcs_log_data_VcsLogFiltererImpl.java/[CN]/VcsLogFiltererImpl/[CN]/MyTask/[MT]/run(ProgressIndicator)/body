{
  VisiblePack visiblePack=null;
  List<Request> requests;
  while (!(requests=myTaskController.popRequests()).isEmpty()) {
    try {
      visiblePack=getVisiblePack(visiblePack,requests);
    }
 catch (    ProcessCanceledException ignored) {
      return;
    }
catch (    Throwable t) {
      LOG.error("Error while filtering log",t);
    }
  }
  myTaskController.taskCompleted(visiblePack);
  if (visiblePack != null) {
    final List<MoreCommitsRequest> requestsToRun=myRequestsToRun;
    myRequestsToRun=ContainerUtil.newArrayList();
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      @Override public void run(){
        for (        MoreCommitsRequest request : requestsToRun) {
          request.onLoaded.run();
        }
      }
    }
);
  }
}
