{
  if (!ensureValid())   return false;
  CommandProcessor.getInstance().executeCommand(myProject,new Runnable(){
    @Override public void run(){
      final String refactoringId=getRefactoringId();
      if (refactoringId != null) {
        final RefactoringEventData beforeData=new RefactoringEventData();
        final V localVariable=getLocalVariable();
        if (localVariable != null) {
          beforeData.addElement(localVariable);
        }
 else {
          final E beforeExpr=getBeforeExpr();
          if (beforeExpr != null) {
            beforeData.addElement(beforeExpr);
          }
        }
        myProject.getMessageBus().syncPublisher(RefactoringEventListener.REFACTORING_EVENT_TOPIC).refactoringStarted(refactoringId,beforeData);
      }
      performIntroduce();
    }
  }
,getCommandName(),getCommandName());
  V variable=getVariable();
  if (variable != null) {
    saveSettings(variable);
  }
  return false;
}
