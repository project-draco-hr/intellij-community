{
  if (task.isHeadless()) {
    if (ApplicationManager.getApplication().isDispatchThread()) {
      runProcessWithProgressSynchronously(task,null);
    }
 else {
      runProcessWithProgressInCurrentThread(task,new EmptyProgressIndicator(),ModalityState.NON_MODAL);
    }
  }
 else   if (task.isModal()) {
    runProcessWithProgressSynchronously(task.asModal(),null);
  }
 else {
    final Task.Backgroundable backgroundable=task.asBackgroundable();
    if (backgroundable.isConditionalModal() && !backgroundable.shouldStartInBackground()) {
      runProcessWithProgressSynchronously(task,null);
    }
 else {
      runProcessWithProgressAsynchronously(backgroundable);
    }
  }
}
