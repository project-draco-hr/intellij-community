{
  Application application=ApplicationManager.getApplication();
  PostfixTemplatesManager templatesManager=application.getComponent(PostfixTemplatesManager.class);
  PsiElement position=parameters.getPosition();
  PostfixTemplateContext context=templatesManager.isAvailable(position,executionContext);
  if (context == null)   return Collections.emptyList();
  String extraPrefix=context.shouldFixPrefixMatcher();
  if (extraPrefix != null) {
    PrefixMatcher prefixMatcher=result.getPrefixMatcher();
    PrefixMatcher extraMatcher=prefixMatcher.cloneWithPrefix(extraPrefix + prefixMatcher.getPrefix());
    result=result.withPrefixMatcher(extraMatcher);
  }
  List<LookupElement> lookupElements=templatesManager.collectTemplates(context);
  for (  LookupElement postfixElement : lookupElements) {
    result.addElement(postfixElement);
  }
  return lookupElements;
}
