{
  PyFunction pyFunction=PsiTreeUtil.getParentOfType(element,PyFunction.class,false);
  if (!isTestFunction(pyFunction))   return null;
  final PyClass containingClass=pyFunction.getContainingClass();
  final RunnerAndConfigurationSettings settings=makeConfigurationSettings(location,"tests from function");
  final AbstractPythonTestRunConfiguration configuration=(AbstractPythonTestRunConfiguration)settings.getConfiguration();
  configuration.setMethodName(pyFunction.getName());
  RunConfiguration conf=findConfiguration(location,pyFunction,1);
  if (conf instanceof AbstractPythonTestRunConfiguration) {
    configuration.setEnvs(((AbstractPythonTestRunConfiguration)conf).getEnvs());
  }
  if (containingClass != null) {
    configuration.setClassName(containingClass.getName());
    configuration.setTestType(AbstractPythonTestRunConfiguration.TestType.TEST_METHOD);
  }
 else {
    configuration.setTestType(AbstractPythonTestRunConfiguration.TestType.TEST_FUNCTION);
  }
  if (!setupConfigurationScript(configuration,pyFunction))   return null;
  configuration.setName(configuration.suggestedName());
  myPsiElement=pyFunction;
  return settings;
}
