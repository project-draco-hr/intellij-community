{
  final RunManager runManager=RunManager.getInstance(element.getProject());
  final RunnerAndConfigurationSettings[] existingConfigurations=runManager.getConfigurationSettings(getConfigurationType());
  RunnerAndConfigurationSettings settings;
  RunConfiguration configuration;
  if (level == 1) {
    PyClass cl=((PyFunction)element).getContainingClass();
    if (cl != null)     settings=createConfigurationFromClass(location,cl);
 else     settings=createConfigurationFromClass(location,element);
    configuration=checkSettings(settings,existingConfigurations);
    if (configuration != null)     return configuration;
  }
  if (level == 1 || level == 2) {
    settings=createConfigurationFromFile(location,element);
    configuration=checkSettings(settings,existingConfigurations);
    if (configuration != null)     return configuration;
  }
  PsiElement e=location.getPsiElement();
  PsiDirectory dir=e.getContainingFile().getContainingDirectory();
  if (dir != null) {
    PsiLocation<PsiDirectory> l=new PsiLocation<PsiDirectory>(e.getProject(),dir);
    settings=createConfigurationFromFolder(l);
    configuration=checkSettings(settings,existingConfigurations);
    if (configuration != null)     return configuration;
  }
  return null;
}
