{
  if (!isAvailable(location))   return null;
  RunnerAndConfigurationSettings settings;
  if (PythonUnitTestRunnableScriptFilter.isIfNameMain(location)) {
    return null;
  }
  settings=createConfigurationFromFolder(location);
  if (settings != null)   return settings;
  PsiElement element=location.getPsiElement();
  if (element instanceof PsiWhiteSpace) {
    element=element.getPrevSibling();
  }
  final PyElement pyElement=PsiTreeUtil.getParentOfType(element,PyElement.class,false);
  if (pyElement != null) {
    settings=createConfigurationFromFunction(location,pyElement);
    if (settings != null)     return settings;
    settings=createConfigurationFromClass(location,pyElement);
    if (settings != null)     return settings;
    final VirtualFile virtualFile=location.getVirtualFile();
    if (virtualFile != null && virtualFile.getFileType() instanceof PythonFileType)     settings=createConfigurationFromFile(location,pyElement);
    if (settings != null)     return settings;
  }
  return null;
}
