{
  Disposer.register(myProject,this);
  Map<VirtualFile,VcsLogProvider> logProviders=findLogProviders(roots,myProject);
  myDataManager=new VcsLogDataManager(myProject,this,logProviders);
  VcsLogRefresher logRefresher;
  if (contentTabName != null) {
    logRefresher=new PostponableLogRefresher(myProject,myDataManager,contentTabName);
  }
 else {
    logRefresher=new VcsLogRefresher(){
      @Override public void refresh(      @NotNull VirtualFile root){
        myDataManager.refresh(Collections.singletonList(root));
      }
    }
;
  }
  refreshLogOnVcsEvents(logProviders,logRefresher);
  myDataManager.initialize();
  myColorManager=new VcsLogColorManagerImpl(logProviders.keySet());
  myUi=createLogUi();
  myUi.requestFocus();
  return myUi.getMainFrame().getMainComponent();
}
