{
  myProject=project;
  myUiProperties=uiProperties;
  myRecreateMainLogHandler=recreateHandler;
  Map<VirtualFile,VcsLogProvider> logProviders=findLogProviders(roots,myProject);
  myLogData=new VcsLogData(myProject,logProviders,new MyFatalErrorsHandler());
  myPostponableRefresher=new PostponableLogRefresher(myLogData);
  myTabsLogRefresher=new VcsLogTabsWatcher(myProject,myPostponableRefresher,myLogData);
  refreshLogOnVcsEvents(logProviders,myPostponableRefresher,myLogData);
  myColorManager=new VcsLogColorManagerImpl(logProviders.keySet());
  if (scheduleRefreshImmediately) {
    scheduleInitialization();
  }
  Disposer.register(project,this);
}
