{
  myProject=project;
  myUiProperties=uiProperties;
  Map<VirtualFile,VcsLogProvider> logProviders=findLogProviders(roots,myProject);
  myDataManager=new VcsLogDataManager(myProject,logProviders,new MyFatalErrorsConsumer());
  myPostponableRefresher=new PostponableLogRefresher(myDataManager);
  myTabsLogRefresher=new VcsLogTabsWatcher(myProject,myPostponableRefresher,myDataManager);
  refreshLogOnVcsEvents(logProviders,myPostponableRefresher,myDataManager);
  myColorManager=new VcsLogColorManagerImpl(logProviders.keySet());
  myDataManager.refreshCompletely();
  Disposer.register(project,this);
}
