{
  final List<AddParameter> newParams=new ArrayList<AddParameter>();
  for (  AddParameter param : myAddParameterRequests) {
    if (param.type != null) {
      final Substring typeSub=myOriginalDocString.getParamTypeSubstring(param.name);
      if (typeSub != null) {
        replace(typeSub.getTextRange(),param.type);
        continue;
      }
      final Substring nameSub=findParamNameSubstring(param.name);
      if (nameSub != null) {
        updateParamDeclarationWithType(nameSub,param.type);
        continue;
      }
    }
    newParams.add(param);
  }
  if (!newParams.isEmpty()) {
    final SectionBasedDocStringBuilder paramBlockBuilder=createBuilder();
    final Section firstParamSection=findFirstParametersSection();
    if (firstParamSection == null) {
      paramBlockBuilder.addEmptyLine().startParametersSection();
      final String blockText=buildBlock(paramBlockBuilder,newParams,getExpectedFieldIndent(),getExpectedSectionIndent());
      insertAfterLine(findLastNonEmptyLine(),blockText);
    }
 else {
      final SectionField firstParamField=ContainerUtil.getFirstItem(firstParamSection.getFields());
      if (firstParamField == null) {
        final String blockText=buildBlock(paramBlockBuilder,newParams,getExpectedFieldIndent(),getSectionIndent(firstParamSection));
        insertAfterLine(getSectionLastTitleLine(firstParamSection),blockText);
      }
 else {
        final String blockText=buildBlock(paramBlockBuilder,newParams,getFieldIndent(firstParamSection,firstParamField),getSectionIndent(firstParamSection));
        insertBeforeLine(getFieldStartLine(firstParamField),blockText);
      }
    }
  }
}
