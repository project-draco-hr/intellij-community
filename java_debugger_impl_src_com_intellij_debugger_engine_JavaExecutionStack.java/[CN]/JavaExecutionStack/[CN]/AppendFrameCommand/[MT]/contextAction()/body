{
  if (myStackFramesIterator.hasNext()) {
    JavaStackFrame frame;
    boolean first=myAdded == 0;
    if (first && myTopFrameReady) {
      frame=myTopFrame;
      myStackFramesIterator.next();
    }
 else {
      frame=new JavaStackFrame(myStackFramesIterator.next(),myDebugProcess,myTracker,myNodeManager);
      if (first && !myTopFrameReady) {
        myTopFrame=frame;
        myTopFrameReady=true;
      }
    }
    if (first || DebuggerSettings.getInstance().SHOW_LIBRARY_STACKFRAMES || (!frame.getDescriptor().isSynthetic() && !frame.getDescriptor().isInLibraryContent())) {
      if (++myAdded > mySkip) {
        myContainer.addStackFrames(Arrays.asList(frame),false);
      }
    }
    myDebugProcess.getManagerThread().schedule(new AppendFrameCommand(getSuspendContext(),myStackFramesIterator,myContainer,myAdded,mySkip));
  }
 else {
    myContainer.addStackFrames(Collections.<JavaStackFrame>emptyList(),true);
  }
}
