{
  final PsiElement element=params.getElementToSearch();
  if (!(element instanceof PyElement) && !(element instanceof PsiDirectory)) {
    return;
  }
  AccessToken token=ApplicationManager.getApplication().acquireReadActionLock();
  String name;
  SearchScope searchScope;
  try {
    searchScope=params.getEffectiveSearchScope();
    if (searchScope instanceof GlobalSearchScope) {
      searchScope=GlobalSearchScope.getScopeRestrictedByFileTypes((GlobalSearchScope)searchScope,PythonFileType.INSTANCE);
    }
    name=PyUtil.computeElementNameForStringSearch(element);
  }
  finally {
    token.finish();
  }
  if (StringUtil.isEmpty(name)) {
    return;
  }
  params.getOptimizer().searchWord(name,searchScope,UsageSearchContext.IN_STRINGS,true,element);
}
