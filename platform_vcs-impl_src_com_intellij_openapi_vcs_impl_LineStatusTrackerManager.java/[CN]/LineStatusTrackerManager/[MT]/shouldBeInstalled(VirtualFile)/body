{
  myApplication.assertIsDispatchThread();
  if (isDisabled())   return false;
  if (virtualFile == null || virtualFile instanceof LightVirtualFile)   return false;
  if (!virtualFile.isInLocalFileSystem())   return false;
  final FileStatusManager statusManager=FileStatusManager.getInstance(myProject);
  if (statusManager == null)   return false;
  final AbstractVcs activeVcs=myVcsManager.getVcsFor(virtualFile);
  if (activeVcs == null) {
    log("shouldBeInstalled: for file " + virtualFile.getPath() + " failed: no active VCS");
    return false;
  }
  final FileStatus status=statusManager.getStatus(virtualFile);
  if (status == FileStatus.NOT_CHANGED || status == FileStatus.ADDED || status == FileStatus.UNKNOWN || status == FileStatus.IGNORED) {
    log("shouldBeInstalled: for file " + virtualFile.getPath() + " skipped: status="+ status);
    return false;
  }
  return true;
}
