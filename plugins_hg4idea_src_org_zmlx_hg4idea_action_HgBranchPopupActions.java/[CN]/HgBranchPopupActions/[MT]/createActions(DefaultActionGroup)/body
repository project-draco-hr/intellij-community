{
  DefaultActionGroup popupGroup=new DefaultActionGroup(null,false);
  popupGroup.addAction(new HgNewBranchAction(myProject,Collections.singletonList(myRepository),myRepository.getRoot()));
  popupGroup.addAction(new HgNewBookmarkAction(myProject,Collections.singletonList(myRepository),myRepository.getRoot()));
  if (toInsert != null) {
    popupGroup.addAll(toInsert);
  }
  popupGroup.addSeparator("Bookmarks");
  List<String> bookmarkNames=HgUtil.getNamesWithoutHashes(myRepository.getBookmarks());
  String currentBookmark=myRepository.getCurrentBookmark();
  Collections.sort(bookmarkNames);
  for (  String bookmark : bookmarkNames) {
    AnAction bookmarkAction=new BranchActions(myProject,bookmark,myRepository);
    if (bookmark.equals(currentBookmark)) {
      bookmarkAction.getTemplatePresentation().setIcon(PlatformIcons.CHECK_ICON);
    }
    popupGroup.add(bookmarkAction);
  }
  popupGroup.addSeparator("Branches");
  List<String> branchNames=HgUtil.getNamesWithoutHashes(myRepository.getBranches());
  Collections.sort(branchNames);
  for (  String branch : branchNames) {
    if (!branch.equals(myRepository.getCurrentBranch())) {
      popupGroup.add(new BranchActions(myProject,branch,myRepository));
    }
  }
  return popupGroup;
}
