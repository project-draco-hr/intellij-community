{
  UpdatedFiles updatedFiles=UpdatedFiles.create();
  HgMergeCommand hgMergeCommand=new HgMergeCommand(myProject,mySelectedRepository.getRoot());
  hgMergeCommand.setBranch(myBranchName);
  HgCommandResultNotifier notifier=new HgCommandResultNotifier(myProject);
  try {
    new HgHeadMerger(myProject,hgMergeCommand).merge(mySelectedRepository.getRoot(),updatedFiles,HgRevisionNumber.NULL_REVISION_NUMBER);
    new HgConflictResolver(myProject,updatedFiles).resolve(mySelectedRepository.getRoot());
  }
 catch (  VcsException exception) {
    if (exception.isWarning()) {
      notifier.notifyWarning("Warning during merge",exception.getMessage());
    }
 else {
      notifier.notifyError(null,"Exception during merge",exception.getMessage());
    }
  }
}
