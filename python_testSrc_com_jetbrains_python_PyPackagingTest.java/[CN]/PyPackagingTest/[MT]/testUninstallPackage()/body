{
  forAllPythonEnvs(new Processor<Sdk>(){
    @Override public boolean process(    final Sdk sdk){
      try {
        final File tempDir=FileUtil.createTempDirectory(getTestName(false),null);
        final String venvSdkHome=PyPackagingUtil.createVirtualEnv(sdk,tempDir.getPath());
        final Sdk venvSdk=createTempSdk(venvSdkHome);
        assertNotNull(venvSdk);
        final PyPackagingUtil packaging=PyPackagingUtil.getInstance();
        final List<PyPackage> packages1=packaging.getInstalledPackages(venvSdk);
        final PyPackage pip1=findPackage("pip",packages1);
        assertNotNull(pip1);
        assertEquals("pip",pip1.getName());
        assertEquals("1.0.2",pip1.getVersion());
        packaging.uninstallPackage(venvSdk,pip1);
        final List<PyPackage> packages2=packaging.getInstalledPackages(venvSdk);
        final PyPackage pip2=findPackage("pip",packages2);
        assertNull(pip2);
      }
 catch (      PyExternalProcessException e) {
        fail(String.format("Error for interpreter '%s': %s",sdk.getHomePath(),e.getMessage()));
      }
catch (      IOException e) {
        throw new RuntimeException(e);
      }
      return true;
    }
  }
);
}
