{
  if (actual != null && expected != null) {
    if (!PyTypeChecker.match(expected,actual,context,substitutions)) {
      final String expectedName=PythonDocumentationProvider.getTypeName(expected,context);
      String quotedExpectedName=String.format("'%s'",expectedName);
      final boolean hasGenerics=PyTypeChecker.hasGenerics(expected,context);
      ProblemHighlightType highlightType=ProblemHighlightType.GENERIC_ERROR_OR_WARNING;
      if (hasGenerics) {
        final PyType substitute=PyTypeChecker.substitute(expected,substitutions,context);
        if (substitute != null) {
          quotedExpectedName=String.format("'%s' (matched generic type '%s')",PythonDocumentationProvider.getTypeName(substitute,context),expectedName);
          highlightType=ProblemHighlightType.WEAK_WARNING;
        }
      }
      final String actualName=PythonDocumentationProvider.getTypeName(actual,context);
      final String msg=String.format("Expected type %s, got '%s' instead",quotedExpectedName,actualName);
      registerProblem(node,msg,highlightType);
      return msg;
    }
  }
  return null;
}
