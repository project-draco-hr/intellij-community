{
  myFlag=false;
  Alarm alarm=new Alarm(Alarm.ThreadToUse.POOLED_THREAD,myTestRootDisposable);
  alarm.addRequest(new Runnable(){
    @Override public void run(){
      myFlag=true;
    }
  }
,100);
  final long start=System.currentTimeMillis();
  try {
    ProgressManager.getInstance().executeProcessUnderProgress(new Runnable(){
      @Override public void run(){
        while (System.currentTimeMillis() - start < 10000) {
          ProgressManager.checkCanceled();
        }
      }
    }
,indicator);
    fail("must have thrown PCE");
  }
 catch (  ProcessCanceledException e) {
    assertTrue(checkCanceledCalled);
  }
}
