{
  for (int i=0; i < 1000; i++) {
    final ProgressIndicatorBase indicator=new ProgressIndicatorBase();
    ProgressManager.getInstance().runProcess(new Runnable(){
      @Override public void run(){
        ProgressManager.checkCanceled();
        try {
          indicator.cancel();
          ProgressManager.checkCanceled();
          fail("checkCanceled() must have caught just canceled indicator");
        }
 catch (        ProcessCanceledException ignored) {
        }
      }
    }
,indicator);
  }
}
