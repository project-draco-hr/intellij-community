{
  String text=myFragments.get(fragmentIndex);
  if (StringUtil.isEmpty(text))   return 0;
  TextLayout layout=getCachedTextLayout(fragmentIndex);
  if (layout == null && needFontFallback(font,text)) {
    layout=createAndCacheTextLayout(fragmentIndex,font,getFontMetrics(font).getFontRenderContext());
  }
  if (layout != null) {
    return (int)layout.getAdvance();
  }
 else {
    return getFontMetrics(font).stringWidth(text);
  }
}
