{
  final String variableName=variable.getName();
  if (variableName == null) {
    return null;
  }
  PsiClass aClass=ClassUtils.getContainingClass(variable);
  while (aClass != null) {
    final PsiField field=aClass.findFieldByName(variableName,true);
    if (field != null) {
      if (!m_ignoreInvisibleFields) {
        return aClass;
      }
 else       if (ClassUtils.isFieldVisible(field,aClass) && (PsiUtil.getEnclosingStaticElement(variable,aClass) == null) || field.hasModifierProperty(PsiModifier.STATIC)) {
        return aClass;
      }
    }
    aClass=ClassUtils.getContainingClass(aClass);
  }
  return null;
}
