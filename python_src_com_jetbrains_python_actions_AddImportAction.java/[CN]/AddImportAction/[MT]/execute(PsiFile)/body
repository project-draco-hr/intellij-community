{
  new WriteCommandAction(file.getProject(),file){
    @Override protected void run(    Result result) throws Throwable {
      String name=getRefName();
      final PsiElement element=ResolveImportUtil.resolveInRoots(file,name);
      if (element != null) {
        final PsiFileSystemItem toImport=element instanceof PsiFileSystemItem ? (PsiFileSystemItem)element : element.getContainingFile();
        final AddImportHelper.ImportPriority priority=AddImportHelper.getImportPriority(file,toImport);
        AddImportHelper.addImportStatement(file,name,null,priority);
      }
    }
  }
.execute();
}
