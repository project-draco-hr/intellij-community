{
  String tempDirectory=FileUtil.getTempDirectory();
  String root=tempDirectory + "/" + name;
  assertTrue(new File(root).mkdirs());
  HgPlatformTest.initRepo(root);
  touch("a.txt");
  hg("add a.txt");
  hg("commit -m another -u abc");
  hg("up -r 0");
  ProjectLevelVcsManagerImpl vcsManager=(ProjectLevelVcsManagerImpl)ProjectLevelVcsManager.getInstance(myProject);
  vcsManager.setDirectoryMapping(root,HgVcs.VCS_NAME);
  VirtualFile file=LocalFileSystem.getInstance().findFileByIoFile(new File(root));
  HgRepository repository=HgUtil.getRepositoryManager(myProject).getRepositoryForRoot(file);
  assertNotNull("Couldn't find repository for root " + root,repository);
  return repository;
}
