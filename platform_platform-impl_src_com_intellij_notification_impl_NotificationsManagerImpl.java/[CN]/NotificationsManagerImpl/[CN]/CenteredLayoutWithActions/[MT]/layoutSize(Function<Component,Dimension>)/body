{
  Dimension titleSize=myTitleComponent == null ? new Dimension() : size.fun(myTitleComponent);
  Dimension centeredSize=myCenteredComponent == null ? new Dimension() : size.fun(myCenteredComponent);
  Dimension actionSize=myActionPanel == null ? new Dimension() : size.fun(myActionPanel);
  int expandHeight=myExpandAction == null || myLayoutData.showMinSize ? 0 : size.fun(myExpandAction).height;
  int height=myLayoutData.configuration.topSpaceHeight + titleSize.height + centeredSize.height+ Math.max(actionSize.height,expandHeight)+ myLayoutData.configuration.bottomSpaceHeight;
  if (titleSize.height > 0 && centeredSize.height > 0) {
    height+=myLayoutData.configuration.titleContentSpaceHeight;
  }
  if (centeredSize.height > 0 && actionSize.height > 0) {
    height+=myLayoutData.configuration.contentActionsSpaceHeight;
  }
  if (titleSize.height > 0 && actionSize.height > 0) {
    height+=myLayoutData.configuration.titleActionsSpaceHeight;
  }
  int width=centeredSize.width;
  if (width < titleSize.width || width < actionSize.width) {
    width=Math.min(BalloonLayoutConfiguration.MaxWidth,Math.max(titleSize.width + myLayoutData.configuration.closeOffset,actionSize.width));
  }
 else {
    width+=myLayoutData.configuration.closeOffset;
  }
  return new Dimension(Math.max(width,BalloonLayoutConfiguration.MinWidth),height);
}
