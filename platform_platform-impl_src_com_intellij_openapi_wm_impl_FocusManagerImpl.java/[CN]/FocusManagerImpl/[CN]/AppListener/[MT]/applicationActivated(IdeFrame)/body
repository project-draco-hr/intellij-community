{
  if (Registry.is("trace.focus.on.app.activation")) {
    LOG.info("Application is activating");
  }
  final FocusCommand cmd=myFocusCommandOnAppActivation;
  ActionCallback callback=myCallbackOnActivation;
  myFocusCommandOnAppActivation=null;
  myCallbackOnActivation=null;
  if (cmd != null) {
    if (Registry.is("trace.focus.on.app.activation")) {
      LOG.info("Use focus command that we have saved on deactivation");
      LOG.info(cmd.getAllocation());
    }
    requestFocus(cmd,true).notify(callback);
  }
 else {
    Component lastFocusedComponent=focusLastFocusedComponent(ideFrame);
    if (Registry.is("trace.focus.on.app.activation")) {
      final Project project=ideFrame.getProject();
      if (project != null) {
        LOG.info("Use last focused component because we do not have a focus command");
        LOG.info("Component in [" + project.getName() + "]: "+ (lastFocusedComponent != null ? lastFocusedComponent.getClass().getName() : null));
      }
    }
  }
}
