{
  Ref<PsiElement> targetElementRef=new Ref<>();
  ProgressIndicatorUtils.runInReadActionWithWriteActionPriority(new Runnable(){
    @Override public void run(){
      targetElementRef.set(docManager.findTargetElement(editor,offset,originalElement.getContainingFile(),originalElement));
    }
  }
);
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    @Override public void run(){
      PsiElement targetElement=targetElementRef.get();
      if (targetElement == null) {
        closeQuickDocIfPossible();
        return;
      }
      myAlarm.cancelAllRequests();
      if (!originalElement.equals(myActiveElements.get(editor))) {
        return;
      }
      if (docManager.getDocInfoHint() != null && !docManager.isCloseOnSneeze()) {
        return;
      }
      if (!docManager.hasActiveDockedDocWindow() && myHintManager.hasShownHintsThatWillHideByOtherHint(false)) {
        myAlarm.addRequest(this,EditorSettingsExternalizable.getInstance().getQuickDocOnMouseOverElementDelayMillis());
        return;
      }
      editor.putUserData(PopupFactoryImpl.ANCHOR_POPUP_POSITION,editor.offsetToVisualPosition(originalElement.getTextRange().getStartOffset()));
      try {
        docManager.showJavaDocInfo(editor,targetElement,originalElement,myHintCloseCallback,true);
        myDocumentationManager=new WeakReference<DocumentationManager>(docManager);
      }
  finally {
        editor.putUserData(PopupFactoryImpl.ANCHOR_POPUP_POSITION,null);
      }
    }
  }
,ApplicationManager.getApplication().getNoneModalityState());
}
