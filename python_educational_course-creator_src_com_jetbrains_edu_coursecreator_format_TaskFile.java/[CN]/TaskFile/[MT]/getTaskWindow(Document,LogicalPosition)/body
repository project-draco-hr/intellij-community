{
  int line=pos.line;
  if (line >= document.getLineCount()) {
    return null;
  }
  int column=pos.column;
  int offset=document.getLineStartOffset(line) + column;
  for (  TaskWindow tw : task_windows) {
    if (tw.getLine() <= line) {
      int twStartOffset=tw.getRealStartOffset(document);
      final int length=tw.getReplacementLength() > 0 ? tw.getReplacementLength() : 0;
      int twEndOffset=twStartOffset + length;
      if (twStartOffset <= offset && offset <= twEndOffset) {
        return tw;
      }
    }
  }
  return null;
}
