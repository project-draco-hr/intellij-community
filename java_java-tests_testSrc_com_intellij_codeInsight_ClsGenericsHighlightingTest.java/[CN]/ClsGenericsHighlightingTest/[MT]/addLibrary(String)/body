{
  ModuleRootModificationUtil.updateModel(myModule,new Consumer<ModifiableRootModel>(){
    @Override public void consume(    ModifiableRootModel model){
      LibraryTable libraryTable=model.getModuleLibraryTable();
      Library library=libraryTable.createLibrary("test");
      Library.ModifiableModel libraryModel=library.getModifiableModel();
      for (      String annotationsDir : libraryPath) {
        String path=myFixture.getTestDataPath() + "/libs/" + annotationsDir;
        VirtualFile libJarLocal=LocalFileSystem.getInstance().findFileByPath(path);
        assertNotNull(libJarLocal);
        VirtualFile jarRoot=JarFileSystem.getInstance().getJarRootForLocalFile(libJarLocal);
        assertNotNull(jarRoot);
        libraryModel.addRoot(jarRoot,OrderRootType.CLASSES);
      }
      libraryModel.commit();
      String contentUrl=VfsUtilCore.pathToUrl(myFixture.getTempDirPath());
      model.addContentEntry(contentUrl).addSourceFolder(contentUrl,false);
    }
  }
);
}
