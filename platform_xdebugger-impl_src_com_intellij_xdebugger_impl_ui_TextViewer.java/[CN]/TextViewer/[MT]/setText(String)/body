{
  if (text != null) {
    if (needSlashRSupport(text,isViewer())) {
      if (!((DocumentImpl)getDocument()).setAcceptSlashR(true)) {
        Editor editor=getEditor();
        if (editor instanceof EditorEx) {
          ((EditorEx)editor).reinitSettings();
        }
      }
    }
 else {
      text=StringUtil.convertLineSeparators(text);
    }
  }
  super.setText(text);
}
