{
  boolean purePaintingMode=myEditor.isPurePaintingMode();
  boolean foldingEnabled=myEditor.getFoldingModel().isFoldingEnabled();
  myEditor.setPurePaintingMode(false);
  myEditor.getFoldingModel().setFoldingEnabled(true);
  try {
    int startVisualLine=myView.offsetToVisualLine(startOffset,false);
    int endVisualLine=myView.offsetToVisualLine(endOffset,true);
    for (int i=startVisualLine; i <= endVisualLine; i++) {
      myLineWidths.set(i,UNKNOWN_WIDTH);
    }
    myWidthInPixels=-1;
    myEditor.getContentComponent().revalidate();
  }
  finally {
    myEditor.setPurePaintingMode(purePaintingMode);
    myEditor.getFoldingModel().setFoldingEnabled(foldingEnabled);
  }
}
