{
  JavaCompiler compiler=ToolProvider.getSystemJavaCompiler();
  if (compiler != null) {
    return compiler;
  }
  String message="System Java Compiler was not found in classpath";
  try {
    Class.forName("com.sun.tools.javac.api.JavacTool",false,JavacMain.class.getClassLoader());
  }
 catch (  Throwable ex) {
    message=message + ":\n" + ExceptionUtil.getThrowableText(ex);
  }
  throw new CannotCreateJavaCompilerException(message);
}
