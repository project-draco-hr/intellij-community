{
  VirtualFile taskDir=file.getParent();
  final Document document=FileDocumentManager.getInstance().getDocument(file);
  if (document == null) {
    LOG.debug("Couldn't flush windows");
    return;
  }
  if (taskDir != null) {
    String name=file.getNameWithoutExtension() + "_windows";
    PrintWriter printWriter=null;
    try {
      final VirtualFile windowsFile=taskDir.createChildData(taskFile,name);
      printWriter=new PrintWriter(new FileOutputStream(windowsFile.getPath()));
      for (      AnswerPlaceholder answerPlaceholder : taskFile.getAnswerPlaceholders()) {
        int start=answerPlaceholder.getRealStartOffset(document);
        String windowDescription=document.getText(new TextRange(start,start + answerPlaceholder.getPossibleAnswerLength()));
        printWriter.println("#educational_plugin_window = " + windowDescription);
      }
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        @Override public void run(){
          FileDocumentManager.getInstance().saveDocument(document);
        }
      }
);
    }
 catch (    IOException e) {
      LOG.error(e);
    }
 finally {
      if (printWriter != null) {
        printWriter.close();
      }
    }
  }
}
