{
  CommandProcessor.getInstance().executeCommand(myElements[0].getProject(),new Runnable(){
    public void run(){
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        public void run(){
          for (          PsiNamedElement oldElement : myElements) {
            PyClassRefactoringUtil.rememberNamedReferences(oldElement);
            final PsiNamedElement newElement=(PsiNamedElement)(myDestination.add(oldElement));
            for (            UsageInfo usage : usages) {
              PyImportStatementBase importStatement=getUsageImportStatement(usage);
              if (importStatement != null) {
                PyClassRefactoringUtil.updateImportOfElement(importStatement,newElement);
              }
              if (usage.getFile() == oldElement.getContainingFile()) {
                PyClassRefactoringUtil.insertImport(oldElement,newElement);
              }
            }
            PyClassRefactoringUtil.restoreNamedReferences(newElement);
            oldElement.delete();
          }
        }
      }
);
    }
  }
,REFACTORING_NAME,null);
}
