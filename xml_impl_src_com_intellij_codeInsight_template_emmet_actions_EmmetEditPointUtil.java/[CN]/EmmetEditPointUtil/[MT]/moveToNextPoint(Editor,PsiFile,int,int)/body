{
  final Document doc=editor.getDocument();
  PsiDocumentManager.getInstance(file.getProject()).commitDocument(doc);
  for (int i=offset + inc; i < doc.getTextLength() && i >= 0; i+=inc) {
    PsiElement current=InjectedLanguageUtil.findElementAtNoCommit(file,i);
    if (current == null)     continue;
    if (current.getParent() instanceof XmlText) {
      final int line=doc.getLineNumber(i);
      final int lineStart=doc.getLineStartOffset(line);
      final int lineEnd=doc.getLineEndOffset(line);
      if (lineEnd == offset)       continue;
      final CharSequence text=doc.getCharsSequence().subSequence(lineStart,lineEnd);
      if (StringUtil.isEmptyOrSpaces(text) && moveCaret(editor,current,lineEnd)) {
        return;
      }
    }
 else     if (isEmptyEditPoint(current) && moveCaret(editor,current,current.getTextRange().getStartOffset())) {
      return;
    }
  }
}
