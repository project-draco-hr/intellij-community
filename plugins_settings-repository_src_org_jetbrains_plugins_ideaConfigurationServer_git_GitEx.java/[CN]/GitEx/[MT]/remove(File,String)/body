{
  Repository repository=getRepository();
  DirCache dirCache=repository.lockDirCache();
  try {
    DirCacheEditor editor=dirCache.editor();
    editor.add(file.isFile() ? new DirCacheEditor.DeletePath(path) : new DirCacheEditor.DeleteTree(path));
    editor.commit();
  }
  finally {
    dirCache.unlock();
  }
}
