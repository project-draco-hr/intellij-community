{
  checkAvailability();
  if (!(dir instanceof NewVirtualFile))   return null;
  RootIndex rootIndex=getRootIndex();
  if (rootIndex != null) {
    return rootIndex.getPackageName(dir);
  }
  return myState.getPackageNameForDirectory((NewVirtualFile)dir);
}
