{
  checkAvailability();
  if (!(dir instanceof NewVirtualFile))   return false;
  if (ourUseRootIndexOnly) {
    return getRootIndex().isProjectExcludeRoot(dir);
  }
  boolean standardResult=myState.myProjectExcludeRoots.contains(((NewVirtualFile)dir).getId());
  RootIndex rootIndex=getRootIndex();
  Boolean riResult=rootIndex != null ? rootIndex.isProjectExcludeRoot(dir) : null;
  return assertConsistentResult(dir,riResult,standardResult);
}
