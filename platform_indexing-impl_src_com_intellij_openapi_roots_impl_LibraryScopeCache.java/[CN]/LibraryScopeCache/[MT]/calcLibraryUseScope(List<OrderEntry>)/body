{
  List<GlobalSearchScope> united=ContainerUtil.newArrayList();
  united.add(getLibrariesOnlyScope());
  Set<Module> modulesInvolved=new THashSet<>(entries.size());
  for (  OrderEntry entry : entries) {
    Module ownerModule=entry.getOwnerModule();
    united.add(GlobalSearchScope.moduleWithDependentsScope(ownerModule));
    modulesInvolved.add(ownerModule);
  }
  if (modulesInvolved.size() == ModuleManager.getInstance(myProject).getModules().length) {
    return GlobalSearchScope.allScope(myProject);
  }
  return GlobalSearchScope.union(united.toArray(new GlobalSearchScope[united.size()]));
}
