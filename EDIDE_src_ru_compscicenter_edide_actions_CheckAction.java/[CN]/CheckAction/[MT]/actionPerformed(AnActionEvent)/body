{
  Project project=e.getProject();
  Editor selectedEditor=StudyEditor.getSelectedEditor(project);
  FileDocumentManager fileDocumentManager=FileDocumentManager.getInstance();
  VirtualFile openedFile=fileDocumentManager.getFile(selectedEditor.getDocument());
  StudyTaskManager taskManager=StudyTaskManager.getInstance(selectedEditor.getProject());
  TaskFile selectedTaskFile=taskManager.getTaskFile(openedFile);
  Window selectedWindow=selectedTaskFile.getSelectedWindow();
  if (selectedWindow != null)   selectedWindow.setResolveStatus(true);
  selectedTaskFile.setSelectedWindow(null);
  FileDocumentManager.getInstance().saveAllDocuments();
  if (!(project != null && project.isOpen())) {
    return;
  }
  String basePath=project.getBasePath();
  if (basePath == null)   return;
  if (selectedEditor == null) {
    return;
  }
  VirtualFile vfOpenedFile=FileDocumentManager.getInstance().getFile(selectedEditor.getDocument());
  String testFile=basePath + "/.idea/study-tests/" + selectedTaskFile.getTask().getTestFile();
  GeneralCommandLine cmd=new GeneralCommandLine();
  cmd.setWorkDirectory(basePath + "/.idea/study-tests/");
  cmd.setExePath("python");
  cmd.addParameter(testFile);
  try {
    Process p=cmd.createProcess();
    InputStream is_err=p.getErrorStream();
    InputStream is=p.getInputStream();
    BufferedReader bf=new BufferedReader(new InputStreamReader(is));
    BufferedReader bf_err=new BufferedReader(new InputStreamReader(is_err));
    String line;
    String testResult="test failed";
    while ((line=bf.readLine()) != null) {
      if (line.equals("OK")) {
        testResult="test passed";
      }
      System.out.println(line);
    }
    while ((line=bf_err.readLine()) != null) {
      if (line.equals("OK")) {
        testResult="test passed";
      }
      System.out.println(line);
    }
    JOptionPane.showMessageDialog(null,testResult,"",JOptionPane.INFORMATION_MESSAGE);
  }
 catch (  ExecutionException e1) {
    e1.printStackTrace();
  }
catch (  IOException e1) {
    e1.printStackTrace();
  }
}
