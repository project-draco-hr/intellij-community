{
  if (file == null)   return null;
  final List<JsonSchemaObjectCodeInsightWrapper> wrappers=new ArrayList<>();
synchronized (myLock) {
    final Set<VirtualFile> files=mySchemaFiles.isEmpty() ? new HashSet<>() : null;
    for (    JsonSchemaFileProvider provider : getProviders()) {
      final VirtualFile key=provider.getSchemaFile();
      if (files != null)       files.add(key);
      if (provider.isAvailable(myProject,file)) {
        JsonSchemaObjectCodeInsightWrapper wrapper=myWrappers.get(key);
        if (wrapper == null) {
          wrapper=createWrapper(provider);
          if (wrapper == null)           return null;
          myWrappers.putIfAbsent(key,wrapper);
        }
        wrappers.add(wrapper);
      }
    }
    if (files != null)     mySchemaFiles.addAll(files);
  }
  return wrappers;
}
