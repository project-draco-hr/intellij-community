{
  if (file == null)   return null;
  final List<JsonSchemaObjectCodeInsightWrapper> wrappers=new ArrayList<>();
  JsonSchemaProviderFactory[] factories=getProviderFactories();
  for (  JsonSchemaProviderFactory factory : factories) {
    for (    JsonSchemaFileProvider provider : factory.getProviders(myProject)) {
      if (provider.isAvailable(file)) {
        JsonSchemaObjectCodeInsightWrapper wrapper=myWrappers.get(provider);
        if (wrapper == null) {
          JsonSchemaObjectCodeInsightWrapper newWrapper=createWrapper(provider);
          if (newWrapper == null)           return null;
          myWrappers.putIfAbsent(provider,newWrapper);
          wrapper=myWrappers.get(provider);
        }
        if (wrapper != null) {
          wrappers.add(wrapper);
        }
      }
    }
  }
  return wrappers.isEmpty() ? null : (wrappers.size() == 1 ? wrappers.get(0) : new CompositeCodeInsightProviderWithWarning(wrappers));
}
