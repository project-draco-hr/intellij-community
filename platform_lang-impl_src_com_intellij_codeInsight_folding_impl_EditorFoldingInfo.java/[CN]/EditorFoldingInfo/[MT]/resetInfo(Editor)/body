{
  EditorFoldingInfo info=editor.getUserData(KEY);
  if (info != null) {
    for (    FoldRegion region : info.myFoldRegionToSmartPointerMap.keySet()) {
      region.dispose();
    }
    info.myFoldRegionToSmartPointerMap.clear();
  }
  FoldingModel foldingModel=editor.getFoldingModel();
  if (foldingModel instanceof FoldingModelEx) {
    ((FoldingModelEx)foldingModel).rebuild();
  }
  editor.putUserData(KEY,null);
}
