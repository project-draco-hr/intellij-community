{
  myModel=model;
  myConfigurable=configurable;
  LayoutManager layout=inline ? new BorderLayout() : new VerticalFlowLayout(false,true);
  myMainPanel=new JPanel(layout);
  myModel.registerOptionsComponent(provider,this);
  List<FrameworkVersion> versions=provider.getFrameworkType().getVersions();
  if (!versions.isEmpty()) {
    myFrameworkVersionComponent=new FrameworkVersionComponent(model,provider.getFrameworkType().getId(),versions,provider.getVersionLabel());
    if (inline) {
      myMainPanel.add(myFrameworkVersionComponent.getMainPanel(),BorderLayout.WEST);
    }
 else {
      myMainPanel.add(myFrameworkVersionComponent.getMainPanel());
    }
  }
  final JComponent component=myConfigurable.createComponent(inline);
  if (component != null) {
    myMainPanel.add(component);
  }
  final CustomLibraryDescription description=myConfigurable.createLibraryDescription();
  if (description != null) {
    final boolean addSeparator=component != null || myFrameworkVersionComponent != null;
    myLibraryOptionsPanelWrapper=new JPanel(new BorderLayout());
    myMainPanel.add(myLibraryOptionsPanelWrapper);
    if (myConfigurable instanceof OldFrameworkSupportProviderWrapper.FrameworkSupportConfigurableWrapper) {
      ((OldFrameworkSupportProviderWrapper.FrameworkSupportConfigurableWrapper)myConfigurable).getConfigurable().addListener(new FrameworkSupportConfigurableListener(){
        public void frameworkVersionChanged(){
          updateLibrariesPanel();
        }
      }
);
    }
    model.addFrameworkListener(new FrameworkSupportModelAdapter(){
      @Override public void wizardStepUpdated(){
        updateLibrariesPanel();
      }
    }
,parentDisposable);
    myLibraryOptionsPanel=new LibraryOptionsPanel(description,myModel.getBaseDirectoryForLibrariesPath(),createLibraryVersionFilter(),container,!myConfigurable.isOnlyLibraryAdded());
    Disposer.register(myConfigurable,myLibraryOptionsPanel);
    if (addSeparator) {
      JComponent separator=SeparatorFactory.createSeparator("Libraries",null);
      separator.setBorder(IdeBorderFactory.createEmptyBorder(5,0,5,5));
      myLibraryOptionsPanelWrapper.add(BorderLayout.NORTH,separator);
    }
    myLibraryOptionsPanelWrapper.add(BorderLayout.CENTER,myLibraryOptionsPanel.getMainPanel());
    myLibraryOptionsPanelWrapper.setVisible(myConfigurable.isVisible());
  }
}
