{
  myModel=model;
  myConfigurable=configurable;
  VerticalFlowLayout layout=new VerticalFlowLayout();
  layout.setVerticalFill(true);
  myMainPanel=new JPanel(layout);
  myModel.registerOptionsComponent(provider,this);
  List<FrameworkVersion> versions=provider.getFrameworkType().getVersions();
  if (!versions.isEmpty()) {
    myFrameworkVersionComponent=new FrameworkVersionComponent(model,provider.getFrameworkType().getId(),versions,"Versions:");
    myMainPanel.add(myFrameworkVersionComponent.getMainPanel());
  }
 else {
    myFrameworkVersionComponent=null;
  }
  final JComponent component=myConfigurable.createComponent();
  if (component != null) {
    myMainPanel.add(component);
  }
  final boolean addSeparator=component != null || myFrameworkVersionComponent != null;
  myLibraryOptionsPanelWrapper=new JPanel(new BorderLayout());
  myMainPanel.add(myLibraryOptionsPanelWrapper);
  if (myConfigurable instanceof OldFrameworkSupportProviderWrapper.FrameworkSupportConfigurableWrapper) {
    ((OldFrameworkSupportProviderWrapper.FrameworkSupportConfigurableWrapper)myConfigurable).getConfigurable().addListener(new FrameworkSupportConfigurableListener(){
      public void frameworkVersionChanged(){
        updateLibrariesPanel();
      }
    }
);
  }
  model.addFrameworkListener(new FrameworkSupportModelAdapter(){
    @Override public void wizardStepUpdated(){
      updateLibrariesPanel();
    }
  }
,parentDisposable);
  final CustomLibraryDescription description=myConfigurable.createLibraryDescription();
  if (description != null) {
    myLibraryOptionsPanel=new LibraryOptionsPanel(description,new NotNullComputable<String>(){
      @NotNull @Override public String compute(){
        return myModel.getBaseDirectoryForLibrariesPath();
      }
    }
,createLibraryVersionFilter(),container,!myConfigurable.isOnlyLibraryAdded()){
      @Override protected void onVersionChanged(      @Nullable String version){
        if (myFrameworkVersionComponent == null) {
          myModel.setSelectedLibraryVersion(provider.getId(),version);
        }
      }
    }
;
    myLibraryOptionsPanel.setLibraryProvider(myModel.getLibraryProvider());
    Disposer.register(myConfigurable,myLibraryOptionsPanel);
    if (addSeparator) {
      JComponent separator1=SeparatorFactory.createSeparator("Libraries",null);
      separator1.setBorder(IdeBorderFactory.createEmptyBorder(5,0,5,5));
      myLibraryOptionsPanelWrapper.add(BorderLayout.NORTH,separator1);
    }
    myLibraryOptionsPanelWrapper.add(BorderLayout.CENTER,myLibraryOptionsPanel.getMainPanel());
    myLibraryOptionsPanelWrapper.setVisible(myConfigurable.isVisible());
  }
}
