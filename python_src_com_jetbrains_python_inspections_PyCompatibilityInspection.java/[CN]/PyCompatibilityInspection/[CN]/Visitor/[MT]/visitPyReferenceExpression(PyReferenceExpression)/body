{
  super.visitPyElement(node);
  if (shouldBeCompatibleWithPy3()) {
    if (PyNames.BASESTRING.equals(node.getText())) {
      PsiElement res=node.getReference().resolve();
      if (res != null) {
        ProjectFileIndex ind=ProjectRootManager.getInstance(node.getProject()).getFileIndex();
        PsiFile file=res.getContainingFile();
        if (file != null) {
          final VirtualFile virtualFile=file.getVirtualFile();
          if (virtualFile != null && ind.isInLibraryClasses(virtualFile)) {
            registerProblem(node,"basestring type is not available in py3");
          }
        }
 else {
          registerProblem(node,"basestring type is not available in py3");
        }
      }
    }
  }
}
