{
  final VirtualFile vFile=file.getVirtualFile();
  final VirtualFile parentDir=vFile.getParent();
  final String newPackageName=vFile.getNameWithoutExtension();
  final VirtualFile existing=parentDir.findChild(newPackageName);
  if (existing != null) {
    showFileExistsErrorMessage(existing,ID,file.getProject());
    return;
  }
  WriteCommandAction.runWriteCommandAction(file.getProject(),new Runnable(){
    public void run(){
      try {
        final VirtualFile packageDir=parentDir.createChildDirectory(PyConvertModuleToPackageAction.this,newPackageName);
        vFile.move(PyConvertModuleToPackageAction.this,packageDir);
        vFile.rename(PyConvertModuleToPackageAction.this,PyNames.INIT_DOT_PY);
      }
 catch (      IOException e) {
        LOG.error(e);
      }
    }
  }
);
}
