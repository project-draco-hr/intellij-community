{
  if (myWizard != null) {
    Disposer.dispose(myWizard.getDisposable());
    myWizard=null;
  }
  if (myCreatedProject != null) {
    myProjectManager.closeProject(myCreatedProject);
    ApplicationManager.getApplication().runWriteAction(new Runnable(){
      @Override public void run(){
        Disposer.dispose(myCreatedProject);
      }
    }
);
    myCreatedProject=null;
  }
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      ProjectRootManager.getInstance(myProjectManager.getDefaultProject()).setProjectSdk(myOldDefaultProjectSdk);
      for (      Sdk sdk : mySdks) {
        ProjectJdkTable.getInstance().removeJdk(sdk);
      }
    }
  }
);
  SelectTemplateSettings.getInstance().setLastTemplate(null,null);
  try {
    UIUtil.dispatchAllInvocationEvents();
    Thread.sleep(2000);
    UIUtil.dispatchAllInvocationEvents();
  }
  finally {
    super.tearDown();
  }
}
