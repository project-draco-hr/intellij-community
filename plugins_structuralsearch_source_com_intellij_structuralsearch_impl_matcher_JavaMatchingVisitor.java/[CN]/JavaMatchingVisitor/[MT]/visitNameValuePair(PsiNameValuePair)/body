{
  final PsiIdentifier nameIdentifier=pair.getNameIdentifier();
  if (nameIdentifier == null) {
    myMatchingVisitor.setResult(true);
    return;
  }
  final PsiNameValuePair elementNameValuePair=(PsiNameValuePair)myMatchingVisitor.getElement();
  PsiIdentifier matchedNameValuePair=elementNameValuePair.getNameIdentifier();
  PsiAnnotationMemberValue annotationInitializer=pair.getValue();
  boolean isTypedInitializer=annotationInitializer != null && myMatchingVisitor.getMatchContext().getPattern().isTypedVar(annotationInitializer) && annotationInitializer instanceof PsiReferenceExpression;
  myMatchingVisitor.setResult(myMatchingVisitor.match(annotationInitializer,elementNameValuePair.getValue()) || (isTypedInitializer && elementNameValuePair.getValue() == null && allowsAbsenceOfMatch(annotationInitializer)));
  if (myMatchingVisitor.getResult()) {
    final MatchingHandler handler=myMatchingVisitor.getMatchContext().getPattern().getHandler(nameIdentifier);
    if (handler instanceof SubstitutionHandler) {
      myMatchingVisitor.setResult(((SubstitutionHandler)handler).handle(matchedNameValuePair,myMatchingVisitor.getMatchContext()));
    }
 else {
      myMatchingVisitor.setResult(myMatchingVisitor.match(nameIdentifier,matchedNameValuePair));
    }
  }
}
