{
  if (ourLock != null) {
    throw new AssertionError();
  }
  ourLock=new SocketLock(PathManager.getConfigPath(),PathManager.getSystemPath());
  SocketLock.ActivateStatus status;
  try {
    status=ourLock.lock(args);
  }
 catch (  Exception e) {
    Main.showMessage("Cannot Lock System Folders",e);
    return false;
  }
  if (status == SocketLock.ActivateStatus.NO_INSTANCE) {
    ShutDownTracker.getInstance().registerShutdownTask(new Runnable(){
      @Override public void run(){
        ourLock.dispose();
      }
    }
);
    return true;
  }
 else   if (Main.isHeadless() || status == SocketLock.ActivateStatus.CANNOT_ACTIVATE) {
    String message="Only one instance of " + ApplicationNamesInfo.getInstance().getFullProductName() + " can be run at a time.";
    Main.showMessage("Too Many Instances",message,true);
  }
  return false;
}
