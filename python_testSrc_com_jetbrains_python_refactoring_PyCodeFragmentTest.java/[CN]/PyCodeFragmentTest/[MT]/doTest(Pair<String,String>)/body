{
  final String testName=getTestName(false).toLowerCase();
  final String fullPath=getTestDataPath() + testName + ".test";
  final VirtualFile vFile=LocalFileSystem.getInstance().findFileByPath(fullPath.replace(File.separatorChar,'/'));
  String fileText=StringUtil.convertLineSeparators(VfsUtil.loadText(vFile),"\n");
  final int beginMarker=fileText.indexOf(BEGIN_MARKER);
  final int endMarker=fileText.indexOf(END_MARKER);
  final int resultMarker=fileText.indexOf(RESULT_MARKER);
  assertTrue(beginMarker != -1);
  assertTrue(endMarker != -1);
  assertTrue(resultMarker != -1);
  final StringBuilder builder=new StringBuilder();
  builder.append(fileText.substring(0,beginMarker));
  builder.append(fileText.substring(beginMarker + BEGIN_MARKER.length(),endMarker));
  builder.append((fileText.substring(endMarker + END_MARKER.length(),resultMarker)));
  final String result=fileText.substring(resultMarker + RESULT_MARKER.length());
  for (  Pair<String,String> pair : files2Create) {
    myFixture.addFileToProject(pair.first,pair.second);
  }
  final PyFile file=(PyFile)myFixture.addFileToProject(testName + ".py",builder.toString());
  check(file,beginMarker,endMarker,result);
}
