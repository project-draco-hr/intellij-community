{
  PsiBuilder.Marker marker=builder.mark();
  final PsiBuilder.Marker marker2=builder.mark();
  LOG.assertTrue(ParserUtils.getToken(builder,begin));
  if (builder.getTokenType() == content) {
    final PsiBuilder.Marker contentMarker=builder.mark();
    builder.advanceLexer();
    if (builder.getTokenType() == mDOLLAR || literal == null) {
      contentMarker.done(GSTRING_CONTENT);
    }
 else {
      contentMarker.drop();
    }
  }
  boolean inj=builder.getTokenType() == mDOLLAR;
  while (builder.getTokenType() == mDOLLAR || builder.getTokenType() == content) {
    if (builder.getTokenType() == mDOLLAR) {
      parseInjection(builder,parser);
    }
 else {
      ParserUtils.eatElement(builder,GSTRING_CONTENT);
    }
  }
  if (!ParserUtils.getToken(builder,end)) {
    builder.error(message);
  }
  if (inj || literal == null) {
    marker2.drop();
    marker.done(compoundLiteral);
  }
 else {
    marker2.done(literal);
    if (forRefExpr) {
      marker.drop();
    }
 else {
      marker.done(LITERAL);
    }
  }
  return inj;
}
