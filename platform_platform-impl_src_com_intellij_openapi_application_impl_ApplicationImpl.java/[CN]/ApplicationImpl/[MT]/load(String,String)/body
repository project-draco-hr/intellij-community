{
  AccessToken token=HeavyProcessLatch.INSTANCE.processStarted("Loading application components");
  try {
    long t=System.currentTimeMillis();
    loadComponents();
    init(new Runnable(){
      @Override public void run(){
        getPicoContainer().getComponentInstance(ServiceManagerImpl.class);
        StateStorageManager storageManager=ComponentsPackage.getStateStore(ApplicationImpl.this).getStateStorageManager();
        storageManager.addMacro(StoragePathMacros.APP_CONFIG,optionsPath);
        storageManager.addMacro(StoragePathMacros.ROOT_CONFIG,configPath);
        for (        ApplicationLoadListener listener : ApplicationLoadListener.EP_NAME.getExtensions()) {
          try {
            listener.beforeApplicationLoaded(ApplicationImpl.this);
          }
 catch (          Throwable e) {
            LOG.error(e);
          }
        }
      }
    }
);
    t=System.currentTimeMillis() - t;
    LOG.info(getComponentConfigurations().length + " application components initialized in " + t+ " ms");
  }
 catch (  StateStorageException e) {
    throw new IOException(e);
  }
 finally {
    token.finish();
  }
  myLoaded=true;
  createLocatorFile();
}
