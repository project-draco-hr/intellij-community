{
  VcsLogBranchFilter branchFilter=filters.getBranchFilter();
  if (branchFilter == null) {
    return null;
  }
  final Collection<String> branchNames=new HashSet<String>(branchFilter.getBranchNames());
  return new HashSet<Integer>(ContainerUtil.mapNotNull(refs.getBranches(),new Function<VcsRef,Integer>(){
    @Override public Integer fun(    VcsRef ref){
      if (branchNames.contains(ref.getName())) {
        return myHashMap.getCommitIndex(ref.getCommitHash());
      }
      return null;
    }
  }
));
}
