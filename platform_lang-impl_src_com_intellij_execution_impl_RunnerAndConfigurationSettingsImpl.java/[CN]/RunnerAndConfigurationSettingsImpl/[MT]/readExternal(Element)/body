{
  myIsTemplate=Boolean.valueOf(element.getAttributeValue(TEMPLATE_FLAG_ATTRIBUTE)).booleanValue();
  myTemporary=Boolean.valueOf(element.getAttributeValue(TEMPORARY_ATTRIBUTE)).booleanValue() || TEMP_CONFIGURATION.equals(element.getName());
  myEditBeforeRun=Boolean.valueOf(element.getAttributeValue(EDIT_BEFORE_RUN)).booleanValue();
  myFolderName=element.getAttributeValue(FOLDER_NAME);
  final ConfigurationFactory factory=getFactory(element);
  if (factory == null)   return;
  myWasSingletonSpecifiedExplicitly=false;
  if (myIsTemplate) {
    mySingleton=factory.isConfigurationSingletonByDefault();
  }
 else {
    String singletonStr=element.getAttributeValue(SINGLETON);
    if (StringUtil.isEmpty(singletonStr)) {
      mySingleton=factory.isConfigurationSingletonByDefault();
    }
 else {
      myWasSingletonSpecifiedExplicitly=true;
      mySingleton=Boolean.parseBoolean(singletonStr);
    }
  }
  if (myIsTemplate) {
    myConfiguration=myManager.getConfigurationTemplate(factory).getConfiguration();
  }
 else {
    final String name=element.getAttributeValue(NAME_ATTR);
    myConfiguration=myManager.doCreateConfiguration(name,factory,false);
  }
  myConfiguration.readExternal(element);
  List<Element> runners=element.getChildren(RUNNER_ELEMENT);
  myUnloadedRunnerSettings=null;
  WeakStringInterner interner=new WeakStringInterner();
  for (  final Element runnerElement : runners) {
    String id=runnerElement.getAttributeValue(RUNNER_ID);
    ProgramRunner runner=RunnerRegistry.getInstance().findRunnerById(id);
    if (runner != null) {
      RunnerSettings settings=createRunnerSettings(runner);
      if (settings != null) {
        settings.readExternal(runnerElement);
      }
      myRunnerSettings.put(runner,settings);
    }
 else {
      if (myUnloadedRunnerSettings == null)       myUnloadedRunnerSettings=new ArrayList<Element>(1);
      JDOMUtil.internElement(runnerElement,interner);
      myUnloadedRunnerSettings.add(runnerElement);
    }
  }
  List configurations=element.getChildren(CONFIGURATION_ELEMENT);
  myUnloadedConfigurationPerRunnerSettings=null;
  for (  final Object configuration : configurations) {
    Element configurationElement=(Element)configuration;
    String id=configurationElement.getAttributeValue(RUNNER_ID);
    ProgramRunner runner=RunnerRegistry.getInstance().findRunnerById(id);
    if (runner != null) {
      ConfigurationPerRunnerSettings settings=myConfiguration.createRunnerSettings(new InfoProvider(runner));
      if (settings != null) {
        settings.readExternal(configurationElement);
      }
      myConfigurationPerRunnerSettings.put(runner,settings);
    }
 else {
      if (myUnloadedConfigurationPerRunnerSettings == null)       myUnloadedConfigurationPerRunnerSettings=new ArrayList<Element>(1);
      myUnloadedConfigurationPerRunnerSettings.add(configurationElement);
    }
  }
}
