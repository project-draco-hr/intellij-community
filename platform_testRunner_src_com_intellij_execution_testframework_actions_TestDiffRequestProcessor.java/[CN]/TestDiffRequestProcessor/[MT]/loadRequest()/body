{
  if (myIndex < 0 || myIndex >= myRequests.size())   return new NoDiffRequest();
  DiffHyperlink hyperlink=myRequests.get(myIndex);
  try {
    String title=hyperlink.getDiffTitle();
    String title1;
    String title2=ExecutionBundle.message("diff.content.actual.title");
    DiffContent content1;
    DiffContent content2=DiffContentFactory.create(hyperlink.getRight(),null);
    String filePath=hyperlink.getFilePath();
    final VirtualFile vFile;
    if (filePath != null && (vFile=LocalFileSystem.getInstance().findFileByPath(filePath)) != null) {
      title1=ExecutionBundle.message("diff.content.expected.title") + " (" + vFile.getPresentableUrl()+ ")";
      content1=DiffContentFactory.create(getProject(),vFile);
    }
 else {
      title1=ExecutionBundle.message("diff.content.expected.title");
      content1=DiffContentFactory.create(hyperlink.getLeft(),null);
    }
    return new SimpleDiffRequest(title,content1,content2,title1,title2);
  }
 catch (  Exception e) {
    return new ErrorDiffRequest(e);
  }
}
