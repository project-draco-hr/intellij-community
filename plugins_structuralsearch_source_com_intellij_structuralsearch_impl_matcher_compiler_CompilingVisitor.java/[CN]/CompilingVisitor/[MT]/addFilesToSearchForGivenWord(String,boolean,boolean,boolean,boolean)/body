{
  boolean addedSomething=false;
  if (code && context.scanned.get(refname) == null) {
    context.helper.processAllFilesWithWord(refname,(GlobalSearchScope)context.options.getScope(),new MyFileSink());
    context.scanned.put(refname,refname);
    addedSomething=true;
  }
 else   if (comments && context.scannedComments.get(refname) == null) {
    context.helper.processAllFilesWithWordInComments(refname,(GlobalSearchScope)context.options.getScope(),new MyFileSink());
    context.scannedComments.put(refname,refname);
    addedSomething=true;
  }
 else   if (literals && context.scannedLiterals.get(refname) == null) {
    context.helper.processAllFilesWithWordInLiterals(refname,(GlobalSearchScope)context.options.getScope(),new MyFileSink());
    context.scannedLiterals.put(refname,refname);
    addedSomething=true;
  }
  if (addedSomething && endTransaction) {
    endTransaction();
  }
}
