{
  if ((!filter.accepts(element) || element instanceof PsiIdentifier) && (context.pattern.isRealTypedVar(element)) && context.pattern.getHandlerSimple(element) == null) {
    String name=SubstitutionHandler.getTypedVarString(element);
    final SubstitutionHandler handler;
    context.pattern.setHandler(element,handler=(SubstitutionHandler)context.pattern.getHandler(name));
    if (handler != null && context.options.getVariableConstraint(handler.getName()).isPartOfSearchResults()) {
      handler.setTarget(true);
      context.pattern.setTargetNode(element);
    }
  }
}
