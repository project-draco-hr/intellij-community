{
  PyStringLiteralExpression string=PsiTreeUtil.getParentOfType(file.findElementAt(editor.getCaretModel().getOffset()),PyStringLiteralExpression.class);
  PyElementGenerator elementGenerator=PyElementGenerator.getInstance(project);
  if (string != null) {
    StringBuilder strBuilder=new StringBuilder();
    for (    ASTNode node : string.getStringNodes())     strBuilder.append(node.getText());
    String stringText=strBuilder.toString();
    int prefixLength=PyStringLiteralExpressionImpl.getPrefixLength(stringText);
    String prefix=stringText.substring(0,prefixLength);
    stringText=stringText.substring(prefixLength);
    if (stringText.startsWith("'") && stringText.endsWith("'")) {
      String result=convertSingleToDoubleQuoted(stringText);
      PyStringLiteralExpression st=elementGenerator.createStringLiteralAlreadyEscaped(prefix + result);
      string.replace(st);
    }
    if (stringText.startsWith("\"") && stringText.endsWith("\"")) {
      String result=convertDoubleToSingleQuoted(stringText);
      PyStringLiteralExpression st=elementGenerator.createStringLiteralAlreadyEscaped(prefix + result);
      string.replace(st);
    }
  }
}
