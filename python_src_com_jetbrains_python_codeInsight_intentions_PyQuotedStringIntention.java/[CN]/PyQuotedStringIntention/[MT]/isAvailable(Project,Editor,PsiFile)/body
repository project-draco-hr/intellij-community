{
  PyStringLiteralExpression string=PsiTreeUtil.getParentOfType(file.findElementAt(editor.getCaretModel().getOffset()),PyStringLiteralExpression.class);
  if (string != null) {
    final PyDocStringOwner docStringOwner=PsiTreeUtil.getParentOfType(string,PyDocStringOwner.class);
    if (docStringOwner != null) {
      if (docStringOwner.getDocStringExpression() == string)       return false;
    }
    String stringText=string.getText();
    int prefixLength=PyStringLiteralExpressionImpl.getPrefixLength(stringText);
    stringText=stringText.substring(prefixLength);
    if (stringText.length() >= 6) {
      if (stringText.startsWith("'''") && stringText.endsWith("'''") || stringText.startsWith("\"\"\"") && stringText.endsWith("\"\"\""))       return false;
    }
    if (stringText.length() > 2) {
      if (stringText.startsWith("'") && stringText.endsWith("'")) {
        setText(PyBundle.message("INTN.quoted.string.single.to.double"));
        return true;
      }
      if (stringText.startsWith("\"") && stringText.endsWith("\"")) {
        setText(PyBundle.message("INTN.quoted.string.double.to.single"));
        return true;
      }
    }
  }
  return false;
}
