{
  PyStringLiteralExpression string=PsiTreeUtil.getParentOfType(file.findElementAt(editor.getCaretModel().getOffset()),PyStringLiteralExpression.class);
  PyElementGenerator elementGenerator=PyElementGenerator.getInstance(project);
  if (string != null) {
    final String stringText=string.getText();
    int prefixLength=PyStringLiteralExpressionImpl.getPrefixLength(stringText);
    final String text=stringText.substring(prefixLength);
    if (text.startsWith("'") && text.endsWith("'")) {
      String result=convertSingleToDoubleQuoted(stringText);
      PyStringLiteralExpression st=elementGenerator.createStringLiteralAlreadyEscaped(result);
      string.replace(st);
    }
    if (text.startsWith("\"") && text.endsWith("\"")) {
      String result=convertDoubleToSingleQuoted(stringText);
      PyStringLiteralExpression st=elementGenerator.createStringLiteralAlreadyEscaped(result);
      string.replace(st);
    }
  }
}
