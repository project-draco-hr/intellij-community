{
  boolean wasAutodetectedAsText=fileType == FileTypes.PLAIN_TEXT;
  boolean wasAutodetectedAsBinary=fileType == FileTypes.UNKNOWN;
  int flags=BitUtil.set(0,AUTO_DETECTED_AS_TEXT_MASK,wasAutodetectedAsText);
  flags=BitUtil.set(flags,AUTO_DETECTED_AS_BINARY_MASK,wasAutodetectedAsBinary);
  writeFlagsToCache(file,flags);
  if (file instanceof VirtualFileWithId) {
    int id=Math.abs(((VirtualFileWithId)file).getId());
    flags=BitUtil.set(flags,AUTO_DETECT_WAS_RUN_MASK,true);
    flags=BitUtil.set(flags,ATTRIBUTES_WERE_LOADED_MASK,true);
    packedFlags.set(id,flags);
    if (toLog()) {
      log("F: cacheAutoDetectedFileType(" + file.getName() + ") = "+ flags);
    }
    if (wasAutodetectedAsText || wasAutodetectedAsBinary) {
      file.putUserData(DETECTED_FROM_CONTENT_FILE_TYPE_KEY,null);
      return;
    }
  }
  file.putUserData(DETECTED_FROM_CONTENT_FILE_TYPE_KEY,fileType);
}
