{
  final List<VirtualFile> changed=new ArrayList<VirtualFile>();
  for (  VirtualFile file : files) {
    if (isDetectable(file) && wasAutoDetectedBefore(file)) {
      FileType before=file.getFileType();
      FileType after=detectFromContent(file);
      if (before != after) {
        changed.add(file);
      }
    }
  }
  if (!changed.isEmpty()) {
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      @Override public void run(){
        FileContentUtilCore.reparseFiles(changed);
      }
    }
,ApplicationManager.getApplication().getDisposed());
  }
}
