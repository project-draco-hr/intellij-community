{
  final Map<String,String> result=new HashMap<>(environment);
  for (  Map.Entry<String,String> entry : extraEnvironment.entrySet()) {
    final String name=entry.getKey();
    if (PATH_ENV_VARIABLE.equals(name) || PythonEnvUtil.PYTHONPATH.equals(name)) {
      PythonEnvUtil.addPathToEnv(result,name,entry.getValue());
    }
 else {
      result.put(name,entry.getValue());
    }
  }
  return result;
}
