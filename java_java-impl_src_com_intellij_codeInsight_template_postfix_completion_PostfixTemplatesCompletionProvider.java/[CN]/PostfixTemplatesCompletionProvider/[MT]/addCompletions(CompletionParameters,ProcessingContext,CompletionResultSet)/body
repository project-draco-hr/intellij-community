{
  if (!isCompletionEnabled(parameters) || LiveTemplateCompletionContributor.shouldShowAllTemplates() || parameters.getEditor().getCaretModel().getCaretCount() != 1) {
    return;
  }
  PostfixLiveTemplate postfixLiveTemplate=getPostfixLiveTemplate(parameters.getOriginalFile(),parameters.getEditor());
  if (postfixLiveTemplate != null) {
    postfixLiveTemplate.addCompletions(parameters,result.withPrefixMatcher(new MyPrefixMatcher(result.getPrefixMatcher().getPrefix())));
    CharSequence documentContent=parameters.getEditor().getDocument().getCharsSequence();
    String possibleKey=postfixLiveTemplate.computeTemplateKeyWithoutContextChecking(documentContent,parameters.getOffset());
    if (possibleKey != null) {
      result=result.withPrefixMatcher(possibleKey);
      result.restartCompletionOnPrefixChange(StandardPatterns.string().oneOf(postfixLiveTemplate.getAllTemplateKeys()));
    }
  }
}
