{
  if (baseDir != null) {
    if (TestSourcesFilter.isTestSources(baseDir.getVirtualFile(),baseDir.getProject())) {
      if (skipSourceDirsForBaseTestDirectory) {
        return scope.intersectWith(GlobalSearchScopesCore.projectTestScope(baseDir.getProject()));
      }
    }
 else {
      if (skipTestDirsForBaseSourceDirectory) {
        return scope.intersectWith(GlobalSearchScopesCore.projectProductionScope(baseDir.getProject()));
      }
    }
  }
  return scope;
}
