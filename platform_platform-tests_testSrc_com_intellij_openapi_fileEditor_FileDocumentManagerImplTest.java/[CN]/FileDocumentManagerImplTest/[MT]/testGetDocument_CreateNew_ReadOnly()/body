{
  final VirtualFile file=createFile();
  ApplicationManager.getApplication().runWriteAction(new ThrowableComputable<Object,IOException>(){
    @Override public Object compute() throws IOException {
      file.setWritable(false);
      return null;
    }
  }
);
  final Document document=myDocumentManager.getDocument(file);
  assertNotNull(document);
  assertEquals("test",document.getText());
  assertEquals(file.getModificationStamp(),document.getModificationStamp());
  assertEquals(file.isWritable(),document.isWritable());
}
