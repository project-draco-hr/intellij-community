{
  final MatchingStrategy strategy=context.getPattern().getStrategy();
  skipIfNecessary(nodes,nodes2,strategy);
  skipIfNecessary(nodes2,nodes,strategy);
  final PsiElement patternElement=nodes.current();
  final MatchingHandler handler=context.getPattern().getHandler(patternElement);
  if (nodes2.hasNext() && handler.match(patternElement,nodes2.current(),context)) {
    nodes.advance();
    final boolean shouldRewindOnMatchFailure;
    if (shouldAdvanceTheMatchFor(patternElement,nodes2.current())) {
      nodes2.advance();
      skipIfNecessary(nodes,nodes2,strategy);
      shouldRewindOnMatchFailure=true;
    }
 else {
      shouldRewindOnMatchFailure=false;
    }
    skipIfNecessary(nodes2,nodes,strategy);
    if (nodes.hasNext()) {
      final MatchingHandler nextHandler=context.getPattern().getHandler(nodes.current());
      if (nextHandler.matchSequentially(nodes,nodes2,context)) {
        return true;
      }
 else {
        nodes.rewind();
        if (shouldRewindOnMatchFailure)         nodes2.rewind();
      }
    }
 else {
      return handler.isMatchSequentiallySucceeded(nodes2);
    }
  }
  return false;
}
