{
  if (!templatesShown.getAndSet(true)) {
    for (    final TemplateImpl possible : templates) {
      result.addElement(new LiveTemplateLookupElementImpl(possible,false));
    }
    PsiFile file=parameters.getPosition().getContainingFile();
    Editor editor=parameters.getEditor();
    for (    CustomLiveTemplate customLiveTemplate : CustomLiveTemplate.EP_NAME.getExtensions()) {
      if (customLiveTemplate instanceof CustomLiveTemplateBase && TemplateManagerImpl.isApplicable(customLiveTemplate,editor,file)) {
        ((CustomLiveTemplateBase)customLiveTemplate).addCompletions(parameters,result);
      }
    }
  }
}
