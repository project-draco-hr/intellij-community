{
  Set<EditorCustomization> features=new HashSet<>();
  VcsConfiguration configuration=VcsConfiguration.getInstance(project);
  if (configuration != null) {
    boolean enableSpellChecking=forceSpellCheckOn || configuration.CHECK_COMMIT_MESSAGE_SPELLING;
    ContainerUtil.addIfNotNull(features,SpellCheckingEditorCustomizationProvider.getInstance().getCustomization(enableSpellChecking));
    features.add(new RightMarginEditorCustomization(configuration.USE_COMMIT_MESSAGE_MARGIN,configuration.COMMIT_MESSAGE_MARGIN_SIZE));
    features.add(WrapWhenTypingReachesRightMarginCustomization.getInstance(configuration.WRAP_WHEN_TYPING_REACHES_RIGHT_MARGIN));
  }
 else {
    ContainerUtil.addIfNotNull(features,SpellCheckingEditorCustomizationProvider.getInstance().getEnabledCustomization());
    features.add(new RightMarginEditorCustomization(false,-1));
  }
  features.add(SoftWrapsEditorCustomization.ENABLED);
  features.add(AdditionalPageAtBottomEditorCustomization.DISABLED);
  features.add(MonospaceEditorCustomization.getInstance());
  EditorTextFieldProvider service=ServiceManager.getService(project,EditorTextFieldProvider.class);
  return service.getEditorField(FileTypes.PLAIN_TEXT.getLanguage(),project,features);
}
