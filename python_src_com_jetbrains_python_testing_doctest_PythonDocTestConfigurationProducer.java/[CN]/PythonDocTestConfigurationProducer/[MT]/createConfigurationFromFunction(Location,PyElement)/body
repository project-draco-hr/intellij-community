{
  PyFunction pyFunction=PsiTreeUtil.getParentOfType(element,PyFunction.class,false);
  if (pyFunction == null || !PythonDocTestUtil.isDocTestFunction(pyFunction))   return null;
  final PyClass containingClass=pyFunction.getContainingClass();
  final RunnerAndConfigurationSettings settings=makeConfigurationSettings(location,"doc tests from function");
  final PythonDocTestRunConfiguration configuration=(PythonDocTestRunConfiguration)settings.getConfiguration();
  configuration.setMethodName(pyFunction.getName());
  if (containingClass != null) {
    configuration.setClassName(containingClass.getName());
    configuration.setTestType(PythonDocTestRunConfiguration.TestType.TEST_METHOD);
  }
 else {
    configuration.setTestType(PythonDocTestRunConfiguration.TestType.TEST_FUNCTION);
  }
  if (!setupConfigurationScript(configuration,pyFunction))   return null;
  configuration.setName(configuration.suggestedName());
  myPsiElement=pyFunction;
  return settings;
}
