{
  if (!(file instanceof PyFile)) {
    return false;
  }
  PsiReference element=file.findReferenceAt(offset);
  if (element instanceof PyReferenceExpression && isImportable((PsiElement)element)) {
    final PyReferenceExpression refExpr=(PyReferenceExpression)element;
    if (!refExpr.isQualified()) {
      final PsiPolyVariantReference reference=refExpr.getReference();
      if (reference.resolve() == null) {
        AutoImportQuickFix fix=proposeImportFix(refExpr,reference);
        if (fix != null && fix.getCandidatesCount() == 1) {
          fix.invoke(file);
        }
        return true;
      }
    }
  }
  return false;
}
