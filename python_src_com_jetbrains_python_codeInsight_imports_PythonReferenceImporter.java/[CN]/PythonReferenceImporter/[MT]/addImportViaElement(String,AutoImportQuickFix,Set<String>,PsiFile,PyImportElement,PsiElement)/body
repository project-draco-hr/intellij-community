{
  PsiElement sourceFile=PyUtil.turnDirIntoInit(source);
  if (sourceFile instanceof PyFileImpl) {
    PyReferenceExpression importReferenceExpression=importElement.getImportReferenceExpression();
    if (importReferenceExpression != null) {
      seenFileNames.add(importReferenceExpression.getReferencedName());
    }
    PyFileImpl importSourceFile=(PyFileImpl)sourceFile;
    PsiElement res=importSourceFile.findExportedName(refText);
    if (res != null && !(res instanceof PyFile) && !(res instanceof PyImportElement) && res.getContainingFile() != null && PsiTreeUtil.isAncestor(source,res.getContainingFile(),false)) {
      existingImportFile=importSourceFile;
      fix.addImport(res,importSourceFile,importElement);
    }
  }
  return existingImportFile;
}
