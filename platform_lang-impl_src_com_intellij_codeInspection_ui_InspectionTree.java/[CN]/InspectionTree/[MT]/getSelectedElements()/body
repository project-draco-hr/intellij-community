{
  TreePath[] selectionPaths=getSelectionPaths();
  if (selectionPaths != null) {
    InspectionToolWrapper toolWrapper=getSelectedToolWrapper(true);
    if (toolWrapper == null)     return RefEntity.EMPTY_ELEMENTS_ARRAY;
    Set<RefEntity> result=new LinkedHashSet<RefEntity>();
    for (    TreePath selectionPath : selectionPaths) {
      final InspectionTreeNode node=(InspectionTreeNode)selectionPath.getLastPathComponent();
      addElementsInNode(node,result);
    }
    return ArrayUtil.reverseArray(result.toArray(new RefEntity[result.size()]));
  }
  return RefEntity.EMPTY_ELEMENTS_ARRAY;
}
