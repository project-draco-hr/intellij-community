{
  if (!ENABLED || !myContext.allowCallContext(expression)) {
    return null;
  }
  final long startInference=System.currentTimeMillis();
  final Set<String> seenAttrs=collectUsedAttributes(expression);
  LOG.debug(String.format("Attempting to infer type for expression: %s. Used attributes: %s",expression.getText(),seenAttrs));
  final Set<PyClass> allCandidates=suggestCandidateClasses(expression,seenAttrs);
  final long startPrioritization=System.currentTimeMillis();
  final List<CandidateClass> bestCandidates=prepareCandidates(allCandidates,expression);
  LOG.debug("Total " + (System.currentTimeMillis() - startPrioritization) + " ms to prioritize candidate classes");
  LOG.debug("Total " + (System.currentTimeMillis() - startInference) + " ms to infer candidate classes");
  return PyUnionType.createWeakType(PyUnionType.union(ContainerUtil.map(bestCandidates,new Function<CandidateClass,PyType>(){
    @Override public PyType fun(    CandidateClass cls){
      return new PyClassTypeImpl(cls.myClass,false);
    }
  }
)));
}
