{
  final Set<PyClass> candidates=Sets.newHashSet();
  for (  String attribute : seenAttrs) {
    if (COMMON_OBJECT_ATTRIBUTES.contains(attribute)) {
      candidates.add(PyBuiltinCache.getInstance(expression).getClass(PyNames.OBJECT));
    }
 else {
      final Collection<PyClass> declaringClasses=PyClassAttributesIndex.find(attribute,expression.getProject());
      LOG.debug("Attribute " + attribute + " is declared in "+ declaringClasses.size()+ " classes");
      candidates.addAll(declaringClasses);
    }
  }
  final Set<PyClass> suitableClasses=Sets.newHashSet();
  for (  PyClass candidate : candidates) {
    if (PyUserSkeletonsUtil.isUnderUserSkeletonsDirectory(candidate.getContainingFile())) {
      continue;
    }
    if (getAllInheritedAttributeNames(candidate).containsAll(seenAttrs)) {
      suitableClasses.add(candidate);
    }
  }
  for (  PyClass candidate : Lists.newArrayList(suitableClasses)) {
    for (    PyClass ancestor : getAncestorClassesFast(candidate)) {
      if (suitableClasses.contains(ancestor)) {
        suitableClasses.remove(candidate);
      }
    }
  }
  final List<CandidateClass> result=ContainerUtil.map(suitableClasses,new Function<PyClass,CandidateClass>(){
    @Override public CandidateClass fun(    PyClass pyClass){
      return new CandidateClass(pyClass,expression);
    }
  }
);
  Collections.sort(result);
  return result;
}
