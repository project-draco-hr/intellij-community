{
  while (myLogicalLine < myDocument.getLineCount()) {
    int lineStartOffset=myDocument.getLineStartOffset(myLogicalLine);
    if (lineStartOffset > nextWrapOffset)     return nextWrapOffset;
    myLogicalLine++;
    if (!isCollapsed(lineStartOffset))     return lineStartOffset;
  }
  return nextWrapOffset;
}
