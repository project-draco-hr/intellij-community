{
  while (myLogicalLine < myDocument.getLineCount()) {
    int lineStartOffset=myDocument.getLineStartOffset(myLogicalLine);
    if (!isCollapsed(lineStartOffset))     return lineStartOffset;
    myLogicalLine++;
  }
  return Integer.MAX_VALUE;
}
