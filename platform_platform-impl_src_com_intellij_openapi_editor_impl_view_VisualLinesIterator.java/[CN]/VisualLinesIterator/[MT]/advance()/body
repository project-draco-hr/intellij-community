{
  checkEnd();
  int nextWrapOffset=getNextSoftWrapOffset();
  int nextLineStart=getNextNotFoldedLineStartOffset();
  myOffset=Math.min(nextWrapOffset,nextLineStart);
  if (myOffset == Integer.MAX_VALUE) {
    myOffset=-1;
  }
 else   if (myOffset == nextWrapOffset) {
    mySoftWrap++;
  }
 else {
    myLogicalLine++;
  }
  myVisualLine++;
}
