{
  long started=System.currentTimeMillis();
  StringBuilder sb=new StringBuilder();
  boolean flag=false;
  while (System.currentTimeMillis() - started < PORTS_WAITING_TIMEOUT) {
    if (s.hasNextLine()) {
      String line=s.nextLine();
      sb.append(line).append("\n");
      try {
        int i=Integer.parseInt(line);
        if (flag) {
          LOG.warn("Unexpected strings in output:\n" + sb.toString());
        }
        return i;
      }
 catch (      NumberFormatException ignored) {
        flag=true;
        continue;
      }
    }
    TimeoutUtil.sleep(200);
    if (process.exitValue() != 0) {
      String error;
      try {
        error="Console process terminated with error:\n" + StreamUtil.readText(process.getErrorStream()) + sb.toString();
      }
 catch (      Exception ignored) {
        error="Console process terminated with exit code " + process.exitValue() + ", output:"+ sb.toString();
      }
      throw new ExecutionException(error);
    }
 else {
      break;
    }
  }
  throw new ExecutionException("Couldn't read integer value from stream");
}
