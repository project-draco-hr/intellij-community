{
  final AnAction runCompletions=new AnAction(){
    @Override public void actionPerformed(    AnActionEvent e){
      Editor editor=myConsoleView.getConsoleEditor();
      if (LookupManager.getActiveLookup(editor) != null) {
        AnAction replace=ActionManager.getInstance().getAction("EditorChooseLookupItemReplace");
        ActionUtil.performActionDumbAware(replace,e);
        return;
      }
      AnAction completionAction=ActionManager.getInstance().getAction("CodeCompletion");
      if (completionAction == null) {
        return;
      }
      ActionUtil.performActionDumbAware(completionAction,e);
    }
    @Override public void update(    AnActionEvent e){
      Editor editor=myConsoleView.getConsoleEditor();
      if (LookupManager.getActiveLookup(editor) != null) {
        e.getPresentation().setEnabled(false);
      }
      int offset=editor.getCaretModel().getOffset();
      Document document=editor.getDocument();
      int lineStart=document.getLineStartOffset(document.getLineNumber(offset));
      String textToCursor=document.getText(new TextRange(lineStart,offset));
      e.getPresentation().setEnabled(!CharMatcher.WHITESPACE.matchesAllOf(textToCursor));
    }
  }
;
  runCompletions.registerCustomShortcutSet(KeyEvent.VK_TAB,0,myConsoleView.getConsoleEditor().getComponent());
  runCompletions.getTemplatePresentation().setVisible(false);
  return runCompletions;
}
