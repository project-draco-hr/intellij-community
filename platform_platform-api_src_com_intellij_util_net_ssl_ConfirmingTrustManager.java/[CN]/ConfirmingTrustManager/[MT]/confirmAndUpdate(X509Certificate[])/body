{
  Application app=ApplicationManager.getApplication();
  final X509Certificate endPoint=chain[0];
  if (app.isUnitTestMode() || app.isHeadlessEnvironment()) {
    myCustomManager.addCertificate(endPoint);
    return true;
  }
  boolean accepted=CertificatesManager.showAcceptDialog(new Callable<DialogWrapper>(){
    @Override public DialogWrapper call() throws Exception {
      return CertificateWarningDialog.createUntrustedCertificateWarning(endPoint);
    }
  }
);
  if (accepted) {
    LOG.info("Certificate was accepted");
    myCustomManager.addCertificate(endPoint);
  }
  return accepted;
}
