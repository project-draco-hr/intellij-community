{
  if (broken) {
    return false;
  }
  FileOutputStream stream=null;
  myWriteLock.lock();
  try {
    myKeyStore.setCertificateEntry(createAlias(certificate),certificate);
    stream=new FileOutputStream(myPath);
    myKeyStore.store(stream,myPassword.toCharArray());
    myTrustManager=initFactoryAndGetManager();
    return true;
  }
 catch (  Exception e) {
    LOG.error("Can't add certificate",e);
    return false;
  }
 finally {
    StreamUtil.closeStream(stream);
    myWriteLock.unlock();
  }
}
