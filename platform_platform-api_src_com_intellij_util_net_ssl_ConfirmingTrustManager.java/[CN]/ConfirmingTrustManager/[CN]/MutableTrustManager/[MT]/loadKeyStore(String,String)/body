{
  KeyStore keyStore=null;
  try {
    keyStore=KeyStore.getInstance(KeyStore.getDefaultType());
    File cacertsFile=new File(path);
    if (cacertsFile.exists()) {
      FileInputStream stream=null;
      try {
        stream=new FileInputStream(path);
        keyStore.load(stream,password.toCharArray());
      }
  finally {
        StreamUtil.closeStream(stream);
      }
    }
 else {
      FileUtil.createParentDirs(cacertsFile);
      keyStore.load(null,password.toCharArray());
    }
  }
 catch (  Exception e) {
    LOG.error(e);
    broken=true;
  }
  return keyStore;
}
