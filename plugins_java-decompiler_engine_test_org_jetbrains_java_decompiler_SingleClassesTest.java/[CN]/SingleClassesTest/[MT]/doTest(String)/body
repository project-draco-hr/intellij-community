{
  try {
    File classFile=new File(testDataDir,"/classes/pkg/" + testName + ".class");
    assertTrue(classFile.isFile());
    decompiler.addSpace(classFile,true);
    File[] innerClasses=classFile.getParentFile().listFiles(new FilenameFilter(){
      @Override public boolean accept(      File dir,      String name){
        return name.matches(testName + "\\$.+\\.class");
      }
    }
);
    for (    File inner : innerClasses) {
      decompiler.addSpace(inner,true);
    }
    decompiler.decompileContext();
    File decompiledFile=new File(tempDir,testName + ".java");
    assertTrue(decompiledFile.isFile());
    File referenceFile=new File(testDataDir,"results/" + testName + ".dec");
    assertTrue(referenceFile.isFile());
    String decompiledContent=getContent(decompiledFile);
    String referenceContent=getContent(referenceFile);
    assertEquals(referenceContent,decompiledContent);
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
