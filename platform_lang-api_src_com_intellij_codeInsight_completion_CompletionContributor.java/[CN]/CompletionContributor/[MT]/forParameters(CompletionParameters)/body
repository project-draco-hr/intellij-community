{
  return ApplicationManager.getApplication().runReadAction(new Computable<List<CompletionContributor>>(){
    @Override public List<CompletionContributor> compute(){
      PsiElement position=parameters.getPosition();
      List<CompletionContributor> all=forLanguage(PsiUtilCore.getLanguageAtOffset(position.getContainingFile(),parameters.getOffset()));
      return DumbService.getInstance(position.getProject()).filterByDumbAwareness(all);
    }
  }
);
}
