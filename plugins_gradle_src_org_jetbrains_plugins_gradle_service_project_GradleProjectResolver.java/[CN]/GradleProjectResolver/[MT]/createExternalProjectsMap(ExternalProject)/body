{
  final Map<String,ExternalProject> externalProjectMap=ContainerUtilRt.newHashMap();
  if (rootExternalProject == null)   return externalProjectMap;
  Queue<ExternalProject> queue=new LinkedList<ExternalProject>();
  queue.add(rootExternalProject);
  while (!queue.isEmpty()) {
    ExternalProject externalProject=queue.remove();
    queue.addAll(externalProject.getChildProjects().values());
    final String moduleName=externalProject.getName();
    final String qName=externalProject.getQName();
    String moduleId=StringUtil.isEmpty(qName) || ":".equals(qName) ? moduleName : qName;
    externalProjectMap.put(moduleId,externalProject);
  }
  return externalProjectMap;
}
