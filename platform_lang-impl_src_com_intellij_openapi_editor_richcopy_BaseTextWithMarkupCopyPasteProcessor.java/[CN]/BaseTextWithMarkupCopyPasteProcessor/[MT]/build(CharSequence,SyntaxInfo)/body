{
  String stringRepresentation=null;
  final StringBuilder buffer=StringBuilderSpinAllocator.alloc();
  try {
    buildStringRepresentation(buffer,charSequence,syntaxInfo,Registry.intValue("editor.richcopy.max.size.megabytes") * 1048576);
    stringRepresentation=buffer.toString();
    if (Registry.is("editor.richcopy.debug")) {
      LOG.info("Resulting text: \n'" + stringRepresentation + "'");
    }
  }
 catch (  Exception e) {
    LOG.error(e);
  }
 finally {
    StringBuilderSpinAllocator.dispose(buffer);
  }
  myData=stringRepresentation == null ? null : createTransferable(stringRepresentation);
}
