{
  if (comboBox == null || arrowButton == null) {
    return;
  }
  hasFocus=false;
  checkFocus();
  final Graphics2D g=(Graphics2D)g2.create();
  final Rectangle arrowButtonBounds=arrowButton.getBounds();
  final int xxx=arrowButtonBounds.x - JBUI.scale(5);
  final int H=height - JBUI.scale(2);
  final int W=width - JBUI.scale(2);
  final Shape clip=g.getClip();
  g.setRenderingHint(RenderingHints.KEY_ANTIALIASING,RenderingHints.VALUE_ANTIALIAS_ON);
  g.setRenderingHint(RenderingHints.KEY_STROKE_CONTROL,RenderingHints.VALUE_STROKE_NORMALIZE);
  final int R=JBUI.scale(5);
  if (hasFocus) {
    g.clipRect(JBUI.scale(2),JBUI.scale(2),comboBox.getWidth() - JBUI.scale(4),comboBox.getHeight() - JBUI.scale(4));
  }
  final Color background=editor != null && comboBox.isEditable() ? editor.getBackground() : UIUtil.getPanelBackground();
  g.setColor(background);
  g.fillRoundRect(x + JBUI.scale(1),y + JBUI.scale(1),W,H,R,R);
  g.setColor(getArrowButtonFillColor(arrowButton.getBackground()));
  g.fillRoundRect(xxx,y + JBUI.scale(1),width - xxx,H,R,R);
  g.setColor(background);
  g.fillRect(xxx,y + JBUI.scale(1),JBUI.scale(5),H);
  final Color borderColor=getBorderColor();
  g.setColor(getArrowButtonFillColor(borderColor));
  int off=hasFocus ? 1 : 0;
  g.drawLine(xxx + JBUI.scale(5),y + JBUI.scale(1) + off,xxx + JBUI.scale(5),height - JBUI.scale(2));
  Rectangle r=rectangleForCurrentValue();
  paintCurrentValueBackground(g,r,hasFocus);
  paintCurrentValue(g,r,false);
  if (hasFocus) {
    g.setClip(clip);
    DarculaUIUtil.paintFocusRing(g,JBUI.scale(2),JBUI.scale(2),width - JBUI.scale(4),height - JBUI.scale(4));
  }
 else {
    g.setColor(borderColor);
    g.drawRoundRect(JBUI.scale(1),JBUI.scale(1),width - JBUI.scale(2),height - JBUI.scale(2),R,R);
    if (!UIUtil.isUnderDarcula() && comboBox.isEnabled()) {
      g.setColor(getArrowButtonFillColor(getBorderColor()));
      final int offX=xxx + JBUI.scale(5);
      g.clipRect(offX,y,width - offX,height);
      g.drawRoundRect(JBUI.scale(1),JBUI.scale(1),width - JBUI.scale(2),height - JBUI.scale(2),R,R);
    }
  }
  g.dispose();
}
