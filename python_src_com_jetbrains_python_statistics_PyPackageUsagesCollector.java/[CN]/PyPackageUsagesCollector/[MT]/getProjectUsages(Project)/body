{
  final Set<UsageDescriptor> result=new HashSet<UsageDescriptor>();
  for (  final Module m : ModuleManager.getInstance(project).getModules()) {
    Sdk pythonSdk=PythonSdkType.findPythonSdk(m);
    if (pythonSdk != null) {
      ApplicationManager.getApplication().runReadAction(new Runnable(){
        @Override public void run(){
          List<PyRequirement> requirements=PyPackageManagerImpl.getRequirements(m);
          if (requirements != null) {
            Collection<String> packages;
            try {
              packages=new HashSet<String>(PyPIPackageUtil.INSTANCE.getPackageNames());
            }
 catch (            IOException e) {
              return;
            }
            for (            PyRequirement requirement : requirements) {
              String name=requirement.getName();
              if (packages.contains(name)) {
                result.add(new UsageDescriptor(name,1));
              }
            }
          }
        }
      }
);
    }
  }
  return result;
}
