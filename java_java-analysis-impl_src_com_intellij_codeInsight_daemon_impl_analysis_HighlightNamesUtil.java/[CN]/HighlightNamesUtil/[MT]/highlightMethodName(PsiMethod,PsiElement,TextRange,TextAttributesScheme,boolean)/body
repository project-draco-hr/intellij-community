{
  boolean isInherited=false;
  if (!isDeclaration) {
    if (isCalledOnThis(elementToHighlight)) {
      final PsiClass containingClass=method.getContainingClass();
      PsiClass enclosingClass=containingClass == null ? null : PsiTreeUtil.getParentOfType(elementToHighlight,PsiClass.class);
      while (enclosingClass != null) {
        isInherited=enclosingClass.isInheritor(containingClass,true);
        if (isInherited)         break;
        enclosingClass=PsiTreeUtil.getParentOfType(enclosingClass,PsiClass.class,true);
      }
    }
  }
  HighlightInfoType type=getMethodNameHighlightType(method,isDeclaration,isInherited);
  if (type != null && elementToHighlight != null) {
    TextAttributes attributes=mergeWithScopeAttributes(method,type,colorsScheme);
    HighlightInfo.Builder builder=HighlightInfo.newHighlightInfo(type).range(range);
    if (attributes != null) {
      builder.textAttributes(attributes);
    }
    return builder.createUnconditionally();
  }
  return null;
}
