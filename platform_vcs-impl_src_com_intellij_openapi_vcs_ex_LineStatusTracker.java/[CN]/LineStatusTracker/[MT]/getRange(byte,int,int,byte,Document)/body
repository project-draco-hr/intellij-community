{
  if (rangeType == emptyRangeCondition) {
    int lineStartOffset=offset1 < document.getLineCount() ? document.getLineStartOffset(offset1) : document.getTextLength();
    return new TextRange(lineStartOffset,lineStartOffset);
  }
 else {
    int startOffset=document.getLineStartOffset(offset1);
    int endOffset=document.getLineEndOffset(offset2 - 1);
    return new TextRange(startOffset,endOffset);
  }
}
