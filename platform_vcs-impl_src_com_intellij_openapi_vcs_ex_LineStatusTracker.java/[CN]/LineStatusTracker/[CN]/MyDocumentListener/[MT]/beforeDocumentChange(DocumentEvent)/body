{
  myApplication.assertWriteAccessAllowed();
synchronized (myLock) {
    if (myReleased)     return;
    if (myBulkUpdate || myAnathemaThrown || BaseLoadState.LOADED != myBaseLoaded)     return;
    try {
      myFirstChangedLine=myDocument.getLineNumber(e.getOffset());
      myLastChangedLine=myDocument.getLineNumber(e.getOffset() + e.getOldLength());
      myChangedLines=myLastChangedLine - myFirstChangedLine;
      if (StringUtil.endsWithChar(e.getOldFragment(),'\n'))       myLastChangedLine++;
      myTotalLines=e.getDocument().getLineCount();
    }
 catch (    ProcessCanceledException ignore) {
    }
  }
}
