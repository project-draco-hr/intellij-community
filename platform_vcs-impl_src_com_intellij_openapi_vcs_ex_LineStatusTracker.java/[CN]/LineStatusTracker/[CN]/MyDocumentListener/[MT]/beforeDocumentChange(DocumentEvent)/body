{
  myApplication.assertWriteAccessAllowed();
synchronized (myLock) {
    if (myReleased)     return;
    if (myBulkUpdate || myAnathemaThrown || BaseLoadState.LOADED != myBaseLoaded)     return;
    try {
      myFirstChangedLine=myDocument.getLineNumber(e.getOffset());
      myLastChangedLine=e.getOldLength() == 0 ? myFirstChangedLine : myDocument.getLineNumber(e.getOffset() + e.getOldLength() - 1);
      if (StringUtil.endsWithChar(e.getOldFragment(),'\n'))       myLastChangedLine++;
      myChangedLines=myLastChangedLine - myFirstChangedLine;
      myTotalLines=getLineCount(e.getDocument());
    }
 catch (    ProcessCanceledException ignore) {
    }
  }
}
