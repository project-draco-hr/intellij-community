{
  mySessionId=sessionId;
  myChannel=channel;
  myPreloadedData=preloaded;
  final CmdlineRemoteProto.Message.ControllerMessage.GlobalSettings globals=params.getGlobalSettings();
  myProjectPath=FileUtil.toCanonicalPath(params.getProjectId());
  String globalOptionsPath=FileUtil.toCanonicalPath(globals.getGlobalOptionsPath());
  myBuildType=convertCompileType(params.getBuildType());
  myScopes=params.getScopeList();
  List<String> filePaths=params.getFilePathList();
  final Map<String,String> builderParams=new HashMap<String,String>();
  for (  CmdlineRemoteProto.Message.KeyValuePair pair : params.getBuilderParameterList()) {
    builderParams.put(pair.getKey(),pair.getValue());
  }
  myInitialFSDelta=delta;
  if (preloaded == null || preloaded.getRunner() == null) {
    myBuildRunner=new BuildRunner(new JpsModelLoaderImpl(myProjectPath,globalOptionsPath,null));
  }
 else {
    myBuildRunner=preloaded.getRunner();
  }
  myBuildRunner.setFilePaths(filePaths);
  myBuildRunner.setBuilderParams(builderParams);
  myForceModelLoading=Boolean.parseBoolean(builderParams.get(BuildParametersKeys.FORCE_MODEL_LOADING));
}
