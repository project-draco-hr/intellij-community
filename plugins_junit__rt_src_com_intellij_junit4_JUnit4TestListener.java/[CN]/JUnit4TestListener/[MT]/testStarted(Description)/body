{
  final String methodName=JUnit4ReflectionUtil.getMethodName(description);
  final String classFQN=JUnit4ReflectionUtil.getClassName(description);
  final List parents=(List)myParents.get(description);
  List parentsHierarchy=parents != null && !parents.isEmpty() ? (List)parents.remove(0) : Collections.singletonList(classFQN);
  int idx=0;
  String currentClass;
  String currentParent;
  while (idx < myStartedSuites.size() && idx < parentsHierarchy.size()) {
    currentClass=(String)myStartedSuites.get(idx);
    currentParent=(String)parentsHierarchy.get(parentsHierarchy.size() - 1 - idx);
    if (!currentClass.equals(currentParent))     break;
    idx++;
  }
  for (int i=myStartedSuites.size() - 1; i >= idx; i--) {
    currentClass=(String)myStartedSuites.remove(i);
    myPrintStream.println("##teamcity[testSuiteFinished name=\'" + escapeName(getShortName(currentClass)) + "\']");
  }
  for (int i=idx; i < parentsHierarchy.size(); i++) {
    final String fqName=(String)parentsHierarchy.get(parentsHierarchy.size() - 1 - i);
    final String className=getShortName(fqName);
    if (!className.equals(myRootName)) {
      myPrintStream.println("##teamcity[testSuiteStarted name=\'" + escapeName(className) + "\'"+ (parents == null ? " locationHint=\'java:suite://" + escapeName(fqName) + "\'" : "")+ "]");
      myStartedSuites.add(fqName);
    }
  }
  myPrintStream.println("##teamcity[testStarted name=\'" + escapeName(methodName) + "\' "+ getTestMethodLocation(methodName,classFQN)+ "]");
  myCurrentTestStart=currentTime();
}
