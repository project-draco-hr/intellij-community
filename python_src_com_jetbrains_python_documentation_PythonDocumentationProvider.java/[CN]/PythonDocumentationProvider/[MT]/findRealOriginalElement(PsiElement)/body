{
  if (element == null) {
    return null;
  }
  final PsiFile file=element.getContainingFile();
  if (file == null) {
    return element;
  }
  final Document document=PsiDocumentManager.getInstance(element.getProject()).getDocument(file);
  if (document == null) {
    return element;
  }
  final int newOffset=TargetElementUtil.adjustOffset(file,document,element.getTextOffset());
  final PsiElement newElement=file.findElementAt(newOffset);
  return newElement != null ? newElement : element;
}
