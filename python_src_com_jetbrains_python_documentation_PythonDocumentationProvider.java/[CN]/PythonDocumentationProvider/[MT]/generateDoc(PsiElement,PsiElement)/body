{
  if (element != null && PydevConsoleRunner.isInPydevConsole(element) || originalElement != null && PydevConsoleRunner.isInPydevConsole(originalElement)) {
    return PydevDocumentationProvider.createDoc(element,originalElement);
  }
  ChainIterable<String> cat=new ChainIterable<String>();
  final ChainIterable<String> prolog_cat=new ChainIterable<String>();
  final ChainIterable<String> doc_cat=new ChainIterable<String>();
  final ChainIterable<String> epilog_cat=new ChainIterable<String>();
  cat.add(prolog_cat).addWith(TagCode,doc_cat).add(epilog_cat);
  cat=wrapInTag("html",wrapInTag("body",cat));
  final ChainIterable<String> reassign_cat=new ChainIterable<String>();
  PsiElement followed=resolveToDocStringOwner(element,originalElement,reassign_cat);
  PyClass cls;
  PsiElement outer=null;
  boolean is_property=false;
  String accessor_kind="None";
  if (originalElement != null) {
    String element_name=originalElement.getText();
    if (PyUtil.isPythonIdentifier(element_name)) {
      outer=originalElement.getParent();
      if (outer instanceof PyQualifiedExpression) {
        PyExpression qual=((PyQualifiedExpression)outer).getQualifier();
        if (qual != null) {
          PyType type=qual.getType(TypeEvalContext.fast());
          if (type instanceof PyClassType) {
            cls=((PyClassType)type).getPyClass();
            if (cls != null) {
              Property property=cls.findProperty(element_name);
              if (property != null) {
                is_property=true;
                final AccessDirection dir=AccessDirection.of((PyElement)outer);
                Maybe<PyFunction> accessor=property.getByDirection(dir);
                prolog_cat.add("property ").addWith(TagBold,$().addWith(TagCode,$(element_name))).add(" of ").add(describeClass(cls,TagCode,true,true));
                if (accessor.isDefined() && property.getDoc() != null) {
                  doc_cat.add(": ").add(property.getDoc()).add(BR);
                }
 else {
                  final PyFunction getter=property.getGetter().valueOrNull();
                  if (getter != null && getter != element) {
                    PyStringLiteralExpression docstring=getter.getDocStringExpression();
                    if (docstring != null) {
                      prolog_cat.add(BR).addWith(TagItalic,$("Copied from getter:")).add(BR).add(docstring.getStringValue());
                    }
                  }
                  doc_cat.add(BR);
                }
                doc_cat.add(BR);
                if (accessor.isDefined() && accessor.value() == null)                 followed=null;
                if (dir == AccessDirection.READ)                 accessor_kind="Getter";
 else                 if (dir == AccessDirection.WRITE)                 accessor_kind="Setter";
 else                 accessor_kind="Deleter";
                if (followed != null)                 epilog_cat.addWith(TagSmall,$(BR,BR,accessor_kind," of property")).add(BR);
              }
            }
          }
        }
      }
    }
  }
  if (prolog_cat.isEmpty() && !is_property)   prolog_cat.add(reassign_cat);
  if (followed instanceof PyDocStringOwner) {
    String docString=null;
    PyStringLiteralExpression doc_expr=((PyDocStringOwner)followed).getDocStringExpression();
    if (doc_expr != null)     docString=doc_expr.getStringValue();
    if (followed instanceof PyClass) {
      cls=(PyClass)followed;
      doc_cat.add(describeDecorators(cls,TagItalic,BR,LCombUp));
      doc_cat.add(describeClass(cls,TagBold,true,false));
    }
 else     if (followed instanceof PyFunction) {
      PyFunction fun=(PyFunction)followed;
      if (!is_property) {
        cls=fun.getContainingClass();
        if (cls != null) {
          doc_cat.addWith(TagSmall,describeClass(cls,TagCode,true,true)).add(BR).add(BR);
        }
      }
 else       cls=null;
      doc_cat.add(describeDecorators(fun,TagItalic,BR,LCombUp)).add(describeFunction(fun,TagBold,LCombUp));
      if (docString == null) {
        addInheritedDocString(fun,cls,doc_cat,epilog_cat);
      }
    }
 else     if (followed instanceof PyFile) {
      String path=VfsUtil.urlToPath(((PyFile)followed).getUrl());
      if ("".equals(path)) {
        prolog_cat.addWith(TagSmall,$(PyBundle.message("QDOC.module.path.unknown")));
      }
 else {
        RootFinder finder=new RootFinder(path);
        ResolveImportUtil.visitRoots(followed,finder);
        final String root_path=finder.getResult();
        if (root_path != null) {
          String after_part=path.substring(root_path.length());
          prolog_cat.addWith(TagSmall,$(root_path).addWith(TagBold,$(after_part)));
        }
 else         prolog_cat.addWith(TagSmall,$(path));
      }
    }
    if (docString != null) {
      doc_cat.add(BR).add(combUpDocString(element.getProject(),docString));
    }
  }
 else   if (is_property) {
    String accessor_message;
    if (followed != null)     accessor_message="Declaration: ";
 else     accessor_message=accessor_kind + " is not defined.";
    doc_cat.addWith(TagItalic,$(accessor_message)).add(BR);
    if (followed != null)     doc_cat.add(combUp(PyUtil.getReadableRepr(followed,false)));
  }
 else   if (followed != null && outer instanceof PyReferenceExpression) {
    Class[] uninteresting_classes={PyTargetExpression.class,PyAugAssignmentStatement.class};
    boolean is_interesting=element != null && !PyUtil.instanceOf(element,uninteresting_classes);
    if (is_interesting) {
      PsiElement old_parent=element.getParent();
      is_interesting=!PyUtil.instanceOf(old_parent,uninteresting_classes);
    }
    if (is_interesting) {
      doc_cat.add(combUp(PyUtil.getReadableRepr(followed,false)));
    }
  }
  if (followed instanceof PyNamedParameter) {
    PyFunction function=PsiTreeUtil.getParentOfType(followed,PyFunction.class);
    if (function != null) {
      final String docString=PyUtil.strValue(function.getDocStringExpression());
      EpydocString epydocString=new EpydocString(docString);
      if (epydocString != null) {
        final String name=((PyNamedParameter)followed).getName();
        final String type=epydocString.getParamType(name);
        if (type != null) {
          doc_cat.add(": ").add(type);
        }
        final String desc=epydocString.getParamDescription(name);
        if (desc != null) {
          epilog_cat.add(BR).add(desc);
        }
      }
    }
  }
  if (doc_cat.isEmpty() && epilog_cat.isEmpty())   return null;
 else   return cat.toString();
}
