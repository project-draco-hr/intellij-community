{
  if (type == null) {
    return UNKNOWN;
  }
  if (type instanceof PyTypeReference) {
    final PyType resolved=((PyTypeReference)type).resolve(null,context);
    if (resolved != null) {
      return getTypeName(resolved,context);
    }
    return UNKNOWN;
  }
  final String name=type.getName();
  if (type instanceof PyCollectionType) {
    final PyType elementType=((PyCollectionType)type).getElementType(context);
    if (elementType != null) {
      return String.format("%s of %s",name,getTypeName(elementType,context));
    }
  }
  if (type instanceof PyUnionType) {
    final List<String> typeNames=new ArrayList<String>();
    for (    PyType t : ((PyUnionType)type).getMembers()) {
      typeNames.add(getTypeName(t,context));
    }
    Collections.sort(typeNames);
    return String.format("one of (%s)",StringUtil.join(typeNames,", "));
  }
  return name;
}
