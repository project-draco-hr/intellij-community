{
  final PsiElement refElement=p.getElementToSearch();
  boolean caseSensitive=refElement.getLanguage().isCaseSensitive();
  String text=null;
  if (refElement instanceof PsiFileSystemItem && !(refElement instanceof SyntheticFileSystemItem)) {
    final VirtualFile vFile=((PsiFileSystemItem)refElement).getVirtualFile();
    if (vFile != null) {
      text=vFile.getNameWithoutExtension();
    }
    caseSensitive=false;
  }
 else   if (refElement instanceof PsiNamedElement) {
    text=((PsiNamedElement)refElement).getName();
    if (refElement instanceof PsiMetaOwner) {
      final PsiMetaData metaData=((PsiMetaOwner)refElement).getMetaData();
      if (metaData != null)       text=metaData.getName();
    }
  }
  if (text == null && refElement instanceof PsiMetaOwner) {
    final PsiMetaData metaData=((PsiMetaOwner)refElement).getMetaData();
    if (metaData != null)     text=metaData.getName();
  }
  if (StringUtil.isNotEmpty(text)) {
    final SearchScope searchScope=p.getEffectiveSearchScope();
    p.getOptimizer().searchWord(text,searchScope,caseSensitive,refElement);
  }
}
