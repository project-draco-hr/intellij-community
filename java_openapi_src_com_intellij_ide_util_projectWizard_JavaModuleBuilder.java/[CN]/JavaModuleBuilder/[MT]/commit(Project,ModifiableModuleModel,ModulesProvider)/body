{
  LanguageLevelProjectExtension extension=LanguageLevelProjectExtension.getInstance(ProjectManager.getInstance().getDefaultProject());
  Boolean aDefault=extension.getDefault();
  LanguageLevelProjectExtension instance=LanguageLevelProjectExtension.getInstance(project);
  if (aDefault != null && !aDefault) {
    instance.setLanguageLevel(extension.getLanguageLevel());
    instance.setDefault(false);
  }
 else {
    Sdk sdk=ProjectRootManager.getInstance(project).getProjectSdk();
    if (sdk != null) {
      JavaSdkVersion version=JavaSdk.getInstance().getVersion(sdk);
      if (version != null) {
        instance.setLanguageLevel(version.getMaxLanguageLevel());
        instance.setDefault(true);
      }
    }
  }
  return super.commit(project,model,modulesProvider);
}
