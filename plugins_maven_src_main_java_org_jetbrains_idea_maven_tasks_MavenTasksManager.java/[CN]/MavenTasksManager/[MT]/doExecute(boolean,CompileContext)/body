{
  List<MavenRunnerParameters> parametersList;
synchronized (this) {
    parametersList=new ArrayList<MavenRunnerParameters>();
    Set<MavenCompilerTask> tasks=before ? myState.beforeCompileTasks : myState.afterCompileTasks;
    if (context.isRebuild()) {
      tasks=Sets.union(before ? myState.beforeRebuildTask : myState.afterRebuildTask,tasks);
    }
    for (    MavenCompilerTask each : tasks) {
      VirtualFile file=LocalFileSystem.getInstance().findFileByPath(each.getProjectPath());
      if (file == null)       continue;
      MavenExplicitProfiles explicitProfiles=myProjectsManager.getExplicitProfiles();
      parametersList.add(new MavenRunnerParameters(true,file.getParent().getPath(),Arrays.asList(each.getGoal()),explicitProfiles.getEnabledProfiles(),explicitProfiles.getDisabledProfiles()));
    }
  }
  return myRunner.runBatch(parametersList,null,null,TasksBundle.message("maven.tasks.executing"),context.getProgressIndicator());
}
