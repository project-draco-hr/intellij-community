{
  final VirtualFile virtualFile=event.getData(VcsDataKeys.VCS_VIRTUAL_FILE);
  final Project project=event.getData(CommonDataKeys.PROJECT);
  final VcsRevisionNumber revision=getRevisionNumber(event);
  if (revision == null || virtualFile == null || project == null) {
    return;
  }
  final VcsLogManager log=ServiceManager.getService(project,VcsLogManager.class);
  if (log == null) {
    return;
  }
  ToolWindow window=ToolWindowManager.getInstance(project).getToolWindow(ChangesViewContentManager.TOOLWINDOW_ID);
  ContentManager cm=window.getContentManager();
  Content[] contents=cm.getContents();
  for (  Content content : contents) {
    if (VcsLogContentProvider.TAB_NAME.equals(content.getDisplayName())) {
      cm.setSelectedContent(content);
    }
  }
  Runnable selectCommit=new Runnable(){
    @Override public void run(){
      VcsLogUiImpl logUi=log.getLogUi();
      if (logUi == null) {
        return;
      }
      logUi.getVcsLog().jumpToReference(revision.asString());
    }
  }
;
  if (!window.isVisible()) {
    window.activate(selectCommit,true);
  }
 else {
    selectCommit.run();
  }
}
