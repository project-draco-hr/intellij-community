{
  if (myDisposed || !myProject.isInitialized() || ApplicationManager.getApplication().isUnitTestMode())   return;
  if (!ProjectLevelVcsManager.getInstance(myProject).hasActiveVcss())   return;
  ChangeListManagerImpl changeListManager=ChangeListManagerImpl.getInstanceImpl(myProject);
  Couple<Integer> unv=changeListManager.getUnversionedFilesSize();
  Trinity<List<VirtualFile>,Integer,Integer> unversionedPair=Trinity.create(unv.getFirst() > UNVERSIONED_MAX_SIZE ? Collections.<VirtualFile>emptyList() : changeListManager.getUnversionedFiles(),unv.getFirst(),unv.getSecond());
  if (LOG.isDebugEnabled()) {
    LOG.debug("refresh view, unversioned collections size: " + unversionedPair.getFirst().size() + " unv size passed: "+ unversionedPair.getSecond()+ " dirs: "+ unversionedPair.getThird());
  }
  myView.updateModel(changeListManager.getChangeListsCopy(),unversionedPair,changeListManager.getDeletedFiles(),changeListManager.getModifiedWithoutEditing(),changeListManager.getSwitchedFilesMap(),changeListManager.getSwitchedRoots(),myState.myShowIgnored ? changeListManager.getIgnoredFiles() : null,changeListManager.getLockedFolders(),changeListManager.getLogicallyLockedFolders());
  changeDetails();
}
