{
  final ConfigurationFactory factory=PythonConfigurationType.getInstance().getConfigurationFactories()[0];
  final RunnerAndConfigurationSettings settings=RunManager.getInstance(project).createRunConfiguration("test",factory);
  final PythonRunConfiguration configuration=(PythonRunConfiguration)settings.getConfiguration();
  configuration.setScriptName(testFile.getPath());
  VirtualFile userFile=taskDir.findChild(virtualFile.getNameWithoutExtension() + ".py");
  if (userFile == null) {
    return;
  }
  VirtualFile ideaDir=project.getBaseDir().findChild(".idea");
  if (ideaDir == null) {
    return;
  }
  VirtualFileManager.getInstance().refreshWithoutFileWatcher(true);
  ProjectView.getInstance(project).refresh();
  VirtualFile courseDir=ideaDir.findChild("course");
  if (courseDir == null) {
    return;
  }
  configuration.setScriptParameters(PathUtil.toSystemDependentName(courseDir.getPath()) + " " + PathUtil.toSystemDependentName(userFile.getPath()));
  Executor executor=DefaultRunExecutor.getRunExecutorInstance();
  ProgramRunnerUtil.executeConfiguration(project,settings,executor);
}
