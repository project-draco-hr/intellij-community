{
  final ConfigurationFactory factory=PythonConfigurationType.getInstance().getConfigurationFactories()[0];
  final RunnerAndConfigurationSettings settings=RunManager.getInstance(project).createRunConfiguration("test",factory);
  final PythonRunConfiguration configuration=(PythonRunConfiguration)settings.getConfiguration();
  configuration.setScriptName(testFile.getPath());
  configuration.setWorkingDirectory(taskDir.getPath());
  String taskFileName=CCProjectService.getRealTaskFileName(virtualFile.getName());
  if (taskFileName == null) {
    return;
  }
  VirtualFile userFile=taskDir.findChild(taskFileName);
  if (userFile == null) {
    return;
  }
  VirtualFile ideaDir=project.getBaseDir().findChild(".idea");
  if (ideaDir == null) {
    return;
  }
  VirtualFileManager.getInstance().refreshWithoutFileWatcher(true);
  ProjectView.getInstance(project).refresh();
  configuration.setScriptParameters(PathUtil.toSystemDependentName(project.getBasePath()) + " " + PathUtil.toSystemDependentName(userFile.getPath()));
  Executor executor=DefaultRunExecutor.getRunExecutorInstance();
  ProgramRunnerUtil.executeConfiguration(project,settings,executor);
}
