{
  GitRepository firstRepo=assertNotNull(ContainerUtil.getFirstItem(repositories));
  if (repositories.size() == 1)   return firstRepo;
  ArrayList<VirtualFile> roots=newArrayList(getRootsFromRepositories(repositories));
  GitRebaseActionDialog dialog=new GitRebaseActionDialog(project,getTemplatePresentation().getText(),roots,firstRepo.getRoot());
  dialog.show();
  VirtualFile root=dialog.selectRoot();
  if (root == null)   return null;
  return getRepositoryManager(project).getRepositoryForRootQuick(root);
}
