{
  assumeTrue(SystemInfo.isWinVistaOrNewer);
  final File target=FileUtil.createTempDirectory(myTempDirectory,"temp.",".dir");
  final File path=FileUtil.createTempFile(myTempDirectory,"junction.",".dir",false);
  final File junction=IoTestUtil.createJunction(target.getPath(),path.getAbsolutePath());
  try {
    FileAttributes attributes=getAttributes(junction);
    assertEquals(FileAttributes.Type.DIRECTORY,attributes.type);
    assertEquals(0,attributes.flags);
    assertTrue(attributes.isWritable());
    final String resolved1=FileSystemUtil.resolveSymLink(junction);
    assertEquals(target.getPath(),resolved1);
    FileUtil.delete(target);
    attributes=getAttributes(junction);
    assertEquals(FileAttributes.Type.DIRECTORY,attributes.type);
    assertEquals(0,attributes.flags);
    assertTrue(attributes.isWritable());
    final String resolved2=FileSystemUtil.resolveSymLink(junction);
    assertEquals(null,resolved2);
  }
  finally {
    IoTestUtil.deleteJunction(junction.getPath());
  }
}
