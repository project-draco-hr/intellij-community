{
  PsiClass aClass=ClassUtils.getContainingClass(variable);
  final String variableName=variable.getName();
  if (variableName == null) {
    return null;
  }
  while (aClass != null) {
    final PsiField[] fields=aClass.getAllFields();
    for (    PsiField field : fields) {
      final String fieldName=field.getName();
      if (!variableName.equals(fieldName)) {
        continue;
      }
      if (!m_ignoreInvisibleFields || ClassUtils.isFieldVisible(field,aClass)) {
        return aClass;
      }
    }
    if (m_ignoreStaticMethods) {
      if (aClass.hasModifierProperty(PsiModifier.STATIC) || isContainedInStaticMethod(aClass)) {
        return null;
      }
    }
    aClass=ClassUtils.getContainingClass(aClass);
  }
  return null;
}
