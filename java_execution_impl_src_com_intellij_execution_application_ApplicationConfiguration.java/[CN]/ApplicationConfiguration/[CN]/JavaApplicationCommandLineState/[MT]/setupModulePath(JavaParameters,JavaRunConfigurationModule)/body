{
  JavaSdkVersion version=null;
  Sdk jdk=params.getJdk();
  if (jdk != null) {
    SdkTypeId type=jdk.getSdkType();
    if (type instanceof JavaSdk) {
      version=((JavaSdk)type).getVersion(jdk);
    }
  }
  if (version != null && version.isAtLeast(JavaSdkVersion.JDK_1_9)) {
    PsiClass mainClass=module.findClass(params.getMainClass());
    if (mainClass != null) {
      PsiJavaModule mainModule=JavaModuleGraphUtil.findDescriptorByElement(mainClass);
      if (mainModule != null) {
        params.setModuleName(mainModule.getModuleName());
        params.getModulePath().addAll(params.getClassPath().getPathList());
      }
    }
  }
}
