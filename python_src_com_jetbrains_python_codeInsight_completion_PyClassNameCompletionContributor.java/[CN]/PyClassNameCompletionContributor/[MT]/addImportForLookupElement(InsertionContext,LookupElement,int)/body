{
  PsiDocumentManager manager=PsiDocumentManager.getInstance(context.getProject());
  Document document=manager.getDocument(context.getFile());
  if (document != null) {
    manager.commitDocument(document);
  }
  final PsiReference ref=context.getFile().findReferenceAt(tailOffset);
  if (ref == null || ref.resolve() == item.getPsiElement()) {
    return;
  }
  new WriteCommandAction(context.getProject(),context.getFile()){
    @Override protected void run(    @NotNull Result result) throws Throwable {
      AddImportHelper.addImport(PyUtil.as(item.getPsiElement(),PsiNamedElement.class),context.getFile(),(PyElement)ref.getElement());
    }
  }
.execute();
}
