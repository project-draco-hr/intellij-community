{
  PsiDocumentManager manager=PsiDocumentManager.getInstance(context.getProject());
  Document document=manager.getDocument(context.getFile());
  if (document != null) {
    manager.commitDocument(document);
  }
  final PsiReference ref=context.getFile().findReferenceAt(tailOffset);
  if (ref == null || ref.resolve() == item.getObject()) {
    return;
  }
  new WriteCommandAction(context.getProject(),context.getFile()){
    @Override protected void run(    Result result) throws Throwable {
      AddImportHelper.addImport((PsiNamedElement)item.getObject(),context.getFile(),(PyElement)ref.getElement());
    }
  }
.execute();
}
