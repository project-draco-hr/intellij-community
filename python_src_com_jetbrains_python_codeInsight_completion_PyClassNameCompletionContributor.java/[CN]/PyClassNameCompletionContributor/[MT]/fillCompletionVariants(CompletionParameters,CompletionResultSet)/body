{
  if (parameters.isExtendedCompletion()) {
    final PsiElement element=parameters.getPosition();
    final PsiElement parent=element.getParent();
    if (parent instanceof PyReferenceExpression && ((PyReferenceExpression)parent).getQualifier() != null) {
      return;
    }
    if (PsiTreeUtil.getParentOfType(element,PyImportStatementBase.class) != null) {
      return;
    }
    addVariantsFromIndex(result,parameters.getOriginalFile(),PyClassNameIndex.KEY,IMPORTING_INSERT_HANDLER,Conditions.<PyClass>alwaysTrue());
    addVariantsFromIndex(result,parameters.getOriginalFile(),PyFunctionNameIndex.KEY,FUNCTION_INSERT_HANDLER,TOPLEVEL_FUNCTION);
    addVariantsFromModules(result,parameters.getOriginalFile());
  }
}
