{
  final PsiDirectory taskDir=file.getContainingDirectory();
  Course course=CCProjectService.getInstance(file.getProject()).getCourse();
  if (course == null) {
    return;
  }
  if (taskDir == null || !taskDir.getName().contains("task")) {
    return;
  }
  PsiDirectory lessonDir=taskDir.getParent();
  if (lessonDir == null || !lessonDir.getName().contains("lesson")) {
    return;
  }
  Lesson lesson=course.getLesson(lessonDir.getName());
  if (lesson == null) {
    return;
  }
  Task task=lesson.getTask(taskDir.getName());
  if (task == null) {
    return;
  }
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      CCRunTestsAction.clearTestEnvironment(taskDir.getVirtualFile(),taskDir.getProject());
    }
  }
);
  Map<String,TaskFile> taskFiles=task.getTaskFiles();
  TaskFile taskFile=task.getTaskFile(oldName);
  String realTaskFileName=CCProjectService.getRealTaskFileName(oldName);
  taskFiles.remove(realTaskFileName);
  taskFiles.put(CCProjectService.getRealTaskFileName(file.getName()),taskFile);
}
