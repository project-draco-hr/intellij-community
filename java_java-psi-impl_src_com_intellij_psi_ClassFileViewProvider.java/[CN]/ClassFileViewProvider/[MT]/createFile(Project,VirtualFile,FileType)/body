{
  FileIndexFacade fileIndex=ServiceManager.getService(project,FileIndexFacade.class);
  if (!fileIndex.isInLibraryClasses(vFile) && fileIndex.isInSource(vFile)) {
    return null;
  }
  String name=vFile.getNameWithoutExtension();
  int index=name.lastIndexOf('$',name.length());
  if (index > 0 && index < name.length() - 1) {
    String supposedParentName=name.substring(0,index) + ".class";
    if (vFile.getParent().findChild(supposedParentName) != null) {
      return null;
    }
  }
  return new ClsFileImpl(PsiManager.getInstance(project),this);
}
