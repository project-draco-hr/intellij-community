{
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    if (myImage == null || !isLargeEnough(myImage,size)) {
      myImage=UIUtil.createImage(size.width,size.height,BufferedImage.TYPE_INT_ARGB);
    }
  }
 else {
    if (myImage == null) {
      myImage=component.createVolatileImage(size.width,size.height);
    }
 else     if (!isLargeEnough(myImage,size) || ((VolatileImage)myImage).validate(component.getGraphicsConfiguration()) == VolatileImage.IMAGE_INCOMPATIBLE) {
      myImage.flush();
      myImage=component.createVolatileImage(size.width,size.height);
    }
  }
}
