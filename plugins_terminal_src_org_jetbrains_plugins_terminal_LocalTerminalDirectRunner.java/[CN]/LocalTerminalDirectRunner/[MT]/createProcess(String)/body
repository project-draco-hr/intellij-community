{
  Map<String,String> envs=new HashMap<String,String>(System.getenv());
  envs.put("TERM","xterm-256color");
  EncodingEnvironmentUtil.fixDefaultEncodingIfMac(envs,getProject());
  try {
    return PtyProcess.exec(getCommand(),envs,directory != null ? directory : currentProjectFolder());
  }
 catch (  IOException e) {
    throw new ExecutionException(e);
  }
}
