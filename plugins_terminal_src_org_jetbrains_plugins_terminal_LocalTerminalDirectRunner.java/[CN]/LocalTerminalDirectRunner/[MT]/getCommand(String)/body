{
  if (SystemInfo.isUnix) {
    List<String> command=Lists.newArrayList(shellPath.split(" "));
    String shellName=command.size() > 0 ? getShellName(command.get(0)) : null;
    if (shellName != null) {
      command.remove(0);
      List<String> result=Lists.newArrayList(shellName);
      String rcFilePath=findRCFile(shellName);
      if (rcFilePath != null && (shellName.equals("bash") || shellName.equals("sh"))) {
        result.add("--rcfile");
        result.add(rcFilePath);
      }
      if (!loginOrInteractive(command)) {
        if (hasLoginArgument(shellName) && SystemInfo.isMac) {
          result.add("--login");
        }
 else {
          result.add("-i");
        }
      }
      result.addAll(command);
      return ArrayUtil.toStringArray(result);
    }
 else {
      return ArrayUtil.toStringArray(command);
    }
  }
 else {
    return new String[]{shellPath};
  }
}
