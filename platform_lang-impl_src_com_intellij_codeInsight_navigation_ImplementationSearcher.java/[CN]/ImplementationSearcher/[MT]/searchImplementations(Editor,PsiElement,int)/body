{
  final TargetElementUtil targetElementUtil=TargetElementUtil.getInstance();
  boolean onRef=ApplicationManager.getApplication().runReadAction(new Computable<Boolean>(){
    @Override public Boolean compute(){
      return targetElementUtil.findTargetElement(editor,getFlags() & ~(TargetElementUtil.REFERENCED_ELEMENT_ACCEPTED | TargetElementUtil.LOOKUP_ITEM_ACCEPTED),offset) == null;
    }
  }
);
  return searchImplementations(element,editor,offset,onRef && ApplicationManager.getApplication().runReadAction(new Computable<Boolean>(){
    @Override public Boolean compute(){
      return element == null || targetElementUtil.includeSelfInGotoImplementation(element);
    }
  }
),onRef);
}
