{
  PsiFile targetContainer=null;
  if (editor != null) {
    final Document document=editor.getDocument();
    targetContainer=PsiDocumentManager.getInstance(project).getPsiFile(document);
    if (targetContainer instanceof PyFile && selectionSpansMultipleLines(editor)) {
      final List<PyElement> moduleMembers=collectAllMovableElementsInSelection(editor,(PyFile)targetContainer);
      if (moduleMembers.isEmpty()) {
        showBadSelectionErrorHint(project,editor);
      }
 else {
        doMove(project,ContainerUtil.findAllAsArray(moduleMembers,PsiNamedElement.class),targetContainer,null);
      }
      return true;
    }
  }
  final PsiNamedElement e=PyMoveModuleMembersHelper.extractNamedElement(element);
  if (e != null && PyMoveModuleMembersHelper.isMovableElement(e)) {
    if (PyUtil.isTopLevel(e)) {
      doMove(project,new PsiElement[]{e},targetContainer,null);
    }
 else {
      showBadSelectionErrorHint(project,editor);
    }
    return true;
  }
  return false;
}
