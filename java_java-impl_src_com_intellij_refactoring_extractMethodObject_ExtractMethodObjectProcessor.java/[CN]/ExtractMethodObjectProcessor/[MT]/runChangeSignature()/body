{
  if (myCopyMethodToInner != null) {
    ApplicationManager.getApplication().runWriteAction(myCopyMethodToInner);
  }
  if (myChangeReturnType) {
    final Runnable runnable=new Runnable(){
      public void run(){
        final PsiTypeElement typeElement=((PsiLocalVariable)((PsiDeclarationStatement)JavaPsiFacade.getElementFactory(myProject).createStatementFromText(myInnerClassName + " l =null;",myInnerClass)).getDeclaredElements()[0]).getTypeElement();
        final PsiTypeElement innerMethodReturnTypeElement=myInnerMethod.getReturnTypeElement();
        LOG.assertTrue(innerMethodReturnTypeElement != null);
        innerMethodReturnTypeElement.replace(typeElement);
      }
    }
;
    ApplicationManager.getApplication().runWriteAction(runnable);
  }
}
