{
  LOG.debug("Query: '" + query + "' caret at: "+ caret);
  final Pair<String,Integer> lookup=Pair.create(query,caret);
  Response response=null;
  if (ignoreCaret) {
    for (    Pair<String,Integer> pair : ourCache.keySet()) {
      if (pair.getFirst().equals(query)) {
        response=ourCache.get(pair);
        break;
      }
    }
  }
 else {
    response=ourCache.get(lookup);
  }
  LOG.debug("Cache " + (response != null ? "hit" : "miss"));
  if (response == null) {
    final String url=String.format("%s?filter=%s&caret=%d",INTELLISENSE_RESOURCE,URLEncoder.encode(query,"utf-8"),caret);
    final long startTime=System.currentTimeMillis();
    response=new Response(myRepository.doREST(url,false).getResponseBodyAsStream());
    LOG.debug(String.format("Intellisense request to YouTrack took %d ms to complete",System.currentTimeMillis() - startTime));
    ourCache.put(lookup,response);
  }
  return response;
}
