{
  final String text=matchedNode.getText();
  if (matcher == null) {
    matcher=Pattern.compile(matchExpression).matcher(text);
  }
 else {
    matcher.reset(text);
  }
  if (!matcher.find()) {
    return false;
  }
  for (int i=0; i < handlers.size(); ++i) {
    final SubstitutionHandler handler=handlers.get(i);
    if (!handler.handle(matchedNode,matcher.start(i + 1),matcher.end(i + 1),context)) {
      return false;
    }
  }
  return true;
}
