{
  Presentation presentation=e.getPresentation();
  if (!Registry.is("vcs.log.highlight.not.indexed")) {
    presentation.setEnabledAndVisible(false);
  }
 else {
    Project project=e.getProject();
    VcsLog log=e.getData(VcsLogDataKeys.VCS_LOG);
    if (project == null || log == null) {
      presentation.setEnabledAndVisible(false);
    }
 else {
      VcsLogData dataManager=VcsProjectLog.getInstance(project).getDataManager();
      if (dataManager == null) {
        presentation.setEnabledAndVisible(false);
      }
 else {
        VcsLogIndex index=dataManager.getIndex();
        if (!(index instanceof VcsLogPersistentIndex)) {
          presentation.setEnabledAndVisible(false);
        }
 else {
          presentation.setEnabledAndVisible(!log.getSelectedCommits().isEmpty());
        }
      }
    }
  }
}
