{
  if (!Registry.is("ide.hide.excluded.files") && !selection.mySelectedExcludeRoots.isEmpty() && selection.mySelectedDirectories.isEmpty()&& selection.mySelectedRoots.isEmpty()) {
    e.getPresentation().setEnabledAndVisible(true);
    e.getPresentation().setText("Cancel Exclusion");
    return;
  }
  super.doUpdate(e,module,selection);
  Set<ModuleSourceRootEditHandler<?>> selectedRootHandlers=getHandlersForSelectedRoots(selection);
  if (!selectedRootHandlers.isEmpty()) {
    String text;
    if (selectedRootHandlers.size() == 1) {
      ModuleSourceRootEditHandler<?> handler=selectedRootHandlers.iterator().next();
      text="Unmark as " + handler.getRootTypeName() + " "+ StringUtil.pluralize("Root",selection.mySelectedRoots.size());
    }
 else {
      text="Unmark Roots";
    }
    e.getPresentation().setText(text);
  }
}
