{
  HgRepositoryManager manager=HgUtil.getRepositoryManager(project);
  HgProjectSettings hgProjectSettings=ServiceManager.getService(project,HgProjectSettings.class);
  HgMultiRootBranchConfig hgMultiRootBranchConfig=new HgMultiRootBranchConfig(manager.getRepositories());
  Condition<AnAction> preselectActionCondition=new Condition<AnAction>(){
    @Override public boolean value(    AnAction action){
      return false;
    }
  }
;
  return new HgBranchPopup(currentRepository,manager,hgMultiRootBranchConfig,hgProjectSettings,preselectActionCondition);
}
