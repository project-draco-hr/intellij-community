{
  int currentColumn=startColumn;
  CharSequence text=document.getImmutableCharSequence();
  for (int i=startOffset; i < endOffset; i++) {
    if (text.charAt(i) == '\t') {
      currentColumn=(currentColumn / tabSize + 1) * tabSize;
    }
 else {
      currentColumn++;
    }
    if (currentColumn > column)     return i;
  }
  return endOffset;
}
