{
  return new DelayedDocumentWatcher(myProject,myDelayMillis,new Consumer<Integer>(){
    @Override public void consume(    Integer modificationStamp){
      restartAllAutoTests(modificationStamp);
    }
  }
,new Condition<VirtualFile>(){
    @Override public boolean value(    VirtualFile file){
      if (ScratchFileService.getInstance().getRootType(file) != null) {
        return false;
      }
      return FileEditorManager.getInstance(myProject).isFileOpen(file);
    }
  }
);
}
