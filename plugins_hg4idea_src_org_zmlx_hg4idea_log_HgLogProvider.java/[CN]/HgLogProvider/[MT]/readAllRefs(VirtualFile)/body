{
  myRepositoryManager.waitUntilInitialized();
  HgRepository repository=myRepositoryManager.getRepositoryForRoot(root);
  if (repository == null) {
    LOG.error("Repository not found for root " + root);
    return Collections.emptyList();
  }
  repository.update();
  Collection<HgNameWithHashInfo> branches=repository.getBranches();
  Collection<HgNameWithHashInfo> bookmarks=repository.getBookmarks();
  Collection<VcsRef> refs=new ArrayList<VcsRef>(branches.size() + bookmarks.size());
  for (  HgNameWithHashInfo branchInfo : branches) {
    refs.add(new VcsRefImpl(myVcsObjectsFactory.createHash(branchInfo.getHash()),branchInfo.getName(),HgRefManager.BRANCH,root));
  }
  for (  HgNameWithHashInfo bookmarkInfo : bookmarks) {
    refs.add(new VcsRefImpl(myVcsObjectsFactory.createHash(bookmarkInfo.getHash()),bookmarkInfo.getName(),HgRefManager.BOOKMARK,root));
  }
  String currentRevision=repository.getCurrentRevision();
  if (currentRevision != null) {
    refs.add(new VcsRefImpl(myVcsObjectsFactory.createHash(currentRevision),"HEAD",HgRefManager.HEAD,root));
  }
  return refs;
}
