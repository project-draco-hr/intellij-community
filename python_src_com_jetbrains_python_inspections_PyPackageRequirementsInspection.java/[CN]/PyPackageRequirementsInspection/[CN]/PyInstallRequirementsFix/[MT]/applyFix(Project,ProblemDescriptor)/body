{
  boolean installManagement=false;
  final PyPackageManager manager=PyPackageManager.getInstance(mySdk);
  boolean hasManagement=false;
  try {
    hasManagement=manager.hasManagement(false);
  }
 catch (  ExecutionException ignored) {
  }
  if (!hasManagement) {
    final int result=Messages.showYesNoDialog(project,"Python packaging tools are required for installing packages. Do you want to " + "install 'pip' and 'setuptools' for your interpreter?","Install Python Packaging Tools",Messages.getQuestionIcon());
    if (result == Messages.YES) {
      installManagement=true;
    }
 else {
      return;
    }
  }
  final List<PyRequirement> chosen;
  if (myUnsatisfied.size() > 1) {
    final PyChooseRequirementsDialog dialog=new PyChooseRequirementsDialog(project,myUnsatisfied);
    if (dialog.showAndGet()) {
      chosen=dialog.getMarkedElements();
    }
 else {
      chosen=Collections.emptyList();
    }
  }
 else {
    chosen=myUnsatisfied;
  }
  if (chosen.isEmpty()) {
    return;
  }
  if (installManagement) {
    final PyPackageManagerUI ui=new PyPackageManagerUI(project,mySdk,new UIListener(myModule){
      @Override public void finished(      List<ExecutionException> exceptions){
        super.finished(exceptions);
        if (exceptions.isEmpty()) {
          installRequirements(project,chosen);
        }
      }
    }
);
    ui.installManagement();
  }
 else {
    installRequirements(project,chosen);
  }
}
