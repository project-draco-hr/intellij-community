{
  return new WriteCommandAction<CaretAndSelectionState>(null){
    @Override public void run(    @NotNull Result<CaretAndSelectionState> actionResult){
      actionResult.setResult(extractCaretAndSelectionMarkersImpl(document,processBlockSelection));
    }
  }
.execute().getResultObject();
}
