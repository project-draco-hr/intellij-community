{
  final PsiElement original=parameters.getOriginalPosition();
  if (original != null) {
    final PsiElement parent=original.getParent();
    if (parent instanceof PyStringLiteralExpression) {
      final int stringOffset=parameters.getOffset() - parameters.getPosition().getTextRange().getStartOffset();
      if (isInsideSubstitutionChunk((PyStringLiteralExpression)parent,stringOffset)) {
        final PyExpression[] arguments=getFormatFunctionKeyWordArguments(original);
        for (        PyExpression argument : arguments) {
          result=result.withPrefixMatcher(getPrefix(parameters.getOffset(),argument.getContainingFile()));
          addKeysFromStarArgument(result,argument);
          addKeyWordArgument(result,argument);
        }
      }
    }
 else     if (PyUtil.instanceOf(parent,PyKeywordArgument.class,PyReferenceExpression.class)) {
      final PyArgumentList argumentList=PsiTreeUtil.getParentOfType(original,PyArgumentList.class);
      result=result.withPrefixMatcher(getPrefix(parameters.getOffset(),parent.getContainingFile()));
      addElementsFromFormattedString(result,argumentList);
    }
  }
}
