{
  if (notEnvConfiguration()) {
    fail("Running under teamcity but not by Env configuration. Skipping.");
    return;
  }
  List<String> roots=getPythonRoots();
  if (roots.size() == 0) {
    String msg=testName + ": environments are not defined. Skipping. \nSpecify either " + PYCHARM_PYTHON_ENVS+ " or "+ PYCHARM_PYTHON_VIRTUAL_ENVS+ " environment variable.";
    LOG.warn(msg);
    System.out.println(msg);
    return;
  }
  if (!DONT_RUN_LOCAL) {
    TaskRunner taskRunner=new TaskRunner(roots);
    taskRunner.runTask(testTask,testName);
  }
  if (SHOULD_RUN_REMOTE && PyTestRemoteSdkProvider.shouldRunRemoteSdk(testTask)) {
    if (PyTestRemoteSdkProvider.canRunRemoteSdk()) {
      TaskRunner remoteRunner=new RemoteTaskRunner(roots);
      remoteRunner.runTask(testTask,testName);
    }
 else {
      if (PyTestRemoteSdkProvider.shouldFailWhenCantRunRemote()) {
        fail("Cant run with remote sdk: password isn't set");
      }
    }
  }
}
