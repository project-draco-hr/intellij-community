{
  String fullReferenceText=reference.getCanonicalText();
  for (  ExternalLibraryResolver resolver : ExternalLibraryResolver.EP_NAME.getExtensions()) {
    ExternalClassResolveResult resolveResult=resolver.resolveClass(shortReferenceName,isReferenceToAnnotation(psiElement),currentModule);
    OrderEntryFix fix=null;
    if (resolveResult != null && facade.findClass(resolveResult.getQualifiedClassName(),currentModule.getModuleWithDependenciesAndLibrariesScope(true)) == null) {
      fix=new AddExternalLibraryToDependenciesQuickFix(currentModule,resolveResult.getLibrary(),reference,resolveResult.getQualifiedClassName());
    }
 else     if (!fullReferenceText.equals(shortReferenceName)) {
      ExternalLibraryDescriptor descriptor=resolver.resolvePackage(fullReferenceText);
      if (descriptor != null) {
        fix=new AddExternalLibraryToDependenciesQuickFix(currentModule,descriptor,reference,null);
      }
    }
    if (fix != null) {
      registrar.register(fix);
      result.add(fix);
    }
  }
}
