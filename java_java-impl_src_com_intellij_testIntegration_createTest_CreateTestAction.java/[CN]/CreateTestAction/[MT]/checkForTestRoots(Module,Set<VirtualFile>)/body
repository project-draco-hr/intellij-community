{
  List<VirtualFile> sourceRoots=ModuleRootManager.getInstance(srcModule).getSourceRoots(JavaSourceRootType.TEST_SOURCE);
  for (  VirtualFile sourceRoot : sourceRoots) {
    if (!JavaProjectRootsUtil.isInGeneratedCode(sourceRoot,srcModule.getProject())) {
      testFolders.add(sourceRoot);
    }
  }
  if (!testFolders.isEmpty())   return;
  final HashSet<Module> modules=new HashSet<Module>();
  ModuleUtilCore.collectModulesDependsOn(srcModule,modules);
  for (  Module module : modules) {
    testFolders.addAll(ModuleRootManager.getInstance(module).getSourceRoots(JavaSourceRootType.TEST_SOURCE));
  }
}
