{
  Module targetModule=null;
  for (  VirtualFile testFolder : testFolders) {
    Module targetModuleCandidate=ProjectFileIndex.SERVICE.getInstance(project).getModuleForFile(testFolder);
    if (targetModuleCandidate == srcModule) {
      targetModule=srcModule;
      break;
    }
 else     if (targetModule == null || TestModuleProperties.getInstance(targetModule).getProductionModule() != srcModule) {
      targetModule=targetModuleCandidate;
    }
  }
  return targetModule == null ? srcModule : targetModule;
}
