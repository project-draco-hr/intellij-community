{
  if (myProject.isDefault()) {
    return VirtualFile.EMPTY_ARRAY;
  }
  final List<VirtualFile> result=new ArrayList<VirtualFile>(5);
  Processor<VirtualFile> processor=Processors.cancelableCollectProcessor(result);
  collectVirtualFilesWithWord(word,occurenceMask,scope,caseSensitively,processor);
  return result.isEmpty() ? VirtualFile.EMPTY_ARRAY : result.toArray(new VirtualFile[result.size()]);
}
