{
  final Project project=e.getData(CommonDataKeys.PROJECT);
  final DataContext dataContext=e.getDataContext();
  PsiClass psiClass=getTarget(dataContext);
  if (psiClass != null) {
    psiClass=(PsiClass)psiClass.getOriginalElement();
    HierarchyService hierarchyService=HierarchyService.instance(project);
    if (hierarchyService != null) {
      LOG.info("Subtypes of " + psiClass + " retrieve started");
      SmartClassAnchor[] classAnchors=hierarchyService.getSingleClassHierarchy().getDirectSubtypes(psiClass);
      String[] subtypes=new String[classAnchors.length];
      LOG.info("Subtypes of " + psiClass + " retrieve PSI started, count="+ classAnchors.length);
      for (int i=0; i < classAnchors.length; i++) {
        PsiClass subClass=classAnchors[i].retrieveClass(project);
        subtypes[i]=subClass.toString() + "(" + subClass.getQualifiedName()+ ", "+ subClass.getContainingFile().getVirtualFile().getPresentableUrl()+ ")";
      }
      LOG.info("Subtypes of " + psiClass + "("+ psiClass.getQualifiedName()+ "): "+ Arrays.toString(subtypes));
    }
  }
}
