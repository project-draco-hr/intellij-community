{
  GraphLayout graphLayout=myPrintedLinearGraph.getGraphLayout();
  int upNodeIndex, downNodeIndex;
  if (element instanceof GraphNode) {
    upNodeIndex=((GraphNode)element).getNodeIndex();
    downNodeIndex=upNodeIndex;
  }
 else {
    GraphEdge edge=(GraphEdge)element;
    upNodeIndex=edge.getUpNodeIndex();
    downNodeIndex=edge.getDownNodeIndex();
  }
  int upLayoutIndex=graphLayout.getLayoutIndex(upNodeIndex);
  int downLayoutIndex=graphLayout.getLayoutIndex(downNodeIndex);
  int headNodeIndex=graphLayout.getOneOfHeadNodeIndex(upNodeIndex);
  CommitId headCommitId=myPrintedLinearGraph.getHashIndex(headNodeIndex);
  if (upLayoutIndex != downLayoutIndex) {
    return myColorManager.getColorOfFragment(headCommitId,upLayoutIndex * downLayoutIndex);
  }
  if (upLayoutIndex == graphLayout.getLayoutIndex(headNodeIndex))   return myColorManager.getColorOfBranch(headCommitId);
 else   return myColorManager.getColorOfFragment(headCommitId,upLayoutIndex);
}
