{
  final int argsLength=types1.length;
  final PsiType[] nTypes1=new PsiType[argsLength];
  for (int i=0; i < argsLength; i++) {
    nTypes1[i]=siteSubstitutor1.substitute(types1[i]);
  }
  final PsiSubstitutor methodSubstitutor2=calculateMethodSubstitutor(typeParameters2,method2,siteSubstitutor2,types2,nTypes1,languageLevel);
  final int level=Math.min(applicabilityLevel,PsiUtil.getApplicabilityLevel(method2,methodSubstitutor2,nTypes1,languageLevel,false));
  if (level > MethodCandidateInfo.ApplicabilityLevel.NOT_APPLICABLE) {
    for (    PsiTypeParameter typeParameter : typeParameters2) {
      final PsiType substituted=methodSubstitutor2.substitute(typeParameter);
      for (      PsiClassType extendsType : typeParameter.getExtendsListTypes()) {
        if (substituted == null || !TypeConversionUtil.isAssignable(methodSubstitutor2.substitute(extendsType),substituted,false)) {
          return MethodCandidateInfo.ApplicabilityLevel.NOT_APPLICABLE;
        }
      }
    }
    if (level == MethodCandidateInfo.ApplicabilityLevel.VARARGS) {
      if (!TypeConversionUtil.isAssignable(methodSubstitutor2.substitute(types2[argsLength - 1]),nTypes1[argsLength - 1])) {
        return MethodCandidateInfo.ApplicabilityLevel.NOT_APPLICABLE;
      }
    }
  }
  return level;
}
