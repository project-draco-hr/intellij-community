{
  try {
    final Method superMethod=BasicLookAndFeel.class.getDeclaredMethod("getDefaults");
    superMethod.setAccessible(true);
    final UIDefaults metalDefaults=(UIDefaults)superMethod.invoke(new MetalLookAndFeel());
    final UIDefaults defaults=(UIDefaults)superMethod.invoke(base);
    if (SystemInfo.isLinux) {
      Font font=findFont("Ubuntu");
      if (font != null) {
        for (        Object key : defaults.keySet()) {
          if (key instanceof String && ((String)key).endsWith(".font")) {
            defaults.put(key,new FontUIResource(font.deriveFont(15f)));
          }
        }
      }
    }
    LafManagerImpl.initInputMapDefaults(defaults);
    initIdeaDefaults(defaults);
    patchStyledEditorKit();
    patchComboBox(metalDefaults,defaults);
    defaults.remove("Spinner.arrowButtonBorder");
    defaults.put("Spinner.arrowButtonSize",new Dimension(16,5));
    MetalLookAndFeel.setCurrentTheme(new DarculaMetalTheme());
    return defaults;
  }
 catch (  Exception e) {
    log(e);
  }
  return super.getDefaults();
}
