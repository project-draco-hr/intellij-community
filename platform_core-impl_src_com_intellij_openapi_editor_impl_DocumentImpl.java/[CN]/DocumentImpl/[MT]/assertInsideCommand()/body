{
  CommandProcessor commandProcessor=CommandProcessor.getInstance();
  if (!commandProcessor.isUndoTransparentActionInProgress() && commandProcessor.getCurrentCommand() == null && myAssertThreading) {
    throw new IncorrectOperationException("Must not change document outside command or undo-transparent action.");
  }
}
