{
  try {
    if (LOG.isDebugEnabled())     LOG.debug(event.toString());
    myLineSet=getLineSet().update(prevText,event.getOffset(),event.getOffset() + event.getOldLength(),event.getNewFragment(),event.isWholeTextReplaced());
    myFrozen=null;
    if (myTabTrackingRequestors > 0) {
      updateMightContainTabs(event.getNewFragment());
    }
    setModificationStamp(newModificationStamp);
    if (!ShutDownTracker.isShutdownHookRunning()) {
      DocumentListener[] listeners=getCachedListeners();
      for (      DocumentListener listener : listeners) {
        try {
          listener.documentChanged(event);
        }
 catch (        ProcessCanceledException e) {
          if (!myAssertThreading) {
            throw e;
          }
 else {
            LOG.error("ProceeCanceledException shouldn't be thrown from document listeners on real document");
          }
        }
catch (        Throwable e) {
          LOG.error(e);
        }
      }
    }
  }
  finally {
    myEventsHandling=false;
  }
}
