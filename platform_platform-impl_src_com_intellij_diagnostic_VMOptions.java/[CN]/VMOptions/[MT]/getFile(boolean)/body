{
  final String vmOptionsFile=System.getProperty("jb.vmOptionsFile");
  if (!StringUtil.isEmptyOrSpaces(vmOptionsFile)) {
    return new File(vmOptionsFile);
  }
  final String productName=ApplicationNamesInfo.getInstance().getProductName().toLowerCase(Locale.US);
  final String platformSuffix=SystemInfo.is64Bit ? "64" : "";
  final String osSuffix=SystemInfo.isWindows ? ".exe" : "";
  final File binFile=new File(PathManager.getBinPath() + File.separatorChar + productName+ platformSuffix+ osSuffix+ ".vmoptions");
  if (SystemInfo.isMac) {
    File customFile=new File(FileUtil.expandUserHome(PathManager.getConfigPath() + "/" + productName+ ".vmoptions"));
    if (customFile.exists())     return customFile;
    if (!customFile.exists() && isWriteAccess && binFile.exists()) {
      copyVmFile(binFile,customFile);
      return customFile;
    }
  }
  return binFile.exists() ? binFile : null;
}
