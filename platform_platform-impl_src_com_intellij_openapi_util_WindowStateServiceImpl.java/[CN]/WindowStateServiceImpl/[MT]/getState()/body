{
  Element element=new Element(STATE);
synchronized (myStateMap) {
    for (    Map.Entry<String,WindowState> entry : myStateMap.entrySet()) {
      String key=entry.getKey();
      if (key != null) {
        WindowState state=entry.getValue();
        Element child=new Element(STATE);
        if (state.myLocation != null) {
          child.setAttribute(X,Integer.toString(state.myLocation.x));
          child.setAttribute(Y,Integer.toString(state.myLocation.y));
        }
        if (state.mySize != null) {
          child.setAttribute(WIDTH,Integer.toString(state.mySize.width));
          child.setAttribute(HEIGHT,Integer.toString(state.mySize.height));
        }
        if (state.myState != null) {
          child.setAttribute(EXTENDED,state.myState.toString());
        }
        child.setAttribute(KEY,key);
        element.addContent(child);
      }
    }
  }
  return element;
}
