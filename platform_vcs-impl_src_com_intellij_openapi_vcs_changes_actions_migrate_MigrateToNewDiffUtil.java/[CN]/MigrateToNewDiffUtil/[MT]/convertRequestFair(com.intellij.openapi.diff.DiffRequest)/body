{
  if (oldRequest.getOnOkRunnable() != null)   return null;
  com.intellij.openapi.diff.DiffContent[] contents=oldRequest.getContents();
  String[] titles=oldRequest.getContentTitles();
  DiffContent[] newContents=new DiffContent[contents.length];
  for (int i=0; i < contents.length; i++) {
    newContents[i]=convertContent(oldRequest.getProject(),contents[i]);
    if (newContents[i] == null)     return null;
  }
  SimpleDiffRequest newRequest=new SimpleDiffRequest(oldRequest.getWindowTitle(),newContents,titles);
  newRequest.putUserData(DiffUserDataKeys.CONTEXT_ACTIONS,Collections.<AnAction>singletonList(new MyShowDiffAction(oldRequest)));
  DiffNavigationContext navigationContext=(DiffNavigationContext)oldRequest.getGenericData().get(DiffTool.SCROLL_TO_LINE.getName());
  if (navigationContext != null) {
    newRequest.putUserData(DiffUserDataKeysEx.NAVIGATION_CONTEXT,navigationContext);
  }
  return newRequest;
}
