{
  if (oldRequest.getOnOkRunnable() != null)   return null;
  com.intellij.openapi.diff.DiffContent[] contents=oldRequest.getContents();
  String[] titles=oldRequest.getContentTitles();
  List<DiffContent> newContents=new ArrayList<DiffContent>(contents.length);
  for (int i=0; i < contents.length; i++) {
    DiffContent convertedContent=convertContent(oldRequest.getProject(),contents[i]);
    if (convertedContent == null)     return null;
    newContents.add(convertedContent);
  }
  SimpleDiffRequest newRequest=new SimpleDiffRequest(oldRequest.getWindowTitle(),newContents,Arrays.asList(titles));
  newRequest.putUserData(DiffUserDataKeys.CONTEXT_ACTIONS,Collections.<AnAction>singletonList(new MyShowDiffAction(oldRequest)));
  DiffNavigationContext navigationContext=(DiffNavigationContext)oldRequest.getGenericData().get(DiffTool.SCROLL_TO_LINE.getName());
  if (navigationContext != null) {
    newRequest.putUserData(DiffUserDataKeysEx.NAVIGATION_CONTEXT,navigationContext);
  }
  return newRequest;
}
