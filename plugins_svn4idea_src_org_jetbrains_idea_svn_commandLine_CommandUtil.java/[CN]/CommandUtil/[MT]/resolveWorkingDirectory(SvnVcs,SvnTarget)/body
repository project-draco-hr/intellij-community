{
  File workingDirectory=target.isFile() ? target.getFile() : null;
  workingDirectory=correctUpToExistingParent(workingDirectory);
  if (workingDirectory == null) {
    workingDirectory=!vcs.getProject().isDefault() ? VfsUtilCore.virtualToIoFile(vcs.getProject().getBaseDir()) : getHomeDirectory();
  }
  return workingDirectory;
}
