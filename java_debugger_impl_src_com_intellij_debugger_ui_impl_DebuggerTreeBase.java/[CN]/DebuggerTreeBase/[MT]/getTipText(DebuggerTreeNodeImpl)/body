{
  NodeDescriptorImpl descriptor=node.getDescriptor();
  if (descriptor instanceof ValueDescriptorImpl) {
    String text=((ValueDescriptorImpl)descriptor).getValueText();
    final String tipText=DebuggerUtilsEx.prepareValueText(text,myProject);
    if (!tipText.isEmpty() && (tipText.indexOf('\n') >= 0 || !getVisibleRect().contains(getRowBounds(getRowForPath(new TreePath(node.getPath())))))) {
      return tipText;
    }
  }
  return node.getMarkupTooltipText() != null ? "" : null;
}
