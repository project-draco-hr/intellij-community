{
  final PsiManager psiManager=PsiManager.getInstance(project);
  LinkedHashSet<GlobalSearchScope> resolveScopes=newLinkedHashSet(mapNotNull(candidateFiles,new Function<VirtualFile,GlobalSearchScope>(){
    @Override public GlobalSearchScope fun(    VirtualFile file){
      PsiFile psiFile=psiManager.findFile(file);
      return psiFile == null ? null : psiFile.getResolveScope();
    }
  }
));
  return GlobalSearchScope.union(resolveScopes.toArray(new GlobalSearchScope[resolveScopes.size()]));
}
