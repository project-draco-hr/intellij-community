{
synchronized (TARGETS_COMPLETELY_MARKED_DIRTY) {
    Set<BuildTarget<?>> targetsCompletelyMarkedDirty=TARGETS_COMPLETELY_MARKED_DIRTY.get(context);
    if (targetsCompletelyMarkedDirty == null) {
      targetsCompletelyMarkedDirty=Collections.synchronizedSet(new HashSet<BuildTarget<?>>());
      TARGETS_COMPLETELY_MARKED_DIRTY.set(context,targetsCompletelyMarkedDirty);
    }
    targetsCompletelyMarkedDirty.add(target);
  }
}
