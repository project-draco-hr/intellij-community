{
  if (mySchemesTableModel.isProjectScheme(getSelectedScheme())) {
    int rowToSelect=mySchemesTableModel.exportProjectScheme();
    if (rowToSelect > 0) {
      mySchemesTable.getSelectionModel().setSelectionInterval(rowToSelect,rowToSelect);
    }
  }
 else {
    Collection<String> names=CodeStyleSchemesImpl.getSchemeManager().getAllSchemeNames();
    String selectedName=getSelectedScheme().getName();
    SaveSchemeDialog saveDialog=new SaveSchemeDialog(myParent,ApplicationBundle.message("title.save.code.style.scheme.as"),names,selectedName);
    if (saveDialog.showAndGet()) {
      int row=mySchemesTableModel.createNewScheme(getSelectedScheme(),saveDialog.getSchemeName());
      mySchemesTable.getSelectionModel().setSelectionInterval(row,row);
    }
  }
}
