{
  final String homePath=mySdk.getHomePath();
  if (homePath == null) {
    throw new ExecutionException("Cannot find Python interpreter for SDK " + mySdk.getName());
  }
  final SdkAdditionalData sdkData=mySdk.getSdkAdditionalData();
  if (sdkData instanceof PyRemoteSdkAdditionalDataBase) {
    RemoteSdkCredentials remoteSdkCredentials;
    try {
      remoteSdkCredentials=((RemoteSdkAdditionalData)sdkData).getRemoteSdkCredentials(false);
    }
 catch (    InterruptedException e) {
      LOG.error(e);
      remoteSdkCredentials=null;
    }
catch (    final ExecutionException e) {
      if (e.getCause() instanceof VagrantNotStartedException) {
        final List<? extends PyExecutionFix> fixes=ImmutableList.of(new PyExecutionFix(){
          @NotNull @Override public String getName(){
            return "Launch Vagrant";
          }
          @Override public void run(          @NotNull Sdk sdk){
            final PythonRemoteInterpreterManager manager=PythonRemoteInterpreterManager.getInstance();
            if (manager != null) {
              try {
                manager.runVagrant(((VagrantNotStartedException)e.getCause()).getVagrantFolder());
                clearCaches();
              }
 catch (              ExecutionException e) {
                throw new RuntimeException(e);
              }
            }
          }
        }
);
        throw new PyExternalProcessException(helperPath,args,"Vagrant instance is down. <a href=\"" + LAUNCH_VAGRANT + "\">Launch vagrant</a>",fixes);
      }
 else {
        throw new PyExternalProcessException(helperPath,args,e.getMessage());
      }
    }
    final PythonRemoteInterpreterManager manager=PythonRemoteInterpreterManager.getInstance();
    if (manager != null && remoteSdkCredentials != null) {
      final List<String> cmdline=new ArrayList<String>();
      cmdline.add(homePath);
      cmdline.add(RemoteFile.detectSystemByPath(homePath).createRemoteFile(helperPath).getPath());
      cmdline.addAll(Collections2.transform(args,new Function<String,String>(){
        @Override public String apply(        @Nullable String input){
          return quoteIfNeeded(input);
        }
      }
));
      try {
        if (askForSudo) {
          askForSudo=!manager.ensureCanWrite(null,remoteSdkCredentials,remoteSdkCredentials.getInterpreterPath());
        }
        ProcessOutput processOutput;
        do {
          PathMappingSettings mappings=manager.setupMappings(null,(PyRemoteSdkAdditionalDataBase)sdkData,null);
          processOutput=manager.runRemoteProcess(null,remoteSdkCredentials,mappings,ArrayUtil.toStringArray(cmdline),workingDir,askForSudo);
          if (askForSudo && processOutput.getStderr().contains("sudo: 3 incorrect password attempts")) {
            continue;
          }
          break;
        }
 while (true);
        return processOutput;
      }
 catch (      ExecutionException e) {
        throw new PyExternalProcessException(helperPath,args,"Error running SDK: " + e.getMessage());
      }
    }
 else {
      throw new PyExternalProcessException(helperPath,args,PythonRemoteInterpreterManager.WEB_DEPLOYMENT_PLUGIN_IS_DISABLED);
    }
  }
 else {
    throw new PyExternalProcessException(helperPath,args,"Invalid remote SDK");
  }
}
