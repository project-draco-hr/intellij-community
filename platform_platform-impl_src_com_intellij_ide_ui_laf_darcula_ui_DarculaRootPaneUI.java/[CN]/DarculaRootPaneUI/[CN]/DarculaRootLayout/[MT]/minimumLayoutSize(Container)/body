{
  Dimension cpd, mbd, tpd;
  int cpWidth=0;
  int cpHeight=0;
  int mbWidth=0;
  int mbHeight=0;
  int tpWidth=0;
  int tpHeight=0;
  Insets i=parent.getInsets();
  JRootPane root=(JRootPane)parent;
  if (root.getContentPane() != null) {
    cpd=root.getContentPane().getMinimumSize();
  }
 else {
    cpd=root.getSize();
  }
  if (cpd != null) {
    cpWidth=cpd.width;
    cpHeight=cpd.height;
  }
  if (root.getJMenuBar() != null) {
    mbd=root.getJMenuBar().getMinimumSize();
    if (mbd != null) {
      mbWidth=mbd.width;
      mbHeight=mbd.height;
    }
  }
  if ((root.getWindowDecorationStyle() != JRootPane.NONE) && (root.getUI() instanceof DarculaRootPaneUI)) {
    JComponent titlePane=((DarculaRootPaneUI)root.getUI()).getTitlePane();
    if (titlePane != null) {
      tpd=titlePane.getMinimumSize();
      if (tpd != null) {
        tpWidth=tpd.width;
        tpHeight=tpd.height;
      }
    }
  }
  return new Dimension(Math.max(Math.max(cpWidth,mbWidth),tpWidth) + i.left + i.right,cpHeight + mbHeight + tpHeight+ i.top+ i.bottom);
}
