{
  IntArrayList breakOffsets=new IntArrayList();
  int nextOffset=startOffset;
  while (true) {
    int prevOffset=nextOffset;
    nextOffset=calcWordBreakOffset(text,nextOffset,endOffset,x,clipX,widthProvider);
    if (nextOffset == prevOffset && lineStart) {
      nextOffset=calcCharBreakOffset(text,nextOffset,endOffset,x,clipX,widthProvider);
      if (nextOffset == prevOffset) {
        nextOffset++;
      }
    }
    if (nextOffset >= endOffset) {
      break;
    }
    breakOffsets.add(nextOffset);
    lineStart=true;
    x=0;
  }
  return breakOffsets;
}
