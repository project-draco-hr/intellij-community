{
  out.writeLong(myId);
  StreamUtil.writeStringOrNull(out,myName);
  out.writeLong(myTimestamp);
  final Ref<IOException> ref=new Ref<IOException>();
  accessChanges(new Runnable(){
    @Override public void run(){
      try {
        out.writeInt(myChanges.size());
        for (        Change c : myChanges) {
          StreamUtil.writeChange(out,c);
        }
      }
 catch (      IOException e) {
        ref.set(e);
      }
    }
  }
);
  if (ref.get() != null)   throw ref.get();
}
