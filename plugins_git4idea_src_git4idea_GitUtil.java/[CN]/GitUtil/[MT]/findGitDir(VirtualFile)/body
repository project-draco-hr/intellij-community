{
  VirtualFile child=rootDir.findChild(DOT_GIT);
  if (child == null) {
    return null;
  }
  if (child.isDirectory()) {
    boolean headExists=child.findChild(GitRepositoryFiles.HEAD) != null;
    return headExists ? child : null;
  }
  String content=readContent(child);
  if (content == null)   return null;
  String pathToDir=parsePathToRepository(content);
  File file=findSubmoduleRepositoryDir(rootDir,pathToDir);
  if (file == null)   return null;
  return VcsUtil.getVirtualFileWithRefresh(file);
}
