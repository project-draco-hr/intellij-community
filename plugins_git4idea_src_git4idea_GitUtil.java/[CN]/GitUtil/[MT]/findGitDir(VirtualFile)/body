{
  VirtualFile dotGit=rootDir.findChild(DOT_GIT);
  if (dotGit == null) {
    return null;
  }
  if (dotGit.isDirectory()) {
    boolean headExists=dotGit.findChild(GitRepositoryFiles.HEAD) != null;
    return headExists ? dotGit : null;
  }
  String content=readContent(dotGit);
  if (content == null)   return null;
  String pathToDir=parsePathToRepository(content);
  File file=findSubmoduleRepositoryDir(rootDir.getPath(),pathToDir);
  if (file == null)   return null;
  return VcsUtil.getVirtualFileWithRefresh(file);
}
