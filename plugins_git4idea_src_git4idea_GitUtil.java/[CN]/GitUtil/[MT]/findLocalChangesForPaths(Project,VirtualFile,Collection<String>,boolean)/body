{
  ChangeListManagerEx changeListManager=(ChangeListManagerEx)ChangeListManager.getInstance(project);
  List<Change> affectedChanges=new ArrayList<Change>();
  for (  String path : affectedPaths) {
    String absolutePath=relativePaths ? toAbsolute(root,path) : path;
    VirtualFile file=findRefreshFileOrLog(absolutePath);
    if (file != null) {
      Change change=changeListManager.getChange(file);
      if (change != null) {
        affectedChanges.add(change);
      }
 else {
        String message="Change is not found for " + file.getPath();
        if (changeListManager.isInUpdate()) {
          message+=" because ChangeListManager is being updated.";
          LOG.debug(message);
        }
 else {
          LOG.info(message);
        }
      }
    }
  }
  return affectedChanges;
}
