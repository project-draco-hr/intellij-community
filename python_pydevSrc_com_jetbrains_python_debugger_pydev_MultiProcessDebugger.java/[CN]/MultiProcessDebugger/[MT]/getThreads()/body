{
  List<PyThreadInfo> threads=Lists.newArrayList(myMainDebugger.getThreads());
  List<PyThreadInfo> result=Lists.newArrayList();
  cleanDebuggers();
  collectAndRegisterThreads(threads);
  for (  PyThreadInfo t : threads) {
    myThreadRegistry.register(t.getId(),myMainDebugger);
    String threadName=myOtherDebuggers.size() > 0 ? ThreadRegistry.threadName(t.getName(),t.getId()) : t.getName();
    PyThreadInfo newThread=new PyThreadInfo(t.getId(),threadName,t.getFrames(),t.getStopReason(),t.getMessage());
    threads.add(newThread);
  }
  return Collections.unmodifiableCollection(result);
}
