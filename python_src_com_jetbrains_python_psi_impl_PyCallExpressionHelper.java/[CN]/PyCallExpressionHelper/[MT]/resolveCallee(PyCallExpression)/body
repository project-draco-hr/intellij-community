{
  PyExpression calleeReference=us.getCallee();
  if (calleeReference != null) {
    PsiReference cref=calleeReference.getReference();
    if (cref != null) {
      PsiElement resolved=null;
      if (cref instanceof PsiPolyVariantReference) {
        PsiPolyVariantReference poly=(PsiPolyVariantReference)cref;
        ResolveResult[] targets=poly.multiResolve(false);
        for (        ResolveResult target : targets) {
          PsiElement elt=target.getElement();
          if (elt instanceof PyFunction) {
            resolved=elt;
            break;
          }
        }
      }
 else       resolved=cref.resolve();
      if (resolved != null) {
        EnumSet<PyCallExpression.Flag> flags=EnumSet.noneOf(PyCallExpression.Flag.class);
        int implicit_offset=0;
        if (isByInstance(us))         implicit_offset+=1;
        if (resolved instanceof PyFunction) {
          PyFunction meth=(PyFunction)resolved;
          if (PyNames.INIT.equals(meth.getName()))           implicit_offset+=1;
          PyDecoratorList decolist=meth.getDecoratorList();
          if (decolist != null) {
            PyDecorator[] decos=decolist.getDecorators();
            if (decos.length == 1) {
              PyDecorator deco=decos[0];
              String deconame=deco.getName();
              if (deco.isBuiltin()) {
                if (PyNames.STATICMETHOD.equals(deconame)) {
                  flags.add(PyCallExpression.Flag.STATICMETHOD);
                  if (implicit_offset > 0)                   implicit_offset-=1;
                }
 else                 if (PyNames.CLASSMETHOD.equals(deconame)) {
                  flags.add(PyCallExpression.Flag.CLASSMETHOD);
                }
              }
            }
          }
        }
        if (!(resolved instanceof PyFunction))         return null;
        return new PyCallExpression.PyMarkedFunction((PyFunction)resolved,flags,implicit_offset);
      }
    }
  }
  return null;
}
