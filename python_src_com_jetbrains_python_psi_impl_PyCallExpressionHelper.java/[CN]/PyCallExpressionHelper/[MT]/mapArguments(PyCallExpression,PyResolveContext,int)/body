{
  final PyArgumentList argumentList=callExpression.getArgumentList();
  final PyCallExpression.PyMarkedCallee markedCallee=callExpression.resolveCallee(resolveContext,implicitOffset);
  if (markedCallee == null || argumentList == null) {
    return new PyCallExpression.PyArgumentsMapping(null,Collections.<PyExpression,PyNamedParameter>emptyMap(),Collections.<PyParameter>emptyList(),Collections.<PyExpression>emptyList());
  }
  boolean seenSingleStar=false;
  final TypeEvalContext context=resolveContext.getTypeEvalContext();
  final Map<PyExpression,PyNamedParameter> mappedParameters=new LinkedHashMap<PyExpression,PyNamedParameter>();
  final List<PyParameter> unmappedParameters=new ArrayList<PyParameter>();
  final List<PyParameter> allParameters=PyUtil.getParameters(markedCallee.getCallable(),context);
  final List<PyParameter> parameters=dropImplicitParameters(allParameters,markedCallee.getImplicitOffset());
  final List<PyExpression> arguments=new ArrayList<PyExpression>(Arrays.asList(argumentList.getArguments()));
  final List<PyExpression> positionalArguments=removePositionalElements(arguments,resolveContext);
  final List<PyKeywordArgument> keywordArguments=filterKeywordArguments(arguments);
  final List<PyExpression> variadicPositionalArguments=filterVariadicPositionalArguments(arguments);
  final List<PyExpression> variadicKeywordArguments=filterVariadicKeywordArguments(arguments);
  for (  PyParameter parameter : parameters) {
    if (parameter instanceof PyNamedParameter) {
      final PyNamedParameter namedParameter=(PyNamedParameter)parameter;
      final String parameterName=namedParameter.getName();
      if (namedParameter.isPositionalContainer()) {
        if (variadicPositionalArguments.size() == 1) {
          mappedParameters.put(variadicPositionalArguments.remove(0),namedParameter);
        }
 else {
          positionalArguments.clear();
          variadicPositionalArguments.clear();
        }
      }
 else       if (namedParameter.isKeywordContainer()) {
        if (variadicKeywordArguments.size() == 1) {
          mappedParameters.put(variadicKeywordArguments.remove(0),namedParameter);
        }
 else {
          keywordArguments.clear();
          variadicKeywordArguments.clear();
        }
      }
 else       if (seenSingleStar) {
        final PyExpression keywordArgument=removeKeywordArgument(keywordArguments,parameterName);
        if (keywordArgument != null) {
          mappedParameters.put(keywordArgument,namedParameter);
        }
 else         if (variadicKeywordArguments.isEmpty() && !namedParameter.hasDefaultValue()) {
          unmappedParameters.add(namedParameter);
        }
      }
 else {
        if (!positionalArguments.isEmpty()) {
          final PyExpression positionalArgument=next(positionalArguments);
          if (positionalArgument != null) {
            mappedParameters.put(positionalArgument,namedParameter);
          }
 else           if (!namedParameter.hasDefaultValue()) {
            unmappedParameters.add(namedParameter);
          }
        }
 else {
          final PyKeywordArgument keywordArgument=removeKeywordArgument(keywordArguments,parameterName);
          if (keywordArgument != null) {
            mappedParameters.put(keywordArgument,namedParameter);
          }
 else           if (variadicPositionalArguments.isEmpty() && variadicKeywordArguments.isEmpty() && !namedParameter.hasDefaultValue()) {
            unmappedParameters.add(namedParameter);
          }
        }
      }
    }
 else     if (parameter instanceof PyTupleParameter) {
    }
 else     if (parameter instanceof PySingleStarParameter) {
      seenSingleStar=true;
    }
 else     if (!parameter.hasDefaultValue()) {
      unmappedParameters.add(parameter);
    }
  }
  final List<PyExpression> unmappedArguments=new ArrayList<PyExpression>();
  unmappedArguments.addAll(positionalArguments);
  unmappedArguments.addAll(keywordArguments);
  unmappedArguments.addAll(variadicPositionalArguments);
  unmappedArguments.addAll(variadicKeywordArguments);
  return new PyCallExpression.PyArgumentsMapping(markedCallee,mappedParameters,unmappedParameters,unmappedArguments);
}
