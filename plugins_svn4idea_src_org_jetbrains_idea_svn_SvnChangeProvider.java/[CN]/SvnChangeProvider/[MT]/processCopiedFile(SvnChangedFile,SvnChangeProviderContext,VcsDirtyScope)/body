{
  boolean foundRename=false;
  final Status copiedStatus=copiedFile.getStatus();
  final String copyFromURL=copiedFile.getCopyFromURL();
  final Set<SvnChangedFile> deletedToDelete=new HashSet<SvnChangedFile>();
  for (  SvnChangedFile deletedFile : context.getDeletedFiles()) {
    final Status deletedStatus=deletedFile.getStatus();
    if (deletedStatus.getURL() != null && Comparing.equal(copyFromURL,deletedStatus.getURL().toString())) {
      final String clName=SvnUtil.getChangelistName(copiedFile.getStatus());
      applyMovedChange(context,copiedFile.getFilePath(),dirtyScope,deletedToDelete,deletedFile,copiedStatus,clName);
      for (      SvnChangedFile deletedChild : context.getDeletedFiles()) {
        final Status childStatus=deletedChild.getStatus();
        final SVNURL childUrl=childStatus.getURL();
        if (childUrl == null) {
          continue;
        }
        final String childURL=childUrl.toDecodedString();
        if (StringUtil.startsWithConcatenation(childURL,copyFromURL,"/")) {
          String relativePath=childURL.substring(copyFromURL.length());
          File newPath=new File(copiedFile.getFilePath().getIOFile(),relativePath);
          FilePath newFilePath=myFactory.createFilePathOn(newPath);
          if (!context.isDeleted(newFilePath)) {
            applyMovedChange(context,newFilePath,dirtyScope,deletedToDelete,deletedChild,context.getTreeConflictStatus(newPath),clName);
          }
        }
      }
      foundRename=true;
      break;
    }
  }
  final List<SvnChangedFile> deletedFiles=context.getDeletedFiles();
  for (  SvnChangedFile file : deletedToDelete) {
    deletedFiles.remove(file);
  }
  if (!foundRename && copiedStatus.getURL() != null) {
    File wcPath=guessWorkingCopyPath(copiedStatus.getFile(),copiedStatus.getURL(),copyFromURL);
    Status status;
    try {
      status=myVcs.getFactory(wcPath).createStatusClient().doStatus(wcPath,false);
    }
 catch (    SvnBindException ex) {
      LOG.info(ex);
      status=null;
    }
    if (status != null && status.is(StatusType.STATUS_DELETED)) {
      final FilePath filePath=myFactory.createFilePathOnDeleted(wcPath,false);
      final SvnContentRevision beforeRevision=SvnContentRevision.createBaseRevision(myVcs,filePath,status.getRevision());
      final ContentRevision afterRevision=CurrentContentRevision.create(copiedFile.getFilePath());
      context.getBuilder().processChangeInList(context.createMovedChange(beforeRevision,afterRevision,copiedStatus,status),SvnUtil.getChangelistName(status),SvnVcs.getKey());
      foundRename=true;
    }
  }
  if (!foundRename) {
    LOG.info("Rename not found for " + copiedFile.getFilePath().getPresentableUrl());
    context.processStatus(copiedFile.getFilePath(),copiedStatus);
  }
}
