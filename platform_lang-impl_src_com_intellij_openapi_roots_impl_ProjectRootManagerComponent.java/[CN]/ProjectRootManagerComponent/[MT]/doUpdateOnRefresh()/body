{
  if (ApplicationManager.getApplication().isUnitTestMode() && (!myStartupActivityPerformed || myProject.isDisposed())) {
    return;
  }
  if (myProject.isDefault()) {
    return;
  }
  if (ApplicationManager.getApplication().isInternal())   LOG.info(new Throwable("refresh"));
  DumbServiceImpl dumbService=DumbServiceImpl.getInstance(myProject);
  DumbModeTask task=FileBasedIndexProjectHandler.createChangedFilesIndexingTask(myProject);
  if (task != null) {
    dumbService.queueTask(task);
  }
  if (myRefreshCacheUpdaters.size() == 0) {
    return;
  }
  if (ourScheduleCacheUpdateInDumbMode) {
    dumbService.queueCacheUpdateInDumbMode(myRefreshCacheUpdaters);
  }
 else {
    dumbService.queueCacheUpdate(myRefreshCacheUpdaters);
  }
}
