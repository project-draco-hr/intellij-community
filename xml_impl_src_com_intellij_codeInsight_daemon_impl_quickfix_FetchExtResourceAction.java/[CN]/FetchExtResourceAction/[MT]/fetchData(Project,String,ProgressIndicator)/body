{
  try {
    HttpRequests.request(dtdUrl).accept("text/xml,application/xml,text/html,*/*").connect(new HttpRequests.RequestProcessor<FetchResult>(){
      @Override public FetchResult process(      @NotNull HttpRequests.Request request) throws IOException {
        FetchResult result=new FetchResult();
        result.bytes=request.readBytes(indicator);
        result.contentType=request.getConnection().getContentType();
        return result;
      }
    }
);
  }
 catch (  MalformedURLException e) {
    if (!ApplicationManager.getApplication().isUnitTestMode()) {
      ApplicationManager.getApplication().invokeLater(new Runnable(){
        @Override public void run(){
          Messages.showMessageDialog(project,XmlBundle.message("invalid.url.message",dtdUrl),XmlBundle.message("invalid.url.title"),Messages.getErrorIcon());
        }
      }
,indicator.getModalityState());
    }
  }
  return null;
}
