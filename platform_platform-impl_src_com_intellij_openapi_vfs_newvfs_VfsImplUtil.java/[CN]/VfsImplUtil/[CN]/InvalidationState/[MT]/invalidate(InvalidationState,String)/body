{
  Pair<ArchiveFileSystem,ArchiveHandler> handlerPair=ourHandlers.remove(path);
  if (handlerPair != null) {
    handlerPair.second.dispose();
    forEachDirectoryComponent(path,new Consumer<String>(){
      @Override public void consume(      String containingDirectoryPath){
        Set<String> handlers=ourDominatorsMap.get(containingDirectoryPath);
        if (handlers != null && handlers.remove(path) && handlers.isEmpty()) {
          ourDominatorsMap.remove(containingDirectoryPath);
        }
      }
    }
);
    if (state == null)     state=new InvalidationState();
    state.registerPathToRefresh(path,handlerPair.first);
  }
  return state;
}
