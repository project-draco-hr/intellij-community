{
  boolean needToResetSearchFocus=mySearchTextComponent.hasFocus();
  boolean needToResetReplaceFocus=myReplaceTextComponent.hasFocus();
  updateSearchComponent();
  updateReplaceComponent();
  if (myFindModel.isReplaceState()) {
    if (myReplaceFieldWrapper.getParent() == null) {
      myLeftPanel.add(myReplaceFieldWrapper,BorderLayout.CENTER);
    }
    if (myReplaceToolbarWrapper.getParent() == null) {
      myRightPanel.add(myReplaceToolbarWrapper,BorderLayout.CENTER);
    }
    if (needToResetReplaceFocus) {
      myReplaceTextComponent.requestFocusInWindow();
    }
  }
 else {
    if (myReplaceFieldWrapper.getParent() != null) {
      myLeftPanel.remove(myReplaceFieldWrapper);
    }
    if (myReplaceToolbarWrapper.getParent() != null) {
      myRightPanel.remove(myReplaceToolbarWrapper);
    }
  }
  if (needToResetSearchFocus)   mySearchTextComponent.requestFocusInWindow();
  mySearchActionsToolbar1.updateActionsImmediately();
  mySearchActionsToolbar2.updateActionsImmediately();
  myReplaceActionsToolbar1.updateActionsImmediately();
  myReplaceActionsToolbar2.updateActionsImmediately();
  myReplaceToolbarWrapper.revalidate();
  revalidate();
  repaint();
  myLivePreviewController.setTrackingSelection(!myFindModel.isGlobal());
}
