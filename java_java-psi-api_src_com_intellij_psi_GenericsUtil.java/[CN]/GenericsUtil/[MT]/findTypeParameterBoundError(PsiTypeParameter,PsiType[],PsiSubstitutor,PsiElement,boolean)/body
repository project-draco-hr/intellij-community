{
  PsiType substituted=substitutor.substitute(typeParameter);
  if (substituted == null)   return null;
  if (context != null) {
    substituted=PsiUtil.captureToplevelWildcards(substituted,context);
  }
  if (substituted instanceof PsiWildcardType) {
    if (((PsiWildcardType)substituted).isSuper()) {
      return null;
    }
  }
  for (  PsiType type : extendsTypes) {
    PsiType extendsType=substitutor.substitute(type);
    if (substituted instanceof PsiWildcardType) {
      final PsiType extendsBound=((PsiWildcardType)substituted).getExtendsBound();
      if (acceptExtendsBound(extendsType,extendsBound)) {
        return null;
      }
    }
 else     if (substituted instanceof PsiIntersectionType) {
      for (      PsiType extendsBound : ((PsiIntersectionType)substituted).getConjuncts()) {
        if (acceptExtendsBound(extendsType,extendsBound))         return null;
      }
    }
 else     if (substituted instanceof PsiCapturedWildcardType) {
      final PsiType extendsBound=((PsiCapturedWildcardType)substituted).getUpperBound();
      if (acceptExtendsBound(extendsType,extendsBound) || extendsType.equals(extendsBound)) {
        return null;
      }
    }
    if (extendsType != null && !TypeConversionUtil.isAssignable(extendsType,substituted,allowUncheckedConversion)) {
      return extendsType;
    }
  }
  return null;
}
