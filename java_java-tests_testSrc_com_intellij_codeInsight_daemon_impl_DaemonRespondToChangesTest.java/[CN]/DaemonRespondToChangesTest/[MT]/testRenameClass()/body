{
  configureByFile(BASE_PATH + "AClass.java");
  Document document=getDocument(getFile());
  Collection<HighlightInfo> infos=highlightErrors();
  assertEquals(0,infos.size());
  final PsiClass psiClass=((PsiJavaFile)getFile()).getClasses()[0];
  new RenameProcessor(myProject,psiClass,"Class2",false,false).run();
  TextRange dirty=myDaemonCodeAnalyzer.getFileStatusMap().getFileDirtyScope(document,Pass.UPDATE_ALL);
  assertEquals(getFile().getTextRange(),dirty);
  highlightErrors();
  assertTrue(myDaemonCodeAnalyzer.isErrorAnalyzingFinished(getFile()));
}
