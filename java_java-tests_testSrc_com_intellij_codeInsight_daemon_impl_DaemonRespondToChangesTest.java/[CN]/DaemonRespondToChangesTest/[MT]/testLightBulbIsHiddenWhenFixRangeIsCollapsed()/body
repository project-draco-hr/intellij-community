{
  configureByText(StdFileTypes.JAVA,"class S { void foo() { boolean var; if (<selection>va<caret>r</selection>) {}} }");
  ((EditorImpl)myEditor).getScrollPane().getViewport().setSize(1000,1000);
  final Set<LightweightHint> visibleHints=ContainerUtil.newIdentityTroveSet();
  getProject().getMessageBus().connect(myTestRootDisposable).subscribe(EditorHintListener.TOPIC,new EditorHintListener(){
    @Override public void hintShown(    final Project project,    final LightweightHint hint,    final int flags){
      visibleHints.add(hint);
      hint.addHintListener(new HintListener(){
        @Override public void hintHidden(        EventObject event){
          visibleHints.remove(hint);
          hint.removeHintListener(this);
        }
      }
);
    }
  }
);
  highlightErrors();
  IntentionHintComponent lastHintBeforeDeletion=myDaemonCodeAnalyzer.getLastIntentionHint();
  assertNotNull(lastHintBeforeDeletion);
  delete(myEditor);
  highlightErrors();
  IntentionHintComponent lastHintAfterDeletion=myDaemonCodeAnalyzer.getLastIntentionHint();
  assertSame(lastHintBeforeDeletion,lastHintAfterDeletion);
  assertEmpty(visibleHints);
}
