{
  LayoutDirectoryDialog dialog=new LayoutDirectoryDialog(project,CodeInsightBundle.message("process.reformat.code"),CodeInsightBundle.message("process.scope.directory",dir.getVirtualFile().getPath()),FormatChangedTextUtil.hasChanges(dir));
  boolean enableIncludeDirectoriesCb=dir.getSubdirectories().length > 0;
  dialog.setEnabledIncludeSubdirsCb(enableIncludeDirectoriesCb);
  dialog.setSelectedIncludeSubdirsCb(enableIncludeDirectoriesCb);
  dialog.show();
  if (dialog.isOK()) {
    return dialog;
  }
  return null;
}
