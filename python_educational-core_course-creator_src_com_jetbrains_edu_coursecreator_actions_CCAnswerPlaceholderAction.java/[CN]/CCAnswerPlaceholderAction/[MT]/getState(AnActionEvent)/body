{
  final Project project=e.getProject();
  if (project == null || !CCUtils.isCourseCreator(project)) {
    return null;
  }
  final PsiFile psiFile=CommonDataKeys.PSI_FILE.getData(e.getDataContext());
  if (psiFile == null) {
    return null;
  }
  VirtualFile virtualFile=psiFile.getVirtualFile();
  if (virtualFile == null) {
    return null;
  }
  final Editor editor=CommonDataKeys.EDITOR.getData(e.getDataContext());
  if (editor == null) {
    return null;
  }
  TaskFile taskFile=StudyUtils.getTaskFile(project,virtualFile);
  if (taskFile == null) {
    return null;
  }
  AnswerPlaceholder answerPlaceholder=taskFile.getAnswerPlaceholder(editor.getDocument(),editor.getCaretModel().getLogicalPosition(),true);
  return new CCState(taskFile,answerPlaceholder,psiFile,editor,project);
}
