{
  final Sdk moduleSdk=ModuleRootManager.getInstance(module).getSdk();
  if (moduleSdk == null) {
    return null;
  }
  final Set<Sdk> sdksFromDependencies=new LinkedHashSet<Sdk>();
  OrderEnumerator enumerator=OrderEnumerator.orderEntries(module).runtimeOnly().recursively();
  if (productionOnly) {
    enumerator=enumerator.productionOnly();
  }
  enumerator.forEachModule(new Processor<Module>(){
    @Override public boolean process(    Module module){
      Sdk sdk=ModuleRootManager.getInstance(module).getSdk();
      if (sdk != null && sdk.getSdkType().equals(moduleSdk.getSdkType())) {
        sdksFromDependencies.add(sdk);
      }
      return true;
    }
  }
);
  return findLatestVersion(moduleSdk,sdksFromDependencies);
}
