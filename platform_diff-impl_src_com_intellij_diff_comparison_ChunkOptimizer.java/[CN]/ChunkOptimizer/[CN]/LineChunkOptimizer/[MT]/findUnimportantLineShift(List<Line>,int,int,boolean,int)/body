{
  for (int i=0; i < count; i++) {
    int index=leftToRight ? offset + i : offset - i;
    if (lines.get(index).getNonSpaceChars() <= threshold) {
      return i;
    }
  }
  return -1;
}
