{
  String suggestedName=changeLists[0].DESCRIPTION;
  final ChangeListManager changeListManager=ChangeListManager.getInstance(project);
  final ChangeListChooser chooser=new ChangeListChooser(project,changeListManager.getChangeListsCopy(),changeListManager.getDefaultChangeList(),VcsBundle.message("unshelve.changelist.chooser.title"),suggestedName){
    @Nullable @Override protected JComponent createSouthPanel(){
      return addDoNotShowCheckBox(ObjectUtils.assertNotNull(super.createSouthPanel()),createRemoveFilesStrategyCheckbox(project));
    }
  }
;
  if (!chooser.showAndGet())   return;
  final List<ShelvedBinaryFile> finalBinaryFiles=binaryFiles == null || binaryFiles.isEmpty() ? null : binaryFiles;
  final List<ShelvedChange> finalChanges=changes == null || changes.isEmpty() ? null : changes;
  final ShelveChangesManager shelveChangesManager=ShelveChangesManager.getInstance(project);
  ProgressManager.getInstance().run(new Task.Backgroundable(project,"Unshelve Changes",true){
    @Override public void run(    @NotNull ProgressIndicator indicator){
      for (      ShelvedChangeList changeList : changeLists) {
        shelveChangesManager.unshelveChangeList(changeList,finalChanges,finalBinaryFiles,chooser.getSelectedList(),true);
      }
    }
  }
);
}
