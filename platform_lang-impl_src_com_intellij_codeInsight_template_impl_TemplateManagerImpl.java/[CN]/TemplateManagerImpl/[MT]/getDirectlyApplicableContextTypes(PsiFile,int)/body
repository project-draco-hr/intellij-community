{
  LinkedHashSet<TemplateContextType> set=new LinkedHashSet<>();
  LinkedList<TemplateContextType> contexts=buildOrderedContextTypes();
  for (  TemplateContextType contextType : contexts) {
    if (contextType.isInContext(file,offset)) {
      set.add(contextType);
    }
  }
  removeBases:   while (true) {
    for (    TemplateContextType type : set) {
      if (set.removeAll(getBases(type))) {
        continue removeBases;
      }
    }
    return set;
  }
}
