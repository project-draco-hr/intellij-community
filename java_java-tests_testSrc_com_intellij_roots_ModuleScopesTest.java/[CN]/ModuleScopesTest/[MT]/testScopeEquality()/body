{
  Module module=createModule("a.iml",StdModuleTypes.JAVA);
  addDependentModule(module,DependencyScope.COMPILE);
  addLibrary(module,DependencyScope.COMPILE);
  GlobalSearchScope deps=module.getModuleWithDependentsScope();
  GlobalSearchScope depsTests=module.getModuleTestsWithDependentsScope();
  assertFalse(deps.equals(depsTests));
  assertFalse(depsTests.equals(deps));
  ((ModuleEx)module).clearScopesCache();
  GlobalSearchScope deps2=module.getModuleWithDependentsScope();
  GlobalSearchScope depsTests2=module.getModuleTestsWithDependentsScope();
  assertFalse(deps2.equals(depsTests2));
  assertFalse(depsTests2.equals(deps2));
  assertNotSame(deps,deps2);
  assertNotSame(depsTests,depsTests2);
  assertEquals(deps,deps2);
  assertEquals(depsTests,depsTests2);
}
