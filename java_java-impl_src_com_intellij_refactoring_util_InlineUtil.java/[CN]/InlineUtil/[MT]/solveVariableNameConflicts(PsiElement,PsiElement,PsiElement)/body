{
  if (scope instanceof PsiVariable) {
    PsiVariable var=(PsiVariable)scope;
    String name=var.getName();
    String oldName=name;
    final JavaCodeStyleManager codeStyleManager=JavaCodeStyleManager.getInstance(scope.getProject());
    while (true) {
      String newName=codeStyleManager.suggestUniqueVariableName(name,placeToInsert,true);
      if (newName.equals(name))       break;
      name=newName;
      newName=codeStyleManager.suggestUniqueVariableName(name,var,true);
      if (newName.equals(name))       break;
      name=newName;
    }
    if (!name.equals(oldName)) {
      RefactoringUtil.renameVariableReferences(var,name,new LocalSearchScope(renameScope),true);
      var.getNameIdentifier().replace(JavaPsiFacade.getElementFactory(scope.getProject()).createIdentifier(name));
    }
  }
  PsiElement[] children=scope.getChildren();
  for (  PsiElement child : children) {
    solveVariableNameConflicts(child,placeToInsert,renameScope);
  }
}
