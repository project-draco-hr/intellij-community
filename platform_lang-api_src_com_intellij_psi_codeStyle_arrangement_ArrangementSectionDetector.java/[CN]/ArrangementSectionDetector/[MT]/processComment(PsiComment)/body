{
  final TextRange range=comment.getTextRange();
  final TextRange expandedRange=myDocument == null ? range : ArrangementUtil.expandToLineIfPossible(range,myDocument);
  final TextRange sectionTextRange=new TextRange(expandedRange.getStartOffset(),expandedRange.getEndOffset());
  final String commentText=comment.getText().trim();
  final boolean start=isSectionStartComment(mySettings,commentText);
  if (start) {
    mySectionEntryProducer.consume(new ArrangementSectionEntryTemplate(comment,START_SECTION,sectionTextRange,commentText));
    myCurrentSection=commentText;
  }
 else   if (myCurrentSection != null && isSectionEndComment(mySettings,commentText)) {
    mySectionEntryProducer.consume(new ArrangementSectionEntryTemplate(comment,END_SECTION,sectionTextRange,commentText));
    myCurrentSection=null;
  }
}
