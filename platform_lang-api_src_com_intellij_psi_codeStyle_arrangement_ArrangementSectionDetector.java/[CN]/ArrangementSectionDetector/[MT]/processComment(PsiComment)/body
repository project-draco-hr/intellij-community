{
  final TextRange range=comment.getTextRange();
  final TextRange expandedRange=myDocument == null ? range : ArrangementUtil.expandToLineIfPossible(range,myDocument);
  final int startOffset=expandedRange.getStartOffset();
  final int endOffset=expandedRange.getEndOffset();
  final String commentText=comment.getText().trim();
  final boolean start=isSectionStartComment(mySettings,commentText);
  if (start) {
    mySectionEntryProducer.consume(new ArrangementSectionEntryTemplate(comment,START_SECTION,startOffset,endOffset,commentText));
    myCurrentSection=commentText;
  }
 else   if (myCurrentSection != null && isSectionEndComment(mySettings,commentText)) {
    mySectionEntryProducer.consume(new ArrangementSectionEntryTemplate(comment,END_SECTION,startOffset,endOffset,commentText));
    myCurrentSection=null;
  }
}
