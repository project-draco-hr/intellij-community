{
  if (refElement instanceof PsiMethod) {
    PsiMethod refMethod=(PsiMethod)refElement;
    PsiClass refMethodClass=refMethod.getContainingClass();
    if (refMethodClass == null)     return true;
    if (!refMethod.hasModifierProperty(PsiModifier.STATIC)) {
      PsiSubstitutor substitutor=TypeConversionUtil.getClassSubstitutor(myContainingClass,refMethodClass,PsiSubstitutor.EMPTY);
      if (substitutor != null) {
        MethodSignature superSignature=method.getSignature(substitutor);
        MethodSignature refSignature=refMethod.getSignature(PsiSubstitutor.EMPTY);
        if (MethodSignatureUtil.isSubsignature(superSignature,refSignature)) {
          if (!consumer.process(ref))           return false;
        }
      }
    }
    if (!myStrictSignatureSearch) {
      PsiManager manager=method.getManager();
      if (manager.areElementsEquivalent(refMethodClass,myContainingClass)) {
        if (!consumer.process(ref))         return false;
      }
    }
  }
  return true;
}
