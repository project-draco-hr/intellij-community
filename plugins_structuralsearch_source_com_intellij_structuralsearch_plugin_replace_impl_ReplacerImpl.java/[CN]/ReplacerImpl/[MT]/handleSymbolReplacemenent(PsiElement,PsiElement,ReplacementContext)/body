{
  if (replacement instanceof PsiReferenceExpression && ((PsiReferenceExpression)replacement).getQualifierExpression() == null) {
    final PsiStatement[] searchStatements=context.getCodeBlock().getStatements();
    if (searchStatements.length > 0 && searchStatements[0] instanceof PsiExpressionStatement) {
      final PsiExpression expression=((PsiExpressionStatement)searchStatements[0]).getExpression();
      if (expression instanceof PsiReferenceExpression && ((PsiReferenceExpression)expression).getQualifierExpression() == null) {
        if (el instanceof PsiNamedElement) {
          PsiElement oldReplacement=replacement;
          replacement=el.copy();
          ((PsiNamedElement)replacement).setName(oldReplacement.getText());
        }
      }
    }
  }
  return replacement;
}
