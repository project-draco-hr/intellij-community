{
  if (!file.getViewProvider().supportsIncrementalReparse(file.getLanguage())) {
    return new TextRange(0,newDocumentText.length());
  }
  int commonPrefixLength=StringUtil.commonPrefixLength(oldPsiText,newDocumentText);
  if (commonPrefixLength == newDocumentText.length() && newDocumentText.length() == oldPsiText.length()) {
    return new TextRange(0,newDocumentText.length());
  }
  int commonSuffixLength=StringUtil.commonSuffixLength(oldPsiText,newDocumentText);
  return new TextRange(commonPrefixLength,Math.max(commonPrefixLength,oldPsiText.length() - commonSuffixLength));
}
