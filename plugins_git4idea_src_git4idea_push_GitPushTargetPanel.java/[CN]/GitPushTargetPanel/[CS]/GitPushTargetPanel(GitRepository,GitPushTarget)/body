{
  myRepository=repository;
  myCurrentTarget=defaultTarget;
  String initialBranch="";
  String initialRemote="";
  if (defaultTarget == null) {
    if (repository.getCurrentBranch() == null) {
      myError="Detached HEAD";
    }
 else     if (repository.getRemotes().isEmpty()) {
      myError="No remotes";
    }
 else     if (repository.isFresh()) {
      myError="Empty repository";
    }
 else {
      myError="Can't push";
    }
  }
 else {
    initialBranch=getTextFieldText(defaultTarget);
    initialRemote=defaultTarget.getBranch().getRemote().getName();
  }
  myEditRemoteControl=new ExtraEditControl(){
    @Override public void click(    @NotNull MouseEvent event){
      showRemoteSelector(event);
    }
  }
;
  myTargetTextField=new PushTargetTextField(repository.getProject(),getTargetNames(myRepository),initialBranch);
  myRemoteLabel=new JBLabel(initialRemote);
  setLayout(new BorderLayout());
  setOpaque(false);
  JPanel remoteAndSeparator=new JPanel(new BorderLayout());
  remoteAndSeparator.setOpaque(false);
  remoteAndSeparator.add(myRemoteLabel,BorderLayout.CENTER);
  remoteAndSeparator.add(new JBLabel(SEPARATOR),BorderLayout.EAST);
  add(remoteAndSeparator,BorderLayout.WEST);
  add(myTargetTextField,BorderLayout.CENTER);
  updateTextField();
}
