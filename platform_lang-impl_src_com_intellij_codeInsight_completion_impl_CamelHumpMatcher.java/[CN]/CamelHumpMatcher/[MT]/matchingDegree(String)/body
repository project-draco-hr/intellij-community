{
  FList<TextRange> ranges=myCaseInsensitiveMatcher.matchingFragments(string);
  if (ranges != null && !ranges.isEmpty()) {
    int matchStart=ranges.get(0).getStartOffset();
    int underscoreEnd=skipUnderscores(string);
    if (matchStart > 0 && matchStart <= underscoreEnd) {
      return myCaseInsensitiveMatcher.matchingDegree(string.substring(matchStart)) - 1;
    }
  }
  return myMatcher.matchingDegree(string);
}
