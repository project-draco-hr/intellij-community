{
  final List<PsiPackage> packages=getCurrentSuitePackages();
  final List<PsiClass> classes=getCurrentSuiteClasses();
  if (!packages.isEmpty() || !classes.isEmpty()) {
    myAlarm.addRequest(new Runnable(){
      public void run(){
        if (myProject.isDisposed())         return;
        for (        PsiPackage aPackage : packages) {
          new PackageAnnotator(aPackage).annotate((CoverageSuiteImpl)suite,new PackageAnnotator.Annotator(){
            public void annotatePackage(            String packageQualifiedName,            PackageCoverageInfo packageCoverageInfo){
              myPackageCoverageInfos.put(packageQualifiedName,packageCoverageInfo);
            }
            public void annotateSourceDirectory(            String packageQualifiedName,            PackageCoverageInfo dirCoverageInfo,            Module module){
              final Pair<String,Module> p=new Pair<String,Module>(packageQualifiedName,module);
              myDirCoverageInfos.put(p,dirCoverageInfo);
            }
            public void annotateTestDirectory(            String packageQualifiedName,            PackageCoverageInfo packageCoverageInfo,            Module module){
              final Pair<String,Module> p=new Pair<String,Module>(packageQualifiedName,module);
              myTestDirCoverageInfos.put(p,packageCoverageInfo);
            }
            public void annotateClass(            String classQualifiedName,            ClassCoverageInfo classCoverageInfo){
              myClassCoverageInfos.put(classQualifiedName,classCoverageInfo);
            }
          }
);
        }
        triggerPresentationUpdate();
      }
    }
,100);
  }
}
