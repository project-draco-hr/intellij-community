{
  myEditorFactoryListener=new EditorFactoryListener(){
    public void editorCreated(    EditorFactoryEvent event){
      final Editor editor=event.getEditor();
      if (editor.getProject() != null && editor.getProject() != myProject)       return;
      ApplicationManager.getApplication().invokeLater(new Runnable(){
        public void run(){
          if (myProject.isDisposed())           return;
          applyInformationToEditor(editor);
        }
      }
);
    }
    public void editorReleased(    EditorFactoryEvent event){
      final Editor editor=event.getEditor();
      if (editor.getProject() != null && editor.getProject() != myProject)       return;
      final SrcFileAnnotator fileAnnotator=myAnnotators.remove(editor);
      if (fileAnnotator != null) {
        Disposer.dispose(fileAnnotator);
      }
    }
  }
;
  EditorFactory.getInstance().addEditorFactoryListener(myEditorFactoryListener);
  myProjectManagerListener=new ProjectManagerAdapter(){
    public void projectClosing(    Project project){
synchronized (myLock) {
        if (project.equals(myProject)) {
          myIsProjectClosing=true;
        }
      }
    }
  }
;
  ProjectManager.getInstance().addProjectManagerListener(myProjectManagerListener);
  Disposer.register(myProject,new Disposable(){
    public void dispose(){
      EditorFactory.getInstance().removeEditorFactoryListener(myEditorFactoryListener);
      ProjectManager.getInstance().removeProjectManagerListener(myProjectManagerListener);
    }
  }
);
}
