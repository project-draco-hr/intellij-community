{
  final List<LookupElement> result=new ArrayList<LookupElement>();
  PyFile containingFile=(PyFile)getElement().getContainingFile().getOriginalFile();
  final List<String> dunderAll=containingFile.getDunderAll();
  containingFile.processDeclarations(new PsiScopeProcessor(){
    @Override public boolean execute(    PsiElement element,    ResolveState state){
      if (element instanceof PsiNamedElement && !(element instanceof LightNamedElement)) {
        final String name=((PsiNamedElement)element).getName();
        if (name != null && PyUtil.getInitialUnderscores(name) == 0 && (dunderAll == null || !dunderAll.contains(name))) {
          result.add(LookupElementBuilder.create((PsiNamedElement)element).setIcon(element.getIcon(Iconable.ICON_FLAG_CLOSED)));
        }
      }
 else       if (element instanceof PyImportElement) {
        final String visibleName=((PyImportElement)element).getVisibleName();
        if (visibleName != null && (dunderAll == null || !dunderAll.contains(visibleName))) {
          result.add(LookupElementBuilder.create(element,visibleName));
        }
      }
      return true;
    }
    @Override public <T>T getHint(    Key<T> hintKey){
      return null;
    }
    @Override public void handleEvent(    Event event,    @Nullable Object associated){
    }
  }
,ResolveState.initial(),null,containingFile);
  return ArrayUtil.toObjectArray(result);
}
