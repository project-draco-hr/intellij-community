{
  MethodAccess type=MethodAccess.NORMAL;
  if (method.root != null) {
    DirectGraph graph=method.getOrBuildGraph();
    StructMethod mt=method.methodStruct;
    if ((noSynthFlag || mt.isSynthetic()) && mt.hasModifier(CodeConstants.ACC_STATIC)) {
      if (graph.nodes.size() == 2) {
        if (graph.first.exprents.size() == 1) {
          Exprent exprent=graph.first.exprents.get(0);
          MethodDescriptor mtdesc=MethodDescriptor.parseDescriptor(mt.getDescriptor());
          int parcount=mtdesc.params.length;
          Exprent exprCore=exprent;
          if (exprent.type == Exprent.EXPRENT_EXIT) {
            ExitExprent exexpr=(ExitExprent)exprent;
            if (exexpr.getExitType() == ExitExprent.EXIT_RETURN && exexpr.getValue() != null) {
              exprCore=exexpr.getValue();
            }
          }
switch (exprCore.type) {
case Exprent.EXPRENT_FIELD:
            FieldExprent fexpr=(FieldExprent)exprCore;
          if ((parcount == 1 && !fexpr.isStatic()) || (parcount == 0 && fexpr.isStatic())) {
            if (fexpr.getClassname().equals(node.classStruct.qualifiedName)) {
              if (fexpr.isStatic() || (fexpr.getInstance().type == Exprent.EXPRENT_VAR && ((VarExprent)fexpr.getInstance()).getIndex() == 0)) {
                type=MethodAccess.FIELD_GET;
              }
            }
          }
        break;
case Exprent.EXPRENT_VAR:
      if (parcount == 1) {
        if (((VarExprent)exprCore).getIndex() != 0) {
          type=MethodAccess.FIELD_GET;
        }
      }
    break;
case Exprent.EXPRENT_FUNCTION:
  FunctionExprent functionExprent=(FunctionExprent)exprCore;
if (functionExprent.getFuncType() >= FunctionExprent.FUNCTION_IMM && functionExprent.getFuncType() <= FunctionExprent.FUNCTION_PPI) {
  if (functionExprent.getLstOperands().get(0).type == Exprent.EXPRENT_FIELD) {
    type=MethodAccess.FUNCTION;
  }
}
break;
case Exprent.EXPRENT_INVOCATION:
type=MethodAccess.METHOD;
break;
case Exprent.EXPRENT_ASSIGNMENT:
AssignmentExprent asexpr=(AssignmentExprent)exprCore;
if (asexpr.getLeft().type == Exprent.EXPRENT_FIELD && asexpr.getRight().type == Exprent.EXPRENT_VAR) {
FieldExprent fexpras=(FieldExprent)asexpr.getLeft();
if ((parcount == 2 && !fexpras.isStatic()) || (parcount == 1 && fexpras.isStatic())) {
if (fexpras.getClassname().equals(node.classStruct.qualifiedName)) {
if (fexpras.isStatic() || (fexpras.getInstance().type == Exprent.EXPRENT_VAR && ((VarExprent)fexpras.getInstance()).getIndex() == 0)) {
if (((VarExprent)asexpr.getRight()).getIndex() == parcount - 1) {
type=MethodAccess.FIELD_SET;
}
}
}
}
}
}
if (type == MethodAccess.METHOD) {
type=MethodAccess.NORMAL;
InvocationExprent invexpr=(InvocationExprent)exprCore;
if ((invexpr.isStatic() && invexpr.getLstParameters().size() == parcount) || (!invexpr.isStatic() && invexpr.getInstance().type == Exprent.EXPRENT_VAR && ((VarExprent)invexpr.getInstance()).getIndex() == 0 && invexpr.getLstParameters().size() == parcount - 1)) {
boolean equalpars=true;
for (int i=0; i < invexpr.getLstParameters().size(); i++) {
Exprent parexpr=invexpr.getLstParameters().get(i);
if (parexpr.type != Exprent.EXPRENT_VAR || ((VarExprent)parexpr).getIndex() != i + (invexpr.isStatic() ? 0 : 1)) {
equalpars=false;
break;
}
}
if (equalpars) {
type=MethodAccess.METHOD;
}
}
}
}
 else if (graph.first.exprents.size() == 2) {
Exprent exprentFirst=graph.first.exprents.get(0);
Exprent exprentSecond=graph.first.exprents.get(1);
if (exprentFirst.type == Exprent.EXPRENT_ASSIGNMENT && exprentSecond.type == Exprent.EXPRENT_EXIT) {
MethodDescriptor mtdesc=MethodDescriptor.parseDescriptor(mt.getDescriptor());
int parcount=mtdesc.params.length;
AssignmentExprent asexpr=(AssignmentExprent)exprentFirst;
if (asexpr.getLeft().type == Exprent.EXPRENT_FIELD && asexpr.getRight().type == Exprent.EXPRENT_VAR) {
FieldExprent fexpras=(FieldExprent)asexpr.getLeft();
if ((parcount == 2 && !fexpras.isStatic()) || (parcount == 1 && fexpras.isStatic())) {
if (fexpras.getClassname().equals(node.classStruct.qualifiedName)) {
if (fexpras.isStatic() || (fexpras.getInstance().type == Exprent.EXPRENT_VAR && ((VarExprent)fexpras.getInstance()).getIndex() == 0)) {
if (((VarExprent)asexpr.getRight()).getIndex() == parcount - 1) {
ExitExprent exexpr=(ExitExprent)exprentSecond;
if (exexpr.getExitType() == ExitExprent.EXIT_RETURN && exexpr.getValue() != null) {
if (exexpr.getValue().type == Exprent.EXPRENT_VAR && ((VarExprent)asexpr.getRight()).getIndex() == parcount - 1) {
  type=MethodAccess.FIELD_SET;
}
}
}
}
}
}
}
}
}
}
}
}
if (type != MethodAccess.NORMAL) {
mapMethodType.put(method,type);
}
 else {
mapMethodType.remove(method);
}
}
