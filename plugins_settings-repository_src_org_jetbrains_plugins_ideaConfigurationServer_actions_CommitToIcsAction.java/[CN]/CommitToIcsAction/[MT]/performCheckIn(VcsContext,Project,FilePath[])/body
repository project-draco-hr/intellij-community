{
  ProjectId projectId=ServiceManager.getService(project,ProjectId.class);
  if (projectId.uid == null) {
  }
  List<Change> projectFileChanges=null;
  Change[] changes=context.getSelectedChanges();
  if (changes != null && changes.length > 0) {
    for (    Change change : changes) {
      if (isProjectConfigFile(change.getVirtualFile(),project)) {
        if (projectFileChanges == null) {
          projectFileChanges=new SmartList<Change>();
        }
        projectFileChanges.add(change);
      }
    }
  }
 else {
    ChangeListManager manager=ChangeListManager.getInstance(project);
    FilePath[] paths=getRoots(context);
    for (    FilePath path : paths) {
      if (isProjectConfigFile(path.getVirtualFile(),project)) {
        for (        Change change : manager.getChangesIn(path)) {
          if (projectFileChanges == null) {
            projectFileChanges=new SmartList<Change>();
          }
          projectFileChanges.add(change);
        }
      }
    }
  }
  if (projectFileChanges == null) {
    return;
  }
  new CommitToIcsDialog(project,projectFileChanges).show();
}
