{
  File propFile=FileUtil.findFirstThatExist(System.getProperty(PROPERTIES_FILE),getUserHome() + "/idea.properties",getHomePath() + "/bin/idea.properties",getHomePath() + "/community/bin/idea.properties");
  if (propFile != null) {
    try {
      Reader fis=new BufferedReader(new FileReader(propFile));
      try {
        Map<String,String> properties=FileUtil.loadProperties(fis);
        String home=properties.get("idea.home");
        if (home != null && ourHomePath == null) {
          ourHomePath=getAbsolutePath(substituteVars(home));
        }
        Properties sysProperties=System.getProperties();
        for (        String key : properties.keySet()) {
          if (sysProperties.getProperty(key,null) == null) {
            String value=substituteVars(properties.get(key));
            sysProperties.setProperty(key,value);
          }
        }
      }
  finally {
        fis.close();
      }
    }
 catch (    IOException e) {
      System.err.println("Problem reading from property file: " + propFile.getPath());
    }
  }
}
