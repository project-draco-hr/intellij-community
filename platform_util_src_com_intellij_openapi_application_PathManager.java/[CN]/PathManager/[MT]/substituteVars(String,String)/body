{
  if (s == null)   return null;
  if (s.startsWith("..")) {
    s=ideaHomePath + File.separatorChar + BIN_FOLDER+ File.separatorChar+ s;
  }
  Matcher m=PROPERTY_REF.matcher(s);
  while (m.find()) {
    String key=m.group(1);
    String value=System.getProperty(key);
    if (value == null) {
      if (PROPERTY_HOME_PATH.equals(key) || PROPERTY_HOME.equals(key)) {
        value=ideaHomePath;
      }
 else       if (PROPERTY_CONFIG_PATH.equals(key)) {
        value=getConfigPath();
      }
 else       if (PROPERTY_SYSTEM_PATH.equals(key)) {
        value=getSystemPath();
      }
    }
    if (value == null) {
      System.err.println("Unknown property: " + key);
      value="";
    }
    s=StringUtil.replace(s,m.group(),value);
    m=PROPERTY_REF.matcher(s);
  }
  return s;
}
