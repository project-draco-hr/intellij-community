{
  Queue<ExternalProject> queue=ContainerUtil.newLinkedList();
  queue.add(parentProject);
  while (!queue.isEmpty()) {
    final ExternalProject externalProject=queue.remove();
    final String projectId=externalProject.getQName();
    boolean isRelatedProject=projectId.equals(externalProjectId);
    final Map<String,ExternalSourceSet> result=ContainerUtil.newHashMap();
    for (    Map.Entry<String,ExternalSourceSet> sourceSetEntry : externalProject.getSourceSets().entrySet()) {
      final String sourceSetName=sourceSetEntry.getKey();
      final String sourceSetId=projectId + ":" + sourceSetName;
      if (isRelatedProject || externalProjectId.equals(sourceSetId)) {
        result.put(sourceSetName,sourceSetEntry.getValue());
      }
    }
    if (!result.isEmpty() || isRelatedProject)     return result;
    queue.addAll(externalProject.getChildProjects().values());
  }
  return Collections.emptyMap();
}
