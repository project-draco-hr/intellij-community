{
  XBreakpointType<B,?> type=XDebuggerUtil.getInstance().findBreakpointType(typeCls);
  VirtualFile file=FileDocumentManager.getInstance().getFile(document);
  AccessToken token=WriteAction.start();
  try {
    return XDebuggerManager.getInstance(myProject).getBreakpointManager().addLineBreakpoint((XLineBreakpointType)type,file.getUrl(),lineIndex,((XLineBreakpointType)type).createBreakpointProperties(file,lineIndex));
  }
  finally {
    token.finish();
  }
}
