{
  final XBreakpointType<B,?> type=XDebuggerUtil.getInstance().findBreakpointType(typeCls);
  final VirtualFile file=FileDocumentManager.getInstance().getFile(document);
  return ApplicationManager.getApplication().runWriteAction(new Computable<XLineBreakpoint>(){
    @Override public XLineBreakpoint compute(){
      return XDebuggerManager.getInstance(myProject).getBreakpointManager().addLineBreakpoint((XLineBreakpointType)type,file.getUrl(),lineIndex,((XLineBreakpointType)type).createBreakpointProperties(file,lineIndex));
    }
  }
);
}
