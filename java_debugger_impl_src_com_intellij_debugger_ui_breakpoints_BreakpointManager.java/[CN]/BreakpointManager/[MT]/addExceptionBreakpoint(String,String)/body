{
  ApplicationManager.getApplication().assertIsDispatchThread();
  JavaExceptionBreakpointType type=(JavaExceptionBreakpointType)XDebuggerUtil.getInstance().findBreakpointType(JavaExceptionBreakpointType.class);
  AccessToken token=WriteAction.start();
  try {
    XBreakpoint<JavaExceptionBreakpointProperties> xBreakpoint=XDebuggerManager.getInstance(myProject).getBreakpointManager().addBreakpoint(type,new JavaExceptionBreakpointProperties(exceptionClassName,packageName));
    ExceptionBreakpoint breakpoint=new ExceptionBreakpoint(myProject,exceptionClassName,packageName,xBreakpoint);
    addBreakpoint(breakpoint);
    if (LOG.isDebugEnabled()) {
      LOG.debug("ExceptionBreakpoint Added");
    }
    return breakpoint;
  }
  finally {
    token.finish();
  }
}
