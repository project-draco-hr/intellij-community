{
  myActive=null;
  if (descriptor instanceof RainbowAttributeDescriptor) {
    myActive=myRainbowPanel;
  }
 else   if (descriptor instanceof ColorAndFontDescription) {
    myActive=myColorAndFontPanel;
  }
  if (getComponentCount() == 0 || myActive != getComponent(0)) {
    boolean ignoreRepaint=getIgnoreRepaint();
    try {
      setIgnoreRepaint(true);
      if (getComponentCount() != 0) {
        remove(0);
      }
      setPreferredSize(null);
      add((JPanel)myActive);
    }
  finally {
      setIgnoreRepaint(ignoreRepaint);
      revalidate();
    }
  }
  myActive.reset(descriptor);
  updatePreviewPanel(descriptor);
}
