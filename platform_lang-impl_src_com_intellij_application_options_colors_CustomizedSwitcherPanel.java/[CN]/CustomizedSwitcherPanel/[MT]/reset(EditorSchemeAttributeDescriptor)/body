{
  myActive=null;
  if (descriptor instanceof RainbowAttributeDescriptor) {
    myActive=myRainbowPanel;
  }
 else   if (descriptor instanceof ColorAndFontDescription) {
    myActive=myColorAndFontPanel;
  }
  if (getComponentCount() == 0 || myActive != getComponent(0)) {
    final PaintLocker locker=new PaintLocker(this);
    try {
      if (getComponentCount() != 0) {
        remove(0);
      }
      setPreferredSize(null);
      add((JPanel)myActive);
    }
  finally {
      locker.release();
    }
  }
  myActive.reset(descriptor);
  updatePreviewPanel(descriptor);
}
