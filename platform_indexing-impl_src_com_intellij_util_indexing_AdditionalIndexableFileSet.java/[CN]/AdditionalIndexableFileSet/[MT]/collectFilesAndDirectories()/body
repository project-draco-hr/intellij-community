{
  THashSet<VirtualFile> files=new THashSet<VirtualFile>();
  THashSet<VirtualFile> directories=new THashSet<VirtualFile>();
  if (myExtensions == null) {
    myExtensions=Extensions.getExtensions(IndexedRootsProvider.EP_NAME);
  }
  for (  IndexedRootsProvider provider : myExtensions) {
    for (    VirtualFile root : IndexableSetContributor.getRootsToIndex(provider)) {
      if (root != null) {
        (root.isDirectory() ? directories : files).add(root);
      }
    }
    if (myProject != null) {
      Set<VirtualFile> projectRoots=IndexableSetContributor.getProjectRootsToIndex(provider,myProject);
      for (      VirtualFile root : projectRoots) {
        if (root != null) {
          (root.isDirectory() ? directories : files).add(root);
        }
      }
    }
  }
  cachedFiles=files;
  cachedDirectories=directories;
  return directories;
}
