{
  THashSet<VirtualFile> files=new THashSet<VirtualFile>();
  THashSet<VirtualFile> directories=new THashSet<VirtualFile>();
  if (myExtensions == null) {
    myExtensions=Extensions.getExtensions(IndexableSetContributor.EP_NAME);
  }
  for (  IndexableSetContributor contributor : myExtensions) {
    for (    VirtualFile root : IndexableSetContributor.getRootsToIndex(contributor)) {
      (root.isDirectory() ? directories : files).add(root);
    }
    if (myProject != null) {
      Set<VirtualFile> projectRoots=IndexableSetContributor.getProjectRootsToIndex(contributor,myProject);
      for (      VirtualFile root : projectRoots) {
        (root.isDirectory() ? directories : files).add(root);
      }
    }
  }
  cachedFiles=files;
  cachedDirectories=directories;
  return directories;
}
