{
  if (ref.hasAt())   return EnumSet.of(FIELD);
  if (ref.hasMemberPointer())   return EnumSet.of(METHOD);
  final EnumSet<GroovyResolveKind> result=EnumSet.allOf(GroovyResolveKind.class);
  if (!ResolveUtil.canBeClass(ref))   result.remove(CLASS);
  if (!ResolveUtil.canBePackage(ref))   result.remove(PACKAGE);
  if (ref.isQualified())   result.remove(BINDING);
  if (!(ref.getParent() instanceof GrMethodCall))   result.remove(METHOD);
  return result;
}
