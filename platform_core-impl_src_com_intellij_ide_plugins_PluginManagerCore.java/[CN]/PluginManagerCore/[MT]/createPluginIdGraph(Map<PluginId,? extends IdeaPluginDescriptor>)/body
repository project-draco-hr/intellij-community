{
  final List<PluginId> ids=new ArrayList<PluginId>(idToDescriptorMap.keySet());
  Collections.sort(ids,new Comparator<PluginId>(){
    @Override public int compare(    @NotNull PluginId o1,    @NotNull PluginId o2){
      return o2.getIdString().compareTo(o1.getIdString());
    }
  }
);
  return GraphGenerator.create(CachingSemiGraph.create(new GraphGenerator.SemiGraph<PluginId>(){
    @Override public Collection<PluginId> getNodes(){
      return ids;
    }
    @Override public Iterator<PluginId> getIn(    PluginId pluginId){
      final IdeaPluginDescriptor descriptor=idToDescriptorMap.get(pluginId);
      List<PluginId> plugins=new ArrayList<PluginId>();
      for (      PluginId dependentPluginId : descriptor.getDependentPluginIds()) {
        IdeaPluginDescriptor dep=idToDescriptorMap.get(dependentPluginId);
        if (dep != null) {
          PluginId realPluginId=dep.getPluginId();
          if (idToDescriptorMap.containsKey(realPluginId)) {
            plugins.add(realPluginId);
          }
        }
      }
      return plugins.iterator();
    }
  }
));
}
