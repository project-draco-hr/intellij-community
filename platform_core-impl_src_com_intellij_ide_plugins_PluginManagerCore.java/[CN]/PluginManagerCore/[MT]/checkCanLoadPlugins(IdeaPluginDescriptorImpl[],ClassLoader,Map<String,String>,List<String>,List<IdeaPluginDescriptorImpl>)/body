{
  for (  IdeaPluginDescriptorImpl descriptor : pluginDescriptors) {
    boolean shouldLoad=shouldLoadPlugin(descriptor,pluginDescriptors);
    if (shouldLoad) {
      if (isBrokenPlugin(descriptor)) {
        brokenPluginsList.add(descriptor.getName());
        shouldLoad=false;
      }
    }
    if (shouldLoad) {
      final List<String> modules=descriptor.getModules();
      if (modules != null) {
        for (        String module : modules) {
          if (!ourModulesToContainingPlugins.containsKey(module)) {
            ourModulesToContainingPlugins.put(module,descriptor);
          }
        }
      }
      result.add(descriptor);
    }
 else {
      descriptor.setEnabled(false);
      disabledPluginNames.put(descriptor.getPluginId().getIdString(),descriptor.getName());
      initClassLoader(parentLoader,descriptor);
    }
  }
}
