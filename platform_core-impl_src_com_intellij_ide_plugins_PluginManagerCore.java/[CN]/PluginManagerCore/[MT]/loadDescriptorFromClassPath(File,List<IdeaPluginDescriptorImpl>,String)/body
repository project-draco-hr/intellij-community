{
  IdeaPluginDescriptorImpl platformPluginDescriptor=null;
  if (platformPrefix != null) {
    platformPluginDescriptor=loadDescriptor(file,platformPrefix + "Plugin.xml");
    if (platformPluginDescriptor != null && !result.contains(platformPluginDescriptor)) {
      platformPluginDescriptor.setUseCoreClassLoader(true);
      result.add(platformPluginDescriptor);
    }
  }
  IdeaPluginDescriptorImpl pluginDescriptor=loadDescriptor(file,PLUGIN_XML);
  if (platformPrefix != null && pluginDescriptor != null && pluginDescriptor.getName().equals(SPECIAL_IDEA_PLUGIN)) {
    return pluginDescriptor;
  }
  if (pluginDescriptor != null && !result.contains(pluginDescriptor)) {
    if (platformPluginDescriptor != null) {
      pluginDescriptor.setUseCoreClassLoader(true);
    }
    result.add(pluginDescriptor);
    return pluginDescriptor;
  }
  return null;
}
