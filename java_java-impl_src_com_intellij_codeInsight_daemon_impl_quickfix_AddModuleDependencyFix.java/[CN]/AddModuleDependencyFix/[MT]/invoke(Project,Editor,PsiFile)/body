{
  if (myModules.size() == 1) {
    addDependencyOnModule(project,editor,ContainerUtil.getFirstItem(myModules));
  }
 else {
    final JBList list=new JBList(myModules);
    list.setCellRenderer(new ModuleListCellRenderer());
    final JBPopup popup=JBPopupFactory.getInstance().createListPopupBuilder(list).setTitle("Choose Module to Add Dependency on").setMovable(false).setResizable(false).setRequestFocus(true).setItemChoosenCallback(new Runnable(){
      @Override public void run(){
        final Object value=list.getSelectedValue();
        if (value instanceof Module) {
          addDependencyOnModule(project,editor,(Module)value);
        }
      }
    }
).createPopup();
    if (editor != null) {
      popup.showInBestPositionFor(editor);
    }
 else {
      popup.showCenteredInCurrentWindow(project);
    }
  }
}
