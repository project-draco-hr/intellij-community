{
  super(reference);
  myCurrentModule=currentModule;
  myRefVFile=refVFile;
  myClasses=classes;
  myModules=new LinkedHashSet<>();
  final PsiElement psiElement=reference.getElement();
  final Project project=psiElement.getProject();
  final JavaPsiFacade facade=JavaPsiFacade.getInstance(project);
  final ProjectFileIndex fileIndex=ProjectRootManager.getInstance(project).getFileIndex();
  final ModuleRootManager rootManager=ModuleRootManager.getInstance(currentModule);
  for (  PsiClass aClass : classes) {
    if (!facade.getResolveHelper().isAccessible(aClass,psiElement,aClass))     continue;
    PsiFile psiFile=aClass.getContainingFile();
    if (psiFile == null)     continue;
    VirtualFile virtualFile=psiFile.getVirtualFile();
    if (virtualFile == null)     continue;
    Module classModule=fileIndex.getModuleForFile(virtualFile);
    if (classModule != null && classModule != currentModule && !rootManager.isDependsOn(classModule)) {
      myModules.add(classModule);
    }
  }
}
