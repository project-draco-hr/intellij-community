{
  for (  Pair<String,String> pair : files2Create) {
    myFixture.addFileToProject(pair.first,pair.second);
  }
  myFixture.configureByFile("/refactoring/extractmethod/" + testPath);
  final RefactoringActionHandler handler=LanguageRefactoringSupport.INSTANCE.forLanguage(PythonLanguage.getInstance()).getExtractMethodHandler();
  try {
    System.setProperty(PyExtractMethodUtil.NAME,name);
    try {
      handler.invoke(myFixture.getProject(),myFixture.getEditor(),myFixture.getFile(),new FileDataContext(myFixture.getFile()));
    }
 catch (    Exception e) {
      assertEquals(result,e.getMessage());
      return;
    }
  }
  finally {
    System.clearProperty(PyExtractMethodUtil.NAME);
  }
  myFixture.checkResultByFile("/refactoring/extractmethod/" + result);
}
