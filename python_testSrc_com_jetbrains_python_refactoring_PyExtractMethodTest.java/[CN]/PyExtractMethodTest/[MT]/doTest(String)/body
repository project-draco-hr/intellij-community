{
  final String testName=getTestName(false);
  final String beforeName=testName + ".before.py";
  final String afterName=testName + ".after.py";
  final String dir="refactoring/extractmethod/";
  myFixture.configureByFile(dir + beforeName);
  final RefactoringSupportProvider provider=LanguageRefactoringSupport.INSTANCE.forLanguage(PythonLanguage.getInstance());
  assertNotNull(provider);
  final RefactoringActionHandler handler=provider.getExtractMethodHandler();
  assertNotNull(handler);
  final Editor editor=myFixture.getEditor();
  assertInstanceOf(editor,EditorEx.class);
  System.setProperty(PyExtractMethodUtil.NAME,newName);
  try {
    handler.invoke(myFixture.getProject(),editor,myFixture.getFile(),((EditorEx)editor).getDataContext());
  }
  finally {
    System.clearProperty(PyExtractMethodUtil.NAME);
  }
  myFixture.checkResultByFile(dir + afterName);
}
