{
  if (useProxy && PROXY_AUTHENTICATION) {
    String ntlmUserPassword=PROXY_LOGIN.replace('\\','/') + ":" + getPlainProxyPassword();
    provider.setCredentials(new AuthScope(PROXY_HOST,PROXY_PORT,AuthScope.ANY_REALM,AuthSchemes.NTLM),new NTCredentials(ntlmUserPassword));
    provider.setCredentials(new AuthScope(PROXY_HOST,PROXY_PORT),new UsernamePasswordCredentials(PROXY_LOGIN,getPlainProxyPassword()));
  }
  return provider;
}
