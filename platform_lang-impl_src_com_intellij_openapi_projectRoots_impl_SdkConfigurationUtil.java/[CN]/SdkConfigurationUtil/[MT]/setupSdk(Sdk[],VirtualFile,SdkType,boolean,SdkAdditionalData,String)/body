{
  final List<Sdk> sdksList=Arrays.asList(allSdks);
  final ProjectJdkImpl sdk;
  try {
    String sdkPath=sdkType.sdkPath(homeDir);
    final String sdkName=customSdkSuggestedName == null ? createUniqueSdkName(sdkType,sdkPath,sdksList) : createUniqueSdkName(customSdkSuggestedName,sdksList);
    sdk=new ProjectJdkImpl(sdkName,sdkType);
    if (additionalData != null) {
      sdk.setSdkAdditionalData(additionalData);
    }
    sdk.setHomePath(sdkPath);
    sdkType.setupSdkPaths(sdk);
  }
 catch (  Exception e) {
    if (!silent) {
      Messages.showErrorDialog("Error configuring SDK: " + e.getMessage() + ".\nPlease make sure that "+ FileUtil.toSystemDependentName(homeDir.getPath())+ " is a valid home path for this SDK type.","Error Configuring SDK");
    }
    return null;
  }
  return sdk;
}
