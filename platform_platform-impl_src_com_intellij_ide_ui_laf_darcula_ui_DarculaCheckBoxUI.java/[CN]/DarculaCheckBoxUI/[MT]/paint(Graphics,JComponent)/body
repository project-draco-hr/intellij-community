{
  Graphics2D g=(Graphics2D)g2d;
  JCheckBox b=(JCheckBox)c;
  final Dimension size=c.getSize();
  final Font font=c.getFont();
  g.setFont(font);
  FontMetrics fm=SwingUtilities2.getFontMetrics(c,g,font);
  Rectangle viewRect=new Rectangle(size);
  Rectangle iconRect=new Rectangle();
  Rectangle textRect=new Rectangle();
  JBInsets.removeFrom(viewRect,c.getInsets());
  String text=SwingUtilities.layoutCompoundLabel(c,fm,b.getText(),getDefaultIcon(),b.getVerticalAlignment(),b.getHorizontalAlignment(),b.getVerticalTextPosition(),b.getHorizontalTextPosition(),viewRect,iconRect,textRect,b.getIconTextGap());
  if (c.isOpaque()) {
    g.setColor(b.getBackground());
    g.fillRect(0,0,size.width,size.height);
  }
  final boolean selected=b.isSelected();
  final boolean enabled=b.isEnabled();
  drawCheckIcon(c,g,b,iconRect,selected,enabled);
  drawText(c,g,b,fm,textRect,text);
}
