{
  if (!mySettings.SHOW_VCS_ERROR_NOTIFICATIONS) {
    return;
  }
  Collection<VcsRootError> errors=scan();
  if (errors.isEmpty()) {
synchronized (NOTIFICATION_LOCK) {
      expireNotification();
    }
    return;
  }
  Collection<VcsRootError> importantUnregisteredRoots=getImportantUnregisteredMappings(errors);
  Collection<VcsRootError> invalidRoots=getInvalidRoots(errors);
  List<String> unregRootPaths=ContainerUtil.map(importantUnregisteredRoots,new Function<VcsRootError,String>(){
    @Override public String fun(    @NotNull VcsRootError error){
      return error.getMapping();
    }
  }
);
  if (invalidRoots.isEmpty() && (importantUnregisteredRoots.isEmpty() || myReportedUnregisteredRoots.containsAll(unregRootPaths))) {
    return;
  }
  myReportedUnregisteredRoots.addAll(unregRootPaths);
  String title=makeTitle(importantUnregisteredRoots,invalidRoots);
  String description=makeDescription(importantUnregisteredRoots,invalidRoots);
synchronized (NOTIFICATION_LOCK) {
    expireNotification();
    NotificationListener listener=new MyNotificationListener(myProject,mySettings,unregRootPaths);
    VcsNotifier notifier=VcsNotifier.getInstance(myProject);
    myNotification=invalidRoots.isEmpty() ? notifier.notifyMinorInfo(title,description,listener) : notifier.notifyError(title,description,listener);
  }
}
