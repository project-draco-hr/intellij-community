{
  XDebuggerTreeState.NodeInfo childInfo=parentInfo.removeChild(nodeName);
  if (childInfo != null) {
    boolean extendedPresentation=false;
    if (treeNode instanceof XValueNodeImpl) {
      XValuePresentation presentation=((XValueNodeImpl)treeNode).getValuePresentation();
      if (presentation instanceof XValueExtendedPresentation) {
        extendedPresentation=true;
        if (((XValueExtendedPresentation)presentation).isModified()) {
          treeNode.markChanged();
        }
      }
    }
    if (!extendedPresentation && !(Comparing.equal(childInfo.getValue(),treeNode.getRawValue()))) {
      treeNode.markChanged();
    }
    if (!myStopRestoringSelection && childInfo.isSelected()) {
      try {
        myInsideRestoring=true;
        myTree.addSelectionPath(treeNode.getPath());
      }
  finally {
        myInsideRestoring=false;
      }
    }
    restoreChildren((XDebuggerTreeNode)treeNode,childInfo);
  }
 else {
    treeNode.markChanged();
  }
}
