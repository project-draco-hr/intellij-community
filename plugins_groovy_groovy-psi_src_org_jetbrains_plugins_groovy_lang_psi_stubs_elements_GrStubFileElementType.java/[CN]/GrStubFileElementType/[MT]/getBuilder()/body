{
  return new DefaultStubBuilder(){
    @NotNull @Override protected StubElement createStubForFile(    @NotNull final PsiFile file){
      if (file instanceof GroovyFile) {
        return new GrFileStub((GroovyFile)file);
      }
      return super.createStubForFile(file);
    }
    @Override public boolean skipChildProcessingWhenBuildingStubs(    @NotNull ASTNode parent,    @NotNull ASTNode node){
      IElementType childType=node.getElementType();
      IElementType parentType=parent.getElementType();
      if (childType == GroovyElementTypes.PARAMETER && parentType != GroovyElementTypes.PARAMETERS_LIST) {
        return true;
      }
      if (childType == GroovyElementTypes.PARAMETERS_LIST && !(parent.getPsi() instanceof GrMethod)) {
        return true;
      }
      if (childType == GroovyElementTypes.MODIFIERS) {
        if (parentType == GroovyElementTypes.CLASS_INITIALIZER) {
          return true;
        }
        if (parentType == GroovyElementTypes.VARIABLE_DEFINITION && !GroovyElementTypes.VARIABLE_DEFINITION.shouldCreateStub(parent)) {
          return true;
        }
      }
      return false;
    }
  }
;
}
