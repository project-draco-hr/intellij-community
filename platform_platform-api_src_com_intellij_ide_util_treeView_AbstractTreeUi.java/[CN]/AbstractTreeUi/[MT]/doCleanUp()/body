{
  Runnable cleanup=new TreeRunnable("AbstractTreeUi.doCleanUp"){
    @Override public void perform(){
      if (canInitiateNewActivity()) {
        cleanUpNow();
      }
    }
  }
;
  if (isPassthroughMode()) {
    cleanup.run();
  }
 else {
    invokeLaterIfNeeded(false,cleanup);
  }
}
