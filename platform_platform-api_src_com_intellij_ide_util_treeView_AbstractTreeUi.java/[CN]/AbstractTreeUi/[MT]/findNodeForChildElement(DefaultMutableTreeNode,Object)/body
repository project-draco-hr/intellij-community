{
  Object anchor=TreeAnchorizer.getService().createAnchor(element);
  final Object value=myElementToNodeMap.get(anchor);
  TreeAnchorizer.getService().freeAnchor(anchor);
  if (value == null) {
    return null;
  }
  if (value instanceof DefaultMutableTreeNode) {
    final DefaultMutableTreeNode elementNode=(DefaultMutableTreeNode)value;
    return parentNode.equals(elementNode.getParent()) ? elementNode : null;
  }
  final List<DefaultMutableTreeNode> allNodesForElement=(List<DefaultMutableTreeNode>)value;
  for (  final DefaultMutableTreeNode elementNode : allNodesForElement) {
    if (parentNode.equals(elementNode.getParent())) {
      return elementNode;
    }
  }
  return null;
}
