{
  try {
    if (!canInitiateNewActivity()) {
      throw new ProcessCanceledException();
    }
    Promise<?> promise=runnable.run();
    if (!canInitiateNewActivity()) {
      throw new ProcessCanceledException();
    }
    return promise;
  }
 catch (  ProcessCanceledException e) {
    if (!isReleased()) {
      setCancelRequested(true);
      resetToReady();
    }
    throw e;
  }
}
