{
  ApplicationManager.getApplication().assertIsDispatchThread();
  int offset=editor.getCaretModel().getOffset();
  final PsiElement result=getInstance().findTargetElement(editor,flags,offset);
  if (result != null)   return result;
  int expectedCaretOffset=((EditorEx)editor).getExpectedCaretOffset();
  if (expectedCaretOffset != offset) {
    return getInstance().findTargetElement(editor,flags,expectedCaretOffset);
  }
  return null;
}
