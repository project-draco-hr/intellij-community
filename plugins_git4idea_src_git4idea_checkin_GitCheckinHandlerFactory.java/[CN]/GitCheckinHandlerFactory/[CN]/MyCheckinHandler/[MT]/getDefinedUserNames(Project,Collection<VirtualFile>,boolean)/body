{
  final Map<VirtualFile,Couple<String>> defined=ContainerUtil.newHashMap();
  ProgressManager.getInstance().run(new Task.Modal(project,"Checking Git user name...",false){
    @Override public void run(    @NotNull ProgressIndicator pi){
      for (      VirtualFile root : roots) {
        try {
          Couple<String> nameAndEmail=getUserNameAndEmailFromGitConfig(project,root);
          String name=nameAndEmail.getFirst();
          String email=nameAndEmail.getSecond();
          if (name != null && email != null) {
            defined.put(root,nameAndEmail);
            if (stopWhenFoundFirst) {
              return;
            }
          }
        }
 catch (        VcsException e) {
          LOG.error("Couldn't get user.name and user.email for root " + root,e);
        }
      }
    }
  }
);
  return defined;
}
