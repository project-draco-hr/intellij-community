{
  if (thumbBounds.isEmpty() || !scrollbar.isEnabled()) {
    return;
  }
  if (isMacOverlayScrollbar()) {
    paintMacThumb(g,thumbBounds);
  }
 else   if (Registry.is("ide.scroll.new.layout")) {
    Rectangle bounds=new Rectangle(thumbBounds);
    if (isThumbTranslucent()) {
      Alignment alignment=Alignment.get(scrollbar);
      if (alignment == Alignment.LEFT || alignment == Alignment.RIGHT) {
        int offset=getThumbOffset(bounds.width);
        if (offset > 0) {
          bounds.width-=offset;
          if (alignment == Alignment.RIGHT)           bounds.x+=offset;
        }
      }
 else {
        int offset=getThumbOffset(bounds.height);
        if (offset > 0) {
          bounds.height-=offset;
          if (alignment == Alignment.BOTTOM)           bounds.y+=offset;
        }
      }
      if (SystemInfo.isMac) {
        bounds.x+=1;
        bounds.y+=1;
        bounds.width-=2;
        bounds.height-=2;
      }
    }
 else     if (SystemInfo.isMac) {
      boolean vertical=scrollbar == null || Adjustable.VERTICAL == scrollbar.getOrientation();
      bounds.x+=vertical ? 3 : 2;
      bounds.y+=vertical ? 2 : 3;
      bounds.width-=vertical ? 5 : 4;
      bounds.height-=vertical ? 4 : 5;
    }
 else     if (Registry.is("ide.scroll.thumb.small.if.opaque")) {
      bounds.x+=1;
      bounds.y+=1;
      bounds.width-=2;
      bounds.height-=2;
    }
    if (SystemInfo.isMac) {
      int arc=Math.min(bounds.width,bounds.height);
      boolean dark=isDark();
      int c=dark ? 128 : 0;
      int a=dark ? 40 : 100;
      g.setColor(new Color(c,c,c,a));
      Graphics2D g2d=(Graphics2D)g;
      Object old=g2d.getRenderingHint(RenderingHints.KEY_ANTIALIASING);
      g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING,RenderingHints.VALUE_ANTIALIAS_ON);
      g2d.fillRoundRect(bounds.x,bounds.y,bounds.width,bounds.height,arc,arc);
      g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING,old);
    }
 else {
      float value=(float)myThumbFadeColorShift / getAnimationColorShift();
      RegionPainter<Float> painter=isDark() ? JBScrollPane.THUMB_DARK_PAINTER : JBScrollPane.THUMB_PAINTER;
      painter.paint((Graphics2D)g,bounds.x,bounds.y,bounds.width,bounds.height,value);
    }
  }
 else {
    RegionPainter<Integer> painter=UIUtil.getClientProperty(scrollbar,MAXI_THUMB);
    if (painter != null) {
      painter.paint((Graphics2D)g,thumbBounds.x,thumbBounds.y,thumbBounds.width,thumbBounds.height,myThumbFadeColorShift);
    }
 else {
      g.translate(thumbBounds.x,thumbBounds.y);
      paintMaxiThumb((Graphics2D)g,thumbBounds);
      g.translate(-thumbBounds.x,-thumbBounds.y);
    }
  }
}
