{
  UIDefaults defaults=UIManager.getDefaults();
  Enumeration<Object> keys=defaults.keys();
  if (inPresentation) {
    while (keys.hasMoreElements()) {
      Object key=keys.nextElement();
      if (key instanceof String) {
        String name=(String)key;
        if (name.endsWith(".font")) {
          Font font=defaults.getFont(key);
          ourSavedValues.put(key,font);
        }
 else         if (name.endsWith(".rowHeight")) {
          ourSavedValues.put(key,defaults.getInt(key));
        }
      }
    }
    for (    Object key : ourSavedValues.keySet()) {
      Object v=ourSavedValues.get(key);
      if (v instanceof Font) {
        Font font=(Font)v;
        defaults.put(key,new FontUIResource(font.getName(),font.getStyle(),Math.min(20,settings.PRESENTATION_MODE_FONT_SIZE)));
      }
 else       if (v instanceof Integer) {
        defaults.put(key,((Integer)v).intValue() * 3 / 2);
      }
    }
  }
 else {
    for (    Object key : ourSavedValues.keySet()) {
      defaults.put(key,ourSavedValues.get(key));
    }
    ourSavedValues.clear();
  }
}
