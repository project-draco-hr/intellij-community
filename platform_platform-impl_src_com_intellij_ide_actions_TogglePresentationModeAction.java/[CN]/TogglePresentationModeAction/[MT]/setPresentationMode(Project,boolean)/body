{
  final UISettings settings=UISettings.getInstance();
  settings.PRESENTATION_MODE=inPresentation;
  RegistryValue value=Registry.get("editor.distraction.free.mode");
  if (inPresentation) {
    ourSavedDistractionMode=value.asBoolean();
    value.setValue(true);
  }
 else {
    value.setValue(ourSavedDistractionMode);
  }
  final boolean layoutStored=storeToolWindows(project);
  tweakUIDefaults(settings,inPresentation);
  ActionCallback callback=project == null ? ActionCallback.DONE : tweakFrameFullScreen(project,inPresentation);
  callback.doWhenProcessed(new Runnable(){
    @Override public void run(){
      tweakEditorAndFireUpdateUI(settings,inPresentation);
      restoreToolWindows(project,layoutStored,inPresentation);
    }
  }
);
}
