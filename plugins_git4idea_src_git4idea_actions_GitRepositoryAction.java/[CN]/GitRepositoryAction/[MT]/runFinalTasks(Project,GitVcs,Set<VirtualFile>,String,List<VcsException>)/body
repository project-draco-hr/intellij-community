{
  VfsUtil.markDirty(true,false,ArrayUtil.toObjectArray(affectedRoots,VirtualFile.class));
  LocalFileSystem.getInstance().refreshFiles(affectedRoots,true,true,new Runnable(){
    @Override public void run(){
      VcsFileUtil.markFilesDirty(project,affectedRoots);
      for (      TransactionRunnable task : myDelayedTasks) {
        task.run(exceptions);
      }
      myDelayedTasks.clear();
      vcs.showErrors(exceptions,actionName);
    }
  }
);
}
