{
  if (text == null)   return;
  if (myContentPreprocessor != null) {
    final List<LogFragment> fragments=myContentPreprocessor.parseLogLine(text + "\n");
    myOriginalDocument=getOriginalDocument();
    for (    LogFragment fragment : fragments) {
      String formattedMessage=myFormatter.formatMessage(fragment.getText());
      myProcessHandler.notifyTextAvailable(formattedMessage,fragment.getOutputType());
      if (myOriginalDocument != null) {
        myOriginalDocument.append(fragment.getText());
      }
    }
  }
 else {
    final LogFilterModel.MyProcessingResult processingResult=myModel.processLine(text);
    if (processingResult.isApplicable()) {
      final Key key=processingResult.getKey();
      if (key != null) {
        final String messagePrefix=processingResult.getMessagePrefix();
        if (messagePrefix != null) {
          String formattedPrefix=myFormatter.formatPrefix(messagePrefix);
          myProcessHandler.notifyTextAvailable(formattedPrefix,key);
        }
        String formattedMessage=myFormatter.formatMessage(text);
        myProcessHandler.notifyTextAvailable(formattedMessage + "\n",key);
      }
    }
    myOriginalDocument=getOriginalDocument();
    if (myOriginalDocument != null) {
      myOriginalDocument.append(text).append("\n");
    }
  }
}
