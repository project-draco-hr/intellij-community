{
  myTextLabel.setFont(UIUtil.getLabelFont());
  setPreferredSize(null);
  MyNode node=extractNode(value);
  if (node == null) {
    myTextLabel.setText(value.toString());
  }
 else {
    myTextLabel.setText(node.myDisplayName);
    if (myRoot == node.getParent()) {
      myTextLabel.setFont(myTextLabel.getFont().deriveFont(Font.BOLD));
    }
    if (tree.isVisible()) {
      int indent=node.myLevel * (UIUtil.getTreeLeftChildIndent() + UIUtil.getTreeRightChildIndent());
      Insets treeInsets=tree.getInsets();
      if (treeInsets != null) {
        indent+=treeInsets.left + treeInsets.right;
      }
      int visibleWidth=tree.getVisibleRect().width;
      if (visibleWidth > indent) {
        Dimension size=getPreferredSize();
        size.width=visibleWidth - indent;
      }
    }
  }
  myTextLabel.setForeground(selected ? UIUtil.getTreeSelectionForeground() : NORMAL_NODE);
  if (!selected && node != null) {
    Configurable configurable=node.myConfigurable;
    if (configurable != null) {
      if (myFilter.myContext.getErrors().containsKey(configurable)) {
        myTextLabel.setForeground(WRONG_CONTENT);
      }
 else       if (myFilter.myContext.getModified().contains(configurable)) {
        myTextLabel.setForeground(MODIFIED_CONTENT);
      }
    }
  }
  Project project=null;
  if (node != null) {
    SimpleNode parent=node.getParent();
    if (parent instanceof MyNode) {
      if (myRoot == parent.getParent()) {
        project=findConfigurableProject(node);
        if (node.myConfigurable instanceof NodeConfigurable) {
          Configurable[] configurables=((NodeConfigurable)node.myConfigurable).getConfigurables();
          if (configurables != null) {
            project=findConfigurableProject(configurables[0]);
          }
        }
      }
 else       if (((MyNode)parent).myConfigurable instanceof NodeConfigurable) {
        if (((MyNode)node.getParent()).myConfigurable instanceof NodeConfigurable) {
          project=findConfigurableProject(node);
        }
      }
    }
  }
  if (project != null) {
    myProjectIcon.setIcon(selected ? AllIcons.General.ProjectConfigurableSelected : AllIcons.General.ProjectConfigurable);
    myProjectIcon.setToolTipText(OptionsBundle.message(project.isDefault() ? "configurable.default.project.tooltip" : "configurable.current.project.tooltip"));
    myProjectIcon.setVisible(true);
  }
 else {
    myProjectIcon.setVisible(false);
  }
  Icon nodeIcon=null;
  if (node != null) {
    if (0 == node.getChildCount()) {
      nodeIcon=myTree.getEmptyHandle();
    }
 else     if (value instanceof DefaultMutableTreeNode) {
      DefaultMutableTreeNode treeNode=(DefaultMutableTreeNode)value;
      nodeIcon=myTree.isExpanded(new TreePath(treeNode.getPath())) ? myTree.getExpandedHandle() : myTree.getCollapsedHandle();
    }
  }
  myNodeIcon.setIcon(nodeIcon);
  return this;
}
