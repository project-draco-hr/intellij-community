{
  myTextLabel.clear();
  setPreferredSize(null);
  MyNode node=extractNode(value);
  boolean isGroup=node != null && myRoot == node.getParent();
  String name=node != null ? node.myDisplayName : String.valueOf(value);
  myTextLabel.append(name,isGroup ? SimpleTextAttributes.REGULAR_BOLD_ATTRIBUTES : SimpleTextAttributes.REGULAR_ATTRIBUTES);
  myTextLabel.setFont(isGroup ? myTree.getFont() : UIUtil.getLabelFont());
  myTextLabel.setForeground(selected ? UIUtil.getTreeSelectionForeground() : FOREGROUND);
  if (!selected && node != null) {
    Configurable configurable=node.myConfigurable;
    if (configurable != null) {
      if (myFilter.myContext.getErrors().containsKey(configurable)) {
        myTextLabel.setForeground(WRONG_CONTENT);
      }
 else       if (myFilter.myContext.getModified().contains(configurable)) {
        myTextLabel.setForeground(MODIFIED_CONTENT);
      }
    }
  }
  Project project=null;
  if (node != null) {
    SimpleNode parent=node.getParent();
    if (parent instanceof MyNode) {
      if (myRoot == parent.getParent()) {
        project=findConfigurableProject(node);
        if (node.myConfigurable instanceof SortedConfigurableGroup) {
          Configurable[] configurables=((SortedConfigurableGroup)node.myConfigurable).getConfigurables();
          if (configurables != null) {
            project=findConfigurableProject(configurables[0]);
          }
        }
      }
 else       if (((MyNode)parent).myConfigurable instanceof SortedConfigurableGroup) {
        if (((MyNode)node.getParent()).myConfigurable instanceof SortedConfigurableGroup) {
          project=findConfigurableProject(node);
        }
      }
    }
  }
  if (project != null) {
    myProjectIcon.setIcon(selected ? AllIcons.General.ProjectConfigurableSelected : AllIcons.General.ProjectConfigurable);
    myProjectIcon.setToolTipText(OptionsBundle.message(project.isDefault() ? "configurable.default.project.tooltip" : "configurable.current.project.tooltip"));
    myProjectIcon.setVisible(true);
  }
 else {
    myProjectIcon.setVisible(false);
  }
  Icon nodeIcon=null;
  if (value instanceof DefaultMutableTreeNode) {
    DefaultMutableTreeNode treeNode=(DefaultMutableTreeNode)value;
    if (0 == treeNode.getChildCount()) {
      nodeIcon=myTree.getEmptyHandle();
    }
 else {
      nodeIcon=myTree.isExpanded(new TreePath(treeNode.getPath())) ? myTree.getExpandedHandle() : myTree.getCollapsedHandle();
    }
  }
  myNodeIcon.setIcon(nodeIcon);
  if (node != null && myPaintInternalInfo) {
    String id=node.myConfigurable instanceof ConfigurableWrapper ? ((ConfigurableWrapper)node.myConfigurable).getId() : node.myConfigurable instanceof SearchableConfigurable ? ((SearchableConfigurable)node.myConfigurable).getId() : node.myConfigurable.getClass().getSimpleName();
    PluginDescriptor plugin=node.myConfigurable instanceof ConfigurableWrapper ? ((ConfigurableWrapper)node.myConfigurable).getExtensionPoint().getPluginDescriptor() : null;
    String pluginId=plugin == null ? null : plugin.getPluginId().getIdString();
    String pluginName=pluginId == null || PluginManagerCore.CORE_PLUGIN_ID.equals(pluginId) ? null : plugin instanceof IdeaPluginDescriptor ? ((IdeaPluginDescriptor)plugin).getName() : pluginId;
    myTextLabel.append("   ",SimpleTextAttributes.REGULAR_ATTRIBUTES,false);
    myTextLabel.append(pluginName == null ? id : id + " (" + pluginName+ ")",SimpleTextAttributes.GRAYED_SMALL_ATTRIBUTES,false);
  }
  if (node != null && tree.isVisible()) {
    int width=getLeftMargin(node.myLevel) + getPreferredSize().width;
    Insets insets=tree.getInsets();
    if (insets != null) {
      width+=insets.left + insets.right;
    }
    JScrollBar bar=myScroller.getVerticalScrollBar();
    if (bar != null && bar.isVisible()) {
      width+=bar.getWidth();
    }
    width=Math.min(width,300);
    JComponent view=SettingsTreeView.this;
    Dimension size=view.getMinimumSize();
    if (size.width < width) {
      size.width=width;
      view.setMinimumSize(size);
      view.revalidate();
      view.repaint();
    }
  }
  return this;
}
