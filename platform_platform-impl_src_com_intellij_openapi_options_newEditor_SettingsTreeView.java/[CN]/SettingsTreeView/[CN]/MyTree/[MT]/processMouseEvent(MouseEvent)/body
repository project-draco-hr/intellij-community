{
  MyTreeUi ui=(MyTreeUi)myTree.getUI();
  boolean toggleNow=MouseEvent.MOUSE_RELEASED == e.getID() && UIUtil.isActionClick(e,MouseEvent.MOUSE_RELEASED) && !ui.isToggleEvent(e);
  if (toggleNow || MouseEvent.MOUSE_PRESSED == e.getID()) {
    TreePath path=getPathForLocation(e.getX(),e.getY());
    if (path != null) {
      Rectangle bounds=getPathBounds(path);
      if (bounds != null && path.getLastPathComponent() instanceof DefaultMutableTreeNode) {
        DefaultMutableTreeNode node=(DefaultMutableTreeNode)path.getLastPathComponent();
        boolean selected=isPathSelected(path);
        boolean expanded=isExpanded(path);
        Component comp=myRenderer.getTreeCellRendererComponent(this,node,selected,expanded,node.isLeaf(),getRowForPath(path),isFocusOwner());
        comp.setBounds(bounds);
        comp.validate();
        Point point=new Point(e.getX() - bounds.x,e.getY() - bounds.y);
        if (myRenderer.isUnderHandle(point)) {
          if (toggleNow) {
            ui.toggleExpandState(path);
          }
          e.consume();
          return;
        }
      }
    }
  }
  super.processMouseEvent(e);
}
