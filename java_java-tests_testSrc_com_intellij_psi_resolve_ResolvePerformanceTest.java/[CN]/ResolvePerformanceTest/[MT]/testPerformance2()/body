{
  final String fullPath=PathManagerEx.getTestDataPath() + "/psi/resolve/ant/build.xml";
  final VirtualFile vFile=LocalFileSystem.getInstance().findFileByPath(fullPath.replace(File.separatorChar,'/'));
  final List<PsiReference> references=new ArrayList<PsiReference>();
  assertNotNull("file " + fullPath + " not found",vFile);
  String fileText=VfsUtil.loadText(vFile);
  fileText=StringUtil.convertLineSeparators(fileText);
  myFile=createFile(vFile.getName(),fileText);
  myFile.accept(new XmlRecursiveElementVisitor(){
    @Override public void visitXmlAttributeValue(    XmlAttributeValue value){
      ContainerUtil.addAll(references,value.getReferences());
      super.visitXmlAttributeValue(value);
    }
  }
);
  myFile.accept(new JavaRecursiveElementWalkingVisitor(){
    @Override public void visitReferenceExpression(    PsiReferenceExpression expression){
      references.add(expression);
      visitElement(expression);
    }
  }
);
  System.out.println();
  System.out.println("Found " + references.size() + " references");
  resolveAllReferences(references);
}
