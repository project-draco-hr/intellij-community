{
  PsiElement place=context.getFile().findElementAt(context.getTailOffset() - 1);
  if (!Registry.is("java.completion.make.outer.variables.final") || place == null || PsiUtil.isLanguageLevel8OrHigher(place) || JspPsiUtil.isInJspFile(place)) {
    return;
  }
  if (HighlightControlFlowUtil.getInnerClassVariableReferencedFrom(variable,place) != null && !HighlightControlFlowUtil.isReassigned(variable,new HashMap<>())) {
    PsiUtil.setModifierProperty(variable,PsiModifier.FINAL,true);
  }
}
