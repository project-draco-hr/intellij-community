{
  final Project project=getEventProject(e);
  if (project == null)   return;
  MyPopupStep step=new MyPopupStep(collectAttachItems(project),project);
  final ListPopup popup=JBPopupFactory.getInstance().createListPopup(step);
  final JList mainList=((ListPopupImpl)popup).getList();
  ListSelectionListener listener=new ListSelectionListener(){
    @Override public void valueChanged(    ListSelectionEvent event){
      if (event.getValueIsAdjusting())       return;
      Object item=((JList)event.getSource()).getSelectedValue();
      if (item == null) {
        item=mainList.getSelectedValue();
      }
      if (item instanceof AttachItem) {
        popup.setAdText(XDebuggerBundle.message("xdebugger.attach.toLocal.popup.adText",((AttachItem)item).getSelectedDebugger().getDebuggerDisplayName()),SwingConstants.LEADING);
      }
    }
  }
;
  popup.addListSelectionListener(listener);
  listener.valueChanged(new ListSelectionEvent(mainList,mainList.getMinSelectionIndex(),mainList.getMaxSelectionIndex(),false));
  popup.showCenteredInCurrentWindow(project);
}
