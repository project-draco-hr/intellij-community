{
  final PsiExpression thenExpression=conditionalExpression.getThenExpression();
  final PsiExpression elseExpression=conditionalExpression.getElseExpression();
  if (thenExpression != null && PsiType.BOOLEAN.equals(thenExpression.getType()) && elseExpression != null && PsiType.BOOLEAN.equals(elseExpression.getType())) {
    if (value == BooleanExpressionValue.WHEN_TRUE) {
      checkConditionalInternal(conditionalExpression,definiteAssignment,BooleanExpressionValue.WHEN_TRUE);
    }
 else     if (value == BooleanExpressionValue.WHEN_FALSE) {
      checkConditionalInternal(conditionalExpression,definiteAssignment,BooleanExpressionValue.WHEN_FALSE);
    }
 else {
      final boolean da=definiteAssignment.isDefinitelyAssigned();
      final boolean du=definiteAssignment.isDefinitelyUnassigned();
      checkConditionalExpression(conditionalExpression,definiteAssignment,BooleanExpressionValue.WHEN_TRUE);
      final boolean resultDa=definiteAssignment.isDefinitelyAssigned();
      final boolean resultDu=definiteAssignment.isDefinitelyUnassigned();
      definiteAssignment.set(da,du);
      checkConditionalExpression(conditionalExpression,definiteAssignment,BooleanExpressionValue.WHEN_FALSE);
      definiteAssignment.and(resultDa,resultDu);
    }
  }
 else {
    checkConditionalInternal(conditionalExpression,definiteAssignment,BooleanExpressionValue.UNDEFINED);
  }
}
