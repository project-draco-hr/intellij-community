{
  Icon nodeIcon;
  if (valueDescriptor instanceof FieldDescriptorImpl) {
    FieldDescriptorImpl fieldDescriptor=(FieldDescriptorImpl)valueDescriptor;
    nodeIcon=PlatformIcons.FIELD_ICON;
    if (fieldDescriptor.getField().isFinal()) {
      nodeIcon=new LayeredIcon(nodeIcon,AllIcons.Nodes.FinalMark);
    }
    if (fieldDescriptor.isStatic()) {
      nodeIcon=new LayeredIcon(nodeIcon,AllIcons.Nodes.StaticMark);
    }
  }
 else   if (valueDescriptor instanceof ThrownExceptionValueDescriptorImpl) {
    nodeIcon=AllIcons.Nodes.ExceptionClass;
  }
 else   if (valueDescriptor instanceof MethodReturnValueDescriptorImpl) {
    nodeIcon=AllIcons.Debugger.WatchLastReturnValue;
  }
 else   if (isParameter(valueDescriptor)) {
    nodeIcon=PlatformIcons.PARAMETER_ICON;
  }
 else   if (valueDescriptor.isEnumConstant()) {
    nodeIcon=PlatformIcons.ENUM_ICON;
  }
 else   if (valueDescriptor.isArray()) {
    nodeIcon=AllIcons.Debugger.Db_array;
  }
 else   if (valueDescriptor.isPrimitive()) {
    nodeIcon=AllIcons.Debugger.Db_primitive;
  }
 else   if (valueDescriptor instanceof WatchItemDescriptor) {
    nodeIcon=AllIcons.Debugger.Watch;
  }
 else {
    nodeIcon=AllIcons.Debugger.Value;
  }
  if (valueDescriptor instanceof UserExpressionDescriptorImpl) {
    Renderer renderer=((UserExpressionDescriptorImpl)valueDescriptor).getParentDescriptor().getLastRenderer();
    if (renderer instanceof CompoundNodeRenderer) {
      ChildrenRenderer childrenRenderer=((CompoundNodeRenderer)renderer).getChildrenRenderer();
      if (childrenRenderer instanceof EnumerationChildrenRenderer && ((EnumerationChildrenRenderer)childrenRenderer).isAppendDefaultChildren()) {
        nodeIcon=AllIcons.Debugger.Watch;
      }
    }
  }
  if (valueDescriptor instanceof WatchItemDescriptor && nodeIcon != AllIcons.Debugger.Watch) {
    XDebugSession session=XDebuggerManager.getInstance(valueDescriptor.getProject()).getCurrentSession();
    if (session != null) {
      XDebugSessionTab tab=((XDebugSessionImpl)session).getSessionTab();
      if (tab != null && tab.isWatchesInVariables()) {
        nodeIcon=AllIcons.Debugger.Watch;
      }
    }
  }
  final Icon valueIcon=valueDescriptor.getValueIcon();
  if (nodeIcon != null && valueIcon != null) {
    nodeIcon=new RowIcon(nodeIcon,valueIcon);
  }
  return nodeIcon;
}
