{
  Iterable iterable=getIterable(o);
  if (iterable == null)   return context;
  final String tagName=getTagName(o);
  if (tagName != null) {
    Element result=new Element(tagName);
    for (    Object e : iterable) {
      if (e == null) {
        throw new XmlSerializationException("Collection " + myAccessor + " contains 'null' object");
      }
      Content child=(Content)getElementBinding(e.getClass()).serialize(e,result,filter);
      if (child != null) {
        result.addContent(child);
      }
    }
    return result;
  }
 else {
    List<Object> result=new ArrayList<Object>();
    for (    Object e : iterable) {
      ContainerUtil.addIfNotNull(result,getElementBinding(e.getClass()).serialize(e,result,filter));
    }
    return result;
  }
}
