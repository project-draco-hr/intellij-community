{
  serverSocket=acquireSocket();
  if (serverSocket == null) {
    String productName=ApplicationNamesInfo.getInstance().getProductName();
    if (Main.isHeadless()) {
      throw new RuntimeException("Only one instance of " + productName + " can be run at a time.");
    }
    String pathToLogFile=PathManager.getLogPath() + "/idea.log file".replace('/',File.separatorChar);
    JOptionPane.showMessageDialog(JOptionPane.getRootFrame(),CommonBundle.message("cannot.start.other.instance.is.running.error.message",productName,pathToLogFile),CommonBundle.message("title.warning"),JOptionPane.WARNING_MESSAGE);
    acquiredPort=-1;
  }
 else {
    acquiredPort=serverSocket.getLocalPort();
    Thread thread=new Thread(new MyRunnable(),LOCK_THREAD_NAME);
    thread.setPriority(Thread.MIN_PRIORITY);
    thread.start();
  }
}
