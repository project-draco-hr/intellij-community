{
  super.doOKAction();
  final Ref<Boolean> result=new Ref<>();
  Runnable runnable=new Runnable(){
    public void run(){
      UpdateChecker.saveDisabledToUpdatePlugins();
      result.set(UpdateChecker.install(myUploadedPlugins));
    }
  }
;
  final String progressTitle="Download plugins...";
  if (downloadModal()) {
    ProgressManager.getInstance().runProcessWithProgressSynchronously(runnable,progressTitle,true,null);
  }
 else {
    ProgressManager.getInstance().run(new Task.Backgroundable(null,progressTitle,true){
      @Override public void run(      @NotNull ProgressIndicator indicator){
        runnable.run();
      }
      @Override public void onSuccess(){
        final Boolean installed=result.get();
        if (installed != null && installed.booleanValue()) {
          final String pluginName;
          if (myUploadedPlugins.size() == 1) {
            final PluginDownloader firstItem=ContainerUtil.getFirstItem(myUploadedPlugins);
            pluginName=firstItem != null ? firstItem.getPluginName() : null;
          }
 else {
            pluginName=null;
          }
          PluginManagerMain.notifyPluginsWereInstalled(pluginName,null);
        }
      }
    }
);
  }
}
