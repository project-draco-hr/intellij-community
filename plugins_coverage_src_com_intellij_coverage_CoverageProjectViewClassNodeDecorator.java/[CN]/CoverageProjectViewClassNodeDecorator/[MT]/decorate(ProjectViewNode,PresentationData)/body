{
  final CoverageDataManager coverageDataManager=getCoverageDataManager();
  final CoverageSuitesBundle currentSuite=coverageDataManager.getCurrentSuitesBundle();
  final Project project=node.getProject();
  final JavaCoverageAnnotator javaCovAnnotator=getCovAnnotator(currentSuite,project);
  if (javaCovAnnotator == null) {
    return;
  }
  final Object value=node.getValue();
  PsiElement element=null;
  if (value instanceof PsiElement) {
    element=(PsiElement)value;
  }
 else   if (value instanceof SmartPsiElementPointer) {
    element=((SmartPsiElementPointer)value).getElement();
  }
 else   if (value instanceof PackageElement) {
    PackageElement packageElement=(PackageElement)value;
    final String coverageString=javaCovAnnotator.getPackageCoverageInformationString(packageElement.getPackage(),packageElement.getModule(),coverageDataManager);
    data.setLocationString(coverageString);
  }
  if (element instanceof PsiClass) {
    final GlobalSearchScope searchScope=JavaCoverageViewExtension.getSearchScope(currentSuite,project);
    final VirtualFile vFile=PsiUtilCore.getVirtualFile(element);
    if (vFile != null && searchScope.contains(vFile)) {
      final String qName=((PsiClass)element).getQualifiedName();
      if (qName != null) {
        data.setLocationString(javaCovAnnotator.getClassCoverageInformationString(qName,coverageDataManager));
      }
    }
  }
}
