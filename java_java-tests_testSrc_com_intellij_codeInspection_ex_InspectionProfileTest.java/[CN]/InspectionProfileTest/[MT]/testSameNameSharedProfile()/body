{
  InspectionProfileManager profileManager=InspectionProfileManager.getInstance();
  InspectionProfileImpl localProfile=createProfile();
  profileManager.updateProfile(localProfile);
  InspectionProjectProfileManagerImpl projectProfileManager=InspectionProjectProfileManagerImpl.getInstanceImpl(getProject());
  try {
    profileManager.updateProfile(localProfile);
    InspectionProfileImpl profile=new InspectionProfileImpl(PROFILE,InspectionToolRegistrar.getInstance(),projectProfileManager,InspectionProfileImpl.getDefaultProfile(),null);
    projectProfileManager.updateProfile(profile);
    projectProfileManager.setProjectProfile(profile.getName());
    assertTrue(projectProfileManager.getInspectionProfile() == profile);
  }
  finally {
    projectProfileManager.deleteProfile(PROFILE);
  }
}
