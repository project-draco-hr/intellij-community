{
  final PsiModifierList list2=(PsiModifierList)myMatchingVisitor.getElement();
  for (  @PsiModifier.ModifierConstant String modifier : MODIFIERS) {
    if (list.hasModifierProperty(modifier) && !list2.hasModifierProperty(modifier)) {
      myMatchingVisitor.setResult(false);
      return;
    }
  }
  final PsiAnnotation[] annotations=list.getAnnotations();
  if (annotations.length > 0) {
    HashSet<PsiAnnotation> set=new HashSet<PsiAnnotation>(Arrays.asList(annotations));
    for (    PsiAnnotation annotation : annotations) {
      final PsiJavaCodeReferenceElement nameReferenceElement=annotation.getNameReferenceElement();
      if (nameReferenceElement != null && MatchOptions.MODIFIER_ANNOTATION_NAME.equals(nameReferenceElement.getText())) {
        final PsiAnnotationParameterList parameterList=annotation.getParameterList();
        final PsiNameValuePair[] attributes=parameterList.getAttributes();
        for (        PsiNameValuePair pair : attributes) {
          final PsiAnnotationMemberValue value=pair.getValue();
          if (value == null)           continue;
          if (value instanceof PsiArrayInitializerMemberValue) {
            boolean matchedOne=false;
            for (            PsiAnnotationMemberValue v : ((PsiArrayInitializerMemberValue)value).getInitializers()) {
              if (annotationValueMatchesModifierList(list2,v)) {
                matchedOne=true;
                break;
              }
            }
            if (!matchedOne) {
              myMatchingVisitor.setResult(false);
              return;
            }
          }
 else {
            if (!annotationValueMatchesModifierList(list2,value)) {
              myMatchingVisitor.setResult(false);
              return;
            }
          }
        }
        set.remove(annotation);
      }
    }
    myMatchingVisitor.setResult(set.isEmpty() || myMatchingVisitor.matchInAnyOrder(set.toArray(new PsiAnnotation[set.size()]),list2.getAnnotations()));
  }
 else {
    myMatchingVisitor.setResult(true);
  }
}
