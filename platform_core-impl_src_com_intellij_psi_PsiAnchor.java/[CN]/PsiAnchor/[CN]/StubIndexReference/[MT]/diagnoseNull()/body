{
  final PsiFile file=ApplicationManager.getApplication().runReadAction(new Computable<PsiFile>(){
    @Override public PsiFile compute(){
      return getFile();
    }
  }
);
  try {
    PsiElement element=ApplicationManager.getApplication().runReadAction(new NullableComputable<PsiElement>(){
      @Override public PsiElement compute(){
        return restoreFromStubIndex((PsiFileWithStubSupport)file,myIndex,myElementType,true);
      }
    }
);
    return "No diagnostics, element=" + element + "@"+ (element == null ? 0 : System.identityHashCode(element));
  }
 catch (  AssertionError e) {
    String msg=e.getMessage();
    msg+=file == null ? "\n no PSI file" : "\n current file stamp=" + (short)file.getModificationStamp();
    final Document document=FileDocumentManager.getInstance().getCachedDocument(myVirtualFile);
    if (document != null) {
      msg+="\n committed=" + PsiDocumentManager.getInstance(myProject).isCommitted(document);
      msg+="\n saved=" + !FileDocumentManager.getInstance().isDocumentUnsaved(document);
    }
    return msg;
  }
}
