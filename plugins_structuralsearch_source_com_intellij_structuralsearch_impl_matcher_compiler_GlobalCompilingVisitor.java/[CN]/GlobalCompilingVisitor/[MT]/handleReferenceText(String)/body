{
  if (refname == null)   return;
  if (getContext().getPattern().isTypedVar(refname)) {
    SubstitutionHandler handler=(SubstitutionHandler)getContext().getPattern().getHandler(refname);
    RegExpPredicate predicate=MatchingHandler.getSimpleRegExpPredicate(handler);
    if (!isSuitablePredicate(predicate,handler)) {
      return;
    }
    refname=predicate.getRegExp();
    if (handler.isStrictSubtype() || handler.isSubtype()) {
      if (getContext().getSearchHelper().addDescendantsOf(refname,handler.isSubtype())) {
        getContext().getSearchHelper().endTransaction();
      }
      return;
    }
  }
  addFilesToSearchForGivenWord(refname,true,GlobalCompilingVisitor.OccurenceKind.CODE);
}
