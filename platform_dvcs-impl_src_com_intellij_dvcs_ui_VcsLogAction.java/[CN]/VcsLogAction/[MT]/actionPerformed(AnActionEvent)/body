{
  final Project project=e.getRequiredData(CommonDataKeys.PROJECT);
  VcsLog log=e.getRequiredData(VcsLogDataKeys.VCS_LOG);
  log.requestSelectedDetails(new Consumer<List<VcsFullCommitDetails>>(){
    @Override public void consume(    List<VcsFullCommitDetails> details){
      MultiMap<Repo,VcsFullCommitDetails> grouped=groupCommits(project,details,new Function<VcsFullCommitDetails,VirtualFile>(){
        @Override public VirtualFile fun(        VcsFullCommitDetails vcsFullCommitDetails){
          return vcsFullCommitDetails.getRoot();
        }
      }
);
      if (grouped == null)       return;
      actionPerformed(project,grouped);
    }
  }
,null);
}
