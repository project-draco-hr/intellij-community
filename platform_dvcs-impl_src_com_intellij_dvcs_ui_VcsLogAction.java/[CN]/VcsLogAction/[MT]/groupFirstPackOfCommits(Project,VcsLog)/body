{
  MultiMap<Repo,CommitId> commitIds=groupCommits(project,VcsLogUtil.collectFirstPack(log.getSelectedCommits(),VcsLogUtil.MAX_SELECTED_COMMITS),new Function<CommitId,VirtualFile>(){
    @Override public VirtualFile fun(    CommitId hash){
      return hash.getRoot();
    }
  }
);
  if (commitIds == null)   return null;
  MultiMap<Repo,Hash> hashes=MultiMap.create();
  for (  Map.Entry<Repo,Collection<CommitId>> entry : commitIds.entrySet()) {
    hashes.putValues(entry.getKey(),ContainerUtil.map(entry.getValue(),new Function<CommitId,Hash>(){
      @Override public Hash fun(      CommitId commitId){
        return commitId.getHash();
      }
    }
));
  }
  return hashes;
}
