{
  final int typoCount=50000;
  @SuppressWarnings("SpellCheckingInspection") String text=StringUtil.repeat("aaaaaaaaa ",typoCount);
  long start=System.currentTimeMillis();
  VirtualFile file=myFixture.addFileToProject("foo.txt",text).getVirtualFile();
  System.out.println("creation took " + (System.currentTimeMillis() - start) + " ms");
  start=System.currentTimeMillis();
  myFixture.configureFromExistingVirtualFile(file);
  System.out.println("configure took " + (System.currentTimeMillis() - start) + " ms");
  myFixture.enableInspections(getInspectionTools());
  start=System.currentTimeMillis();
  assertSize(typoCount,myFixture.doHighlighting());
  System.out.println("warm-up took " + (System.currentTimeMillis() - start) + " ms");
  PlatformTestUtil.startPerformanceTest("many typos highlighting",1000,new ThrowableRunnable(){
    @Override public void run(){
      assertSize(typoCount,myFixture.doHighlighting());
    }
  }
).cpuBound().assertTiming();
}
