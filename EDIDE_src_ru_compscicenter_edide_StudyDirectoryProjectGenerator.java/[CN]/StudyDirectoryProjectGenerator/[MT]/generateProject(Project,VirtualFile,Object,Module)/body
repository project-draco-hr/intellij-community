{
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    @Override public void run(){
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        @Override public void run(){
          try {
            TaskManager taskManager=TaskManager.getInstance();
            taskManager.setCurrentTask(0);
            int tasksNumber=taskManager.getTasksNum();
            for (int task=0; task < tasksNumber; task++) {
              VirtualFile taskDirectory=baseDir.createChildDirectory(this,"task" + (task + 1));
              for (int file=0; file < taskManager.getTaskFileNum(task); file++) {
                final String curFileName=taskManager.getFileName(task,file);
                createFile(curFileName,taskDirectory);
              }
              final VirtualFile ideaDir=baseDir.findChild(".idea");
              if (ideaDir != null)               createFile(taskManager.getTest(task),ideaDir);
 else               LOG.error("Could not find .idea directory");
            }
          }
 catch (          IOException e) {
            Log.print("Problems with creating files");
            Log.print(e.toString());
            Log.flush();
          }
          LocalFileSystem.getInstance().refresh(false);
        }
      }
);
    }
  }
);
}
