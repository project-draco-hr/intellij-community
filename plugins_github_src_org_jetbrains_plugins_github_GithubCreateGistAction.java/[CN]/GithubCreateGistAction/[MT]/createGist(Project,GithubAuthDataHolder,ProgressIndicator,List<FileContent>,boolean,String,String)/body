{
  if (contents.isEmpty()) {
    GithubNotifications.showWarning(project,FAILED_TO_CREATE_GIST,"Can't create empty gist");
    return null;
  }
  if (contents.size() == 1 && filename != null) {
    FileContent entry=contents.iterator().next();
    contents=Collections.singletonList(new FileContent(filename,entry.getContent()));
  }
  try {
    final List<FileContent> finalContents=contents;
    return GithubUtil.runTask(project,auth,indicator,new ThrowableConvertor<GithubAuthData,GithubGist,IOException>(){
      @NotNull @Override public GithubGist convert(      @NotNull GithubAuthData auth) throws IOException {
        return GithubApiUtil.createGist(auth,finalContents,description,isPrivate);
      }
    }
).getHtmlUrl();
  }
 catch (  IOException e) {
    GithubNotifications.showError(project,FAILED_TO_CREATE_GIST,e);
    return null;
  }
}
