{
  if (file.isDirectory()) {
    return getContentFromDirectory(file,project,prefix);
  }
  Document document=FileDocumentManager.getInstance().getDocument(file);
  String content;
  if (document != null) {
    content=document.getText();
  }
 else {
    content=readFile(file);
  }
  if (content == null) {
    GithubNotifications.showWarning(project,FAILED_TO_CREATE_GIST,"Couldn't read the contents of the file " + file);
    return Collections.emptyMap();
  }
  if (StringUtil.isEmptyOrSpaces(content)) {
    return Collections.emptyMap();
  }
  return Collections.singletonMap(addPrefix(file.getName(),prefix,false),content);
}
