{
  final Ref<String> url=new Ref<String>();
  new Task.Backgroundable(project,"Creating Gist"){
    @Override public void run(    @NotNull ProgressIndicator indicator){
      List<NamedContent> contents=collectContents(project,editor,file,files);
      String gistUrl=createGist(project,auth,contents,aPrivate,description);
      url.set(gistUrl);
    }
    @Override public void onSuccess(){
      resultHandler.consume(url.get());
    }
  }
.queue();
}
