{
  final List<ExternalSystemNode<?>> result=new SmartList<ExternalSystemNode<?>>();
  addModuleNodes(externalProjectsView,dataNodes,result);
  Collection<DataNode<?>> tasksNodes=dataNodes.get(ProjectKeys.TASK);
  if (!tasksNodes.isEmpty()) {
    TasksNode tasksNode=new TasksNode(externalProjectsView,tasksNodes);
    if (externalProjectsView.useTasksNode()) {
      result.add(tasksNode);
    }
 else {
      ContainerUtil.addAll(result,tasksNode.getChildren());
    }
  }
  addDependenciesNode(externalProjectsView,dataNodes,result);
  return result;
}
