{
  final Project project=context.getProject();
  final Editor editor=context.getEditor();
  final PsiFile psiFile=editor != null ? PsiUtilBase.getPsiFileInEditor(editor,project) : null;
  Runnable runnable=new Runnable(){
    @Override public void run(){
      if (project.isDisposed() || editor == null || editor.isDisposed() || psiFile == null || !psiFile.isValid())       return;
      if (CompletionServiceImpl.getCompletionService().getCurrentCompletion() != null)       return;
      CommandProcessor.getInstance().executeCommand(project,new Runnable(){
        @Override public void run(){
          CompletionServiceImpl.setCompletionPhase(CompletionPhase.NoCompletion);
          invokeCompletionHandler(project,editor);
          Lookup lookup=LookupManager.getInstance(project).getActiveLookup();
          if (lookup != null) {
            lookup.addLookupListener(new MyLookupListener(context));
          }
        }
      }
,"",null);
    }
  }
;
  ApplicationManager.getApplication().invokeLater(runnable);
}
