{
  LOG.info("saving " + rootsToSave);
  for (  VirtualFile root : rootsToSave) {
    final String message=GitHandlerUtil.formatOperationName("Stashing changes from",root);
    LOG.info(message);
    final String oldProgressTitle=myProgressIndicator.getText();
    myProgressIndicator.setText(message);
    GitRepository repository=myRepositoryManager.getRepositoryForRoot(root);
    if (repository == null) {
      LOG.error("Repository is null for root " + root);
    }
 else {
      GitCommandResult result=myGit.stashSave(repository,myStashMessage);
      if (result.success() && !result.getErrorOutputAsJoinedString().contains("No local changes to save")) {
        myStashedRoots.add(root);
      }
 else {
        String error="stash " + repository.getRoot() + ": "+ result.getErrorOutputAsJoinedString();
        if (!result.success()) {
          throw new VcsException(error);
        }
 else {
          LOG.warn(error);
        }
      }
    }
    myProgressIndicator.setText(oldProgressTitle);
  }
}
