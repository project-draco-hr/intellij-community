{
  PsiElement anchor=file.getViewProvider().findElementAt(syncStartOffset,language);
  if (anchor == null)   return null;
  PsiElement result=findParent(syncStartOffset,syncEndOffset,type,anchor);
  if (result == null && syncEndOffset == syncStartOffset && anchor.getTextRange().getStartOffset() == syncEndOffset) {
    anchor=PsiTreeUtil.prevLeaf(anchor,false);
    if (anchor != null) {
      result=findParent(syncStartOffset,syncEndOffset,type,anchor);
    }
  }
  return result;
}
