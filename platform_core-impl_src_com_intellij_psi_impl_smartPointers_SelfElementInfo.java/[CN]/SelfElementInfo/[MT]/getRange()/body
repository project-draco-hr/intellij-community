{
  if (myRangeMarker != null) {
    Document document=getDocumentToSynchronize();
    if (document != null) {
      FrozenDocument frozen=getDocumentManager().getLastCommittedDocument(document);
      List<DocumentEvent> events=getDocumentManager().getEventsSinceCommit(document);
      return getMarkerCache(document).getUpdatedRange(myRangeMarker,frozen,events);
    }
    return myRangeMarker.getRange();
  }
  return myPsiRange;
}
