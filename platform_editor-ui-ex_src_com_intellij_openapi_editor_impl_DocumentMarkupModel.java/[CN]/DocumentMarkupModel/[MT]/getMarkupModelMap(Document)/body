{
  ConcurrentMap<Project,MarkupModelImpl> markupModelMap=document.getUserData(MARKUP_MODEL_MAP_KEY);
  if (markupModelMap == null) {
    ConcurrentMap<Project,MarkupModelImpl> newMap=new ConcurrentHashMap<Project,MarkupModelImpl>();
    markupModelMap=((UserDataHolderEx)document).putUserDataIfAbsent(MARKUP_MODEL_MAP_KEY,newMap);
  }
  return markupModelMap;
}
