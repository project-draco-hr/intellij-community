{
  if (value != null && JAVA_LANG_STRING.equals(varType.name()) && !(value instanceof StringReference)) {
    String v=DebuggerUtils.getValueAsString(context,value);
    if (v != null) {
      value=context.getSuspendContext().getDebugProcess().getVirtualMachineProxy().mirrorOf(v);
    }
  }
  if (value instanceof DoubleValue) {
    double dValue=((DoubleValue)value).doubleValue();
    if (varType instanceof FloatType && Float.MIN_VALUE <= dValue && dValue <= Float.MAX_VALUE) {
      value=context.getSuspendContext().getDebugProcess().getVirtualMachineProxy().mirrorOf((float)dValue);
    }
  }
  if (value != null) {
    if (varType instanceof PrimitiveType) {
      if (!(value instanceof PrimitiveValue)) {
        value=(Value)new UnBoxingEvaluator(new IdentityEvaluator(value)).evaluate(context);
      }
    }
 else     if (varType instanceof ReferenceType) {
      if (value instanceof PrimitiveValue) {
        value=(Value)new BoxingEvaluator(new IdentityEvaluator(value)).evaluate(context);
      }
    }
  }
  return value;
}
