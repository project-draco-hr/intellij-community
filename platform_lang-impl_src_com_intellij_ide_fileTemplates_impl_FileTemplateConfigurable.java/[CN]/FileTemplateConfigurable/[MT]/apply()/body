{
  if (myTemplate != null) {
    myTemplate.setText(myTemplateEditor.getDocument().getText());
    String name=myNameField.getText();
    String extension=myExtensionField.getText();
    String filename=name + "." + extension;
    if (name.length() == 0 || !isValidFilename(filename)) {
      throw new ConfigurationException(IdeBundle.message("error.invalid.template.file.name.or.extension"));
    }
    FileType fileType=FileTypeManager.getInstance().getFileTypeByFileName(filename);
    if (fileType == UnknownFileType.INSTANCE) {
      FileTypeChooser.associateFileType(filename);
    }
    myTemplate.setName(name);
    myTemplate.setExtension(extension);
    myTemplate.setReformatCode(myAdjustBox.isSelected());
    myTemplate.setLiveTemplateEnabled(myLiveTemplateBox.isSelected());
  }
  myModified=false;
}
