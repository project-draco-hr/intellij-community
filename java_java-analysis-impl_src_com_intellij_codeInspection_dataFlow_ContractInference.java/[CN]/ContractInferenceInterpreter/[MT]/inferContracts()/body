{
  List<MethodContract> contracts=doInferContracts();
  if (contracts.isEmpty())   return contracts;
  PsiTypeElement typeElement=myMethod.getReturnTypeElement();
  final PsiType returnType=typeElement == null ? null : typeElement.getType();
  boolean referenceTypeReturned=!(returnType instanceof PsiPrimitiveType);
  final boolean notNull=referenceTypeReturned && NullableNotNullManager.getInstance(myMethod.getProject()).isNotNull(myMethod,false);
  if (referenceTypeReturned) {
    contracts=boxReturnValues(contracts);
  }
  return ContainerUtil.filter(contracts,new Condition<MethodContract>(){
    @Override public boolean value(    MethodContract contract){
      if (notNull && contract.returnValue == NOT_NULL_VALUE) {
        return false;
      }
      return InferenceFromSourceUtil.isReturnTypeCompatible(returnType,contract.returnValue);
    }
  }
);
}
