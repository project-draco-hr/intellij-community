{
  super(new BorderLayout());
  myRepository=repository;
  myProject=myRepository.getProject();
  myMqPatchDir=myRepository.getHgDir().findChild("patches");
  mySeriesFile=myMqPatchDir != null ? new File(myMqPatchDir.getPath(),"series") : null;
  myPatchTable=new MyPatchTable(new MyPatchModel(myRepository.getUnappliedPatchNames()));
  myPatchTable.addFocusListener(new FocusAdapter(){
    @Override public void focusLost(    FocusEvent e){
      updatePatchSeriesInBackground(null);
      super.focusLost(e);
    }
  }
);
  myPatchTable.setShowColumns(true);
  myPatchTable.setFillsViewportHeight(true);
  myPatchTable.getEmptyText().setText("Nothing to show");
  myPatchTable.getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_F2,0),START_EDITING);
  myPatchTable.setDragEnabled(true);
  new TableSpeedSearch(myPatchTable);
  myPatchTable.setDropMode(DropMode.INSERT_ROWS);
  myPatchTable.setTransferHandler(new TableRowsTransferHandler(myPatchTable));
  add(createToolbar(),BorderLayout.WEST);
  JScrollPane scrollPane=ScrollPaneFactory.createScrollPane(myPatchTable);
  add(scrollPane,BorderLayout.CENTER);
  myProject.getMessageBus().connect(myProject).subscribe(HgVcs.STATUS_TOPIC,this);
}
