{
  try {
    Object result=webView.getEngine().executeScript("document.getElementById(\"mydiv\").offsetHeight");
    if (result instanceof Integer) {
      final int fontSize=EditorColorsManager.getInstance().getGlobalScheme().getEditorFontSize();
      double x=(double)source.length() * 8 / (int)result;
      final double height=(source.length() * fontSize) / x + 20;
      final int width=(int)(webView.getWidth() == 0 ? 1500 : webView.getWidth());
      final Dimension size=new Dimension(width,(int)height);
      UIUtil.invokeLaterIfNeeded(new Runnable(){
        @Override public void run(){
          javafxPanel.setPreferredSize(size);
          javafxPanel.revalidate();
          javafxPanel.repaint();
        }
      }
);
    }
  }
 catch (  JSException ignore) {
  }
}
