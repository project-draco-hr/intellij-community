{
  if (!f.isValid()) {
    return null;
  }
  String result=f.getName();
  final PyClass c=f.getContainingClass();
  final VirtualFile vfile=f.getContainingFile().getVirtualFile();
  if (vfile != null) {
    String module=QualifiedNameFinder.findShortestImportableName(callSite != null ? callSite : f,vfile);
    if ("builtins".equals(module)) {
      module="__builtin__";
    }
    result=String.format("%s.%s%s",module,c != null ? c.getName() + "." : "",result);
    final PyQualifiedName qname=PyStdlibCanonicalPathProvider.restoreStdlibCanonicalPath(PyQualifiedName.fromDottedString(result));
    if (qname != null) {
      return qname.toString();
    }
  }
  return result;
}
