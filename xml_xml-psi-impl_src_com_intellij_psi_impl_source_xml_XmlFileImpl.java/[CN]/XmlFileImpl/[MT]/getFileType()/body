{
  if (myType == null) {
    myType=getLanguage().getAssociatedFileType();
    if (myType == null) {
      VirtualFile virtualFile=getOriginalFile().getVirtualFile();
      myType=virtualFile == null ? FileTypeRegistry.getInstance().getFileTypeByFileName(getName()) : virtualFile.getFileType();
    }
  }
  return myType;
}
