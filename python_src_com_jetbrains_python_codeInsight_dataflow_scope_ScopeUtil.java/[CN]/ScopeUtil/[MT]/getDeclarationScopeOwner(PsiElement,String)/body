{
  PsiElement element=anchor;
  if (name != null) {
    if (PsiTreeUtil.getParentOfType(anchor,PyParameter.class,PyDecorator.class) != null) {
      element=getScopeOwner(anchor);
    }
    final ScopeOwner originalScopeOwner=getScopeOwner(element);
    ScopeOwner scopeOwner=originalScopeOwner;
    while (scopeOwner != null) {
      if (!(scopeOwner instanceof PyClass) || scopeOwner == originalScopeOwner) {
        Scope scope=ControlFlowCache.getScope(scopeOwner);
        if (scope.containsDeclaration(name)) {
          return scopeOwner;
        }
      }
      scopeOwner=getScopeOwner(scopeOwner);
    }
  }
  return null;
}
