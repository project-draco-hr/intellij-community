{
  final PsiExpression expression=super.getExpressionFromEditor();
  if (expression != null) {
    return expression;
  }
  final PsiExpression expr=PsiTreeUtil.getParentOfType(getFile().findElementAt(getEditor().getCaretModel().getOffset()),PsiExpression.class);
  if (expr == null && InjectedLanguageManager.getInstance(getProject()).isInjectedFragment(getFile())) {
    return PsiTreeUtil.getParentOfType(InjectedLanguageUtil.getTopLevelFile(getFile()).findElementAt(InjectedLanguageUtil.getTopLevelEditor(getEditor()).getCaretModel().getOffset()),PsiExpression.class);
  }
  return expr instanceof PsiLiteralExpression ? expr : null;
}
