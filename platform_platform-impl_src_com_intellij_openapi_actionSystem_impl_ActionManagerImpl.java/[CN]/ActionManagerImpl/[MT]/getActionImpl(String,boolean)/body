{
  AnAction action;
synchronized (myLock) {
    action=myId2Action.get(id);
    if (canReturnStub || !(action instanceof ActionStub)) {
      return action;
    }
  }
  AnAction converted=convertStub((ActionStub)action);
synchronized (myLock) {
    action=myId2Action.get(id);
    if (action instanceof ActionStub) {
      action=replaceStub((ActionStub)action,converted);
    }
    return action;
  }
}
