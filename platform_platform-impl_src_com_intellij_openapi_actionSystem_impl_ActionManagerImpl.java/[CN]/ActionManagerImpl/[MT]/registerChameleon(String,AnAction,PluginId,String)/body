{
  ProjectType type=projectType == null ? null : new ProjectType(projectType);
  AnAction o=myId2Action.get(actionId);
  ChameleonAction chameleonAction;
  if (o == null) {
    chameleonAction=new ChameleonAction(action,type);
    myId2Action.put(actionId,chameleonAction);
    return chameleonAction;
  }
  if (o instanceof ChameleonAction) {
    chameleonAction=(ChameleonAction)o;
  }
 else {
    chameleonAction=new ChameleonAction(o,type);
    myId2Action.put(actionId,chameleonAction);
  }
  AnAction old=chameleonAction.addAction(action,type);
  if (old != null) {
    reportActionError(pluginId,"action with the ID \"" + actionId + "\" was already registered. Action being registered is "+ action+ "; Registered action is "+ myId2Action.get(actionId)+ getPluginInfo(pluginId));
    return null;
  }
  return chameleonAction;
}
