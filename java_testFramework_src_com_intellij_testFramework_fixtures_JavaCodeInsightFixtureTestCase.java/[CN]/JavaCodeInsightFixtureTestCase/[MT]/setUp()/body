{
  super.setUp();
  final TestFixtureBuilder<IdeaProjectTestFixture> projectBuilder=IdeaTestFixtureFactory.getFixtureFactory().createFixtureBuilder(getName());
  myFixture=JavaTestFixtureFactory.getFixtureFactory().createCodeInsightFixture(projectBuilder.getFixture());
  final JavaModuleFixtureBuilder moduleFixtureBuilder=projectBuilder.addModule(JavaModuleFixtureBuilder.class);
  if (toAddSourceRoot()) {
    moduleFixtureBuilder.addSourceContentRoot(myFixture.getTempDirPath());
  }
 else {
    moduleFixtureBuilder.addContentRoot(myFixture.getTempDirPath());
  }
  tuneFixture(moduleFixtureBuilder);
  myFixture.setUp();
  myFixture.setTestDataPath(getTestDataPath());
  myModule=moduleFixtureBuilder.getFixture().getModule();
  LanguageLevelProjectExtension.getInstance(getProject()).setLanguageLevel(LanguageLevel.JDK_1_6);
}
