{
  final XmlTag entry=createPropertyTag(key,value);
  if (myInfo.getValue().isSorted()) {
    final XmlProperty dummyProperty=new XmlProperty(entry,this);
    final int insertIndex=Collections.binarySearch(myInfo.getValue().getPropertiesOrder(),dummyProperty,new Comparator<IProperty>(){
      @Override public int compare(      IProperty p1,      IProperty p2){
        final String k1=p1.getKey();
        final String k2=p2.getKey();
        return k1.compareTo(k2);
      }
    }
);
    final IProperty insertPosition;
    final IProperty inserted;
    if (insertIndex == -1) {
      inserted=addPropertyAfterAndCheckAlphaSorting(key,value,null,false,false);
      myInfo.getValue().getPropertiesOrder().add(0,inserted);
    }
 else {
      final int position=insertIndex < 0 ? -insertIndex - 2 : insertIndex;
      insertPosition=myInfo.getValue().getPropertiesOrder().get(position);
      inserted=addPropertyAfterAndCheckAlphaSorting(key,value,insertPosition,false,false);
      myInfo.getValue().getPropertiesOrder().add(position + 1,inserted);
    }
    return inserted;
  }
 else {
    return addPropertyAfterAndCheckAlphaSorting(key,value,null,true,false);
  }
}
