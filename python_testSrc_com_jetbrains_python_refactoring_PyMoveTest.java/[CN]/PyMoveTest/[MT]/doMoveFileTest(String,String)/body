{
  Project project=myFixture.getProject();
  PsiManager manager=PsiManager.getInstance(project);
  String root="/refactoring/move/" + getTestName(true);
  String rootBefore=root + "/before/src";
  String rootAfter=root + "/after/src";
  VirtualFile dir1=myFixture.copyDirectoryToProject(rootBefore,"");
  PsiDocumentManager.getInstance(project).commitAllDocuments();
  VirtualFile virtualFile=dir1.findFileByRelativePath(fileName);
  assertNotNull(virtualFile);
  PsiElement file=manager.findFile(virtualFile);
  if (file == null) {
    file=manager.findDirectory(virtualFile);
  }
  assertNotNull(file);
  VirtualFile toVirtualDir=dir1.findFileByRelativePath(toDirName);
  assertNotNull(toVirtualDir);
  PsiDirectory toDir=manager.findDirectory(toVirtualDir);
  new MoveFilesOrDirectoriesProcessor(project,new PsiElement[]{file},toDir,false,false,null,null).run();
  VirtualFile dir2=getVirtualFileByName(PythonTestUtil.getTestDataPath() + rootAfter);
  try {
    PlatformTestUtil.assertDirectoriesEqual(dir2,dir1,null);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
