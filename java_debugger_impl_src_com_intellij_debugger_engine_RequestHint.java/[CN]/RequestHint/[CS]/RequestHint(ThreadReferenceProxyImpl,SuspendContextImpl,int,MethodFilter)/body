{
  final DebugProcessImpl debugProcess=suspendContext.getDebugProcess();
  myDepth=depth;
  myMethodFilter=methodFilter;
  myVirtualMachineProxy=debugProcess.getVirtualMachineProxy();
  int frameCount=0;
  SourcePosition position=null;
  try {
    frameCount=stepThread.frameCount();
    position=ApplicationManager.getApplication().runReadAction(new Computable<SourcePosition>(){
      public SourcePosition compute(){
        return ContextUtil.getSourcePosition(new StackFrameContext(){
          public StackFrameProxy getFrameProxy(){
            try {
              return stepThread.frame(0);
            }
 catch (            EvaluateException e) {
              if (LOG.isDebugEnabled()) {
                LOG.debug(e);
              }
              return null;
            }
          }
          public DebugProcess getDebugProcess(){
            return suspendContext.getDebugProcess();
          }
        }
);
      }
    }
);
  }
 catch (  Exception e) {
    LOG.info(e);
  }
 finally {
    myFrameCount=frameCount;
    myPosition=position;
  }
}
