{
  if (ApplicationManager.getApplication().isUnitTestMode() && myHost != null) {
    return myHost;
  }
  if (element == null) {
    return null;
  }
  PsiLanguageInjectionHost injectionHost=InjectedLanguageManager.getInstance(element.getProject()).getInjectionHost(element);
  final RegExpLanguageHost host=getRegExpHost(injectionHost);
  if (host != null) {
    return host;
  }
  final PsiFile file=element.getContainingFile();
  final SmartPsiElementPointer pointer=file.getUserData(FileContextUtil.INJECTED_IN_ELEMENT);
  if (pointer == null) {
    return null;
  }
  final PsiElement pointerElement=pointer.getElement();
  if (pointerElement == null) {
    return null;
  }
  return getRegExpHost(pointerElement);
}
