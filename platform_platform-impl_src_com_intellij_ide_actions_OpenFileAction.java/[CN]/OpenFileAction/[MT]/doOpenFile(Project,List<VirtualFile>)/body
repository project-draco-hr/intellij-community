{
  for (  final VirtualFile file : result) {
    if (file.isDirectory()) {
      Project openedProject;
      if (ProjectAttachProcessor.canAttachToProject()) {
        openedProject=PlatformProjectOpenProcessor.doOpenProject(file,project,false,-1,null,false);
      }
 else {
        openedProject=ProjectUtil.openOrImport(file.getPath(),project,false);
      }
      FileChooserUtil.setLastOpenedFile(openedProject,file);
      return;
    }
    if (OpenProjectFileChooserDescriptor.isProjectFile(file) && (project == null || !file.equals(project.getProjectFile()))) {
      Project openedProject=ProjectUtil.openOrImport(file.getPath(),project,false);
      if (openedProject != null) {
        FileChooserUtil.setLastOpenedFile(openedProject,file);
        return;
      }
    }
    FileType type=FileTypeChooser.getKnownFileTypeOrAssociate(file,project);
    if (type == null)     return;
    if (project != null) {
      openFile(file,project);
    }
 else {
      PlatformProjectOpenProcessor processor=PlatformProjectOpenProcessor.getInstanceIfItExists();
      if (processor != null) {
        processor.doOpenProject(file,null,false);
      }
    }
  }
}
