{
  FileEditorManager fileEditorManager=FileEditorManager.getInstance(myProject);
  Editor selectedTextEditor=fileEditorManager.getSelectedTextEditor();
  if (selectedTextEditor != null) {
    selectElementAtCaret(selectedTextEditor,false);
    return;
  }
  final FileEditor[] editors=fileEditorManager.getSelectedEditors();
  for (  FileEditor fileEditor : editors) {
    if (fileEditor instanceof TextEditor) {
      Editor editor=((TextEditor)fileEditor).getEditor();
      selectElementAtCaret(editor,false);
      return;
    }
  }
  final VirtualFile[] selectedFiles=fileEditorManager.getSelectedFiles();
  if (selectedFiles.length > 0) {
    PsiFile file=PsiManager.getInstance(myProject).findFile(selectedFiles[0]);
    selectFile(file,false);
  }
}
