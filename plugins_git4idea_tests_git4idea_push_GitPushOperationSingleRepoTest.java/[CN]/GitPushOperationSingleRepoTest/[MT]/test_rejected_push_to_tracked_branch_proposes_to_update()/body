{
  pushCommitFromBro();
  final Ref<Boolean> dialogShown=Ref.create(false);
  myDialogManager.registerDialogHandler(GitRejectedPushUpdateDialog.class,new TestDialogHandler<GitRejectedPushUpdateDialog>(){
    @Override public int handleDialog(    GitRejectedPushUpdateDialog dialog){
      dialogShown.set(true);
      return DialogWrapper.CANCEL_EXIT_CODE;
    }
  }
);
  GitPushResult result=push("master","origin/master");
  assertTrue("Rejected push dialog wasn't shown",dialogShown.get());
  assertResult(REJECTED,-1,"master","origin/master",result);
}
