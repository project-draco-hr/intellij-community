{
  pushCommitFromBro();
  cd(myRepository);
  git("checkout -b branch1");
  makeCommit("branch1.txt");
  git("checkout master");
  makeCommit("master.txt");
  git("merge branch1");
  myGitSettings.setAutoUpdateIfPushRejected(true);
  GitPushSettings.getInstance(myProject).setUpdateMethod(UpdateMethod.REBASE);
  final Ref<Boolean> rebaseOverMergeProblemDetected=Ref.create(false);
  myDialogManager.registerMessageHandler(new TestMessageHandler(){
    @Override public int handleMessage(    @NotNull String description){
      rebaseOverMergeProblemDetected.set(description.contains(GitRebaseOverMergeProblem.DESCRIPTION));
      return Messages.CANCEL;
    }
  }
);
  push("master","origin/master");
  assertTrue(rebaseOverMergeProblemDetected.get());
}
