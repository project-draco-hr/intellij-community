{
  FileDocumentManager.getInstance().saveAllDocuments();
  ExecutionResult executionResult;
  RunProfile profile=env.getRunProfile();
  if (state instanceof PythonTestCommandLineStateBase) {
    if (!((PythonTestCommandLineStateBase)state).isRerunEnabled()) {
      throw new ExecutionException(PyBundle.message("runcfg.tests.cant_rerun"));
    }
  }
  if (state instanceof PythonCommandLineState && profile instanceof CommandLinePatcher) {
    executionResult=((PythonCommandLineState)state).execute(env.getExecutor(),(CommandLinePatcher)profile);
  }
 else {
    executionResult=state.execute(env.getExecutor(),this);
  }
  return executionResult == null ? null : new RunContentBuilder(executionResult,env).showRunContent(env.getContentToReuse());
}
