{
  final PsiClass psiClass=JavaExecutionUtil.findMainClass(module,mainClassName);
  if (psiClass == null) {
    return null;
  }
  final PsiFile psiFile=psiClass.getContainingFile();
  if (psiFile == null)   return null;
  final VirtualFile virtualFile=psiFile.getVirtualFile();
  if (virtualFile == null)   return null;
  Module classModule=psiClass.isValid() ? ModuleUtilCore.findModuleForPsiElement(psiClass) : null;
  if (classModule == null)   classModule=module;
  ModuleFileIndex fileIndex=ModuleRootManager.getInstance(classModule).getFileIndex();
  if (fileIndex.isInSourceContent(virtualFile)) {
    return !fileIndex.isInTestSourceContent(virtualFile);
  }
  final List<OrderEntry> entriesForFile=fileIndex.getOrderEntriesForFile(virtualFile);
  for (  OrderEntry entry : entriesForFile) {
    if (entry instanceof ExportableOrderEntry && ((ExportableOrderEntry)entry).getScope() == DependencyScope.TEST) {
      return false;
    }
  }
  return true;
}
