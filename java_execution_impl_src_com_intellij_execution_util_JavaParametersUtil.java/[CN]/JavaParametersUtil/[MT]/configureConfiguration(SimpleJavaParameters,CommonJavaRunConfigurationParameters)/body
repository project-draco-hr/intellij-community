{
  ProgramParametersUtil.configureConfiguration(parameters,configuration);
  Project project=configuration.getProject();
  Module module=ProgramParametersUtil.getModule(configuration);
  String alternativeJrePath=configuration.getAlternativeJrePath();
  if (alternativeJrePath != null) {
    configuration.setAlternativeJrePath(ProgramParametersUtil.expandPath(alternativeJrePath,null,project));
  }
  String vmParameters=configuration.getVMParameters();
  if (vmParameters != null) {
    vmParameters=ProgramParametersUtil.expandPath(vmParameters,module,project);
    for (    Map.Entry<String,String> each : parameters.getEnv().entrySet()) {
      vmParameters=StringUtil.replace(vmParameters,"$" + each.getKey() + "$",each.getValue(),false);
    }
  }
  parameters.getVMParametersList().addParametersString(vmParameters);
}
