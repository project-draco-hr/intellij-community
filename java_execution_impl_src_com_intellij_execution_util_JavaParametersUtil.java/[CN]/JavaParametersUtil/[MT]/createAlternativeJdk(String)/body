{
  final Sdk configuredJdk=ProjectJdkTable.getInstance().findJdk(jreHome);
  if (configuredJdk != null) {
    return configuredJdk;
  }
  if (JdkUtil.checkForJdk(jreHome)) {
    throw new CantRunException(ExecutionBundle.message("jre.path.is.jdk.error.message"));
  }
  if (!JdkUtil.checkForJre(jreHome)) {
    throw new CantRunException(ExecutionBundle.message("jre.path.is.not.valid.jre.home.error.message",jreHome));
  }
  final Sdk jdk=JavaSdk.getInstance().createJdk("",jreHome);
  if (jdk == null)   throw CantRunException.noJdkConfigured();
  return jdk;
}
