{
  final Cipher ciph=Cipher.getInstance("AES/CBC/PKCS5Padding");
  ciph.init(Cipher.ENCRYPT_MODE,key);
  final byte[] body=ciph.doFinal(msgBytes);
  final byte[] iv=ciph.getIV();
  final byte[] data=new byte[4 + iv.length + body.length];
  final int length=body.length;
  data[0]=(byte)((length >> 24) & 0xFF);
  data[1]=(byte)((length >> 16) & 0xFF);
  data[2]=(byte)((length >> 8) & 0xFF);
  data[3]=(byte)(length & 0xFF);
  System.arraycopy(iv,0,data,4,iv.length);
  System.arraycopy(body,0,data,4 + iv.length,body.length);
  return data;
}
