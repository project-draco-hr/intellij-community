{
  ApplicationManager.getApplication().assertReadAccessAllowed();
  List<FoldedRangeState> ranges=new ArrayList<FoldedRangeState>();
  for (  FoldedBlock folding : myFoldings) {
    FoldRegion region=folding.getRegion(index);
    if (region == null || !region.isValid())     continue;
    DocumentEx document=myEditors[index].getDocument();
    int line1=document.getLineNumber(region.getStartOffset());
    int line2=document.getLineNumber(region.getEndOffset()) + 1;
    ranges.add(new FoldedRangeState(line1,line2,region.isExpanded()));
  }
  return ranges;
}
