{
  Graphics2D g=(Graphics2D)graphics;
  final JTextComponent c=getComponent();
  final Container parent=c.getParent();
  if (c.isOpaque() && parent != null) {
    g.setColor(parent.getBackground());
    g.fillRect(0,0,c.getWidth(),c.getHeight());
  }
  if (c.getBorder() instanceof MacIntelliJTextBorder) {
    g.setColor(c.getBackground());
    g.fillRect(3,3,c.getWidth() - 6,c.getHeight() - 6);
  }
 else {
    super.paintBackground(g);
  }
}
