{
  final MessageBusConnection connection=bus.connect();
  connection.subscribe(ChangeListManagerImpl.LISTS_LOADED,new LocalChangeListsLoadedListener(){
    @Override public void processLoadedLists(    final List<LocalChangeList> lists){
      if (lists.isEmpty())       return;
      try {
        ChangeListManager.getInstance(myProject).setReadOnly(LocalChangeList.DEFAULT_NAME,true);
        if (!myConfiguration.changeListsSynchronized()) {
          processChangeLists(lists);
        }
      }
 catch (      ProcessCanceledException e) {
      }
 finally {
        myConfiguration.upgrade();
      }
      connection.disconnect();
    }
  }
);
}
