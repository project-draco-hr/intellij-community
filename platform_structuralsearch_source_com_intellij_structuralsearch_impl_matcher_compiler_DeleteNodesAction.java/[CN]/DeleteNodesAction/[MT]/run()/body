{
  try {
    PsiElement first=null;
    PsiElement last=null;
    for (int i=0; i < elements.size(); ++i) {
      final PsiElement el=(PsiElement)elements.get(i);
      if (!el.isValid())       continue;
      if (first == null) {
        first=last=el;
      }
 else       if (last.getNextSibling() == el) {
        last=el;
      }
 else {
        delete(first,last);
        first=last=null;
        --i;
        continue;
      }
    }
    if (first != null) {
      delete(first,last);
    }
  }
 catch (  Throwable ex) {
    ex.printStackTrace();
  }
 finally {
    elements.clear();
  }
}
