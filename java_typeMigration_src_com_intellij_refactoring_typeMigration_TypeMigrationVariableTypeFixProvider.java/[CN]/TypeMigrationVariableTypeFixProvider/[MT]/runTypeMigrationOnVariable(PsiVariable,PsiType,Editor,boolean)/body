{
  Project project=variable.getProject();
  if (!FileModificationService.getInstance().prepareFileForWrite(variable.getContainingFile()))   return;
  try {
    variable.normalizeDeclaration();
    final TypeMigrationRules rules=new TypeMigrationRules();
    rules.setBoundScope(GlobalSearchScope.projectScope(project));
    TypeMigrationProcessor.runHighlightingTypeMigration(project,editor,rules,variable,targetType,optimizeImports);
    JavaCodeStyleManager.getInstance(project).shortenClassReferences(variable);
    UndoUtil.markPsiFileForUndo(variable.getContainingFile());
  }
 catch (  IncorrectOperationException e) {
    LOG1.error(e);
  }
}
