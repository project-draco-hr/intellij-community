{
  GitPushTarget target=pushSpec.getTarget();
  GitLocalBranch sourceBranch=pushSpec.getSource().getBranch();
  GitRemoteBranch targetBranch=target.getBranch();
  GitLineHandlerListener progressListener=GitStandardProgressAnalyzer.createListener(myProgressIndicator);
  boolean setUpstream=pushSpec.getTarget().isNewBranchCreated() && !branchTrackingInfoIsSet(repository,sourceBranch);
  String tagMode=myTagMode == null ? null : myTagMode.getArgument();
  GitCommandResult res=myGit.push(repository,sourceBranch,targetBranch,myForce,setUpstream,tagMode,progressListener);
  List<GitPushNativeResult> result=GitPushNativeResultParser.parse(res.getOutput());
  if (result.isEmpty()) {
    return Pair.create(null,res.getErrorOutputAsJoinedString());
  }
  return Pair.create(result,null);
}
