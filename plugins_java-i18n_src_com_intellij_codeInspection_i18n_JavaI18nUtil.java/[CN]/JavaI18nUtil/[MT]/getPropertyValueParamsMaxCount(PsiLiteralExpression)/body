{
  int maxCount=-1;
  for (  PsiReference reference : expression.getReferences()) {
    if (reference instanceof PsiPolyVariantReference) {
      for (      ResolveResult result : ((PsiPolyVariantReference)reference).multiResolve(false)) {
        if (result.isValidResult() && result.getElement() instanceof IProperty) {
          try {
            final IProperty property=(IProperty)result.getElement();
            final String propertyValue=property.getValue();
            if (propertyValue == null) {
              continue;
            }
            maxCount=Math.max(maxCount,getPropertyValuePlaceholdersCount(propertyValue));
          }
 catch (          IllegalArgumentException ignored) {
          }
        }
      }
    }
  }
  return maxCount;
}
