{
  final ContentRevision bRev=change.getBeforeRevision();
  final ContentRevision aRev=change.getAfterRevision();
  if (bRev == null && aRev == null) {
    LOG.warn("Both revision contents are empty");
    throw new DiffRequestPresentableException("Bad revisions contents");
  }
  if (bRev != null)   checkContentRevision(project,bRev,context,indicator);
  if (aRev != null)   checkContentRevision(project,aRev,context,indicator);
  String title=getRequestTitle(bRev,aRev);
  indicator.setIndeterminate(true);
  DiffContent content1=createContent(project,bRev,indicator);
  DiffContent content2=createContent(project,aRev,indicator);
  String beforeRevisionTitle=getRevisionTitle(bRev,"Base version");
  String afterRevisionTitle=getRevisionTitle(aRev,"Your version");
  return new SimpleDiffRequest(title,content1,content2,beforeRevisionTitle,afterRevisionTitle);
}
