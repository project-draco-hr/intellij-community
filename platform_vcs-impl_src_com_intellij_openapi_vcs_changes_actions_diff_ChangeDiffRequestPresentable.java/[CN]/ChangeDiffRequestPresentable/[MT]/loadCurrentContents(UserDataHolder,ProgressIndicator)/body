{
  DiffRequest request=null;
  for (  ChangeDiffRequestProvider provider : ChangeDiffRequestProvider.EP_NAME.getExtensions()) {
    if (provider.canCreate(myProject,myChange)) {
      request=provider.process(this,context,indicator);
      break;
    }
  }
  if (request == null)   request=createRequest(myProject,myChange,context,indicator);
  request.putUserData(CONTENT_REVISIONS,new ContentRevision[]{myChange.getBeforeRevision(),myChange.getAfterRevision()});
  for (  Map.Entry<Key,Object> entry : myChangeContext.entrySet()) {
    request.putUserData(entry.getKey(),entry.getValue());
  }
  DataProvider dataProvider=request.getUserData(DiffUserDataKeys.DATA_PROVIDER);
  if (dataProvider == null) {
    dataProvider=new GenericDataProvider();
    request.putUserData(DiffUserDataKeys.DATA_PROVIDER,dataProvider);
  }
  if (dataProvider instanceof GenericDataProvider)   ((GenericDataProvider)dataProvider).putData(VcsDataKeys.CURRENT_CHANGE,myChange);
  return request;
}
