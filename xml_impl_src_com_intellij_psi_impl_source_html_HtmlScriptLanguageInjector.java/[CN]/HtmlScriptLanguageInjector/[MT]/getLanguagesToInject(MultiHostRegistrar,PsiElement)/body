{
  if (!host.isValid() || !(host instanceof XmlText) || !HtmlUtil.isHtmlTagContainingFile(host)) {
    return;
  }
  XmlTag scriptTag=((XmlText)host).getParentTag();
  if (scriptTag == null || !HtmlUtil.isScriptTag(scriptTag)) {
    return;
  }
  String mimeType=scriptTag.getAttributeValue("type");
  Collection<Language> languages=Language.findInstancesByMimeType(mimeType);
  Language language;
  if (!languages.isEmpty()) {
    language=languages.iterator().next();
  }
 else   if (mimeType != null && mimeType.contains("template")) {
    language=StdLanguages.HTML;
  }
 else {
    language=StdLanguages.TEXT;
  }
  if (LanguageUtil.isInjectableLanguage(language)) {
    registrar.startInjecting(language).addPlace(null,null,(PsiLanguageInjectionHost)host,TextRange.create(0,host.getTextLength())).doneInjecting();
  }
}
