{
  for (  VirtualFile root : hierarchy) {
    Module module=myRoots.contentRootOf.get(root);
    Module excludedFromModule=myRoots.excludedFromModule.get(root);
    if (module != null && excludedFromModule != module) {
      return root;
    }
    if (myRoots.excludedFromProject.contains(root) || excludedFromModule != null || !root.isDirectory()) {
      return null;
    }
  }
  return null;
}
