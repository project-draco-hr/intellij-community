{
  int count=0;
  for (VirtualFile root=dir; root != null; root=root.getParent()) {
    if (++count > 1000) {
      throw new IllegalStateException("Possible loop in tree");
    }
    final DirectoryInfo info=myRoots.get(root);
    if (info != null) {
      return info;
    }
    if (isAnyExcludeRoot(root)) {
      return null;
    }
  }
  return null;
}
