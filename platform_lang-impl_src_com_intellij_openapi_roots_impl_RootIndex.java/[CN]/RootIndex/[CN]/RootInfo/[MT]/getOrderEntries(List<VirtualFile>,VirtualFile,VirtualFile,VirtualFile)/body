{
  LinkedHashSet<OrderEntry> orderEntries=ContainerUtil.newLinkedHashSet();
  collectLibraryOrderEntries(hierarchy,libraryClassRoot,librarySourceRoot,orderEntries);
  collectDependencyOrderEntries(hierarchy,orderEntries);
  if (moduleContentRoot != null) {
    ContainerUtil.addIfNotNull(orderEntries,getModuleSourceEntry(hierarchy,moduleContentRoot));
  }
  if (orderEntries.isEmpty()) {
    return null;
  }
  OrderEntry[] array=orderEntries.toArray(new OrderEntry[orderEntries.size()]);
  Arrays.sort(array,DirectoryInfo.BY_OWNER_MODULE);
  return array;
}
