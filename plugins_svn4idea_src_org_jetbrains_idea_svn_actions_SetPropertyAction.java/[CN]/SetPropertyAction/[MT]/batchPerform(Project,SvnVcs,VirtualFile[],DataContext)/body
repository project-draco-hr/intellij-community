{
  File[] ioFiles=new File[file.length];
  for (int i=0; i < ioFiles.length; i++) {
    ioFiles[i]=new File(file[i].getPath());
  }
  SetPropertyDialog dialog=new SetPropertyDialog(project,ioFiles,null,true);
  if (dialog.showAndGet()) {
    String name=dialog.getPropertyName();
    String value=dialog.getPropertyValue();
    boolean recursive=dialog.isRecursive();
    for (int i=0; i < ioFiles.length; i++) {
      File ioFile=ioFiles[i];
      PropertyClient client=activeVcs.getFactory(ioFile).createPropertyClient();
      client.setProperty(ioFile,name,PropertyValue.create(value),Depth.allOrFiles(recursive),false);
    }
    for (int i=0; i < file.length; i++) {
      if (recursive && file[i].isDirectory()) {
        VcsDirtyScopeManager.getInstance(project).dirDirtyRecursively(file[i],true);
      }
 else {
        VcsDirtyScopeManager.getInstance(project).fileDirty(file[i]);
      }
    }
    ;
  }
}
