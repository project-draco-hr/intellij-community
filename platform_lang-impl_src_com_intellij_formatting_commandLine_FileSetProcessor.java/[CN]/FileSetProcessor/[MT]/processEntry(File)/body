{
  if (entry.exists()) {
    if (entry.isDirectory()) {
      LOG.info("Scanning directory " + entry.getPath());
      File[] subEntries=entry.listFiles();
      if (subEntries != null) {
        for (        File subEntry : subEntries) {
          if (!subEntry.isDirectory() || isRecursive) {
            processEntry(subEntry);
          }
        }
      }
    }
 else {
      if (matchesFileMask(entry.getName())) {
        VirtualFile virtualFile=LocalFileSystem.getInstance().refreshAndFindFileByIoFile(entry);
        if (virtualFile == null) {
          throw new IOException("Can not find " + entry.getPath());
        }
        LOG.info("Processing " + virtualFile.getPath());
        if (processFile(virtualFile))         myProcessedFiles++;
      }
    }
  }
}
