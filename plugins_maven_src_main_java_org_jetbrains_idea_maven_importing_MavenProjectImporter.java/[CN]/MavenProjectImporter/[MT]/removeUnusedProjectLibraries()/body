{
  Set<Library> unusedLibraries=new HashSet<Library>();
  Collections.addAll(unusedLibraries,myModelsProvider.getAllLibraries());
  for (  ModuleRootModel eachModel : collectModuleModels()) {
    for (    OrderEntry eachEntry : eachModel.getOrderEntries()) {
      if (eachEntry instanceof LibraryOrderEntry) {
        unusedLibraries.remove(((LibraryOrderEntry)eachEntry).getLibrary());
      }
    }
  }
  boolean removed=false;
  for (  Library each : unusedLibraries) {
    if (!isDisposed(each) && MavenRootModelAdapter.isMavenLibrary(each) && !MavenRootModelAdapter.isChangedByUser(each)) {
      myModelsProvider.removeLibrary(each);
      removed=true;
    }
  }
  return removed;
}
