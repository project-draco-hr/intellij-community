{
  PsiType type=RefactoringChangeUtil.getTypeByExpression(expr);
  if (PsiType.NULL.equals(type)) {
    ExpectedTypeInfo[] infos=ExpectedTypesProvider.getInstance(expr.getProject()).getExpectedTypes(expr,false);
    if (infos.length == 1) {
      type=infos[0].getType();
    }
 else {
      type=factory.createTypeByFQClassName(CommonClassNames.JAVA_LANG_OBJECT,expr.getResolveScope());
    }
  }
  return type;
}
