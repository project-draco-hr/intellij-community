{
  FeatureUsageTracker.getInstance().triggerFeatureUsed("scratch");
  VirtualFile file=ScratchpadManager.getInstance(project).createScratchFile(substitute(project,language));
  PsiFile psiFile=PsiManager.getInstance(project).findFile(file);
  final Document document=psiFile == null ? null : PsiDocumentManager.getInstance(project).getDocument(psiFile);
  if (document != null && StringUtil.isNotEmpty(text)) {
    ApplicationManager.getApplication().runWriteAction(new Runnable(){
      @Override public void run(){
        document.setText(text);
      }
    }
);
  }
  FileEditorManager.getInstance(project).openFile(file,true);
}
