{
  ImageDocument document=imageComponent.getDocument();
  BufferedImage previousImage=document.getValue();
  document.setValue(image);
  if (image == null)   return;
  document.setFormat(format);
  ImageZoomModel zoomModel=getZoomModel();
  if (previousImage == null || !zoomModel.isZoomLevelChanged()) {
    Options options=OptionsManager.getInstance().getOptions();
    ZoomOptions zoomOptions=options.getEditorOptions().getZoomOptions();
    zoomModel.setZoomFactor(1.0d);
    if (zoomOptions.isSmartZooming()) {
      Dimension prefferedSize=zoomOptions.getPrefferedSize();
      if (prefferedSize.width > image.getWidth() && prefferedSize.height > image.getHeight()) {
        double factor=(prefferedSize.getWidth() / (double)image.getWidth() + prefferedSize.getHeight() / (double)image.getHeight()) / 2.0d;
        zoomModel.setZoomFactor(Math.ceil(factor));
      }
    }
  }
}
