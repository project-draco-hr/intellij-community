{
  MultiMap<VirtualFile,String> hashesByRoots=new MultiMap<VirtualFile,String>();
  for (  Node node : nodes) {
    VcsRef ref=findRefByNode(node);
    if (ref == null) {
      LOG.info("Couldn't find ref for hash " + node.getCommitHash());
      continue;
    }
    VirtualFile root=ref.getRoot();
    hashesByRoots.putValue(root,node.getCommitHash().toStrHash());
  }
  for (  Map.Entry<VirtualFile,Collection<String>> entry : hashesByRoots.entrySet()) {
    List<? extends T> details=readDetails(myLogProviders.get(entry.getKey()),entry.getKey(),new ArrayList<String>(entry.getValue()));
    saveInCache(details);
  }
}
