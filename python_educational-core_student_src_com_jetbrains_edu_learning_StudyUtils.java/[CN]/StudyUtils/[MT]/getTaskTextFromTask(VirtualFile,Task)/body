{
  if (task == null) {
    return null;
  }
  String text=getFromTask(task);
  if (text != null && !text.isEmpty()) {
    return text;
  }
  if (taskDirectory != null) {
    String fileNameWithoutExtension=FileUtil.getNameWithoutExtension(EduNames.TASK_HTML);
    int activeStepIndex=task.getActiveStepIndex();
    if (activeStepIndex != -1) {
      fileNameWithoutExtension+=EduNames.STEP_MARKER + activeStepIndex;
    }
    final String prefix=String.format(ourPrefix,EditorColorsManager.getInstance().getGlobalScheme().getEditorFontSize());
    final String taskTextFileHtml=getTaskTextFromTaskName(taskDirectory,fileNameWithoutExtension + "." + FileUtilRt.getExtension(EduNames.TASK_HTML));
    if (taskTextFileHtml != null)     return prefix + taskTextFileHtml + ourPostfix;
    final String taskTextFileMd=getTaskTextFromTaskName(taskDirectory,fileNameWithoutExtension + "." + FileUtilRt.getExtension(EduNames.TASK_MD));
    if (taskTextFileMd != null)     return prefix + convertToHtml(taskTextFileMd) + ourPostfix;
  }
  return null;
}
