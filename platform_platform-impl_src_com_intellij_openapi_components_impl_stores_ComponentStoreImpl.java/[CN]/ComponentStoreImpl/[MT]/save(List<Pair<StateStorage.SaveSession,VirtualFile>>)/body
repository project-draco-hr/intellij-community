{
  ExternalizationSession externalizationSession=myComponents.isEmpty() ? null : getStateStorageManager().startExternalization();
  if (externalizationSession != null) {
    String[] names=ArrayUtilRt.toStringArray(myComponents.keySet());
    Arrays.sort(names);
    for (    String name : names) {
      Object component=myComponents.get(name);
      commitComponent(externalizationSession,component);
    }
  }
  for (  SettingsSavingComponent settingsSavingComponent : mySettingsSavingComponents) {
    try {
      settingsSavingComponent.save();
    }
 catch (    Throwable e) {
      LOG.error(e);
    }
  }
  doSave(externalizationSession == null ? null : externalizationSession.createSaveSessions(),readonlyFiles);
}
