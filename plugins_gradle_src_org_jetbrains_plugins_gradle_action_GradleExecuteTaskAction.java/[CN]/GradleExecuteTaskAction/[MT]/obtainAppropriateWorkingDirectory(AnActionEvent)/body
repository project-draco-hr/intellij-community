{
  final List<ExternalSystemNode> selectedNodes=ExternalSystemDataKeys.SELECTED_NODES.getData(e.getDataContext());
  if (selectedNodes == null || selectedNodes.size() != 1) {
    final Module module=ExternalSystemActionUtil.getModule(e.getDataContext());
    String projectPath=ExternalSystemApiUtil.getExternalProjectPath(module);
    return projectPath == null ? "" : projectPath;
  }
  final ExternalSystemNode<?> node=selectedNodes.get(0);
  final Object externalData=node.getData();
  if (externalData instanceof ExternalConfigPathAware) {
    return ((ExternalConfigPathAware)externalData).getLinkedExternalProjectPath();
  }
 else {
    final ExternalConfigPathAware parentExternalConfigPathAware=node.findParentData(ExternalConfigPathAware.class);
    return parentExternalConfigPathAware != null ? parentExternalConfigPathAware.getLinkedExternalProjectPath() : "";
  }
}
