{
  LOG.assertTrue(myInsideChange);
  HashMap<OrderRootType,VirtualFile[]> oldRoots=new HashMap<OrderRootType,VirtualFile[]>(myFiles);
  boolean changes=false;
  for (  OrderRootType orderRootType : OrderRootType.getAllTypes()) {
    final VirtualFile[] roots=myRoots.get(orderRootType).getVirtualFiles();
    changes=changes || !Comparing.equal(roots,oldRoots.get(orderRootType));
    myFiles.put(orderRootType,roots);
  }
  if (changes) {
    fireRootsChanged();
  }
  myInsideChange=false;
}
