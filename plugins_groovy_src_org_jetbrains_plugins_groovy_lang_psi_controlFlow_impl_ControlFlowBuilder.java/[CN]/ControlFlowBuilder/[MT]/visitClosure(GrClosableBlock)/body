{
  if (closure.getParent() instanceof GrStringInjection) {
    for (    GrParameter parameter : closure.getAllParameters()) {
      if (myPolicy.isVariableInitialized(parameter)) {
        addNode(new ReadWriteVariableInstruction(parameter.getName(),parameter,ReadWriteVariableInstruction.WRITE));
      }
    }
    addNode(new ReadWriteVariableInstruction("owner",closure.getLBrace(),ReadWriteVariableInstruction.WRITE));
    super.visitClosure(closure);
    return;
  }
  ReadWriteVariableInstruction[] reads=ControlFlowBuilderUtil.getReadsWithoutPriorWrites(closure.getControlFlow(),false);
  for (  ReadWriteVariableInstruction read : reads) {
    PsiElement element=read.getElement();
    if (!(element instanceof GrReferenceExpression) || myPolicy.isReferenceAccepted((GrReferenceExpression)element)) {
      addNodeAndCheckPending(new ReadWriteVariableInstruction(read.getVariableName(),closure,ReadWriteVariableInstruction.READ));
    }
  }
  addNodeAndCheckPending(new InstructionImpl(closure));
}
