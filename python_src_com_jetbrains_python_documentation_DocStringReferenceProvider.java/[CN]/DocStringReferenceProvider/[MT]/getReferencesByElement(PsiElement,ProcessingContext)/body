{
  final PyDocStringOwner docStringOwner=PsiTreeUtil.getParentOfType(element,PyDocStringOwner.class);
  if (docStringOwner != null && element == docStringOwner.getDocStringExpression()) {
    final List<PsiReference> result=new ArrayList<PsiReference>();
    String docString=element.getText();
    int pos=0;
    while (pos < docString.length()) {
      final TextRange tagRange=findNextTag(docString,pos,ALL_PARAM_TAGS);
      if (tagRange == null) {
        break;
      }
      pos=CharMatcher.anyOf(" \t*").negate().indexIn(docString,tagRange.getEndOffset());
      CharMatcher identifierMatcher=new CharMatcher(){
        @Override public boolean matches(        char c){
          return Character.isLetterOrDigit(c) || c == '_';
        }
      }
.negate();
      if (docString.substring(tagRange.getStartOffset(),tagRange.getEndOffset()).startsWith(":")) {
        int ws=CharMatcher.anyOf(" \t*").indexIn(docString,pos + 1);
        if (ws != -1) {
          int next=CharMatcher.anyOf(" \t*").negate().indexIn(docString,ws);
          if (next != -1 && !docString.substring(pos,next).contains(":")) {
            int endPos=identifierMatcher.indexIn(docString,pos);
            result.add(new DocStringTypeReference(element,new TextRange(pos,endPos)));
            pos=next;
          }
        }
      }
      int endPos=identifierMatcher.indexIn(docString,pos);
      if (endPos < 0) {
        endPos=docString.length();
      }
      result.add(new DocStringParameterReference(element,new TextRange(pos,endPos)));
      if (docString.substring(tagRange.getStartOffset(),tagRange.getEndOffset()).equals(":type") || docString.substring(tagRange.getStartOffset(),tagRange.getEndOffset()).equals(":rtype")) {
        pos=CharMatcher.anyOf(" \t*").negate().indexIn(docString,endPos + 1);
        endPos=CharMatcher.JAVA_LETTER_OR_DIGIT.negate().indexIn(docString,pos + 1);
        result.add(new DocStringTypeReference(element,new TextRange(pos,endPos)));
      }
      pos=endPos;
    }
    return result.toArray(new PsiReference[result.size()]);
  }
  return PsiReference.EMPTY_ARRAY;
}
