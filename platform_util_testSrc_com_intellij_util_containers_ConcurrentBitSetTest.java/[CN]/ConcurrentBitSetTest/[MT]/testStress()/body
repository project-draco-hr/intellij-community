{
  final ConcurrentBitSet bitSet=new ConcurrentBitSet();
  int N=100;
  final int L=100;
  Thread[] threads=new Thread[N];
  for (int i=0; i < N; i++) {
    Thread thread=new Thread(new Runnable(){
      @Override public void run(){
        for (int i=0; i < 10000; i++) {
          for (int j=0; j < L; j++) {
            bitSet.flip(j);
          }
        }
      }
    }
,"conc bit set");
    threads[i]=thread;
    thread.start();
  }
  for (  Thread thread : threads) {
    thread.join();
  }
  assertEquals(-1,bitSet.nextSetBit(0));
}
