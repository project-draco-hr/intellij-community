{
  if (reference != null) {
    final Module module=ModuleUtil.findModuleForPsiElement(reference);
    final Project project=reference.getProject();
    ComponentManager instance_key=module != null ? module : project;
    PyBuiltinCache instance=ourInstanceCache.get(instance_key);
    if (instance != null) {
      return instance;
    }
    Sdk sdk=findSdkForFile(reference.getContainingFile());
    if (sdk != null) {
      return getBuiltinsForSdk(project,instance_key,sdk);
    }
  }
  return DUD_INSTANCE;
}
