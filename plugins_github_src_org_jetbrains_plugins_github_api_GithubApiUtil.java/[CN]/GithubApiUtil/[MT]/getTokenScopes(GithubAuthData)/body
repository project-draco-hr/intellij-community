{
  HttpMethod method=null;
  try {
    String uri=GithubUrlUtil.getApiUrl(auth.getHost()) + "/user";
    method=doREST(auth,uri,null,Collections.<Header>emptyList(),HttpVerb.HEAD);
    checkStatusCode(method,null);
    Header header=method.getResponseHeader("X-OAuth-Scopes");
    if (header == null) {
      throw new HttpException("No scopes header");
    }
    Collection<String> scopes=new ArrayList<String>();
    for (    HeaderElement elem : header.getElements()) {
      scopes.add(elem.getName());
    }
    return scopes;
  }
  finally {
    if (method != null) {
      method.releaseConnection();
    }
  }
}
