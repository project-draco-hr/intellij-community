{
  HttpMethod method=null;
  try {
    method=doREST(auth,"/user",null,null,HttpVerb.HEAD);
    checkStatusCode(method);
    Header header=method.getResponseHeader("X-OAuth-Scopes");
    if (header == null) {
      throw new HttpException("No scopes header");
    }
    Collection<String> scopes=new ArrayList<String>();
    for (    HeaderElement elem : header.getElements()) {
      scopes.add(elem.getName());
    }
    return scopes;
  }
  finally {
    if (method != null) {
      method.releaseConnection();
    }
  }
}
