{
  GithubAuthorization token=findToken(connection,note);
  if (token == null) {
    return getNewScopedToken(connection,scopes,note).getToken();
  }
  if (token.getScopes().containsAll(scopes)) {
    return token.getToken();
  }
  return updateTokenScopes(connection,token,scopes).getToken();
}
