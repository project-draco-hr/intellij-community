{
  TestFileStructure fileStructure=getThreeLevelDirectoryStructure();
  injectMockDialogFlags(new MockReformatFileSettings().setOptimizeImports(true).setProcessDirectory(true).setIncludeSubdirs(true));
  PsiFile fileInEditor=fileStructure.getFilesAtLevel(2).get(0);
  List<PsiFile> shouldNotBeFormatted=fileStructure.getFilesAtLevel(1);
  performReformatActionOnFileInEditor(fileInEditor);
  checkFormationAndImportsOptimizationFor(fileStructure.getFilesAtLevel(2),fileStructure.getFilesAtLevel(3));
  checkNoProcessingWasPerformedOn(shouldNotBeFormatted);
}
