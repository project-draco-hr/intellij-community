{
  final RunnerAndConfigurationSettings settings=cloneTemplateConfiguration(context);
  try {
    if (!setupConfigurationFromContext((T)settings.getConfiguration(),context,new Ref<PsiElement>(context.getPsiLocation()))) {
      return null;
    }
  }
 catch (  ClassCastException e) {
    LOG.error(myConfigurationFactory + " produced wrong type",e);
    return null;
  }
  return new ConfigurationFromContextImpl(this,settings,context.getPsiLocation());
}
