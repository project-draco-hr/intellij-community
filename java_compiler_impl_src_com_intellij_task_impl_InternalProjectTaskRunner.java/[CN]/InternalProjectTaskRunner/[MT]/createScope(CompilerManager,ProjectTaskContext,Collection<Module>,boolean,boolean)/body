{
  CompileScope scope=compilerManager.createModulesCompileScope(modules.toArray(new Module[modules.size()]),includeDependentModules,includeRuntimeDependencies);
  RunConfiguration configuration=context.getRunConfiguration();
  if (configuration != null) {
    scope.putUserData(CompilerManager.RUN_CONFIGURATION_KEY,configuration);
    scope.putUserData(CompilerManager.RUN_CONFIGURATION_TYPE_ID_KEY,configuration.getType().getId());
  }
  ExecutionManagerImpl.EXECUTION_SESSION_ID_KEY.set(scope,context.getSessionId());
  return scope;
}
