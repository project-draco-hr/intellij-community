{
  final MultiMap<String,IProperty> propertyNames=getPropertiesMap(myResourceBundle,myShowOnlyIncomplete);
  final HashSet<String> remains=new HashSet<>(myElements.keySet());
  for (  Map.Entry<String,Collection<IProperty>> entry : propertyNames.entrySet()) {
    final String propKey=entry.getKey();
    Collection<IProperty> properties=entry.getValue();
    final ResourceBundlePropertyStructureViewElement oldPropertyNode=myElements.get(propKey);
    if (oldPropertyNode != null && properties.contains(oldPropertyNode.getProperty())) {
      remains.remove(propKey);
      continue;
    }
    final IProperty representative=properties.iterator().next();
    final ResourceBundlePropertyStructureViewElement node=new ResourceBundlePropertyStructureViewElement(representative);
    myElements.put(propKey,node);
  }
  for (  String remain : remains) {
    myElements.remove(remain);
  }
  StructureViewTreeElement[] result=new StructureViewTreeElement[propertyNames.size()];
  int i=0;
  for (  String key : propertyNames.keySet()) {
    result[i++]=myElements.get(key);
  }
  return result;
}
