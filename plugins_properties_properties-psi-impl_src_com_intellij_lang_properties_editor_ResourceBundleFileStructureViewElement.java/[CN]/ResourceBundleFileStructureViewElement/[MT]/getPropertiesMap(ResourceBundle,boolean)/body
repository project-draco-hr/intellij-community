{
  List<PropertiesFile> propertiesFiles=resourceBundle.getPropertiesFiles();
  final Map<String,IProperty> propertyNames;
  if (onlyIncomplete) {
    propertyNames=getChildrenIdShowOnlyIncomplete(resourceBundle);
  }
 else {
    propertyNames=new LinkedHashMap<String,IProperty>();
    for (    PropertiesFile propertiesFile : propertiesFiles) {
      List<IProperty> properties=propertiesFile.getProperties();
      for (      IProperty property : properties) {
        String name=property.getKey();
        if (!propertyNames.containsKey(name)) {
          propertyNames.put(name,property);
        }
      }
    }
  }
  return propertyNames;
}
