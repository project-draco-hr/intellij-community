{
  final Map<String,IProperty> propertyNames=new LinkedHashMap<String,IProperty>();
  TObjectIntHashMap<String> occurrences=new TObjectIntHashMap<String>();
  for (  PropertiesFile file : resourceBundle.getPropertiesFiles()) {
    Map<String,IProperty> currentFilePropertyNames=new LinkedHashMap<String,IProperty>();
    for (    IProperty property : file.getProperties()) {
      String name=property.getKey();
      if (!currentFilePropertyNames.containsKey(name)) {
        currentFilePropertyNames.put(name,property);
      }
    }
    propertyNames.putAll(currentFilePropertyNames);
    for (    String propertyName : currentFilePropertyNames.keySet()) {
      if (occurrences.contains(propertyName)) {
        occurrences.adjustValue(propertyName,1);
      }
 else {
        occurrences.put(propertyName,1);
      }
    }
  }
  final int targetOccurrences=resourceBundle.getPropertiesFiles().size();
  occurrences.forEachEntry(new TObjectIntProcedure<String>(){
    @Override public boolean execute(    String propertyName,    int occurrences){
      if (occurrences == targetOccurrences) {
        propertyNames.remove(propertyName);
      }
      return true;
    }
  }
);
  return propertyNames;
}
