{
  System.setProperty("sun.awt.noerasebackground","true");
  Toolkit.getDefaultToolkit().getSystemEventQueue().push(IdeEventQueue.getInstance());
  if (Patches.SUN_BUG_ID_6209673) {
    RepaintManager.setCurrentManager(new IdeRepaintManager());
  }
  if (SystemInfo.isXWindow) {
    String wmName=X11UiUtil.getWmName();
    LOG.info("WM detected: " + wmName);
    if (wmName != null) {
      X11UiUtil.patchDetectedWm(wmName);
    }
  }
  IconLoader.activate();
  new JFrame().pack();
  final File file=new File(PathManager.getSystemPath());
  JobScheduler.getScheduler().scheduleWithFixedDelay(new Runnable(){
    @Override public void run(){
      final long lowDiskSpaceThreshold=50 * 1024 * 1024;
      if (file.getUsableSpace() < lowDiskSpaceThreshold) {
        SwingUtilities.invokeLater(new Runnable(){
          @Override public void run(){
            boolean writable=file.canWrite();
            String fullProductName=ApplicationNamesInfo.getInstance().getFullProductName();
            String title=writable ? "Low disk space on disk where system directory of " + fullProductName + " is located" : "System directory of " + fullProductName + " is read only";
            new NotificationGroup("System",NotificationDisplayType.STICKY_BALLOON,false).createNotification(title,file.getPath(),NotificationType.INFORMATION,null).notify(null);
          }
        }
);
      }
    }
  }
,10,30,TimeUnit.SECONDS);
}
