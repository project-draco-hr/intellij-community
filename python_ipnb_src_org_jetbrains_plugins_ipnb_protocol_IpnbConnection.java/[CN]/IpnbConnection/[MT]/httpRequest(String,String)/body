{
  final URLConnection urlConnection=new URL(url).openConnection();
  if (urlConnection instanceof HttpURLConnection) {
    final HttpURLConnection connection=(HttpURLConnection)urlConnection;
    connection.setRequestMethod(method);
    final BufferedReader reader=new BufferedReader(new InputStreamReader(connection.getInputStream(),"utf-8"));
    try {
      final StringBuilder builder=new StringBuilder();
      char[] buffer=new char[4096];
      int n;
      while ((n=reader.read(buffer)) != -1) {
        builder.append(buffer,0,n);
      }
      return builder.toString();
    }
  finally {
      reader.close();
    }
  }
 else {
    throw new UnsupportedOperationException("Only HTTP URLs are supported");
  }
}
