{
  boolean isSupplier=false;
  PsiType type=expression.getType();
  if (type instanceof PsiClassType) {
    PsiClass resolvedClass=((PsiClassType)type).resolve();
    if (resolvedClass != null && GuavaSupplierConversionRule.GUAVA_SUPPLIER.equals(resolvedClass.getQualifiedName())) {
      isSupplier=true;
    }
  }
  return (PsiExpression)expression.replace(JavaPsiFacade.getElementFactory(expression.getProject()).createExpressionFromText(expression.getText() + "::" + (isSupplier ? "get" : "apply"),null));
}
