{
  final ServerSocket serverSocket=new ServerSocket(0);
  try {
    int port=serverSocket.getLocalPort();
synchronized (serverSocket) {
      try {
        serverSocket.wait(1);
      }
 catch (      InterruptedException e) {
        System.err.println(e);
      }
    }
    return port;
  }
  finally {
    serverSocket.close();
  }
}
