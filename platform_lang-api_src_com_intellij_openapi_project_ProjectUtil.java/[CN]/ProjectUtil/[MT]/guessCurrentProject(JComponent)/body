{
  Project project=null;
  if (component != null) {
    project=CommonDataKeys.PROJECT.getData(DataManager.getInstance().getDataContext(component));
  }
  if (project == null) {
    Project[] openProjects=ProjectManager.getInstance().getOpenProjects();
    if (openProjects.length > 0)     project=openProjects[0];
    if (project == null) {
      DataContext dataContext=DataManager.getInstance().getDataContext();
      project=CommonDataKeys.PROJECT.getData(dataContext);
    }
    if (project == null) {
      project=ProjectManager.getInstance().getDefaultProject();
    }
  }
  return project;
}
