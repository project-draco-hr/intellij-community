{
  final PropertiesFile propFile1=PropertiesImplUtil.getPropertiesFile(myFixture.addFileToProject("qwe/p.properties",""));
  final PropertiesFile propFile2=PropertiesImplUtil.getPropertiesFile(myFixture.addFileToProject("qwe/p_abc.properties",""));
  assertNotNull(propFile1);
  assertNotNull(propFile2);
  myFixture.addFileToProject("qwe/q.properties","");
  final PropertiesFile propertiesFile=PropertiesImplUtil.getPropertiesFile(myFixture.addFileToProject("qwe/q_fr.properties",""));
  assertNotNull(propertiesFile);
  assertSize(2,propertiesFile.getResourceBundle().getPropertiesFiles());
  final ResourceBundleManager resourceBundleManager=ResourceBundleManager.getInstance(getProject());
  resourceBundleManager.combineToResourceBundle(ContainerUtil.newArrayList(propFile1,propFile2),"p");
  resourceBundleManager.dissociateResourceBundle(propertiesFile.getResourceBundle());
  assertSize(1,propertiesFile.getResourceBundle().getPropertiesFiles());
  assertSize(2,propFile2.getResourceBundle().getPropertiesFiles());
  final PsiDirectory toMove=myFixture.addFileToProject("asd/temp.txt","").getParent();
  assertNotNull(toMove);
  MoveFilesOrDirectoriesUtil.doMoveDirectory(propFile1.getParent(),toMove);
  final PsiDirectory movedDir=toMove.findSubdirectory("qwe");
  assertNotNull(movedDir);
  final PropertiesFile newPropFile1=PropertiesImplUtil.getPropertiesFile(movedDir.findFile("p.properties"));
  assertNotNull(newPropFile1);
  assertSize(2,newPropFile1.getResourceBundle().getPropertiesFiles());
  final PropertiesFile newPropertiesFile=PropertiesImplUtil.getPropertiesFile(movedDir.findFile("q_fr.properties"));
  assertNotNull(newPropertiesFile);
  assertSize(1,newPropertiesFile.getResourceBundle().getPropertiesFiles());
}
