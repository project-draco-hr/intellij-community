{
  if (!isDirectory) {
    String templateName=myReference.getNewFileTemplateName();
    if (templateName != null) {
      Project project=myReference.getElement().getProject();
      FileTemplateManager fileTemplateManager=FileTemplateManager.getInstance(project);
      FileTemplate template=fileTemplateManager.getTemplate(templateName);
      if (template == null)       template=fileTemplateManager.findInternalTemplate(templateName);
      if (template != null) {
        try {
          return template.getText(fileTemplateManager.getDefaultProperties());
        }
 catch (        IOException ex) {
          throw new RuntimeException(ex);
        }
      }
    }
  }
  return super.getFileText();
}
