{
  RepositoryDeploymentConfiguration config=(RepositoryDeploymentConfiguration)deploymentTask.getConfiguration();
  String repositoryPath=config.getRepositoryPath();
  File repositoryRootFile;
  if (StringUtil.isEmpty(repositoryPath)) {
    File repositoryParentFolder=new File(PathManager.getSystemPath(),"cloud-git-artifact-deploy");
    repositoryRootFile=FileUtil.findSequentNonexistentFile(repositoryParentFolder,artifactFile.getName(),"");
  }
 else {
    repositoryRootFile=new File(repositoryPath);
  }
  if (!FileUtil.createDirectory(repositoryRootFile)) {
    throw new ServerRuntimeException("Unable to create deploy folder: " + repositoryRootFile);
  }
  config.setRepositoryPath(repositoryRootFile.getAbsolutePath());
  return doCreateDeploymentRuntime(artifactSource,artifactFile,serverRuntime,deploymentTask,logManager,repositoryRootFile);
}
