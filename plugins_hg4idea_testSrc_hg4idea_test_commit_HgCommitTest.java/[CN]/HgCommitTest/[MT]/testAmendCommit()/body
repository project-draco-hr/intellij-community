{
  String changedCommit="anotherCommit";
  HgLogCommand logCommand=new HgLogCommand(myProject);
  logCommand.setLogFile(false);
  HgFile hgFile=new HgFile(myRepository,VfsUtilCore.virtualToIoFile(myRepository));
  List<HgFileRevision> revisions=logCommand.execute(hgFile,-1,false);
  HgRepository hgRepo=HgRepositoryImpl.getInstance(myRepository,myProject,myProject);
  HgCommitCommand commit=new HgCommitCommand(myProject,hgRepo,changedCommit,true);
  commit.executeInCurrentThread();
  List<HgFileRevision> revisionsAfterAmendCommit=logCommand.execute(hgFile,-1,false);
  assertTrue(revisions.size() == revisionsAfterAmendCommit.size());
  assertEquals(revisionsAfterAmendCommit.get(0).getCommitMessage(),changedCommit);
}
