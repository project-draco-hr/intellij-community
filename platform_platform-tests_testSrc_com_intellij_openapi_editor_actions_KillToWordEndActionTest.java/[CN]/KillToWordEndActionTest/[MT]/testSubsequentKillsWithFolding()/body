{
  String text="public class ParentCopy {\n" + "        public Insets getBorderInsets(<caret>Component c) {\n" + "        }\n"+ "    }";
  configureFromFileText(getTestName(false) + ".java",text);
  final FoldingModel model=myEditor.getFoldingModel();
  model.runBatchFoldingOperation(new Runnable(){
    @Override public void run(){
      final FoldRegion foldRegion=model.addFoldRegion(70,90,"");
      if (foldRegion == null)       return;
      foldRegion.setExpanded(false);
      assertFalse(foldRegion.isExpanded());
    }
  }
);
  cutToLineEnd();
  cutToLineEnd();
  model.runBatchFoldingOperationDoNotCollapseCaret(new Runnable(){
    @Override public void run(){
      final FoldRegion[] regions=model.getAllFoldRegions();
      for (      FoldRegion region : regions) {
        if (region == null)         return;
        region.setExpanded(true);
      }
    }
  }
);
  cutToLineEnd();
  cutToLineEnd();
  checkResultByText("public class ParentCopy {\n" + "        public Insets getBorderInsets(    }");
  Transferable contents=CopyPasteManager.getInstance().getContents();
  assertTrue(contents instanceof KillRingTransferable);
  Object string=contents.getTransferData(DataFlavor.stringFlavor);
  assertEquals("Component c) {\n        }\n",string);
}
