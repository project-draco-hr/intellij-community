{
  try {
    final Element element=DefaultStateSerializer.serializeState(state,storageSpec);
    for (    Pair<Element,String> pair : mySplitter.splitState(element)) {
      Element e=pair.first;
      String name=pair.second;
      Element statePart=new Element(StorageData.COMPONENT);
      statePart.setAttribute(StorageData.NAME,componentName);
      statePart.addContent(e.detach());
      myStorageData.put(componentName,myDir.getChild(name),statePart,false);
    }
  }
 catch (  WriteExternalException e) {
    throw new StateStorageException(e);
  }
}
