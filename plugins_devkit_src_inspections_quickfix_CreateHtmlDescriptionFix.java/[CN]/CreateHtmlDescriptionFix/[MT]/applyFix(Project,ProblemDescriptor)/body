{
  final PsiDirectory[] dirs;
  dirs=getDirectories();
  final List<VirtualFile> virtualFiles=getPotentialRoots(myModule,dirs);
  final VirtualFile[] roots=prepare(VfsUtil.toVirtualFileArray(virtualFiles));
  if (roots.length == 1) {
    ApplicationManager.getApplication().runWriteAction(new Runnable(){
      public void run(){
        createDescription(roots[0]);
      }
    }
);
  }
 else {
    List<String> options=new ArrayList<String>();
    for (    VirtualFile file : roots) {
      String path=getPath(file);
      options.add(path);
    }
    final JBList files=new JBList(ArrayUtil.toStringArray(options));
    files.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
    final JBPopup popup=JBPopupFactory.getInstance().createListPopupBuilder(files).setTitle(DevKitBundle.message("select.target.location.of.description",myFilename)).setItemChoosenCallback(new Runnable(){
      public void run(){
        final int index=files.getSelectedIndex();
        if (0 <= index && index < roots.length) {
          ApplicationManager.getApplication().runWriteAction(new Runnable(){
            public void run(){
              createDescription(roots[index]);
            }
          }
);
        }
      }
    }
).createPopup();
    final Editor editor=FileEditorManager.getInstance(myModule.getProject()).getSelectedTextEditor();
    if (editor == null)     return;
    popup.showInBestPositionFor(editor);
  }
}
