{
  resolveLocalConflicts(myContext.getScope(),mySettings.getName());
  preprocessOccurrences();
  int expressionIndex=ArrayUtilRt.find(myOccurrences,myExpression);
  final PsiElement[] replaced=processOccurrences();
  GrStatement anchor=getAnchor(replaced);
  RefactoringUtil.highlightAllOccurrences(myContext.getProject(),replaced,myContext.getEditor());
  return insertVariableDefinition(declaration,anchor,replaced[expressionIndex]);
}
