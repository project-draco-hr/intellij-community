{
  myProject=project;
  final MessageBusConnection connection=project.getMessageBus().connect();
  connection.subscribe(PsiModificationTracker.TOPIC,new PsiModificationTracker.Listener(){
    @Override public void modificationCountChanged(){
      if (!isInsideAtomicChange()) {
        clearCache();
      }
    }
  }
);
  ((PsiManagerEx)psiManager).registerRunnableToRunOnChange(new Runnable(){
    @Override public void run(){
      if (!isInsideAtomicChange()) {
        clearCache();
      }
    }
  }
);
  LowMemoryWatcher.register(new Runnable(){
    @Override public void run(){
      if (myCreatingSem.get() == 0) {
        clearCache();
      }
    }
  }
,project);
}
