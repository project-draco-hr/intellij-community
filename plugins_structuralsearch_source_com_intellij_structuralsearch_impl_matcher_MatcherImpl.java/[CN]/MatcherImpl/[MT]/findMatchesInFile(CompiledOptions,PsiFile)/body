{
  LocalSearchScope scope=new LocalSearchScope(psiFile);
  List<Pair<MatchResult,Configuration>> result=new ArrayList<Pair<MatchResult,Configuration>>();
  for (int i=0; i < compiledOptions.matchContexts.size(); i++) {
    MatchContext context=compiledOptions.matchContexts.get(i);
    Configuration configuration=compiledOptions.myConfigurations.get(i);
    matchContext.clear();
    matchContext.setMatcher(visitor);
    MatchOptions options=context.getOptions();
    matchContext.setOptions(options);
    matchContext.setPattern(context.getPattern());
    visitor.setMatchContext(matchContext);
    MySink sink=new MySink(configuration);
    matchContext.setSink(new MatchConstraintsSink(sink,options.getMaxMatchesCount(),options.isDistinct(),options.isCaseSensitiveMatch()));
    options.setScope(scope);
    match(psiFile);
    List<MatchResult> matches=sink.getMatches();
    for (    MatchResult matchResult : matches) {
      result.add(Pair.create(matchResult,configuration));
    }
  }
  return result;
}
