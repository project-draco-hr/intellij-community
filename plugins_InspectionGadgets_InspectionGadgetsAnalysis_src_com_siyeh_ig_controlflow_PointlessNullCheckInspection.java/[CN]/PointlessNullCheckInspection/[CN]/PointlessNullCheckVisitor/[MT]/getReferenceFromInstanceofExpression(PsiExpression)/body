{
  if (expression instanceof PsiParenthesizedExpression) {
    final PsiParenthesizedExpression parenthesizedExpression=(PsiParenthesizedExpression)expression;
    return getReferenceFromInstanceofExpression(parenthesizedExpression.getExpression());
  }
 else   if (expression instanceof PsiInstanceOfExpression) {
    final PsiInstanceOfExpression instanceOfExpression=(PsiInstanceOfExpression)expression;
    final PsiExpression operand=ParenthesesUtils.stripParentheses(instanceOfExpression.getOperand());
    if (!(operand instanceof PsiReferenceExpression)) {
      return null;
    }
    return (PsiReferenceExpression)operand;
  }
 else   if (expression instanceof PsiPolyadicExpression) {
    final PsiPolyadicExpression polyadicExpression=(PsiPolyadicExpression)expression;
    final IElementType tokenType=polyadicExpression.getOperationTokenType();
    if (JavaTokenType.OROR != tokenType) {
      return null;
    }
    final PsiExpression[] operands=polyadicExpression.getOperands();
    final PsiReferenceExpression referenceExpression=getReferenceFromInstanceofExpression(operands[0]);
    if (referenceExpression == null) {
      return null;
    }
    final PsiElement target=referenceExpression.resolve();
    if (!(target instanceof PsiVariable)) {
      return null;
    }
    final PsiVariable variable=(PsiVariable)target;
    for (int i=1, operandsLength=operands.length; i < operandsLength; i++) {
      final PsiReferenceExpression reference2=getReferenceFromInstanceofExpression(operands[i]);
      if (reference2 == null || !reference2.isReferenceTo(variable)) {
        return null;
      }
    }
    return referenceExpression;
  }
 else {
    return null;
  }
}
