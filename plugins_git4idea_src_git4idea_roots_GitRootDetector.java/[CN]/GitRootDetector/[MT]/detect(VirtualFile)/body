{
  if (startDir == null) {
    return new VcsRootDetectInfo(Collections.<VirtualFile>emptyList(),false,false);
  }
  final Set<VirtualFile> roots=scanForRootsInsideDir(startDir);
  roots.addAll(scanForRootsInContentRoots());
  if (roots.contains(startDir)) {
    return new VcsRootDetectInfo(roots,true,false);
  }
  VirtualFile rootAbove=scanForSingleRootAboveDir(startDir);
  if (rootAbove != null) {
    roots.add(rootAbove);
    return new VcsRootDetectInfo(roots,true,true);
  }
  return new VcsRootDetectInfo(roots,false,false);
}
