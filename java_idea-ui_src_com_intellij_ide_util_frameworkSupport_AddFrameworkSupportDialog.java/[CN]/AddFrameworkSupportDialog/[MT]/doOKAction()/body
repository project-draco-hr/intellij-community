{
  if (myAddSupportPanel.hasSelectedFrameworks()) {
    if (!myAddSupportPanel.downloadLibraries()) {
      int answer=Messages.showYesNoDialog(myAddSupportPanel.getMainPanel(),ProjectBundle.message("warning.message.some.required.libraries.wasn.t.downloaded"),CommonBundle.getWarningTitle(),Messages.getWarningIcon());
      if (answer != Messages.YES) {
        return;
      }
    }
    new WriteAction(){
      protected void run(      @NotNull final Result result){
        ModifiableRootModel model=ModuleRootManager.getInstance(myModule).getModifiableModel();
        myAddSupportPanel.addSupport(myModule,model);
        model.commit();
      }
    }
.execute();
  }
  super.doOKAction();
}
