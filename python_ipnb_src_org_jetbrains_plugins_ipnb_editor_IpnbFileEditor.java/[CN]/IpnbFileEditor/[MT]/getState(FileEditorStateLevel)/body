{
  final int index=getIpnbFilePanel().getSelectedIndex();
  final IpnbEditablePanel cell=getIpnbFilePanel().getSelectedCell();
  final int top=cell != null ? cell.getTop() : 0;
  final Document document=FileDocumentManager.getInstance().getCachedDocument(myFile);
  long modificationStamp=document != null ? document.getModificationStamp() : myFile.getModificationStamp();
  return new IpnbEditorState(modificationStamp,index,top);
}
