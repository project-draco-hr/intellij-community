{
  PsiElement e=findTargetElement(editor,file);
  List<Pair<PsiElement,Unwrapper>> result=new ArrayList<Pair<PsiElement,Unwrapper>>();
  Set<PsiElement> ignored=new HashSet<PsiElement>();
  while (e != null) {
    for (    Unwrapper u : getUnwrappers()) {
      if (u.isApplicableTo(e) && !ignored.contains(e)) {
        result.add(Pair.create(e,u));
        u.collectElementsToIgnore(e,ignored);
      }
    }
    e=e.getParent();
  }
  return result;
}
