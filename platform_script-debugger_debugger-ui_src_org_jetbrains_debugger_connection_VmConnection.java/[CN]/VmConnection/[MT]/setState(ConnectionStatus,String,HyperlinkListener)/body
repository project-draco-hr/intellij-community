{
  ConnectionState newState=new ConnectionState(status,message,messageLinkListener);
  ConnectionState oldState=state.getAndSet(newState);
  if (oldState == null || oldState.getStatus() != status) {
    if (status == ConnectionStatus.CONNECTION_FAILED) {
      opened.setError(Promise.createError(newState.getMessage()));
    }
    connectionDispatcher.getMulticaster().statusChanged(status);
  }
}
