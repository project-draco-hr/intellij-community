{
  opened.setError(Promise.getError("detached and closed"));
  Vm currentVm=vm;
  ActionCallback callback;
  if (currentVm == null) {
    callback=new ActionCallback.Done();
  }
 else {
    vm=null;
    callback=currentVm.detach();
  }
  close(null,ConnectionStatus.DISCONNECTED);
  return callback;
}
