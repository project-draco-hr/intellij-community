{
  if (!CodeInsightSettings.getInstance().ADD_UNAMBIGIOUS_IMPORTS_ON_THE_FLY) {
    return false;
  }
  if (!file.getViewProvider().getLanguages().contains(JavaLanguage.INSTANCE)) {
    return false;
  }
  PsiReference element=file.findReferenceAt(offset);
  if (element instanceof PsiJavaCodeReferenceElement) {
    PsiJavaCodeReferenceElement ref=(PsiJavaCodeReferenceElement)element;
    if (ref.multiResolve(true).length == 0) {
      new ImportClassFix(ref).doFix(editor,false,true);
      return true;
    }
  }
  return false;
}
