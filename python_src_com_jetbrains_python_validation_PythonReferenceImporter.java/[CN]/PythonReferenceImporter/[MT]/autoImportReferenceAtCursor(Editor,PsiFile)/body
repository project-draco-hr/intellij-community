{
  if (!(file instanceof PyFile))   return false;
  int caretOffset=editor.getCaretModel().getOffset();
  Document document=editor.getDocument();
  int lineNumber=document.getLineNumber(caretOffset);
  int startOffset=document.getLineStartOffset(lineNumber);
  int endOffset=document.getLineEndOffset(lineNumber);
  List<PsiElement> elements=CollectHighlightsUtil.getElementsInRange(file,startOffset,endOffset);
  for (  PsiElement element : elements) {
    if (element instanceof PyReferenceExpression && SyntaxMatchers.IN_IMPORT.search(element) == null) {
      final PsiPolyVariantReference reference=((PyReferenceExpression)element).getReference();
      if (reference.resolve() == null) {
        new AddImportAction(reference).execute();
        return true;
      }
    }
  }
  return false;
}
