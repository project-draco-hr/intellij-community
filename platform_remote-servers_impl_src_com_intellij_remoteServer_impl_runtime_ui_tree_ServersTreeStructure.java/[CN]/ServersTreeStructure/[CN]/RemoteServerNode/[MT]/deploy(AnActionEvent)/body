{
  final ServerType<? extends ServerConfiguration> serverType=getValue().getType();
  final DeploymentConfigurationManager configurationManager=DeploymentConfigurationManager.getInstance(doGetProject());
  List<RunnerAndConfigurationSettings> list=new ArrayList<RunnerAndConfigurationSettings>(configurationManager.getDeploymentConfigurations(serverType));
  list.add(null);
  ListPopup popup=JBPopupFactory.getInstance().createListPopup(new BaseListPopupStep<RunnerAndConfigurationSettings>("Deploy Configuration",list){
    @Override public Icon getIconFor(    RunnerAndConfigurationSettings value){
      return value != null ? serverType.getIcon() : null;
    }
    @NotNull @Override public String getTextFor(    RunnerAndConfigurationSettings value){
      return value != null ? value.getName() : "Create...";
    }
    @Override public PopupStep onChosen(    final RunnerAndConfigurationSettings selectedValue,    boolean finalChoice){
      return doFinalStep(new Runnable(){
        @Override public void run(){
          if (selectedValue != null) {
            ProgramRunnerUtil.executeConfiguration(doGetProject(),selectedValue,DefaultRunExecutor.getRunExecutorInstance());
          }
 else {
            configurationManager.createAndRunConfiguration(serverType,RemoteServerNode.this.getValue());
          }
        }
      }
);
    }
  }
);
  if (e.getInputEvent() instanceof MouseEvent) {
    popup.show(new RelativePoint((MouseEvent)e.getInputEvent()));
  }
 else {
    popup.showInBestPositionFor(e.getDataContext());
  }
}
