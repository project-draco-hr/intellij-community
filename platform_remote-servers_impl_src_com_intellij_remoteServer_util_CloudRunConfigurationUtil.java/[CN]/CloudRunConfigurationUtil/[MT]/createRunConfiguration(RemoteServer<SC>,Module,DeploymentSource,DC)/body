{
  Project project=module.getProject();
  String accountName=account.getName();
  String name=generateRunConfigurationName(accountName,module.getName());
  final RunManagerEx runManager=RunManagerEx.getInstanceEx(project);
  ConfigurationFactory configurationFactory=getRunConfigurationType(account.getType()).getConfigurationFactories()[0];
  final RunnerAndConfigurationSettings runSettings=runManager.createRunConfiguration(name,configurationFactory);
  final DeployToServerRunConfiguration<SC,DC> result=(DeployToServerRunConfiguration<SC,DC>)runSettings.getConfiguration();
  result.setServerName(accountName);
  result.setDeploymentSource(deploymentSource);
  result.setDeploymentConfiguration(deploymentConfiguration);
  ((ConfigurationFactoryEx)configurationFactory).onNewConfigurationCreated(runSettings.getConfiguration());
  runManager.addConfiguration(runSettings,false);
  runManager.setSelectedConfiguration(runSettings);
  return result;
}
