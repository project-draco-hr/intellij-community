{
  final List<PsiNamedElement> results=new ArrayList<PsiNamedElement>();
  for (ScopeOwner owner=ScopeUtil.getScopeOwner(anchor); owner != null; owner=ScopeUtil.getScopeOwner(owner)) {
    final Scope scope=ControlFlowCache.getScope(owner);
    results.addAll(scope.getNamedElements());
    for (    PyImportedNameDefiner importedNameDefiner : scope.getImportedNameDefiners()) {
      for (      PyElement importedElement : importedNameDefiner.iterateNames()) {
        if (importedElement instanceof PsiNamedElement) {
          results.add((PsiNamedElement)importedElement);
        }
      }
    }
  }
  return results;
}
