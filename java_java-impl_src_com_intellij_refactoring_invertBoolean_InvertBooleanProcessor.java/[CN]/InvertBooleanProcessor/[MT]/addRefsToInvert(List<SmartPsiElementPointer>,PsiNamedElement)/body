{
  final Query<PsiReference> query=namedElement instanceof PsiMethod ? MethodReferencesSearch.search((PsiMethod)namedElement) : ReferencesSearch.search(namedElement);
  final Collection<PsiReference> refs=query.findAll();
  for (  PsiReference ref : refs) {
    final PsiElement element=ref.getElement();
    if (element instanceof PsiReferenceExpression) {
      final PsiReferenceExpression refExpr=(PsiReferenceExpression)element;
      PsiElement parent=refExpr.getParent();
      if (parent instanceof PsiAssignmentExpression && refExpr.equals(((PsiAssignmentExpression)parent).getLExpression())) {
        toInvert.add(mySmartPointerManager.createSmartPsiElementPointer(((PsiAssignmentExpression)parent).getRExpression()));
      }
 else {
        if (namedElement instanceof PsiParameter) {
          PsiElement gParent=refExpr.getParent().getParent();
          if (gParent instanceof PsiMethodCallExpression) {
            if (!canInvert(((PsiMethodCallExpression)gParent).getMethodExpression(),true)) {
              continue;
            }
          }
        }
        toInvert.add(mySmartPointerManager.createSmartPsiElementPointer(refExpr));
      }
    }
  }
  if (namedElement instanceof PsiVariable) {
    final PsiExpression initializer=((PsiVariable)namedElement).getInitializer();
    if (initializer != null) {
      toInvert.add(mySmartPointerManager.createSmartPsiElementPointer(initializer));
    }
  }
}
