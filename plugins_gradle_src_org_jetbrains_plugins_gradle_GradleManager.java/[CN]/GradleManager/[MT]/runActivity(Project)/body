{
  MessageBusConnection connection=project.getMessageBus().connect(project);
  connection.subscribe(GradleSettings.getInstance(project).getChangesTopic(),new GradleSettingsListenerAdapter(){
    @Override public void onServiceDirectoryPathChange(    @Nullable String oldPath,    @Nullable String newPath){
      ensureProjectsRefresh();
    }
    @Override public void onGradleHomeChange(    @Nullable String oldPath,    @Nullable String newPath,    @NotNull String linkedProjectPath){
      ensureProjectsRefresh();
    }
    @Override public void onGradleDistributionTypeChange(    DistributionType currentValue,    @NotNull String linkedProjectPath){
      ensureProjectsRefresh();
    }
    private void ensureProjectsRefresh(){
      ExternalSystemUtil.refreshProjects(project,GradleConstants.SYSTEM_ID,true);
    }
  }
);
  Map<String,String> adjustedPaths=patchLinkedProjects(project);
  if (adjustedPaths == null) {
    return;
  }
  GradleLocalSettings localSettings=GradleLocalSettings.getInstance(project);
  patchRecentTasks(adjustedPaths,localSettings);
  patchAvailableProjects(adjustedPaths,localSettings);
  patchAvailableTasks(adjustedPaths,localSettings);
}
