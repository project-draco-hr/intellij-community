{
  this(commandLine.createProcess(),commandLine.getCommandLineString(),commandLine.getCharset());
  myHasErrorStream=!commandLine.isRedirectErrorStream();
  setHasPty(commandLine instanceof PtyCommandLine);
  myFilesToDelete=commandLine.getUserData(DELETE_FILES_ON_TERMINATION);
  if (myHasPty && SystemInfo.isWindows) {
    addProcessListener(new ProcessAdapter(){
      @Override public void processTerminated(      ProcessEvent event){
        getProcess().destroy();
      }
    }
);
  }
}
