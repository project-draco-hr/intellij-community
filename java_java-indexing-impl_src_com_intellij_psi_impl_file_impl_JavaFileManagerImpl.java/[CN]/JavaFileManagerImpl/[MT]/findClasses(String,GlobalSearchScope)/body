{
  final Collection<PsiClass> classes=JavaFullClassNameIndex.getInstance().get(qName.hashCode(),myManager.getProject(),scope);
  if (classes.isEmpty())   return PsiClass.EMPTY_ARRAY;
  List<PsiClass> result=new ArrayList<PsiClass>(classes.size());
  for (  PsiClass aClass : classes) {
    final String qualifiedName=aClass.getQualifiedName();
    if (qualifiedName == null || !qualifiedName.equals(qName))     continue;
    PsiUtilCore.ensureValid(aClass);
    PsiFile file=aClass.getContainingFile();
    if (file == null) {
      throw new AssertionError("No file for class: " + aClass + " of "+ aClass.getClass());
    }
    VirtualFile vFile=file.getVirtualFile();
    if (!hasAcceptablePackage(vFile))     continue;
    result.add(aClass);
  }
  int count=result.size();
  if (count == 0)   return PsiClass.EMPTY_ARRAY;
  if (count == 1)   return new PsiClass[]{result.get(0)};
  ContainerUtil.quickSort(result,new Comparator<PsiClass>(){
    @Override public int compare(    PsiClass o1,    PsiClass o2){
      return scope.compare(o2.getContainingFile().getVirtualFile(),o1.getContainingFile().getVirtualFile());
    }
  }
);
  return result.toArray(new PsiClass[count]);
}
