{
  Project project=getProject();
  if (project == null || project.isDisposed()) {
    emptyTextAndTooltip();
    return;
  }
  GitRepository repo=GitBranchUtil.getCurrentRepository(project);
  if (repo == null) {
    emptyTextAndTooltip();
    return;
  }
  int maxLength=myMaxString.length() - 1;
  myText=StringUtil.shortenTextWithEllipsis(GitBranchUtil.getDisplayableBranchText(repo),maxLength,5);
  myTooltip=getDisplayableBranchTooltip(repo);
  myStatusBar.updateWidget(ID());
  mySettings.setRecentRoot(repo.getRoot().getPath());
}
