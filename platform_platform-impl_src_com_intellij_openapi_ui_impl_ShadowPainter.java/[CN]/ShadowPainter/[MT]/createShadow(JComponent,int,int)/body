{
  final GraphicsConfiguration graphicsConfiguration=GraphicsEnvironment.getLocalGraphicsEnvironment().getDefaultScreenDevice().getDefaultConfiguration();
  final BufferedImage image=graphicsConfiguration.createCompatibleImage(width,height,Transparency.TRANSLUCENT);
  final Graphics2D g=image.createGraphics();
  final int sideSize=myLeft.getIconWidth();
  final int bottomSize=myBottom.getIconHeight();
  final int topSize=myTop.getIconHeight();
  myTopLeft.paintIcon(c,g,0,0);
  myTopRight.paintIcon(c,g,width - myTopRight.getIconWidth(),0);
  myBottomRight.paintIcon(c,g,width - myBottomRight.getIconWidth(),height - myBottomRight.getIconHeight());
  myBottomLeft.paintIcon(c,g,0,height - myBottomLeft.getIconHeight());
  for (int _x=myTopLeft.getIconWidth(); _x < width - myTopRight.getIconWidth(); _x++) {
    myTop.paintIcon(c,g,_x,0);
  }
  for (int _x=myBottomLeft.getIconWidth(); _x < width - myBottomLeft.getIconWidth(); _x++) {
    myBottom.paintIcon(c,g,_x,height - bottomSize);
  }
  for (int _y=myTopLeft.getIconHeight(); _y < height - myBottomLeft.getIconHeight(); _y++) {
    myLeft.paintIcon(c,g,0,_y);
  }
  for (int _y=myTopRight.getIconHeight(); _y < height - myBottomRight.getIconHeight(); _y++) {
    myRight.paintIcon(c,g,width - sideSize,_y);
  }
  if (myBorderColor != null) {
    g.setColor(myBorderColor);
    g.drawRect(sideSize - 1,topSize - 1,width - sideSize * 2 + 1,height - topSize - bottomSize + 1);
  }
  g.dispose();
  return image;
}
