{
  try {
    doTest(new PerformAction(){
      @Override public void performAction(      final VirtualFile rootDir,      final VirtualFile rootAfter) throws Exception {
        GlobalSearchScope scope=GlobalSearchScope.allScope(myProject);
        PsiClass aClass=myJavaFacade.findClass("Test",scope);
        if (aClass == null)         aClass=myJavaFacade.findClass("p.Test",scope);
        assertNotNull("Class Test not found",aClass);
        PsiClass superClass=myJavaFacade.findClass("Super",scope);
        if (superClass == null)         superClass=myJavaFacade.findClass("p1.Super",scope);
        assertNotNull("Class Super not found",superClass);
        new InlineSuperClassRefactoringProcessor(myProject,inlineOne ? aClass : null,superClass,DocCommentPolicy.ASIS,aClass).run();
      }
    }
);
  }
 catch (  BaseRefactoringProcessor.ConflictsInTestsException e) {
    if (fail) {
      return;
    }
 else {
      throw e;
    }
  }
  if (fail) {
    fail("Conflict was not detected");
  }
}
