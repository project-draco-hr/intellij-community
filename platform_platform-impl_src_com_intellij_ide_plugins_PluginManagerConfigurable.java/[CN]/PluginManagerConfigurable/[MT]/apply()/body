{
  final String applyMessage=myPluginManagerMain.apply();
  if (applyMessage != null) {
    throw new ConfigurationException(applyMessage);
  }
  boolean prev=myShutdownRequired;
  myShutdownRequired|=myPluginManagerMain.isRequireShutdown();
  myPluginManagerMain.ignoreChanges();
  if (prev)   return;
  Disposable d=UIUtil.getParents(myPluginManagerMain.getMainPanel()).filter(Disposable.class).first();
  if (d == null)   return;
  Disposer.register(d,new Disposable(){
    @Override public void dispose(){
      ApplicationManager.getApplication().invokeLater(new Runnable(){
        @Override public void run(){
          showShutdownDialogIfNeeded();
        }
      }
,ApplicationManager.getApplication().getDisposed());
    }
  }
);
}
