{
  final SubTree tree=new SubTree(myWorkingCopyDir);
  checkin();
  final FilePath fpSource=VcsUtil.getFilePath(new File(tree.mySourceDir.getPath()),true);
  final FilePath fpT11=VcsUtil.getFilePath(new File(tree.myTargetFiles.get(0).getPath()),false);
  VcsTestUtil.deleteFileInCommand(myProject,tree.mySourceDir);
  VcsTestUtil.deleteFileInCommand(myProject,tree.myTargetFiles.get(0));
  myDirtyScopeManager.markEverythingDirty();
  myChangeListManager.ensureUpToDate(false);
  final Change change=assertDeletedChange(fpSource);
  final Change t11Change=assertDeletedChange(fpT11);
  rollbackIMpl(Arrays.asList(change,t11Change),Collections.<Change>emptyList());
}
