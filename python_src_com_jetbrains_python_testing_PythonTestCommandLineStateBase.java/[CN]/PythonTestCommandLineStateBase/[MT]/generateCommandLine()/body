{
  GeneralCommandLine cmd=new GeneralCommandLine();
  setRunnerPath(cmd);
  if (!StringUtil.isEmptyOrSpaces(myConfiguration.getWorkingDirectory())) {
    cmd.setWorkDirectory(myConfiguration.getWorkingDirectory());
  }
  Map<String,String> envs=myConfiguration.getEnvs();
  if (envs == null)   envs=new HashMap<String,String>();
 else   envs=new HashMap<String,String>(envs);
  envs.put(PYTHONUNBUFFERED,"1");
  List<String> pythonPathList=new ArrayList<String>();
  pythonPathList.add(PythonHelpersLocator.getHelpersRoot().getPath());
  final Module module=myConfiguration.getModule();
  if (module != null) {
    final VirtualFile[] contentRoots=ModuleRootManager.getInstance(module).getContentRoots();
    for (    VirtualFile contentRoot : contentRoots) {
      pythonPathList.add(FileUtil.toSystemDependentName(contentRoot.getPath()));
    }
  }
  String pythonPath=StringUtil.join(pythonPathList,File.pathSeparator);
  if (new File(myConfiguration.getInterpreterPath()).getName().toLowerCase().startsWith("jython")) {
    cmd.getParametersList().add("-Dpython.path=" + pythonPath);
  }
 else {
    insertToPythonPath(envs,pythonPath);
  }
  cmd.getParametersList().addParametersString(myConfiguration.getInterpreterOptions());
  addTestRunnerParameters(cmd);
  cmd.setEnvParams(envs);
  cmd.setPassParentEnvs(myConfiguration.isPassParentEnvs());
  return cmd;
}
