{
  if (project == null) {
    return null;
  }
  GradleProjectSettings settings=GradleSettings.getInstance(project).getLinkedProjectSettings(linkedProjectPath);
  if (settings == null) {
    return null;
  }
  File candidate=null;
  if (settings.getDistributionType() != null) {
switch (settings.getDistributionType()) {
case LOCAL:
      if (settings.getGradleHome() != null) {
        candidate=new File(settings.getGradleHome());
      }
    break;
case DEFAULT_WRAPPED:
  WrapperConfiguration wrapperConfiguration=GradleUtil.getWrapperConfiguration(linkedProjectPath);
candidate=getWrappedGradleHome(linkedProjectPath,wrapperConfiguration);
break;
case WRAPPED:
break;
case BUNDLED:
WrapperConfiguration bundledWrapperSettings=new WrapperConfiguration();
DistributionLocator distributionLocator=new DistributionLocator();
bundledWrapperSettings.setDistribution(distributionLocator.getDistributionFor(GradleVersion.current()));
candidate=getWrappedGradleHome(linkedProjectPath,bundledWrapperSettings);
break;
}
}
File result=null;
if (candidate != null) {
result=isGradleSdkHome(candidate) ? candidate : null;
}
if (result != null) {
return result;
}
return getAutodetectedGradleHome();
}
