{
  initTree();
  JPanel panel=new MavenProjectsNavigatorPanel(myProject,myTree);
  AnAction removeAction=ActionManager.getInstance().getAction("Maven.RemoveRunConfiguration");
  removeAction.registerCustomShortcutSet(CommonShortcuts.getDelete(),myTree,myProject);
  AnAction editSource=ActionManager.getInstance().getAction("Maven.EditRunConfiguration");
  editSource.registerCustomShortcutSet(CommonShortcuts.getEditSource(),myTree,myProject);
  final ToolWindowManagerEx manager=ToolWindowManagerEx.getInstanceEx(myProject);
  myToolWindow=(ToolWindowEx)manager.registerToolWindow(TOOL_WINDOW_ID,false,ToolWindowAnchor.RIGHT,myProject,true);
  myToolWindow.setIcon(MavenIcons.ToolWindowMaven);
  final ContentFactory contentFactory=ServiceManager.getService(ContentFactory.class);
  final Content content=contentFactory.createContent(panel,"",false);
  ContentManager contentManager=myToolWindow.getContentManager();
  contentManager.addContent(content);
  contentManager.setSelectedContent(content,false);
  final ToolWindowManagerAdapter listener=new ToolWindowManagerAdapter(){
    boolean wasVisible=false;
    @Override public void stateChanged(){
      if (myToolWindow.isDisposed())       return;
      boolean visible=myToolWindow.isVisible();
      if (!visible || wasVisible) {
        return;
      }
      scheduleStructureUpdate();
      wasVisible=true;
    }
  }
;
  manager.addToolWindowManagerListener(listener,myProject);
  ActionManager actionManager=ActionManager.getInstance();
  DefaultActionGroup group=new DefaultActionGroup();
  group.add(actionManager.getAction("Maven.GroupProjects"));
  group.add(actionManager.getAction("Maven.ShowIgnored"));
  group.add(actionManager.getAction("Maven.ShowBasicPhasesOnly"));
  group.add(actionManager.getAction("Maven.AlwaysShowArtifactId"));
  group.add(actionManager.getAction("Maven.ShowVersions"));
  myToolWindow.setAdditionalGearActions(group);
}
