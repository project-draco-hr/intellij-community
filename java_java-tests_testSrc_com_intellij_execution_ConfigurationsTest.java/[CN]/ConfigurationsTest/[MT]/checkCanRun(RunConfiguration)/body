{
  final RunProfileState state;
  state=ExecutionEnvironmentBuilder.create(DefaultRunExecutor.getRunExecutorInstance(),configuration).build().getState();
  assertNotNull(state);
  assertTrue(state instanceof JavaCommandLine);
  if (state instanceof TestPackage) {
    @SuppressWarnings("UnusedDeclaration") final JavaParameters parameters=((TestPackage)state).getJavaParameters();
    final SearchForTestsTask task=((TestPackage)state).createSearchingForTestsTask();
    assertNotNull(task);
    task.startSearch();
  }
  try {
    configuration.checkConfiguration();
  }
 catch (  RuntimeConfigurationError e) {
    fail("cannot run: " + e.getMessage());
  }
catch (  RuntimeConfigurationException e) {
  }
  return ((JavaCommandLine)state).getJavaParameters();
}
