{
  final RunProfileState state;
  state=configuration.getState(MOCK_EXECUTOR,new ExecutionEnvironment(new MockProfile(),MOCK_EXECUTOR,myProject,null));
  assertNotNull(state);
  assertTrue(state instanceof JavaCommandLine);
  if (state instanceof TestPackage) {
    final JavaParameters parameters=((TestPackage)state).getJavaParameters();
    ((TestPackage)state).findTests();
  }
  try {
    configuration.checkConfiguration();
  }
 catch (  RuntimeConfigurationError e) {
    fail("cannot run: " + e.getMessage());
  }
catch (  RuntimeConfigurationException e) {
  }
  return ((JavaCommandLine)state).getJavaParameters();
}
