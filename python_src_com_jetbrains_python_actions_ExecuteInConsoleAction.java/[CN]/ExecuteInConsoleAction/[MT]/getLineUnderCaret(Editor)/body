{
  VisualPosition caretPos=editor.getCaretModel().getVisualPosition();
  Pair<LogicalPosition,LogicalPosition> lines=EditorUtil.calcSurroundingRange(editor,caretPos,caretPos);
  LogicalPosition lineStart=lines.first;
  LogicalPosition nextLineStart=lines.second;
  int start=editor.logicalPositionToOffset(lineStart);
  int end=editor.logicalPositionToOffset(nextLineStart);
  if (end <= start) {
    return null;
  }
  return editor.getDocument().getCharsSequence().subSequence(start,end).toString();
}
