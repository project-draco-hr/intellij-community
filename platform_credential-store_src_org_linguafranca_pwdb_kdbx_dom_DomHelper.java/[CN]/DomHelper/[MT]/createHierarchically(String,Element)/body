{
  Element currentElement=startElement;
  for (  String elementName : elementPath.split("/")) {
    try {
      Element nextElement=(Element)xpath.evaluate(elementName,currentElement,XPathConstants.NODE);
      if (nextElement == null) {
        nextElement=(Element)currentElement.appendChild(currentElement.getOwnerDocument().createElement(elementName));
      }
      currentElement=nextElement;
    }
 catch (    XPathExpressionException e) {
      throw new IllegalStateException(e);
    }
  }
  return currentElement;
}
