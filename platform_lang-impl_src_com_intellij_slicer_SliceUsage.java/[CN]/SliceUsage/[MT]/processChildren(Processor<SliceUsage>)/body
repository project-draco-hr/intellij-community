{
  final PsiElement element=ApplicationManager.getApplication().runReadAction(new Computable<PsiElement>(){
    @Override public PsiElement compute(){
      return getElement();
    }
  }
);
  ProgressIndicator indicator=ProgressManager.getInstance().getProgressIndicator();
  indicator.checkCanceled();
  final Processor<SliceUsage> uniqueProcessor=new CommonProcessors.UniqueProcessor<SliceUsage>(processor,new TObjectHashingStrategy<SliceUsage>(){
    @Override public int computeHashCode(    final SliceUsage object){
      return object.getUsageInfo().hashCode();
    }
    @Override public boolean equals(    final SliceUsage o1,    final SliceUsage o2){
      return o1.getUsageInfo().equals(o2.getUsageInfo());
    }
  }
);
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    @Override public void run(){
      if (params.dataFlowToThis) {
        processUsagesFlownDownTo(element,uniqueProcessor);
      }
 else {
        processUsagesFlownFromThe(element,uniqueProcessor);
      }
    }
  }
);
}
