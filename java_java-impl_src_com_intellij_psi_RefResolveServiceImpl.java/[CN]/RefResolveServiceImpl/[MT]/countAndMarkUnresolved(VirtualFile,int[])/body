{
  if (file.isDirectory()) {
    VfsUtilCore.visitChildrenRecursively(file,new VirtualFileVisitor(){
      @Override public boolean visitFile(      @NotNull VirtualFile file){
        doCountAndMarkUnresolved(file,count);
        return true;
      }
      @Nullable @Override public Iterable<VirtualFile> getChildrenIterable(      @NotNull VirtualFile file){
        return ((NewVirtualFile)file).iterInDbChildren();
      }
    }
);
  }
 else {
    doCountAndMarkUnresolved(file,count);
  }
}
