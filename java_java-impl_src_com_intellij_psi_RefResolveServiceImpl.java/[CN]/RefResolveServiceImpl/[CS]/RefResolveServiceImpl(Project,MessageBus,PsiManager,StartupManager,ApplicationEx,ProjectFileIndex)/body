{
  super(project);
  ((FutureTask)resolveProcess).run();
  myApplication=application;
  myProjectFileIndex=projectFileIndex;
  if (ENABLED) {
    File indexFile=new File(getStorageDirectory(),"index");
    File dataFile=new File(getStorageDirectory(),"data");
    fileIsResolved=ConcurrentBitSet.readFrom(new File(getStorageDirectory(),"bitSet"));
    final boolean initial=!indexFile.exists() || !dataFile.exists();
    storage=new PersistentIntList(indexFile,dataFile,initial);
    Disposer.register(this,storage);
    if (!application.isUnitTestMode()) {
      startupManager.runWhenProjectIsInitialized(new Runnable(){
        @Override public void run(){
          init(messageBus,psiManager);
        }
      }
);
    }
    log=new FileWriter(new File(getStorageDirectory(),"log.txt"));
    Disposer.register(this,new Disposable(){
      @Override public void dispose(){
        try {
          save();
          log.close();
        }
 catch (        IOException e) {
          LOG.error(e);
        }
      }
    }
);
  }
 else {
    log=null;
    fileIsResolved=null;
    storage=null;
  }
}
