{
synchronized (lock) {
    cancel("cancel all in tests");
    for (    CommitTask commitTask : documentsToCommit) {
      commitTask.indicator.cancel();
      log(commitTask.project,"Removed from background queue",commitTask);
    }
    documentsToCommit.clear();
    for (    CommitTask commitTask : documentsToApplyInEDT) {
      commitTask.indicator.cancel();
      log(commitTask.project,"Removed from EDT apply queue (sync commit called)",commitTask);
    }
    documentsToApplyInEDT.clear();
    CommitTask task=currentTask;
    if (task != null) {
      cancelAndRemoveFromDocsToCommit(task);
    }
    cancel("Sync commit intervened");
    ((BoundedTaskExecutor)executor).clearAndCancelAll();
  }
}
