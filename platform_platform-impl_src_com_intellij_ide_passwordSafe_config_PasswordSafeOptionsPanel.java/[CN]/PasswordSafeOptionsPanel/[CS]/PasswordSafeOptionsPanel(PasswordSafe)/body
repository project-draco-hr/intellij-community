{
  final PasswordSafeImpl ps=(PasswordSafeImpl)passwordSafe;
  final ChangeListener listener=new ChangeListener(){
    public void stateChanged(    ChangeEvent e){
      boolean isDisk=myRememberOnDiskProtectedRadioButton.isSelected();
      myManagePasswordButton.setEnabled(isDisk);
    }
  }
;
  myRememberOnDiskProtectedRadioButton.addChangeListener(listener);
  listener.stateChanged(null);
  myManagePasswordButton.addActionListener(new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      if (isMasterKeyEmpty(ps)) {
        MasterPasswordDialog.resetMasterPasswordDialog(null,ps.getMasterKeyProvider(),PasswordSafeOptionsPanel.class).show();
      }
 else {
        MasterPasswordDialog.changeMasterPasswordDialog(null,ps.getMasterKeyProvider(),PasswordSafeOptionsPanel.class).show();
      }
      listener.stateChanged(null);
    }
  }
);
}
