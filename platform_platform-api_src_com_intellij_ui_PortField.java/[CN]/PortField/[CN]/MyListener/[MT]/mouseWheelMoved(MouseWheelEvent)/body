{
  int units=e.getUnitsToScroll();
  if (units == 0)   return;
  final Object source=e.getSource();
  if (source instanceof JSpinner) {
    final JSpinner spinner=(JSpinner)source;
    final SpinnerModel model=spinner.getModel();
    if (model instanceof SpinnerNumberModel) {
      final SpinnerNumberModel numberModel=(SpinnerNumberModel)model;
      final Number value=(Number)numberModel.getValue();
      final Number stepSize=numberModel.getStepSize();
      final Comparable minimum=numberModel.getMinimum();
      final Comparable maximum=numberModel.getMaximum();
      final Number newValue=calculateNewValue(value,stepSize,minimum,maximum,units);
      if (newValue != null) {
        numberModel.setValue(newValue);
      }
    }
  }
}
