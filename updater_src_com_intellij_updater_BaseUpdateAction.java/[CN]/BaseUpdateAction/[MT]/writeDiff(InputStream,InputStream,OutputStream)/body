{
  Runner.logger().info("writing diff");
  ByteArrayOutputStream diffOutput=new ByteArrayOutputStream();
  byte[] newerFileBuffer=JBDiff.bsdiff(olderFileIn,newerFileIn,diffOutput);
  diffOutput.close();
  if (!isCritical() && diffOutput.size() < newerFileBuffer.length) {
    patchOutput.write(1);
    Utils.copyBytesToStream(diffOutput,patchOutput);
  }
 else {
    patchOutput.write(0);
    Utils.copyBytesToStream(newerFileBuffer,patchOutput);
  }
}
