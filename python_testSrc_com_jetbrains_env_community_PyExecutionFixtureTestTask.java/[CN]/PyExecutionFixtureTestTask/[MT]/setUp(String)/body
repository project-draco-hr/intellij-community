{
  initFixtureBuilder();
  final TestFixtureBuilder<IdeaProjectTestFixture> fixtureBuilder=IdeaTestFixtureFactory.getFixtureFactory().createFixtureBuilder(testName);
  myFixture=IdeaTestFixtureFactory.getFixtureFactory().createCodeInsightFixture(fixtureBuilder.getFixture());
  UIUtil.invokeAndWaitIfNeeded(new Runnable(){
    @Override public void run(){
      ModuleFixtureBuilder moduleFixtureBuilder=fixtureBuilder.addModule(MyModuleFixtureBuilder.class);
      moduleFixtureBuilder.addSourceContentRoot(myFixture.getTempDirPath());
      moduleFixtureBuilder.addSourceContentRoot(getTestDataPath());
      final List<String> contentRoots=getContentRoots();
      for (      String contentRoot : contentRoots) {
        moduleFixtureBuilder.addContentRoot(getTestDataPath() + contentRoot);
      }
    }
  }
);
  myFixture.setUp();
  myFixture.setTestDataPath(getTestDataPath());
}
