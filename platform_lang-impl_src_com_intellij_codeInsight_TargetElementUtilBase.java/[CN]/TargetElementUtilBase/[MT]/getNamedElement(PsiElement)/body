{
  if (element == null)   return null;
  TargetElementEvaluatorEx2 evaluator=getElementEvaluatorsEx2(element.getLanguage());
  if (evaluator != null) {
    PsiElement result=evaluator.getNamedElement(element);
    if (result != null)     return result;
  }
  PsiElement parent;
  if ((parent=PsiTreeUtil.getParentOfType(element,PsiNamedElement.class,false)) != null) {
    boolean isInjected=parent instanceof PsiFile && InjectedLanguageManager.getInstance(parent.getProject()).isInjectedFragment((PsiFile)parent);
    if (!isInjected && parent.getTextOffset() == element.getTextRange().getStartOffset()) {
      if (evaluator == null || evaluator.isAcceptableNamedParent(parent)) {
        return parent;
      }
    }
  }
  return null;
}
