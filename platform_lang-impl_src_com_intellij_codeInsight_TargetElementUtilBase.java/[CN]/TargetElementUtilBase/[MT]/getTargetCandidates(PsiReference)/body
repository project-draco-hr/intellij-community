{
  PsiElement refElement=reference.getElement();
  TargetElementEvaluatorEx2 evaluator=refElement != null ? getElementEvaluatorsEx2(refElement.getLanguage()) : null;
  if (evaluator != null) {
    Collection<PsiElement> candidates=evaluator.getTargetCandidates(reference);
    if (candidates != null)     return candidates;
  }
  if (reference instanceof PsiPolyVariantReference) {
    final ResolveResult[] results=((PsiPolyVariantReference)reference).multiResolve(false);
    List<PsiElement> navigatableResults=new ArrayList<PsiElement>(results.length);
    for (    ResolveResult r : results) {
      PsiElement element=r.getElement();
      if (EditSourceUtil.canNavigate(element) || element instanceof Navigatable && ((Navigatable)element).canNavigateToSource()) {
        navigatableResults.add(element);
      }
    }
    return navigatableResults;
  }
  PsiElement resolved=reference.resolve();
  if (resolved instanceof NavigationItem) {
    return Collections.singleton(resolved);
  }
  return Collections.emptyList();
}
