{
  final PsiElement onElement=refWhat.getElement();
  final PsiElement fromElement=refFrom.getElement();
  if (onElement != null && fromElement != null) {
    final Module onModule=ModuleUtilCore.findModuleForPsiElement(onElement);
    final Module fromModule=ModuleUtilCore.findModuleForPsiElement(fromElement);
    if (onModule != null && fromModule != null && onModule != fromModule) {
      final RefModule refModule=myManager.getRefModule(fromModule);
      if (refModule != null) {
        Set<Module> modules=refModule.getUserData(DEPENDENCIES);
        if (modules == null) {
          modules=new HashSet<Module>();
          refModule.putUserData(DEPENDENCIES,modules);
        }
        modules.add(onModule);
      }
    }
  }
}
