{
  boolean result;
  long deadline=System.currentTimeMillis() + timeout;
  ProgressIndicator progressWrapper=progressIndicator == null ? null : new SensitiveProgressWrapper(progressIndicator);
  while (!(result=runInReadActionWithWriteActionPriority(action,progressWrapper)) && (progressIndicator == null || !progressIndicator.isCanceled()) && System.currentTimeMillis() < deadline) {
    try {
      TimeUnit.MILLISECONDS.sleep(pauseBetweenRetries);
    }
 catch (    InterruptedException e) {
      Thread.currentThread().interrupt();
      return false;
    }
  }
  return result;
}
