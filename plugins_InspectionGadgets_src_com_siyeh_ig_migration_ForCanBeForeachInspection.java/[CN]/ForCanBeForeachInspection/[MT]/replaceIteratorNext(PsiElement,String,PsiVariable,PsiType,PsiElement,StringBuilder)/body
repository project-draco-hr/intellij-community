{
  if (isIteratorNext(element,iterator,contentType)) {
    out.append(contentVariableName);
  }
 else {
    final PsiElement[] children=element.getChildren();
    if (children.length == 0) {
      final String text=element.getText();
      if (PsiKeyword.INSTANCEOF.equals(text) && out.charAt(out.length() - 1) != ' ') {
        out.append(' ');
      }
      out.append(text);
    }
 else {
      boolean skippingWhiteSpace=false;
      for (      final PsiElement child : children) {
        if (shouldSkip(iterator,contentType,child) || child.equals(childToSkip)) {
          skippingWhiteSpace=true;
        }
 else         if (!(child instanceof PsiWhiteSpace) || !skippingWhiteSpace) {
          skippingWhiteSpace=false;
          replaceIteratorNext(child,contentVariableName,iterator,contentType,childToSkip,out);
        }
      }
    }
  }
}
