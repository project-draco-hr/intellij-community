{
  final boolean noBorder=c.getClientProperty("JTextField.Search.noBorderRing") == Boolean.TRUE;
  boolean hasFocus=c.hasFocus() && !noBorder;
  Icon left=MacIntelliJIconCache.getIcon("searchFieldLeft",false,hasFocus);
  Icon middle=MacIntelliJIconCache.getIcon("searchFieldMiddle",false,hasFocus);
  Icon right=MacIntelliJIconCache.getIcon("searchFieldRight",false,hasFocus);
  Graphics gg=g.create(0,0,c.getWidth(),c.getHeight());
  gg.setClip(r.x,r.y,r.width - right.getIconWidth(),r.height);
  int x=r.x;
  int stop=r.x + (r.width - right.getIconWidth());
  left.paintIcon(c,g,r.x,r.y);
  x+=left.getIconWidth();
  while (x < stop) {
    middle.paintIcon(c,gg,x,r.y);
    x+=middle.getIconWidth();
  }
  gg.dispose();
  right.paintIcon(c,g,stop,r.y);
  if (StringUtil.isEmpty(c.getText()) && !c.hasFocus()) {
    Icon label=MacIntelliJIconCache.getIcon("searchFieldLabel");
    label.paintIcon(c,g,r.x + (r.width - label.getIconWidth()) / 2,r.y);
  }
}
