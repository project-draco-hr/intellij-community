{
  Collection<VirtualFile> dirtyRoots=ContainerUtil.newHashSet();
  if (ProjectUtil.isDirectoryBased(myProject) && myBaseDir != null) {
    VirtualFile ideaDir=myBaseDir.findChild(Project.DIRECTORY_STORE_FOLDER);
    if (ideaDir != null) {
      dirtyRoots.add(ideaDir);
    }
 else {
      LOG.warn(".idea was not found for base dir [" + myBaseDir.getPath() + "]");
    }
  }
  ContainerUtil.addAll(dirtyRoots,getContentRoots());
  String defaultMapping=((ProjectLevelVcsManagerEx)ProjectLevelVcsManager.getInstance(myProject)).haveDefaultMapping();
  boolean haveDefaultMapping=!StringUtil.isEmpty(defaultMapping);
  if (haveDefaultMapping && myBaseDir != null) {
    dirtyRoots.add(myBaseDir);
  }
  return dirtyRoots;
}
