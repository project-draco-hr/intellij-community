{
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      final String referenceName=((PyReferenceExpression)myReference).getReferencedName();
      final PsiFile[] files=FilenameIndex.getFilesByName(myProject,referenceName + ".py",GlobalSearchScope.allScope(myProject));
      if (files.length == 1) {
        final PyImportStatement importNodeToInsert=PythonLanguage.getInstance().getElementGenerator().createImportStatementFromText(myProject,"import " + referenceName);
        try {
          file.addBefore(importNodeToInsert,getFirstNonComment(file));
        }
 catch (        IncorrectOperationException e) {
          LOG.error(e);
        }
      }
    }
  }
);
}
