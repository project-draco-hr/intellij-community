{
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    public void run(){
      final String referenceName=((PyReferenceExpression)myReference).getReferencedName();
      final PsiFile[] files=FilenameIndex.getFilesByName(myProject,referenceName + ".py",GlobalSearchScope.allScope(myProject));
      if (files.length == 1) {
        String text="\n";
        LeafElement ws=Factory.createSingleLeafElement(TokenType.WHITE_SPACE,text,0,text.length(),null,file.getManager());
        final ASTNode importNodeToInsert=PythonLanguage.getInstance().getElementGenerator().createImportStatementFromText(myProject,"import " + referenceName).getNode();
        final PsiElement element=getFirstNonComment(file);
        file.getNode().addChild(ws,element != null ? element.getNode() : file.getFirstChild().getNode());
        file.getNode().addChild(importNodeToInsert,ws);
      }
    }
  }
);
}
