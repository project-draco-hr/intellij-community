{
  AESEngine engine=new AESEngine();
  engine.init(true,new KeyParameter(transformSeed));
  byte[] transformedKey=new byte[key.length];
  System.arraycopy(key,0,transformedKey,0,transformedKey.length);
  for (long rounds=0; rounds < transformRounds; rounds++) {
    engine.processBlock(transformedKey,0,transformedKey,0);
    engine.processBlock(transformedKey,16,transformedKey,16);
  }
  MessageDigest md=getMessageDigestInstance();
  byte[] transformedKeyDigest=md.digest(transformedKey);
  md.update(masterSeed);
  return md.digest(transformedKeyDigest);
}
