{
  List<GitRepository> repositories=initRepositories("community","idea");
  LocalTask defaultTask=myTaskManager.getActiveTask();
  assertNotNull(defaultTask);
  LocalTaskImpl foo=myTaskManager.createLocalTask("foo");
  LocalTask localTask=myTaskManager.activateTask(foo,false);
  myTaskManager.activateInVcs(localTask,defaultTask,TaskManager.VcsOperation.CREATE_BRANCH);
  List<BranchInfo> branches=localTask.getBranches();
  assertEquals(2,branches.size());
  assertEquals(2,defaultTask.getBranches().size());
  myTaskManager.activateTask(defaultTask,false);
  assertEquals("master",repositories.get(0).getCurrentBranch().getName());
  foo=myTaskManager.createLocalTask("foo");
  localTask=myTaskManager.activateTask(foo,false);
  myTaskManager.activateInVcs(localTask,defaultTask,TaskManager.VcsOperation.CREATE_BRANCH);
  assertEquals("foo",repositories.get(0).getCurrentBranch().getName());
}
