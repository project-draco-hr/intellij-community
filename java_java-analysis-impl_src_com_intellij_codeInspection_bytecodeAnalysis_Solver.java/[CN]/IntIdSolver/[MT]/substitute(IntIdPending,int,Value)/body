{
  if (value == lattice.bot) {
    ArrayList<IntIdComponent> delta=new ArrayList<IntIdComponent>();
    for (    IntIdComponent component : pending.delta) {
      if (!contains(component.ids,id)) {
        delta.add(component);
      }
    }
    if (delta.isEmpty()) {
      return pending.rigid ? new IntIdFinal(pending.infinum) : new IntIdFinal(lattice.bot);
    }
 else {
      return new IntIdPending(pending.infinum,pending.rigid,toArray(delta));
    }
  }
 else   if (value.equals(lattice.top)) {
    ArrayList<IntIdComponent> delta=new ArrayList<IntIdComponent>();
    boolean removed=false;
    for (    IntIdComponent component : pending.delta) {
      component.remove(id);
      if (!component.isEmptyAndTouched()) {
        if (component.isEmpty()) {
          return new IntIdFinal(lattice.top);
        }
 else {
          delta.add(component);
        }
      }
 else {
        removed=true;
      }
    }
    if (delta.isEmpty()) {
      return new IntIdFinal(pending.infinum);
    }
 else {
      return new IntIdPending(pending.infinum,pending.rigid || removed,toArray(delta));
    }
  }
 else {
    Value infinum=lattice.join(pending.infinum,value);
    if (infinum == lattice.top) {
      return new IntIdFinal(lattice.top);
    }
    ArrayList<IntIdComponent> delta=new ArrayList<IntIdComponent>();
    boolean removed=false;
    for (    IntIdComponent component : pending.delta) {
      component.removeAndTouch(id);
      if (!component.isEmpty()) {
        delta.add(component);
      }
 else {
        removed=true;
      }
    }
    if (delta.isEmpty()) {
      return new IntIdFinal(infinum);
    }
 else {
      return new IntIdPending(infinum,pending.rigid || removed,toArray(delta));
    }
  }
}
