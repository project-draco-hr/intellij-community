{
  FeatureUsageTracker.getInstance().triggerFeatureUsed("scratch");
  String fileName=buffer ? "buffer" + nextBufferIndex() : "scratch";
  ScratchFileService.Option option=buffer ? ScratchFileService.Option.create_if_missing : ScratchFileService.Option.create_new_always;
  VirtualFile f=ScratchRootType.getInstance().createScratchFile(project,fileName,language,text,option);
  if (f != null) {
    FileEditorManager.getInstance(project).openFile(f,true);
  }
}
