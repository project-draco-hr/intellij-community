{
  Project project=e.getProject();
  ScratchFileService fileService=ScratchFileService.getInstance();
  JBIterable<VirtualFile> files=JBIterable.of(e.getData(CommonDataKeys.VIRTUAL_FILE_ARRAY)).filter(isScratch());
  if (project == null || files.isEmpty())   return;
  PerFileMappings<Language> mapping=fileService.getScratchesMapping();
  LRUPopupBuilder.forFileLanguages(project,files,mapping).showInBestPositionFor(e.getDataContext());
}
