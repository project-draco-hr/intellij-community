{
  String linkedProjectPath=myLinkedProjectPathField.getText();
  if (StringUtil.isEmpty(linkedProjectPath)) {
    throw new ConfigurationException(ExternalSystemBundle.message("error.project.undefined"));
  }
 else {
    ExternalSystemApiUtil.storeLastUsedExternalProjectPath(linkedProjectPath,myExternalSystemId);
  }
  myProjectSettings.setExternalProjectPath(ExternalSystemApiUtil.normalizePath(linkedProjectPath));
  String errorMessage=myProjectSettingsControl.apply(myProjectSettings);
  if (errorMessage != null) {
    throw new ConfigurationException(errorMessage);
  }
  if (mySystemSettingsControl != null) {
    errorMessage=mySystemSettingsControl.apply(mySystemSettings);
    if (errorMessage != null) {
      throw new ConfigurationException(errorMessage);
    }
  }
}
