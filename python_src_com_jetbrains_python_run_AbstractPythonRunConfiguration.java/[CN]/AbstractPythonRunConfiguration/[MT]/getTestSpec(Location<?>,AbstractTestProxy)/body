{
  PsiElement element=location.getPsiElement();
  PyClass pyClass=PsiTreeUtil.getParentOfType(element,PyClass.class,false);
  if (location instanceof PyPsiLocationWithFixedClass) {
    pyClass=((PyPsiLocationWithFixedClass)location).getFixedClass();
  }
  PyFunction pyFunction=PsiTreeUtil.getParentOfType(element,PyFunction.class,false);
  final VirtualFile virtualFile=location.getVirtualFile();
  if (virtualFile != null) {
    String path=virtualFile.getCanonicalPath();
    if (pyClass != null) {
      path+=TEST_NAME_PARTS_SPLITTER + pyClass.getName();
    }
    if (pyFunction != null) {
      path+=TEST_NAME_PARTS_SPLITTER + pyFunction.getName();
    }
    return path;
  }
  return null;
}
