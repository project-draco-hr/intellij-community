{
  super.checkConfiguration();
  if (!myUseModuleSdk) {
    if (StringUtil.isEmptyOrSpaces(getSdkHome())) {
      final Sdk projectSdk=ProjectRootManager.getInstance(getProject()).getProjectJdk();
      if (projectSdk == null || !(projectSdk.getSdkType() instanceof PythonSdkType)) {
        throw new RuntimeConfigurationException(PyBundle.message("runcfg.unittest.no_sdk"));
      }
    }
 else     if (!PythonSdkType.getInstance().isValidSdkHome(getSdkHome())) {
      throw new RuntimeConfigurationException(PyBundle.message("runcfg.unittest.no_valid_sdk"));
    }
  }
 else {
    Sdk sdk=PythonSdkType.findPythonSdk(getModule());
    if (sdk == null) {
      throw new RuntimeConfigurationException(PyBundle.message("runcfg.unittest.no_module_sdk"));
    }
  }
}
