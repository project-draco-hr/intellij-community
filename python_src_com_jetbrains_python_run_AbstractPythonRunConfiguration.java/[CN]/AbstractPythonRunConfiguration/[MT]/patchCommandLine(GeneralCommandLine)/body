{
  final String sdk_home=getSdkHome();
  if (sdk_home != null) {
    File virtualenv_root=PythonSdkType.getVirtualEnvRoot(sdk_home);
    if (virtualenv_root != null) {
      String virtualenv_bin=new File(virtualenv_root,"bin").getPath();
      String path_value;
      if (isPassParentEnvs()) {
        path_value=System.getenv("PATH");
        if (path_value != null)         path_value=virtualenv_bin + File.pathSeparator + path_value;
 else         path_value=virtualenv_bin;
      }
 else       path_value=virtualenv_bin;
      Map<String,String> new_env;
      Map<String,String> cmd_env=commandLine.getEnvParams();
      if (cmd_env != null)       new_env=new com.intellij.util.containers.HashMap<String,String>(cmd_env);
 else       new_env=new com.intellij.util.containers.HashMap<String,String>();
      String existing_path=new_env.get("PATH");
      if (existing_path == null || existing_path.indexOf(virtualenv_bin) < 0) {
        new_env.put("PATH",path_value);
        commandLine.setEnvParams(new_env);
      }
    }
  }
}
