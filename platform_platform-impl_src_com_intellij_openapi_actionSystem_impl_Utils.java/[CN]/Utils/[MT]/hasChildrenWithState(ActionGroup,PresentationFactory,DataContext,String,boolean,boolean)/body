{
  if (group instanceof AlwaysVisibleActionGroup) {
    return true;
  }
  AnActionEvent event=new AnActionEvent(null,context,place,factory.getPresentation(group),ActionManager.getInstance(),0);
  event.setInjectedContext(group.isInInjectedContext());
  for (  AnAction anAction : group.getChildren(event)) {
    if (anAction == null) {
      LOG.error("Null action found in group " + group + ", "+ factory.getPresentation(group));
      continue;
    }
    if (anAction instanceof Separator) {
      continue;
    }
    final Project project=CommonDataKeys.PROJECT.getData(context);
    if (project != null && DumbService.getInstance(project).isDumb() && !anAction.isDumbAware()) {
      continue;
    }
    final Presentation presentation=factory.getPresentation(anAction);
    updateGroupChild(context,place,anAction,presentation);
    if (anAction instanceof ActionGroup) {
      ActionGroup childGroup=(ActionGroup)anAction;
      if (childGroup.isPopup()) {
        if ((checkVisible && !presentation.isVisible()) || (checkEnabled && !presentation.isEnabled())) {
          continue;
        }
      }
      if (hasChildrenWithState(childGroup,factory,context,place,checkVisible,checkEnabled)) {
        return true;
      }
    }
 else     if ((checkVisible && presentation.isVisible()) || (checkEnabled && presentation.isEnabled())) {
      return true;
    }
  }
  return false;
}
