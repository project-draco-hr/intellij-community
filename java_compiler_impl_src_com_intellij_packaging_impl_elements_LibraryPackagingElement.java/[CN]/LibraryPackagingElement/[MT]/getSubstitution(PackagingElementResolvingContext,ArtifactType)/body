{
  final Library library=findLibrary(context);
  if (library != null) {
    final VirtualFile[] files=library.getFiles(OrderRootType.CLASSES);
    final List<PackagingElement<?>> elements=new ArrayList<PackagingElement<?>>();
    for (    VirtualFile file : files) {
      String localPath=PathUtil.getLocalPath(file);
      if (localPath != null) {
        final String path=FileUtil.toSystemIndependentName(localPath);
        elements.add(file.isDirectory() && file.isInLocalFileSystem() ? new DirectoryCopyPackagingElement(path) : new FileCopyPackagingElement(path));
      }
    }
    return elements;
  }
  return null;
}
