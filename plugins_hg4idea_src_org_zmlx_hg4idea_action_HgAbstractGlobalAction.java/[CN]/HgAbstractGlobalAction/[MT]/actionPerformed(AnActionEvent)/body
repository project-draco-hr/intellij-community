{
  final DataContext dataContext=event.getDataContext();
  final Project project=CommonDataKeys.PROJECT.getData(dataContext);
  if (project == null) {
    return;
  }
  VirtualFile file=event.getData(CommonDataKeys.VIRTUAL_FILE);
  HgRepositoryManager repositoryManager=HgUtil.getRepositoryManager(project);
  HgRepository repo=file != null ? repositoryManager.getRepositoryForFile(file) : HgUtil.getCurrentRepository(project);
  List<HgRepository> repositories=repositoryManager.getRepositories();
  if (!repositories.isEmpty()) {
    execute(project,repositories,repo);
  }
}
