{
  final Icon icon=state.getLevel().getIcon();
  final String scopeName=state.getScopeName();
  if (icon instanceof HighlightDisplayLevel.SingleColorIconWithMask) {
    if (myIsFirst) {
      myScopeToAverageSeverityMap.put(scopeName,state.getLevel().getSeverity());
    }
 else {
      final HighlightSeverity severity=myScopeToAverageSeverityMap.get(scopeName);
      if (!ScopesAndSeveritiesTable.MIXED_FAKE_SEVERITY.equals(severity) && !Comparing.equal(severity,state.getLevel().getSeverity())) {
        myScopeToAverageSeverityMap.put(scopeName,ScopesAndSeveritiesTable.MIXED_FAKE_SEVERITY);
      }
    }
  }
 else   if (!ScopesAndSeveritiesTable.MIXED_FAKE_SEVERITY.equals(myScopeToAverageSeverityMap.get(scopeName))) {
    myScopeToAverageSeverityMap.put(scopeName,ScopesAndSeveritiesTable.MIXED_FAKE_SEVERITY);
  }
}
