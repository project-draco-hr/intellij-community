{
  Set<Integer> walkNodes=new HashSet<Integer>();
  TreeSetNodeIterator walker=new TreeSetNodeIterator(startNode,toUp);
  while (walker.notEmpty()) {
    Integer next=walker.pop();
    if (!stopFunction.value(next)) {
      walkNodes.add(next);
      walker.addAll(getNodes(next,toUp));
    }
  }
  return walkNodes;
}
