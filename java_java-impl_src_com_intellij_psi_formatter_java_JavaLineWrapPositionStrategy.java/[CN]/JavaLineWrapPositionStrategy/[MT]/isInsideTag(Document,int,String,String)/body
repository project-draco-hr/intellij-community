{
  CharSequence sequence=document.getCharsSequence();
  final int lineNumber=document.getLineNumber(offset);
  final int lineStartOffset=document.getLineStartOffset(lineNumber);
  final int lineEndOffset=document.getLineEndOffset(lineNumber);
  int searchStartOffset=lineStartOffset;
  int searchEndOffset=lineEndOffset;
  if (lineEndOffset - lineStartOffset > 200) {
    searchStartOffset=Math.max(offset - 100,lineStartOffset);
    searchEndOffset=Math.min(offset + 100,lineEndOffset);
  }
  return CharArrayUtil.indexOf(sequence,tagStart,searchStartOffset,offset) > 0 && CharArrayUtil.indexOf(sequence,tagEnd,offset,searchEndOffset) > 0;
}
