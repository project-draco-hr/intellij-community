{
  BufferedWriter uninstWriter=new BufferedWriter(new FileWriter(myUnInstFile));
  try {
    List<String> allFiles=new ArrayList<String>();
    final Collection<List<String>> lists=myDirToFiles.values();
    for (    final List<String> list : lists) {
      allFiles.addAll(list);
    }
    Collections.sort(allFiles);
    for (    String file : allFiles) {
      uninstWriter.newLine();
      final String relPath=myAbsoluteToRelative.get(file);
      uninstWriter.write("Delete \"$INSTDIR\\" + toWinPath(relPath) + "\"");
      if (relPath.endsWith(".py")) {
        uninstWriter.newLine();
        uninstWriter.write("Delete \"$INSTDIR\\" + toWinPath(relPath) + "c\"");
      }
    }
    uninstWriter.newLine();
    List<String> dirs=new ArrayList<String>(myDirToFiles.keySet());
    Collections.sort(dirs);
    for (int i=dirs.size() - 1; i >= 0; i--) {
      final String dir=dirs.get(i);
      if (dir.length() == 0)       continue;
      uninstWriter.newLine();
      uninstWriter.write("RmDir /r \"$INSTDIR\\" + toWinPath(dir) + "\\__pycache__\"");
      uninstWriter.newLine();
      uninstWriter.write("RmDir \"$INSTDIR\\" + toWinPath(dir) + "\"");
    }
    uninstWriter.newLine();
    uninstWriter.write("RmDir \"$INSTDIR\"");
  }
  finally {
    uninstWriter.close();
  }
}
