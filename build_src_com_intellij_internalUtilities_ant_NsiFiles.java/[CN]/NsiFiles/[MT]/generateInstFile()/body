{
  BufferedWriter instWriter=new BufferedWriter(new FileWriter(myInstFile));
  try {
    Collection<String> dirs=myDirToFiles.keySet();
    for (    String dir : dirs) {
      final List<String> files=myDirToFiles.get(dir);
      if (files.size() == 0)       continue;
      instWriter.newLine();
      instWriter.newLine();
      if (dir.length() > 0) {
        instWriter.write("SetOutPath $INSTDIR\\" + dir);
      }
 else {
        instWriter.write("SetOutPath $INSTDIR");
      }
      for (      String file : files) {
        instWriter.newLine();
        instWriter.write("File \"" + file + "\"");
      }
    }
  }
  finally {
    instWriter.close();
  }
}
