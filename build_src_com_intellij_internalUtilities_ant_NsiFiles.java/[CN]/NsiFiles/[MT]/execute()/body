{
  if (myInstFile == null)   throw new BuildException("Specify required isntFile attribute.");
  if (myUnInstFile == null)   throw new BuildException("Specify required unisntFile attribute.");
  if (myBaseDir == null && myFileSets.size() == 0) {
    throw new BuildException("basedir attribute must be set, " + "or at least " + "one fileset must be given!");
  }
  try {
    if (myBaseDir != null) {
      FileSet fs=(FileSet)getImplicitFileSet().clone();
      fs.setDir(myBaseDir);
      processFileSet(fs);
    }
    for (    FileSet fileSet : myFileSets) {
      processFileSet(fileSet);
    }
    generateInstFile();
    generateUninstFile();
  }
 catch (  IOException e) {
    throw new BuildException(e);
  }
 finally {
    cleanup();
  }
}
