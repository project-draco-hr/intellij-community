{
  if (!(object instanceof PsiElement))   return null;
  Project project=((PsiElement)object).getProject();
  VirtualFile virtualFile=PsiUtilCore.getVirtualFile((PsiElement)object);
  if (virtualFile == null || !virtualFile.isValid())   return null;
  RootType rootType=ScratchFileService.getInstance().getRootType(virtualFile);
  if (rootType == null)   return null;
  if (virtualFile.isDirectory()) {
    return additionalRoots(project).contains(virtualFile) ? rootType.getDisplayName() : null;
  }
  return rootType.substituteName(project,virtualFile);
}
