{
  String url=StringUtil.nullize(urlTextField.getText());
  if (url != null) {
    try {
      if (!icsManager.getRepositoryService().checkUrl(url,getContentPane())) {
        return false;
      }
    }
 catch (    Exception e) {
      return false;
    }
  }
  try {
    RepositoryManager repositoryManager=icsManager.getRepositoryManager();
    if (repositoryManager.createRepositoryIfNeed() && syncType != SyncType.RESET_TO_THEIRS) {
      try {
        SettingsRepositoryPackage.copyLocalConfig();
      }
 catch (      Throwable e) {
        throw e;
      }
    }
    repositoryManager.setUpstream(url,null);
    return true;
  }
 catch (  Throwable e) {
    SettingsRepositoryPackage.getLOG().warn(e);
    Messages.showErrorDialog(getContentPane(),IcsBundle.OBJECT$.message("set.upstream.failed.message",e.getMessage()),IcsBundle.OBJECT$.message("set.upstream.failed.title"));
    return false;
  }
}
