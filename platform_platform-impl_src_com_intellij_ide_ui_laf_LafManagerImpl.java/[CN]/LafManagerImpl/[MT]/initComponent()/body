{
  if (myCurrentLaf != null) {
    final UIManager.LookAndFeelInfo laf=findLaf(myCurrentLaf.getClassName());
    if (laf != null) {
      boolean needUninstall=UIUtil.isUnderDarcula();
      setCurrentLookAndFeel(laf);
      if (WelcomeWizardUtil.getWizardLAF() != null) {
        if (UIUtil.isUnderDarcula()) {
          DarculaInstaller.install();
        }
 else         if (needUninstall) {
          DarculaInstaller.uninstall();
        }
      }
    }
  }
  updateUI();
  if (SystemInfo.isXWindow) {
    myThemeChangeListener=new PropertyChangeListener(){
      @Override public void propertyChange(      final PropertyChangeEvent evt){
        SwingUtilities.invokeLater(new Runnable(){
          @Override public void run(){
            fixGtkPopupStyle();
            patchGtkDefaults(UIManager.getLookAndFeelDefaults());
          }
        }
);
      }
    }
;
    Toolkit.getDefaultToolkit().addPropertyChangeListener(GNOME_THEME_PROPERTY_NAME,myThemeChangeListener);
  }
}
