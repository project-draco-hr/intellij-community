{
  StateStorageManager manager=((ProjectEx)project).getStateStore().getStateStorageManager();
  String projectId=getProjectId(project);
  manager.registerStreamProvider(new IcsStreamProvider(projectId),RoamingType.PER_PLATFORM);
  manager.registerStreamProvider(new IcsStreamProvider(projectId){
    @Override protected boolean isShareable(    @NotNull String fileSpec){
      return settings.shareProjectWorkspace || (!fileSpec.equals(StoragePathMacros.WORKSPACE_FILE) && !fileSpec.equals(WORKSPACE_VERSION_FILE));
    }
  }
,RoamingType.PER_USER);
}
