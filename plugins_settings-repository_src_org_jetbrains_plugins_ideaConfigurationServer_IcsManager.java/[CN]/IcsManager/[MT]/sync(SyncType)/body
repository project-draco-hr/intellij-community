{
  cancelAndDisableAutoCommit();
  final ActionCallback actionCallback=new ActionCallback(3);
  ProgressManager.getInstance().run(new Task.Modal(null,IcsBundle.message("task.sync.title"),true){
    @Override public void run(    @NotNull ProgressIndicator indicator){
      indicator.setIndeterminate(true);
      ApplicationManager.getApplication().invokeAndWait(new Runnable(){
        @Override public void run(){
          ApplicationManager.getApplication().saveSettings();
        }
      }
,ModalityState.any());
      repositoryManager.commit(indicator).notify(actionCallback);
      repositoryManager.pull(indicator).notify(actionCallback);
      repositoryManager.push(indicator).notify(actionCallback);
      awaitCallback(indicator,actionCallback,getTitle());
    }
  }
);
  actionCallback.doWhenProcessed(new Runnable(){
    @Override public void run(){
      autoCommitEnabled=true;
    }
  }
);
  return actionCallback;
}
