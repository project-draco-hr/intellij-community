{
  final Set<String> pluginsToEnable=new HashSet<String>();
  final List<PluginNode> nodes=new ArrayList<PluginNode>();
  for (  PluginDownloader downloader : myUploadedPlugins) {
    String pluginId=downloader.getPluginId();
    if (!mySkippedPlugins.contains(pluginId)) {
      pluginsToEnable.add(pluginId);
      if (!PluginManagerCore.getDisabledPlugins().contains(pluginId)) {
        final PluginNode pluginNode=PluginDownloader.createPluginNode(null,downloader);
        if (pluginNode != null) {
          nodes.add(pluginNode);
        }
      }
    }
  }
  final Runnable notifyRunnable=new Runnable(){
    @Override public void run(){
      PluginManagerMain.notifyPluginsUpdated(myProject);
    }
  }
;
  for (  String pluginId : pluginsToEnable) {
    PluginManagerCore.enablePlugin(pluginId);
  }
  if (!nodes.isEmpty()) {
    try {
      PluginManagerMain.downloadPlugins(nodes,myAllPlugins,notifyRunnable,null);
    }
 catch (    IOException e) {
      LOG.error(e);
    }
  }
 else {
    if (!pluginsToEnable.isEmpty()) {
      notifyRunnable.run();
    }
  }
  super.doOKAction();
}
