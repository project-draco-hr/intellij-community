{
  Set<VirtualFile> roots=GitUtil.gitRoots(getSelectedFilePaths());
  final Ref<VcsException> exception=Ref.create();
  String joined=StringUtil.join(roots,new Function<VirtualFile,String>(){
    @Override public String fun(    VirtualFile root){
      try {
        return getLastCommitMessage(root);
      }
 catch (      VcsException e) {
        exception.set(e);
        return null;
      }
    }
  }
,"\n");
  if (!exception.isNull()) {
    throw exception.get();
  }
  return joined;
}
