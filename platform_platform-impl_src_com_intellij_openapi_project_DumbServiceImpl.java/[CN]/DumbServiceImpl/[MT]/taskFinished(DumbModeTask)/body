{
  UIUtil.invokeAndWaitIfNeeded(new Runnable(){
    @Override public void run(){
      if (myProject.isDisposed())       return;
      Disposer.dispose(prevTask);
      while (true) {
        if (myUpdatesQueue.isEmpty()) {
          updateFinished();
          return;
        }
        DumbModeTask queuedTask=myUpdatesQueue.pullFirst();
        ProgressIndicatorEx indicator=myProgresses.get(queuedTask);
        if (indicator.isCanceled()) {
          Disposer.dispose(queuedTask);
          continue;
        }
        startBackgroundProcess(queuedTask,indicator);
        return;
      }
    }
  }
);
}
