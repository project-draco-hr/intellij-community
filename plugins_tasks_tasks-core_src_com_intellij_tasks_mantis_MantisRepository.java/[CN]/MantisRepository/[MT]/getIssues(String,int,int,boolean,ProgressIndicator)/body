{
  if (myCurrentProject == null || myCurrentFilter == null) {
    throw new Exception(TaskBundle.message("failure.configuration"));
  }
  ensureProjectsRefreshed();
  MantisConnectPortType soap=createSoap();
  int total=limit - offset + 1;
  List<Task> tasks=new ArrayList<Task>(total);
  int pageNumber=offset / PAGE_SIZE + 1;
  while (tasks.size() < total) {
    cancelled.checkCanceled();
    int pageSize=Math.min(PAGE_SIZE,total - tasks.size());
    List<Task> issuesFromPage=getIssuesFromPage(soap,pageNumber,pageSize);
    tasks.addAll(issuesFromPage);
    if (issuesFromPage.size() < pageSize) {
      break;
    }
    pageNumber++;
  }
  return tasks.toArray(new Task[tasks.size()]);
}
