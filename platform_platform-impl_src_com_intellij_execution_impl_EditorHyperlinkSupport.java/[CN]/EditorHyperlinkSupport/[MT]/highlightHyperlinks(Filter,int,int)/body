{
  final Document document=myEditor.getDocument();
  final int startLine=Math.max(0,line1);
  for (int line=startLine; line <= endLine; line++) {
    int endOffset=document.getLineEndOffset(line);
    if (endOffset < document.getTextLength()) {
      endOffset++;
    }
    final String text=getLineText(document,line,true);
    Filter.Result result=customFilter.applyFilter(text,endOffset);
    if (result != null) {
      for (      Filter.ResultItem resultItem : result.getResultItems()) {
        int start=resultItem.getHighlightStartOffset();
        int end=resultItem.getHighlightEndOffset();
        if (end < start || end > document.getTextLength()) {
          LOG.error("Filter returned wrong range: start=" + start + "; end="+ end+ "; length="+ document.getTextLength()+ "; filter="+ customFilter);
          continue;
        }
        TextAttributes attributes=resultItem.getHighlightAttributes();
        if (resultItem.getHyperlinkInfo() != null) {
          createHyperlink(start,end,attributes,resultItem.getHyperlinkInfo(),resultItem.getFollowedHyperlinkAttributes());
        }
 else         if (attributes != null) {
          addHighlighter(start,end,attributes);
        }
      }
    }
  }
}
