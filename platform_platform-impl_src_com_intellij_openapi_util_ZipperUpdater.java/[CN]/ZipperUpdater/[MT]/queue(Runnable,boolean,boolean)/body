{
synchronized (myLock) {
    if (myAlarm.isDisposed())     return;
    final boolean wasRaised=myRaised;
    myRaised=true;
    myIsEmpty=false;
    if (!wasRaised) {
      final Runnable request=new Runnable(){
        public void run(){
synchronized (myLock) {
            if (!myRaised)             return;
            myRaised=false;
          }
          runnable.run();
synchronized (myLock) {
            myIsEmpty=!myRaised;
          }
        }
        @Override public String toString(){
          return runnable.toString();
        }
      }
;
      if (Alarm.ThreadToUse.SWING_THREAD.equals(myThreadToUse)) {
        if (anyModality) {
          myAlarm.addRequest(request,urgent ? 0 : myDelay,ModalityState.any());
        }
 else         if (!ApplicationManager.getApplication().isDispatchThread()) {
          myAlarm.addRequest(request,urgent ? 0 : myDelay,ModalityState.NON_MODAL);
        }
 else {
          myAlarm.addRequest(request,urgent ? 0 : myDelay);
        }
      }
 else {
        myAlarm.addRequest(request,urgent ? 0 : myDelay);
      }
    }
  }
}
