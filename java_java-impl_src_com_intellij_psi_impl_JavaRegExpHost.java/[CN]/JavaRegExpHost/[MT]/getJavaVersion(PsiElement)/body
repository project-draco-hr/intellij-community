{
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    return JavaSdkVersion.JDK_1_9;
  }
  final Module module=ModuleUtilCore.findModuleForPsiElement(element);
  if (module != null) {
    final Sdk sdk=ModuleRootManager.getInstance(module).getSdk();
    if (sdk != null && sdk.getSdkType() instanceof JavaSdk) {
      return JavaSdk.getInstance().getVersion(sdk);
    }
  }
  final Sdk sdk=ProjectRootManager.getInstance(element.getProject()).getProjectSdk();
  if (sdk != null && sdk.getSdkType() instanceof JavaSdk) {
    return JavaSdk.getInstance().getVersion(sdk);
  }
  return null;
}
