{
  if (isEnabled() && charTyped == ' ' && shouldIgnoreSpace(editor)) {
    myIgnoreNextSpace=false;
    return;
  }
  Document document=editor.getDocument();
  boolean addSpaces=isEnabled() && charTyped == '=' && shouldInsertSpaces(editor,dataContext);
  int caretOffset=editor.getCaretModel().getOffset();
  CharSequence text=document.getImmutableCharSequence();
  if (addSpaces && shouldInsertBefore(caretOffset,text)) {
    EditorModificationUtil.insertStringAtCaret(editor," ");
  }
  if (myOriginalHandler != null)   myOriginalHandler.execute(editor,charTyped,dataContext);
  if (addSpaces) {
    EditorModificationUtil.insertStringAtCaret(editor," ");
    myIgnoreNextSpace=true;
    myLastModifiedDocument=document;
    myLastOffset=editor.getCaretModel().getOffset();
  }
 else {
    myIgnoreNextSpace=false;
  }
}
