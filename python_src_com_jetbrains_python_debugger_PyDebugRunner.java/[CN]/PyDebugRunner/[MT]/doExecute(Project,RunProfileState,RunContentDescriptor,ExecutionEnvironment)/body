{
  FileDocumentManager.getInstance().saveAllDocuments();
  final PythonCommandLineState pyState=(PythonCommandLineState)profileState;
  final ServerSocket serverSocket=PythonCommandLineState.createServerSocket();
  final int serverLocalPort=serverSocket.getLocalPort();
  RunProfile profile=env.getRunProfile();
  final ExecutionResult result=pyState.execute(env.getExecutor(),createCommandLinePatchers(project,pyState,profile,serverLocalPort));
  final XDebugSession session=XDebuggerManager.getInstance(project).startSession(this,env,contentToReuse,new XDebugProcessStarter(){
    @NotNull public XDebugProcess start(    @NotNull final XDebugSession session){
      PyDebugProcess pyDebugProcess=new PyDebugProcess(session,serverSocket,result.getExecutionConsole(),result.getProcessHandler(),pyState.isMultiprocessDebug());
      createConsoleCommunicationAndSetupActions(project,result,pyDebugProcess);
      return pyDebugProcess;
    }
  }
);
  return session.getRunContentDescriptor();
}
