{
  FileDocumentManager.getInstance().saveAllDocuments();
  final PythonCommandLineState pyState=(PythonCommandLineState)profileState;
  final Pair<ServerSocket,Integer> serverSocket=pyState.createDebugServerSocket();
  final int serverLocalPort=serverSocket.getSecond();
  RunProfile profile=env.getRunProfile();
  final ExecutionResult result=pyState.execute(executor,createCommandLinePatchers(pyState,profile,serverLocalPort));
  final XDebugSession session=XDebuggerManager.getInstance(project).startSession(this,env,contentToReuse,new XDebugProcessStarter(){
    @NotNull public XDebugProcess start(    @NotNull final XDebugSession session){
      PyDebugProcess pyDebugProcess=new PyDebugProcess(session,serverSocket.getFirst(),result.getExecutionConsole(),result.getProcessHandler(),pyState.isMultiprocessDebug());
      createConsoleCommunicationAndSetupActions(project,result,pyDebugProcess);
      return pyDebugProcess;
    }
  }
);
  return session.getRunContentDescriptor();
}
