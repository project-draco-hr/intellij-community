{
  if (value instanceof MapInfo) {
    MapInfo info=(MapInfo)value;
    if (info.type == MapInfo.Type.INVALID) {
      setForeground(Color.RED);
    }
    if (info.mapping.isDefaultMapping()) {
      append(VcsDirectoryMapping.PROJECT_CONSTANT);
      return;
    }
    String directory=info.mapping.getDirectory();
    VirtualFile baseDir=myProject.getBaseDir();
    if (baseDir != null) {
      final File directoryFile=new File(StringUtil.trimEnd(UriUtil.trimTrailingSlashes(directory),"\\") + "/");
      File ioBase=new File(baseDir.getPath());
      if (directoryFile.isAbsolute() && !FileUtil.isAncestor(ioBase,directoryFile,false)) {
        append(new File(directory).getPath());
        return;
      }
      String relativePath=FileUtil.getRelativePath(ioBase,directoryFile);
      if (".".equals(relativePath) || relativePath == null) {
        append(ioBase.getPath());
      }
 else {
        append(relativePath);
        append(" (" + ioBase + ")",SimpleTextAttributes.GRAYED_ATTRIBUTES);
      }
    }
  }
}
