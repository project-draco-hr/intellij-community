{
  VirtualFileSystemEntry cached=myIdToDirCache.get(id);
  if (cached != null)   return cached;
  TIntArrayList parents=FSRecords.getParents(id);
  int rootId=parents.get(parents.size() - 1);
  VirtualFileSystemEntry result=myRootsById.get(rootId);
  for (int i=parents.size() - 2; i >= 0; i--) {
    if (result == null) {
      break;
    }
    int parentId=parents.get(i);
    result=((VirtualDirectoryImpl)result).findChildById(parentId,cachedOnly);
  }
  if (result != null && result.isDirectory()) {
    VirtualFileSystemEntry old=myIdToDirCache.put(id,result);
    if (old != null)     result=old;
  }
  return result;
}
