{
  final SnuggleEngine engine=new SnuggleEngine();
  engine.getPackages().add(0,IpnbTexPackageDefinitions.getPackage());
  final SnuggleSession session=engine.createSession();
  final SnuggleInput input=new SnuggleInput(formulaText);
  try {
    session.parseInput(input);
    XMLStringOutputOptions options=new XMLStringOutputOptions();
    options.setIndenting(true);
    options.setAddingMathSourceAnnotations(false);
    final String xmlString=session.buildXMLString(options);
    if (xmlString == null)     return;
    final LayoutContextImpl context=(LayoutContextImpl)LayoutContextImpl.getDefaultLayoutContext();
    context.setParameter(Parameter.MATHSIZE,18);
    final Document document=MathMLParserSupport.parseString(xmlString);
    final BufferedImage image=Converter.getInstance().render(document,context);
    final JLabel label=new JLabel();
    label.setIcon(new ImageIcon(image));
    panel.add(label);
  }
 catch (  IOException e) {
    LOG.error(e);
  }
catch (  SAXException e) {
    e.printStackTrace();
  }
catch (  ParserConfigurationException e) {
    e.printStackTrace();
  }
}
