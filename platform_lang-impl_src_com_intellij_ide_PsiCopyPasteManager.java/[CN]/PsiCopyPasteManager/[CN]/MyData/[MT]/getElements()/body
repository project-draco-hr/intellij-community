{
  if (myElements == null)   return PsiElement.EMPTY_ARRAY;
  ApplicationManager.getApplication().runReadAction(new Runnable(){
    @Override public void run(){
      int validElementsCount=0;
      for (      PsiElement element : myElements) {
        if (element.isValid()) {
          validElementsCount++;
        }
      }
      if (validElementsCount != myElements.length) {
        PsiElement[] validElements=new PsiElement[validElementsCount];
        int j=0;
        for (        PsiElement element : myElements) {
          if (element.isValid()) {
            validElements[j++]=element;
          }
        }
        myElements=validElements;
      }
    }
  }
);
  return myElements;
}
