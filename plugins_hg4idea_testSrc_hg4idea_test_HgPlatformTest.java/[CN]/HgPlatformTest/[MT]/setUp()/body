{
  super.setUp();
  try {
    myProjectFixture=IdeaTestFixtureFactory.getFixtureFactory().createFixtureBuilder(getTestName(true)).getFixture();
    myProjectFixture.setUp();
  }
 catch (  Exception e) {
    super.tearDown();
    throw e;
  }
  try {
    myProject=myProjectFixture.getProject();
    VirtualFile projectRoot=myProject.getBaseDir();
    cd(projectRoot);
    hg("version");
    createRepository(projectRoot);
    myVcs=HgVcs.getInstance(myProject);
    assertNotNull(myVcs);
    myVcs.getGlobalSettings().setHgExecutable(HgExecutor.getHgExecutable());
    myVcs.checkVersion();
    myRepository=projectRoot;
    setUpHgrc(myRepository);
  }
 catch (  Exception e) {
    tearDown();
    throw e;
  }
}
