{
  final List<T> result=new ArrayList<T>();
  for (  final PsiElement element : myPsiElements) {
    final T typedElement=PyUtil.as(element,expectedClass);
    if (typedElement != null) {
      result.add(typedElement);
    }
 else {
      final T[] children=PsiTreeUtil.getChildrenOfType(element,expectedClass);
      if (children != null) {
        Collections.addAll(result,children);
      }
    }
  }
  return result;
}
