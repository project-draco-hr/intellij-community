{
  JTextComponent oldComponent=search ? mySearchTextComponent : myReplaceTextComponent;
  Color oldBackground=oldComponent != null ? oldComponent.getBackground() : null;
  final MyTextComponentWrapper wrapper=search ? mySearchFieldWrapper : myReplaceFieldWrapper;
  if (oldComponent != null)   return false;
  final JTextComponent textComponent;
  SearchTextArea textArea=new SearchTextArea(search);
  textComponent=textArea.getTextArea();
  ((JTextArea)textComponent).setRows(isMultiline() ? 2 : 1);
  KeymapUtil.reassignAction(textComponent,KeyStroke.getKeyStroke(KeyEvent.VK_ENTER,0),NEW_LINE_KEYSTROKE,WHEN_FOCUSED);
  wrapper.setContent(textArea);
  UIUtil.addUndoRedoActions(textComponent);
  Utils.setSmallerFont(textComponent);
  textComponent.putClientProperty("AuxEditorComponent",Boolean.TRUE);
  if (oldBackground != null) {
    textComponent.setBackground(oldBackground);
  }
  textComponent.addFocusListener(new FocusListener(){
    @Override public void focusGained(    final FocusEvent e){
      textComponent.repaint();
    }
    @Override public void focusLost(    final FocusEvent e){
      textComponent.repaint();
    }
  }
);
  installCloseOnEscapeAction(textComponent);
  return true;
}
