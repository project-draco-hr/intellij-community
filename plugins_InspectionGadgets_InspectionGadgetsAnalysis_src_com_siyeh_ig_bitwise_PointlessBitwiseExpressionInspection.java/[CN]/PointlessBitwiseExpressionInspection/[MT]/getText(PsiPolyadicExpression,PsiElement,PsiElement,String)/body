{
  final StringBuilder result=new StringBuilder();
  boolean stop=false;
  for (  PsiElement child : expression.getChildren()) {
    if (child == fromTarget) {
      stop=true;
      result.append(replacement);
    }
 else     if (child == untilTarget) {
      stop=false;
    }
 else     if (child instanceof PsiComment || !stop) {
      result.append(child.getText());
    }
 else     if (child instanceof PsiJavaToken && untilTarget == null) {
      stop=false;
    }
  }
  return result.toString();
}
