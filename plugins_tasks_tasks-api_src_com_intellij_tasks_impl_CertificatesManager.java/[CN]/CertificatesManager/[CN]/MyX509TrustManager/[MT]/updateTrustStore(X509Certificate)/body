{
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    @Override public void run(){
      String message=String.format("<html>" + "<p>The following server's certificate is unknown and appears to be self-signed:</p>" + "<pre><h3>Certificate details</h3>%s</pre></br>"+ "<p>Add it to trust storage?</p>"+ "</html>",formatX509Certificate(certificate));
      int res=Messages.showOkCancelDialog(message,"Unknown Server's Certificate","Accept","Reject",AllIcons.General.WarningDialog);
      if (res == Messages.OK) {
        LOG.debug("Certificate was accepted");
        myCustomManager.addCertificate(certificate);
      }
    }
  }
,ModalityState.any());
}
