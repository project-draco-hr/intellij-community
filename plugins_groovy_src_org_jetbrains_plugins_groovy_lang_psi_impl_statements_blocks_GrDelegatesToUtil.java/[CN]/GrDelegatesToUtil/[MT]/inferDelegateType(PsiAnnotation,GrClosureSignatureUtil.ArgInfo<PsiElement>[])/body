{
  final PsiAnnotationMemberValue value=delegatesTo.findDeclaredAttributeValue("value");
  if (value instanceof GrReferenceExpression) {
    return extractTypeFromClassType(((GrReferenceExpression)value).getType());
  }
 else   if (value instanceof PsiClassObjectAccessExpression) {
    return extractTypeFromClassType(((PsiClassObjectAccessExpression)value).getType());
  }
 else   if (value == null || value instanceof PsiLiteralExpression && ((PsiLiteralExpression)value).getType() == PsiType.NULL || value instanceof GrLiteral && ((GrLiteral)value).getType() == PsiType.NULL) {
    String target=GrAnnotationUtil.inferStringAttribute(delegatesTo,"target");
    if (target == null)     return null;
    final int parameter=findTargetParameter(delegatesTo,target);
    if (parameter >= 0) {
      final PsiType type=map[parameter].type;
      final Integer index=GrAnnotationUtil.inferIntegerAttribute(delegatesTo,"genericTypeIndex");
      if (index == null) {
        return type;
      }
      if (type instanceof PsiClassType) {
        final PsiType[] parameters=((PsiClassType)type).getParameters();
        if (parameters.length > index) {
          return parameters[index];
        }
      }
      return null;
    }
  }
 else   if (value instanceof PsiExpression) {
    return ((PsiExpression)value).getType();
  }
  return null;
}
