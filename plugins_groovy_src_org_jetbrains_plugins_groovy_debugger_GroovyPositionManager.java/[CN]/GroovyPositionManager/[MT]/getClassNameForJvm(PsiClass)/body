{
  String suffix=typeDefinition instanceof GrTypeDefinition && ((GrTypeDefinition)typeDefinition).isTrait() ? "$Trait$Helper" : "";
  final PsiClass psiClass=typeDefinition.getContainingClass();
  if (psiClass != null) {
    String parent=getClassNameForJvm(psiClass);
    return parent == null ? null : parent + "$" + typeDefinition.getName()+ suffix;
  }
  for (  ScriptPositionManagerHelper helper : ScriptPositionManagerHelper.EP_NAME.getExtensions()) {
    final String s=helper.customizeClassName(typeDefinition);
    if (s != null) {
      return s;
    }
  }
  String qname=typeDefinition.getQualifiedName();
  return qname == null ? null : qname + suffix;
}
