{
  final JUnitConfiguration.Data data=getConfiguration().getPersistentData();
  return new SearchForTestsTask(getConfiguration().getProject(),myServerSocket){
    private final THashSet<PsiClass> myClasses=new THashSet<PsiClass>();
    @Override protected void search(){
      myClasses.clear();
      try {
        ConfigurationUtil.findAllTestClasses(getClassFilter(data),myClasses);
      }
 catch (      CantRunException ignored) {
      }
    }
    @Override protected void onFound(){
      myFoundTests=!myClasses.isEmpty();
      try {
        addClassesListToJavaParameters(myClasses,new Function<PsiElement,String>(){
          @Override @Nullable public String fun(          final PsiElement element){
            if (element instanceof PsiClass) {
              return JavaExecutionUtil.getRuntimeQualifiedName((PsiClass)element);
            }
 else             if (element instanceof PsiMethod) {
              final PsiMethod method=(PsiMethod)element;
              return JavaExecutionUtil.getRuntimeQualifiedName(method.getContainingClass()) + "," + method.getName();
            }
 else {
              return null;
            }
          }
        }
,getPackageName(data),false,getJavaParameters());
      }
 catch (      ExecutionException ignored) {
      }
    }
  }
;
}
