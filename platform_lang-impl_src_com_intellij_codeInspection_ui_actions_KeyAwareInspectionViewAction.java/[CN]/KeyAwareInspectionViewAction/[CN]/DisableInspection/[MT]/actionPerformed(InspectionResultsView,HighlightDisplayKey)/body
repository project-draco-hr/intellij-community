{
  try {
    if (view.isSingleInspectionRun()) {
      final ModifiableModel model=view.getCurrentProfile().getModifiableModel();
      model.disableTool(key.toString(),view.getProject());
      model.commit();
      view.updateCurrentProfile();
    }
 else {
      final RefEntity[] selectedElements=view.getTree().getSelectedElements();
      final Set<PsiElement> files=new HashSet<PsiElement>();
      final Project project=view.getProject();
      final InspectionProjectProfileManager profileManager=InspectionProjectProfileManager.getInstance(project);
      for (      RefEntity selectedElement : selectedElements) {
        if (selectedElement instanceof RefElement) {
          final PsiElement element=((RefElement)selectedElement).getElement();
          files.add(element);
        }
      }
      ModifiableModel model=profileManager.getCurrentProfile().getModifiableModel();
      for (      PsiElement element : files) {
        model.disableTool(key.toString(),element);
      }
      model.commit();
      DaemonCodeAnalyzer.getInstance(project).restart();
    }
  }
 catch (  IOException e1) {
    Messages.showErrorDialog(view.getProject(),e1.getMessage(),CommonBundle.getErrorTitle());
  }
}
