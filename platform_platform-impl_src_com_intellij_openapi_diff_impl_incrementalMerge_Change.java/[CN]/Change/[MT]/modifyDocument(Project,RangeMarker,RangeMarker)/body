{
  Document document=target.getDocument();
  if (project != null && !ReadonlyStatusHandler.ensureDocumentWritable(project,document)) {
    return null;
  }
  if (DocumentUtil.isEmpty(original)) {
    int offset=target.getStartOffset();
    document.deleteString(offset,target.getEndOffset());
  }
  CharSequence text=original.getDocument().getImmutableCharSequence().subSequence(original.getStartOffset(),original.getEndOffset());
  int startOffset=target.getStartOffset();
  if (DocumentUtil.isEmpty(target)) {
    document.insertString(startOffset,text);
  }
 else {
    document.replaceString(startOffset,target.getEndOffset(),text);
  }
  return new TextRange(startOffset,startOffset + text.length());
}
