{
  return WriteCommandAction.runWriteCommandAction(getProject(),new ThrowableComputable<Editor,IOException>(){
    @Override public Editor compute() throws IOException {
      VirtualFile myVFile=VfsTestUtil.createFile(getSourceRoot(),relativePath);
      VfsUtil.saveText(myVFile,fileText);
      final FileDocumentManager manager=FileDocumentManager.getInstance();
      final Document document=manager.getDocument(myVFile);
      assertNotNull("Can't create document for '" + relativePath + "'",document);
      manager.reloadFromDisk(document);
      document.insertString(0," ");
      document.deleteString(0,1);
      PsiFile myFile=getPsiManager().findFile(myVFile);
      assertNotNull("Can't create PsiFile for '" + relativePath + "'. Unknown file type most probably.",myFile);
      assertTrue(myFile.isPhysical());
      Editor myEditor=createEditor(myVFile);
      myVFile.setCharset(CharsetToolkit.UTF8_CHARSET);
      PsiDocumentManager.getInstance(getProject()).commitAllDocuments();
      return myEditor;
    }
  }
);
}
