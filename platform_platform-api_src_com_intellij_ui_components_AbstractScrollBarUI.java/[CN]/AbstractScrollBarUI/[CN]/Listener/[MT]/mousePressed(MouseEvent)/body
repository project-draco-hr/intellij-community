{
  if (myScrollBar == null || !myScrollBar.isEnabled())   return;
  if (SwingUtilities.isRightMouseButton(event))   return;
  isValueCached=true;
  myCachedValue=myScrollBar.getValue();
  myScrollBar.setValueIsAdjusting(true);
  myMouseX=event.getX();
  myMouseY=event.getY();
  boolean vertical=VERTICAL == myScrollBar.getOrientation();
  if (myThumbBounds.contains(myMouseX,myMouseY)) {
    myOffset=vertical ? (myMouseY - myThumbBounds.y) : (myMouseX - myThumbBounds.x);
    isDragging=true;
  }
 else   if ((isTrackVisible || myScrollBar.isOpaque()) && myTrackBounds.contains(myMouseX,myMouseY)) {
    if (isAbsolutePositioning(event)) {
      myOffset=(vertical ? myThumbBounds.height : myThumbBounds.width) / 2;
      isDragging=true;
      setValueFrom(event);
    }
 else {
      myScrollTimer.stop();
      isDragging=false;
      if (VERTICAL == myScrollBar.getOrientation()) {
        int y=myThumbBounds.isEmpty() ? myScrollBar.getHeight() / 2 : myThumbBounds.y;
        isReversed=myMouseY < y;
      }
 else {
        int x=myThumbBounds.isEmpty() ? myScrollBar.getWidth() / 2 : myThumbBounds.x;
        isReversed=myMouseX < x;
        if (!myScrollBar.getComponentOrientation().isLeftToRight()) {
          isReversed=!isReversed;
        }
      }
      scroll(isReversed);
      startScrollTimerIfNecessary();
    }
  }
}
