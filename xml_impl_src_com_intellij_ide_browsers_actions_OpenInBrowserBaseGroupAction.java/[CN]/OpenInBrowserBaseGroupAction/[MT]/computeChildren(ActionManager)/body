{
  List<AnAction> actionsByEP=new SmartList<AnAction>();
  for (  OpenInBrowserActionProducer actionProducer : OpenInBrowserActionProducer.EP_NAME.getExtensions()) {
    actionsByEP.addAll(actionProducer.getActions());
  }
  List<WebBrowser> browsers=WebBrowserManager.getInstance().getBrowsers();
  boolean addDefaultBrowser=isPopup();
  int offset=addDefaultBrowser ? 1 : 0;
  AnAction[] actions=new AnAction[browsers.size() + offset + actionsByEP.size()];
  if (addDefaultBrowser) {
    if (myDefaultBrowserAction == null) {
      myDefaultBrowserAction=new OpenFileInDefaultBrowserAction();
      myDefaultBrowserAction.getTemplatePresentation().setText("Default");
      myDefaultBrowserAction.getTemplatePresentation().setIcon(AllIcons.Nodes.PpWeb);
    }
    actions[0]=myDefaultBrowserAction;
  }
  for (int i=0, size=browsers.size(); i < size; i++) {
    actions[i + offset]=new BaseWebBrowserAction(browsers.get(i));
  }
  ArrayUtil.copy(actionsByEP,actions,offset + browsers.size());
  return actions;
}
