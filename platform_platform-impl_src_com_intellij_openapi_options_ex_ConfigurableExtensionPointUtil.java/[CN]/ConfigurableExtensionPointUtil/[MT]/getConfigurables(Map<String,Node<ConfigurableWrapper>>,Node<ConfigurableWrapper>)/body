{
  List<Configurable> list=ContainerUtil.newArrayListWithCapacity(node.myChildren.size());
  for (Iterator<Object> iterator=node.myChildren.iterator(); iterator.hasNext(); iterator.remove()) {
    Object child=iterator.next();
    if (child instanceof Configurable) {
      list.add((Configurable)child);
    }
 else {
      @SuppressWarnings("unchecked") Node<ConfigurableWrapper> value=(Node<ConfigurableWrapper>)child;
      if (getConfigurables(tree,value) != null) {
        throw new IllegalStateException("unexpected algorithm state");
      }
      list.add(value.myValue);
      tree.remove(value.myValue.getId());
    }
  }
  if (node.myValue == null) {
    return list;
  }
  for (  Configurable configurable : list) {
    node.myValue=node.myValue.addChild(configurable);
  }
  return null;
}
