{
  List<Configurable> list=ContainerUtil.newArrayList();
  if (withIdeSettings) {
    Application application=ApplicationManager.getApplication();
    if (application != null) {
      if (loadComponents) {
        for (        Configurable configurable : ComponentsPackage.getComponents(application,Configurable.class)) {
          addValid(list,configurable,project);
        }
      }
      for (      ConfigurableEP<Configurable> extension : application.getExtensions(Configurable.APPLICATION_CONFIGURABLE)) {
        addValid(list,ConfigurableWrapper.wrapConfigurable(extension),null);
      }
    }
  }
  if (project != null && !project.isDisposed()) {
    for (    Configurable configurable : ComponentsPackage.getComponents(project,Configurable.class)) {
      addValid(list,configurable,project);
    }
    for (    ConfigurableEP<Configurable> extension : project.getExtensions(Configurable.PROJECT_CONFIGURABLE)) {
      addValid(list,ConfigurableWrapper.wrapConfigurable(extension),project);
    }
  }
  return list;
}
