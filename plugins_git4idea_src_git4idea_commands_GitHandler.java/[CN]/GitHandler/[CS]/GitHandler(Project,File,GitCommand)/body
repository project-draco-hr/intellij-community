{
  myProject=project;
  myCommand=command;
  myAppSettings=GitVcsApplicationSettings.getInstance();
  myProjectSettings=GitVcsSettings.getInstance(myProject);
  myEnv=new HashMap<>(EnvironmentUtil.getEnvironmentMap());
  myVcs=ObjectUtils.assertNotNull(GitVcs.getInstance(project));
  myWorkingDirectory=directory;
  myCommandLine=new GeneralCommandLine();
  if (myAppSettings != null) {
    myCommandLine.setExePath(myAppSettings.getPathToGit());
  }
  myCommandLine.setWorkDirectory(myWorkingDirectory);
  if (GitVersionSpecialty.CAN_OVERRIDE_GIT_CONFIG_FOR_COMMAND.existsIn(myVcs.getVersion())) {
    myCommandLine.addParameters("-c","core.quotepath=false");
  }
  myCommandLine.addParameter(command.name());
  myStdoutSuppressed=true;
  mySilent=myCommand.lockingPolicy() == GitCommand.LockingPolicy.READ;
}
