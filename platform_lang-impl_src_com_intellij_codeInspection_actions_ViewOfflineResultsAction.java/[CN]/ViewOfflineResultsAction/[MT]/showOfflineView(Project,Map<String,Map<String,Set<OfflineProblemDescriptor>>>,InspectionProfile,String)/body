{
  final AnalysisScope scope=new AnalysisScope(project);
  final InspectionManagerEx managerEx=(InspectionManagerEx)InspectionManager.getInstance(project);
  final GlobalInspectionContextImpl context=managerEx.createNewGlobalContext(false);
  context.setExternalProfile(inspectionProfile);
  context.setCurrentScope(scope);
  context.initializeTools(new ArrayList<Tools>(),new ArrayList<Tools>(),new ArrayList<Tools>());
  final InspectionResultsView view=new InspectionResultsView(context,new OfflineInspectionRVContentProvider(resMap,project));
  ((RefManagerImpl)context.getRefManager()).startOfflineView();
  context.addView(view,title,true);
  view.update();
  return view;
}
