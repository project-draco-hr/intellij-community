{
  final String fileName="reference_tests.py";
  runPythonTest(new PyProcessWithConsoleTestTask<PyTestTestProcessRunner>(SdkCreationType.EMPTY_SDK){
    @NotNull @Override protected PyTestTestProcessRunner createProcessRunner() throws Exception {
      return new PyTestTestProcessRunner(getTestDataPath() + "/testRunner/env/unit",fileName);
    }
    @Override protected void checkTestResults(    @NotNull final PyTestTestProcessRunner runner,    @NotNull final String stdout,    @NotNull final String stderr,    @NotNull final String all){
      final List<String> fileNames=runner.getHighlightedStringsInConsole().second;
      Assert.assertThat("No lines highlighted",fileNames,Matchers.not(Matchers.empty()));
      Assert.assertTrue("Assert fail not marked",fileNames.contains("reference_tests.py:7"));
      Assert.assertTrue("Failed test not marked",fileNames.contains("reference_tests.py:12"));
      Assert.assertTrue("Failed test not marked",fileNames.contains("reference_tests.py"));
    }
  }
);
}
