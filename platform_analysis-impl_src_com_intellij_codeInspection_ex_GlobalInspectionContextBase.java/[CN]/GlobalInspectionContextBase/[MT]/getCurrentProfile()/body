{
  if (myExternalProfile != null) {
    return myExternalProfile;
  }
  String currentProfile=((InspectionManagerBase)InspectionManager.getInstance(myProject)).getCurrentProfile();
  ProjectInspectionProfileManager profileManager=ProjectInspectionProfileManager.getInstanceImpl(myProject);
  InspectionProfileImpl profile=profileManager.getProfile(currentProfile,false);
  if (profile == null) {
    profile=InspectionProfileManager.getInstance().getProfile(currentProfile);
    if (profile != null) {
      return profile;
    }
    final String[] availableProfileNames=profileManager.getAvailableProfileNames();
    if (availableProfileNames.length == 0) {
      return null;
    }
    profile=profileManager.getProfile(availableProfileNames[0],true);
  }
  return profile;
}
