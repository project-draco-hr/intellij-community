{
  final Ref<DialogWrapper> wrapperRef=new Ref<DialogWrapper>();
  JDialog dialog=waitUntilFound(robot,null,new GenericTypeMatcher<JDialog>(JDialog.class){
    @Override protected boolean isMatching(    @NotNull JDialog dialog){
      if (!title.equals(dialog.getTitle()) || !dialog.isShowing()) {
        return false;
      }
      DialogWrapper wrapper=getDialogWrapperFrom(dialog,DialogWrapper.class);
      if (wrapper != null) {
        String typeName=Messages.class.getName() + "$MessageDialog";
        if (typeName.equals(wrapper.getClass().getName())) {
          wrapperRef.set(wrapper);
          return true;
        }
      }
      return false;
    }
  }
,LONG_TIMEOUT);
  return new MessageDialogFixture(robot,dialog,wrapperRef.get());
}
