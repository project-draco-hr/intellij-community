{
  PsiFile file=node.getContainingFile();
  if (file == null)   return;
  final String charsetString=PythonFileType.getCharsetFromEncodingDeclaration(file.getText());
  boolean hasNonAscii=false;
  CharsetEncoder asciiEncoder=Charset.forName("US-ASCII").newEncoder();
  int length=value.length();
  char c=0;
  for (int i=0; i < length; ++i) {
    c=value.charAt(i);
    if (!asciiEncoder.canEncode(c)) {
      hasNonAscii=true;
      break;
    }
  }
  if (hasNonAscii) {
    if (charsetString == null)     registerProblem(node,"Non-ASCII character " + c + " in file, but no encoding declared",new AddEncodingQuickFix(myDefaultEncoding,myEncodingFormatIndex));
  }
}
