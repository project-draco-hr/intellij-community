{
  if (e instanceof DocumentEventImpl) {
    DocumentEventImpl event=(DocumentEventImpl)e;
    Document document=e.getDocument();
    int offset=e.getOffset();
    int change=event.getNewLength() - event.getOldLength();
    for (    TaskWindowWrapper taskWindowWrapper : myTaskWindows) {
      int twStart=taskWindowWrapper.getTwStart();
      if (twStart > offset) {
        twStart+=change;
      }
      int twEnd=taskWindowWrapper.getTwEnd();
      if (twEnd >= offset) {
        twEnd+=change;
      }
      TaskWindow taskWindow=taskWindowWrapper.getTaskWindow();
      int line=document.getLineNumber(twStart);
      int start=twStart - document.getLineStartOffset(line);
      int length=twEnd - twStart;
      taskWindow.setLine(line);
      taskWindow.setStart(start);
      if (useLength()) {
        taskWindow.setLength(length);
      }
 else {
        taskWindow.setReplacementLength(length);
      }
    }
  }
}
