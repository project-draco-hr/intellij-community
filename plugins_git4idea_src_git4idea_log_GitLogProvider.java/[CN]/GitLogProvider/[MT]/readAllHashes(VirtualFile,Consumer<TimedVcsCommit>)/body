{
  if (!isRepositoryReady(root)) {
    return LogDataImpl.empty();
  }
  List<String> parameters=new ArrayList<>(GitHistoryUtils.LOG_ALL);
  parameters.add("--date-order");
  final GitBekParentFixer parentFixer=GitBekParentFixer.prepare(root,this);
  Set<VcsUser> userRegistry=newHashSet();
  Set<VcsRef> refs=newHashSet();
  GitHistoryUtils.readCommits(myProject,root,parameters,new CollectConsumer<>(userRegistry),new CollectConsumer<>(refs),new Consumer<TimedVcsCommit>(){
    @Override public void consume(    TimedVcsCommit commit){
      commitConsumer.consume(parentFixer.fixCommit(commit));
    }
  }
);
  return new LogDataImpl(refs,userRegistry);
}
