{
  myProject=project;
  myPsiFile=psiFile;
  myPrintLineNumbers=printLineNumbers;
  myHighlighter=HighlighterFactory.createHighlighter(project,psiFile.getVirtualFile());
  myText=psiFile.getText();
  myHighlighter.setText(myText);
  mySegmentEnd=myText.length();
  myFileName=psiFile.getVirtualFile().getPresentableUrl();
  myHTMLFileName=dirName + File.separator + ExportToHTMLManager.getHTMLFileName(psiFile);
  PsiDocumentManager psiDocumentManager=PsiDocumentManager.getInstance(project);
  myDocument=psiDocumentManager.getDocument(psiFile);
  ArrayList<LineMarkerInfo> methodSeparators=new ArrayList<>();
  if (myDocument != null) {
    final List<LineMarkerInfo> separators=FileSeparatorProvider.getFileSeparators(psiFile,myDocument);
    if (separators != null) {
      methodSeparators.addAll(separators);
    }
  }
  myMethodSeparators=methodSeparators.toArray(new LineMarkerInfo[methodSeparators.size()]);
  myCurrentMethodSeparator=0;
}
