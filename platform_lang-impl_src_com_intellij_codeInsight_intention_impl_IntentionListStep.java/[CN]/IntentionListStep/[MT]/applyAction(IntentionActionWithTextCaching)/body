{
  myFinalRunnable=new Runnable(){
    @Override public void run(){
      HintManager.getInstance().hideAllHints();
      ApplicationManager.getApplication().invokeLater(new Runnable(){
        @Override public void run(){
          if (myProject.isDisposed() || myEditor != null && myEditor.isDisposed())           return;
          if (DumbService.isDumb(myProject) && !DumbService.isDumbAware(cachedAction)) {
            DumbService.getInstance(myProject).showDumbModeNotification(cachedAction.getText() + " is not available during indexing");
            return;
          }
          PsiDocumentManager.getInstance(myProject).commitAllDocuments();
          PsiFile file;
          if (myEditor != null) {
            file=PsiUtilBase.getPsiFileInEditor(myEditor,myProject);
            if (file == null) {
              return;
            }
          }
 else {
            file=myFile;
          }
          ShowIntentionActionsHandler.chooseActionAndInvoke(file,myEditor,cachedAction.getAction(),cachedAction.getText(),myProject);
        }
      }
);
    }
  }
;
}
