{
  SmartPointerElementInfo info=pointer.getElementInfo();
  if (!(info instanceof SelfElementInfo))   return;
  PointerReference reference=new PointerReference(pointer,containingFile,POINTERS_KEY);
  while (true) {
    FilePointersList pointers=getPointers(containingFile);
    if (pointers == null) {
      pointers=containingFile.putUserDataIfAbsent(POINTERS_KEY,new FilePointersList());
    }
    if (pointers.add(reference)) {
      if (((SelfElementInfo)info).hasRange()) {
        pointers.markerCache.rangeChanged();
      }
      break;
    }
  }
}
