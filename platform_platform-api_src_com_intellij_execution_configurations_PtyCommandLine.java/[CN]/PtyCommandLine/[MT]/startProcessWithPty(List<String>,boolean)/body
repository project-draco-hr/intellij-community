{
  Map<String,String> env=new HashMap<String,String>();
  setupEnvironment(env);
  if (isRedirectErrorStream()) {
    LOG.error("Launching process with PTY and redirected error stream is unsupported yet");
  }
  File workDirectory=getWorkDirectory();
  boolean cygwin=myUseCygwinLaunch && SystemInfo.isWindows;
  return PtyProcess.exec(ArrayUtil.toStringArray(commands),env,workDirectory != null ? workDirectory.getPath() : null,console,cygwin,ApplicationManager.getApplication().isEAP() ? getPtyLogFile() : null);
}
