{
  List<ModifiableRootModel> models=ContainerUtilRt.newArrayList();
  try {
    MultiMap<DataNode<ModuleData>,DataNode<ModuleDependencyData>> byModule=ExternalSystemApiUtil.groupBy(toImport,MODULE);
    for (    Map.Entry<DataNode<ModuleData>,Collection<DataNode<ModuleDependencyData>>> entry : byModule.entrySet()) {
      Module ideModule=platformFacade.findIdeModule(entry.getKey().getData(),project);
      if (ideModule == null) {
        LOG.warn(String.format("Can't import module dependencies %s. Reason: target module (%s) is not found at the ide and can't be imported",entry.getValue(),entry.getKey()));
        continue;
      }
      models.add(importData(entry.getValue(),ideModule,platformFacade));
    }
    ExternalSystemApiUtil.commitModels(synchronous,project,models);
  }
 catch (  Throwable t) {
    ExternalSystemApiUtil.disposeModels(models);
    ExceptionUtil.rethrowUnchecked(t);
  }
}
