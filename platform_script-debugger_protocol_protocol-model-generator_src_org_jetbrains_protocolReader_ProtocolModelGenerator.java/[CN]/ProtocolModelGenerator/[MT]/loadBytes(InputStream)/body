{
  ByteArrayOutputStream buffer=new ByteArrayOutputStream(Math.max(stream.available(),16 * 1024));
  byte[] bytes=new byte[1024 * 20];
  while (true) {
    int n=stream.read(bytes,0,bytes.length);
    if (n <= 0) {
      break;
    }
    buffer.write(bytes,0,n);
  }
  buffer.close();
  return buffer.toByteArray();
}
