{
  myContextComponent=PlatformDataKeys.CONTEXT_COMPONENT.getData(e.getDataContext());
  myActionEvent=e;
  myPopupField=new MySearchTextField();
  myPopupField.setOpaque(true);
  initSearchField(myPopupField);
  myPopupField.getTextEditor().setColumns(SEARCH_FIELD_COLUMNS);
  final JPanel panel=new JPanel(new BorderLayout());
  final JLabel title=new JLabel(" Search Everywhere:");
  if (SystemInfo.isMac) {
    title.setFont(title.getFont().deriveFont(Font.BOLD,title.getFont().getSize() - 1f));
  }
 else {
    title.setFont(title.getFont().deriveFont(Font.BOLD));
  }
  panel.add(title,BorderLayout.NORTH);
  panel.add(myPopupField,BorderLayout.CENTER);
  panel.setBorder(IdeBorderFactory.createEmptyBorder(0,5,2,5));
  myBalloon=JBPopupFactory.getInstance().createBalloonBuilder(panel).setShowCallout(false).setHideOnKeyOutside(false).setHideOnAction(false).setAnimationCycle(0).setDialogMode(false).setBorderColor(new JBColor(Gray._130,Gray._77)).setFillColor(new JBColor(Gray._242,new Color(60,63,65))).createBalloon();
  final Window window=WindowManager.getInstance().suggestParentWindow(e.getProject());
  Component parent=UIUtil.findUltimateParent(window);
  final RelativePoint showPoint;
  if (parent != null) {
    showPoint=new RelativePoint(parent,new Point((parent.getSize().width - panel.getPreferredSize().width) / 2,parent.getHeight() / 3));
  }
 else {
    showPoint=JBPopupFactory.getInstance().guessBestPopupLocation(e.getDataContext());
  }
  myBalloon.show(showPoint,Balloon.Position.below);
  IdeFocusManager focusManager=IdeFocusManager.getInstance(e.getProject());
  focusManager.requestFocus(myPopupField.getTextEditor(),true);
}
