{
  Component cmp;
  PsiFile file;
  myLocationString=null;
  if (value instanceof VirtualFile && myProject != null && (file=PsiManager.getInstance(myProject).findFile((VirtualFile)value)) != null) {
    cmp=new GotoFileCellRenderer(list.getWidth()).getListCellRendererComponent(list,file,index,isSelected,cellHasFocus);
  }
 else   if (value instanceof PsiElement) {
    cmp=myPsiRenderer.getListCellRendererComponent(list,value,index,isSelected,cellHasFocus);
  }
 else {
    cmp=super.getListCellRendererComponent(list,value,index,isSelected,cellHasFocus);
  }
  if (myLocationString != null || value instanceof BooleanOptionDescription) {
    final JPanel panel=new JPanel(new BorderLayout());
    panel.add(cmp,BorderLayout.CENTER);
    final Component rightComponent;
    if (value instanceof BooleanOptionDescription) {
      final OnOffButton button=new OnOffButton();
      button.setSelected(((BooleanOptionDescription)value).isOptionEnabled());
      rightComponent=button;
    }
 else {
      rightComponent=myLocation.getListCellRendererComponent(list,value,index,isSelected,cellHasFocus);
    }
    panel.add(rightComponent,BorderLayout.EAST);
    cmp=panel;
  }
  final Color bg=isSelected ? UIUtil.getListSelectionBackground() : getRightBackground();
  cmp.setBackground(bg);
  myMainPanel.setBorder(new CustomLineBorder(bg,0,0,1,0));
  String title=myTitleIndexes.getTitle(index);
  myMainPanel.removeAll();
  if (title != null) {
    myTitle.setText(title);
    myMainPanel.add(SeparatorComponent.createLabeledLineSeparator(" " + title,getRightBackground()),BorderLayout.NORTH);
  }
  myMainPanel.add(cmp,BorderLayout.CENTER);
  return myMainPanel;
}
