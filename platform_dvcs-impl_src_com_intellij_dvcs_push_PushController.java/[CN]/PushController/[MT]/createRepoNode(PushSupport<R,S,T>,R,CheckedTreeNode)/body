{
  T target=support.getDefaultTarget(repository);
  String repoName=getDisplayedRepoName(repository);
  S source=support.getSource(repository);
  final MyRepoModel<R,S,T> model=new MyRepoModel<R,S,T>(repository,support,mySingleRepoProject,source,target,DEFAULT_CHILDREN_PRESENTATION_NUMBER);
  if (target == null) {
    model.setError(VcsError.createEmptyTargetError(repoName));
  }
  final PushTargetPanel<T> pushTargetPanel=support.createTargetPanel(repository,target);
  RepositoryWithBranchPanel<T> repoPanel=new RepositoryWithBranchPanel<T>(myProject,repoName,source.getPresentation(),pushTargetPanel);
  final RepositoryNode repoNode=mySingleRepoProject ? new SingleRepositoryNode(repoPanel) : new RepositoryNode(repoPanel,target != null);
  myView2Model.put(repoNode,model);
  repoPanel.addRepoNodeListener(new RepositoryNodeListener<T>(){
    @Override public void onTargetChanged(    T newTarget){
      model.setSelected(true);
      repoNode.setChecked(true);
      model.setTarget(newTarget);
      model.clearErrors();
      loadCommits(model,repoNode,false);
    }
    @Override public void onSelectionChanged(    boolean isSelected){
      model.setSelected(isSelected);
      rootNode.setChecked(isSelected);
      myDialog.enableOkActions(isPushAllowed());
      if (isSelected && !model.hasCommitInfo() && !model.getSupport().shouldRequestIncomingChangesForNotCheckedRepositories()) {
        loadCommits(model,repoNode,false);
      }
    }
  }
);
  rootNode.add(repoNode);
}
