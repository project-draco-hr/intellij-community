{
  PushTarget target=support.getDefaultTarget(repository);
  final MyRepoModel model=new MyRepoModel(repository,support,isSelected,new PushSpec(support.getSource(repository),target),DEFAULT_CHILDREN_PRESENTATION_NUMBER);
  RepositoryWithBranchPanel repoPanel=new RepositoryWithBranchPanel(myProject,DvcsUtil.getShortRepositoryName(repository),support.getSource(repository).getPresentation(),target == null ? "" : target.getPresentation(),support.getTargetNames(repository));
  final RepositoryNode repoNode=isSingleRepositoryProject ? new SingleRepositoryNode(repoPanel,support.renderTarget(target)) : new RepositoryNode(repoPanel,support.renderTarget(target));
  myView2Model.put(repoNode,model);
  repoNode.setChecked(model.isSelected());
  repoPanel.addRepoNodeListener(new RepositoryNodeListener(){
    @Override public void onTargetChanged(    String newValue){
      VcsError validationError=support.validate(model.getRepository(),newValue);
      if (validationError == null) {
        PushTarget newTarget=support.createTarget(repository,newValue);
        repoNode.setTargetPresentation(support.renderTarget(newTarget));
        model.setSpec(new PushSpec(model.getSpec().getSource(),newTarget));
        loadCommits(model,repoNode,false);
      }
 else {
        repoNode.setTargetPresentation(StringUtil.isEmptyOrSpaces(newValue) ? support.renderTarget(null) : new SimpleColoredText(newValue,SimpleTextAttributes.ERROR_ATTRIBUTES));
        model.setSpec(new PushSpec(model.getSpec().getSource(),null));
      }
      myDialog.updateButtons();
    }
    @Override public void onSelectionChanged(    boolean isSelected){
      model.setSelected(isSelected);
      repoNode.setChecked(isSelected);
      myDialog.updateButtons();
    }
  }
);
  rootNode.add(repoNode);
}
