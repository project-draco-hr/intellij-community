{
  final Project project=e.getProject();
  LOG.assertTrue(project != null);
  final VirtualFile file=getFile(project);
  if (file != null) {
    try {
      final ImportRunProfile profile=new ImportRunProfile(file,project);
      SMTRunnerConsoleProperties properties=profile.getProperties();
      if (properties == null) {
        properties=myProperties;
        LOG.info("Failed to detect test framework in " + file.getPath() + "; use "+ (properties != null ? properties.getTestFrameworkName() + " from toolbar" : "no properties"));
      }
      final Executor executor=properties != null ? properties.getExecutor() : ExecutorRegistry.getInstance().getExecutorById(DefaultRunExecutor.EXECUTOR_ID);
      ExecutionEnvironmentBuilder.create(project,executor,profile).buildAndExecute();
    }
 catch (    ExecutionException e1) {
      Messages.showErrorDialog(project,e1.getMessage(),"Import Failed");
    }
  }
}
