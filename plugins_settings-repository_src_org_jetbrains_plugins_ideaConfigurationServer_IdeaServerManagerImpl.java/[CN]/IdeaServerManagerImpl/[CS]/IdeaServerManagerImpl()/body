{
  mySettings=new IdeaServerSettings();
  myLocalCopyDir=new File(new File(PathManager.getSystemPath(),"ideaServer"),"localCopy");
  myUpdateRequest=new Runnable(){
    @Override public void run(){
      myUpdateAlarm.cancelAllRequests();
      try {
        try {
          if (mySettings.getStatus() == IdeaServerStatus.CONNECTION_FAILED && mySettings.getUserName() != null && mySettings.getPassword() != null) {
            login();
          }
 else           if (mySettings.getStatus() == IdeaServerStatus.LOGGED_IN && mySettings.getUserName() != null && mySettings.getPassword() != null) {
            ping();
          }
        }
 catch (        Exception e) {
        }
      }
  finally {
        myUpdateAlarm.addRequest(myUpdateRequest,30 * 1000);
      }
    }
  }
;
  mySettings.addStatusListener(new StatusListener(){
    @Override public void statusChanged(    final IdeaServerStatus status){
      if (status == IdeaServerStatus.LOGGED_IN) {
        if (!mySettings.wereSettingsSynchronized()) {
          try {
            backupConfig();
          }
  finally {
            mySettings.settingsWereSynchronized();
          }
        }
        try {
          saveSettingsLocalCopy(myLocalCopyDir);
        }
 catch (        SocketTimeoutException timeout) {
        }
catch (        IOException e) {
          LOG.info(e);
        }
      }
    }
  }
);
}
