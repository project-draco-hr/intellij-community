{
  if (!(psiElement instanceof PsiMethod))   return;
  PsiMethod method=(PsiMethod)psiElement;
  final PsiClass containingClass=method.getContainingClass();
  if (!shouldHaveBody(method))   return;
  final PsiCodeBlock body=method.getBody();
  final Document doc=editor.getDocument();
  if (body != null) {
    String bodyText=body.getText();
    if (bodyText.startsWith("{")) {
      final PsiStatement[] statements=body.getStatements();
      if (statements.length > 0) {
        if (statements[0] instanceof PsiDeclarationStatement) {
          if (PsiTreeUtil.getDeepestLast(statements[0]) instanceof PsiErrorElement) {
            if (containingClass.getRBrace() == null) {
              doc.insertString(body.getTextRange().getStartOffset() + 1,"\n}");
            }
          }
        }
      }
    }
    return;
  }
  int endOffset=method.getThrowsList().getTextRange().getEndOffset();
  if (endOffset < doc.getTextLength() && doc.getCharsSequence().charAt(endOffset) == ';') {
    doc.deleteString(endOffset,endOffset + 1);
  }
  doc.insertString(endOffset,"{\n}");
}
