{
  ProgressIndicator oldIndicator=null;
  boolean set=progress != null && progress != (oldIndicator=myThreadIndicator.get());
  if (set) {
    progress.checkCanceled();
    myThreadIndicator.set(progress);
  }
  try {
    process.run();
  }
  finally {
    if (set) {
      myThreadIndicator.set(oldIndicator);
    }
    if (progress != null) {
synchronized (progress) {
        progress.notifyAll();
      }
    }
  }
}
