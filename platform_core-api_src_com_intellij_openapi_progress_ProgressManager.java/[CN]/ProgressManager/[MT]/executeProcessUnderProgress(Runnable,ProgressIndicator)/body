{
  ProgressIndicator oldIndicator=null;
  boolean set=progress != null && progress != (oldIndicator=getProgressIndicator());
  if (set) {
    myThreadIndicator.set(progress);
    try {
      registerIndicatorAndRun(progress,Thread.currentThread(),process);
    }
  finally {
      myThreadIndicator.set(oldIndicator);
    }
  }
 else {
    process.run();
  }
}
