{
  if (!(castType instanceof PsiClassType)) {
    return null;
  }
  final PsiClassType classType=(PsiClassType)castType;
  if (((PsiClassType)castType).resolve() instanceof PsiTypeParameter) {
    return null;
  }
  final PsiClassType rawType=classType.rawType();
  final InstanceofChecker checker=new InstanceofChecker(operand,rawType,false);
  PsiElement parent=PsiTreeUtil.getParentOfType(context,PsiIfStatement.class,PsiConditionalExpression.class,PsiPolyadicExpression.class);
  while (parent != null) {
    parent.accept(checker);
    if (checker.hasAgreeingInstanceof()) {
      return null;
    }
    parent=PsiTreeUtil.getParentOfType(parent,PsiPolyadicExpression.class,PsiIfStatement.class,PsiConditionalExpression.class);
  }
  if (checker.hasAgreeingInstanceof()) {
    return null;
  }
  return checker.getConflictingInstanceof();
}
