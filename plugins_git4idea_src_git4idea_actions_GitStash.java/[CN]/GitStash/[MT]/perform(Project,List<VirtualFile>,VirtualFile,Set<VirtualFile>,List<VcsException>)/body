{
  final ChangeListManager changeListManager=ChangeListManager.getInstance(project);
  if (changeListManager.isFreezedWithNotification("Can not stash changes now"))   return;
  GitStashDialog d=new GitStashDialog(project,gitRoots,defaultRoot);
  if (!d.showAndGet()) {
    return;
  }
  VirtualFile root=d.getGitRoot();
  affectedRoots.add(root);
  final GitLineHandler h=d.handler();
  AccessToken token=DvcsUtil.workingTreeChangeStarted(project);
  try {
    GitHandlerUtil.doSynchronously(h,GitBundle.getString("stashing.title"),h.printableCommandLine());
  }
  finally {
    DvcsUtil.workingTreeChangeFinished(project,token);
  }
  ServiceManager.getService(project,GitPlatformFacade.class).hardRefresh(root);
}
