{
  final ChangeListManager changeListManager=ChangeListManager.getInstance(project);
  if (changeListManager.isFreezedWithNotification("Can not stash changes now"))   return;
  GitStashDialog d=new GitStashDialog(project,gitRoots,defaultRoot);
  d.show();
  if (!d.isOK()) {
    return;
  }
  VirtualFile root=d.getGitRoot();
  affectedRoots.add(root);
  final GitLineHandler h=d.handler();
  GitUtil.workingTreeChangeBegan(project);
  try {
    GitHandlerUtil.doSynchronously(h,GitBundle.getString("stashing.title"),h.printableCommandLine());
  }
  finally {
    GitUtil.workingTreeChangeFinished(project);
  }
  ServiceManager.getService(project,GitPlatformFacade.class).hardRefresh(root);
}
