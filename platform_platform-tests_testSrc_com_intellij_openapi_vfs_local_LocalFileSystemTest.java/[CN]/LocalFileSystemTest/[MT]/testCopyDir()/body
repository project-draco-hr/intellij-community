{
  File fromDir=createTempDirectory();
  File toDir=createTempDirectory();
  VirtualFile fromVDir=myFS.findFileByPath(fromDir.getPath().replace(File.separatorChar,'/'));
  VirtualFile toVDir=myFS.findFileByPath(toDir.getPath().replace(File.separatorChar,'/'));
  assertNotNull(fromVDir);
  assertNotNull(toVDir);
  final VirtualFile dirToCopy=createChildDirectory(fromVDir,"dir");
  final VirtualFile file=createChildData(dirToCopy,"temp_file");
  setBinaryContent(file,new byte[]{0,1,2,3});
  final String newName="dir";
  final VirtualFile dirCopy=copy(dirToCopy,toVDir,newName);
  assertEquals(newName,dirCopy.getName());
  PlatformTestUtil.assertDirectoriesEqual(toVDir,fromVDir);
}
