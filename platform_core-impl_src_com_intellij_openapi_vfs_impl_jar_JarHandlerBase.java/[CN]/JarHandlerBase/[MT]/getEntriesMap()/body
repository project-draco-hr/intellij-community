{
synchronized (lock) {
    Map<String,EntryInfo> map=SoftReference.dereference(myRelPathsToEntries);
    if (map == null) {
      final JarFile zip=getJar();
      if (zip != null) {
        LogUtil.debug(LOG,"mapping %s",myBasePath);
        map=new THashMap<String,EntryInfo>();
        map.put("",new EntryInfo("",null,true));
        final Enumeration<? extends JarFile.JarEntry> entries=zip.entries();
        while (entries.hasMoreElements()) {
          final JarFile.JarEntry entry=entries.nextElement();
          final String name=entry.getName();
          final boolean isDirectory=StringUtil.endsWithChar(name,'/');
          getOrCreate(isDirectory ? name.substring(0,name.length() - 1) : name,isDirectory,map);
        }
        myRelPathsToEntries=new SoftReference<Map<String,EntryInfo>>(map);
      }
 else {
        map=Collections.emptyMap();
      }
    }
    return map;
  }
}
