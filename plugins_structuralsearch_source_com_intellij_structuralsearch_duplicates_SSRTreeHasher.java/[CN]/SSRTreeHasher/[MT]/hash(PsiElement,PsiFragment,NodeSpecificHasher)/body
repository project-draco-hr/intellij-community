{
  final EquivalenceDescriptorProvider descriptorProvider=EquivalenceDescriptorProvider.getInstance(root);
  if (descriptorProvider != null) {
    final EquivalenceDescriptor descriptor=descriptorProvider.buildDescriptor(root);
    if (descriptor != null) {
      return computeHash(root,upper,descriptor,hasher);
    }
  }
  if (root instanceof PsiFile) {
    return hashCodeBlock(hasher.getNodeChildren(root),upper,hasher);
  }
  return computeElementHash(root,upper,hasher);
}
