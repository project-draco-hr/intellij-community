{
  Document document=PsiDocumentManager.getInstance(file.getProject()).getDocument(file);
  if (document == null)   return true;
  PsiImportList importList=((PsiJavaFile)file).getImportList();
  final TextRange importsRange=importList == null ? TextRange.EMPTY_RANGE : importList.getTextRange();
  boolean hasErrorsExceptUnresolvedImports=!DaemonCodeAnalyzerEx.processHighlights(document,file.getProject(),HighlightSeverity.ERROR,0,document.getTextLength(),new Processor<HighlightInfo>(){
    @Override public boolean process(    HighlightInfo error){
      int infoStart=error.getActualStartOffset();
      int infoEnd=error.getActualEndOffset();
      return importsRange.containsRange(infoStart,infoEnd) && error.type.equals(HighlightInfoType.WRONG_REF);
    }
  }
);
  return hasErrorsExceptUnresolvedImports;
}
