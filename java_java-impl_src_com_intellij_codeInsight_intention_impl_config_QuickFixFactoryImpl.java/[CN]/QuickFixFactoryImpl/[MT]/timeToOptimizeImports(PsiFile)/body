{
  if (!CodeInsightSettings.getInstance().OPTIMIZE_IMPORTS_ON_THE_FLY)   return false;
  DaemonCodeAnalyzerEx codeAnalyzer=DaemonCodeAnalyzerEx.getInstanceEx(file.getProject());
  if (file == null || !codeAnalyzer.isHighlightingAvailable(file) || !(file instanceof PsiJavaFile) || file instanceof ServerPageFile)   return false;
  if (!codeAnalyzer.isErrorAnalyzingFinished(file))   return false;
  boolean errors=containsErrorsPreventingOptimize(file);
  return !errors && DaemonListeners.canChangeFileSilently(file);
}
