{
  if (myInRebuildList)   return;
  try {
    myInRebuildList=true;
    if (myChangesToDisplay == null) {
      final ChangeListManager manager=ChangeListManager.getInstance(myProject);
      myChangeListsMap=ContainerUtil.newHashMap();
      Collection<Change> allChanges=ContainerUtil.newArrayList();
      for (      LocalChangeList list : manager.getChangeListsCopy()) {
        for (        Change change : list.getChanges()) {
          allChanges.add(change);
          myChangeListsMap.put(change,list);
        }
      }
      myAllChanges=allChanges;
      updateListsInChooser();
    }
    super.rebuildList();
    if (myRebuildListListener != null) {
      myRebuildListListener.run();
    }
  }
  finally {
    myInRebuildList=false;
  }
}
