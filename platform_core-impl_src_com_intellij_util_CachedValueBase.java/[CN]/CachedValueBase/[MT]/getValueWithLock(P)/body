{
  Data<T> data=getUpToDateOrNull(true);
  if (data != null) {
    return data.myValue;
  }
  RecursionGuard.StackStamp stamp=RecursionManager.createGuard("cachedValue").markStack();
  data=computeData(doCompute(param));
  if (stamp.mayCacheNow()) {
    while (true) {
      Data<T> alreadyComputed=getData();
      boolean reuse=alreadyComputed != null && isUpToDate(alreadyComputed);
      Data<T> toReturn=cacheOrGetData(alreadyComputed,reuse ? null : data);
      if (toReturn != null) {
        valueUpdated(toReturn.myDependencies);
        return toReturn.myValue;
      }
    }
  }
  return data.myValue;
}
