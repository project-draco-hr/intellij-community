{
  if (ApplicationManager.getApplication().isUnitTestMode()) {
    return;
  }
  startupManager.registerStartupActivity(new Runnable(){
    public void run(){
      final File skeletonDir=new File(PathManager.getSystemPath(),PythonSdkType.SKELETON_DIR_NAME);
      final File versionFile=new File(skeletonDir,"version");
      boolean versionUpdated=false;
      if (!versionFile.exists() || readVersion(versionFile) != SKELETONS_VERSION) {
        writeVersion(versionFile,SKELETONS_VERSION);
        versionUpdated=true;
      }
      final List<Sdk> sdkList=PythonSdkType.getAllSdks();
      for (      Sdk sdk : sdkList) {
        final String skeletonsPath=PythonSdkType.findSkeletonsPath(sdk);
        if (skeletonsPath == null) {
          LOG.info("Could not find skeletons path for SDK path " + sdk.getHomePath());
        }
 else         if (versionUpdated || !new File(skeletonsPath).isDirectory()) {
          if (versionUpdated) {
            LOG.info("Rebuilding skeletons for " + sdk.getHomePath() + " because version has been updated");
          }
 else {
            LOG.info("Rebuilding skeletons for " + sdk.getHomePath() + " because skeletons directory "+ skeletonsPath+ " was not found");
          }
          PythonSdkType.generateSkeletons(ProgressManager.getInstance().getProgressIndicator(),sdk.getHomePath(),skeletonsPath);
        }
      }
      final Module[] modules=ModuleManager.getInstance(project).getModules();
      if (modules.length > 0) {
        updateSysPath(modules[0]);
      }
    }
  }
);
}
