{
  final PythonSdkAdditionalData pythonAdditionalData=PyUtil.as(sdk.getSdkAdditionalData(),PythonSdkAdditionalData.class);
  final Collection<VirtualFile> excludedPaths=pythonAdditionalData != null ? pythonAdditionalData.getExcludedPathFiles() : Collections.<VirtualFile>emptyList();
  final List<VirtualFile> results=Lists.newArrayList();
  for (  String path : paths) {
    if (path != null && !FileUtilRt.extensionEquals(path,"egg-info")) {
      final VirtualFile virtualFile=StandardFileSystems.local().refreshAndFindFileByPath(path);
      if (virtualFile != null) {
        final VirtualFile rootFile=PythonSdkType.getSdkRootVirtualFile(virtualFile);
        if (!excludedPaths.contains(rootFile)) {
          results.add(virtualFile);
          continue;
        }
      }
    }
    LOG.info("Bogus sys.path entry " + path);
  }
  return results;
}
