{
  final List<PyFile> results=new ArrayList<PyFile>();
  final GlobalSearchScope scope=includeNonProjectItems ? PyProjectScopeBuilder.excludeSdkTestsScope(project) : GlobalSearchScope.projectScope(project);
  final Collection<VirtualFile> files=FileBasedIndex.getInstance().getContainingFiles(NAME,name,scope);
  for (  VirtualFile virtualFile : files) {
    final PsiFile psiFile=PsiManager.getInstance(project).findFile(virtualFile);
    if (psiFile instanceof PyFile) {
      if (!PyUserSkeletonsUtil.isUnderUserSkeletonsDirectory(psiFile)) {
        results.add((PyFile)psiFile);
      }
    }
  }
  return results;
}
