{
  EditorEx editor=getCurrentEditor();
  if (myProject != null && !myProject.isDisposed() && Registry.is("diff.enable.psi.highlighting")) {
    final Object o=FileEditorManager.getInstance(myProject).getData(dataId,editor,editor.getCaretModel().getCurrentCaret());
    if (o != null)     return o;
  }
  if (DiffDataKeys.CURRENT_EDITOR.is(dataId)) {
    return editor;
  }
 else   if (CommonDataKeys.EDITOR.is(dataId)) {
    return editor;
  }
 else   if (CommonDataKeys.VIRTUAL_FILE.is(dataId)) {
    return editor.getVirtualFile();
  }
 else   if (OpenFileDescriptor.NAVIGATE_IN_EDITOR.is(dataId)) {
    return editor;
  }
  return super.getData(dataId);
}
