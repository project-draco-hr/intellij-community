{
  super(sleepingPolicy);
  if (sleepingPolicy == SleepingPolicy.BLOCKING) {
    if (!(reader instanceof BaseInputStreamReader)) {
      throw new IllegalArgumentException("Blocking policy can be used only with BaseInputStreamReader, that doesn't lock on close");
    }
    myExecutorService=Executors.newSingleThreadExecutor();
    myTokenSubmitter=new Runnable(){
      @Override public void run(){
        try {
          Thread.sleep(DELAY_AFTER_BLOCKING_READ);
          submitToken();
        }
 catch (        InterruptedException ignore) {
        }
      }
    }
;
  }
  myReader=reader;
}
