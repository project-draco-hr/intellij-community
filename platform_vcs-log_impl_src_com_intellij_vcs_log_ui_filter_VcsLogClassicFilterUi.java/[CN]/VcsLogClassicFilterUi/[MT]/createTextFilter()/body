{
  final SearchTextFieldWithStoredHistory textFilter=new SearchTextFieldWithStoredHistory(VCS_LOG_TEXT_FILTER_HISTORY){
    @Override protected void onFieldCleared(){
      myTextFilterModel.setFilter(null);
    }
  }
;
  textFilter.setText(myTextFilterModel.getText());
  textFilter.getTextEditor().addActionListener(new ActionListener(){
    @Override public void actionPerformed(    @NotNull ActionEvent e){
      myTextFilterModel.setFilter(new VcsLogTextFilterImpl(textFilter.getText()));
      textFilter.addCurrentTextToHistory();
    }
  }
);
  textFilter.addDocumentListener(new DocumentAdapter(){
    @Override protected void textChanged(    DocumentEvent e){
      try {
        myTextFilterModel.setUnsavedText(e.getDocument().getText(0,e.getDocument().getLength()));
      }
 catch (      BadLocationException ex) {
        LOG.error(ex);
      }
    }
  }
);
  textFilter.getTextEditor().setToolTipText("Use " + KeymapUtil.getFirstKeyboardShortcutText(VcsLogActionPlaces.VCS_LOG_FOCUS_TEXT_FILTER) + " to switch between text filter and commits list");
  return textFilter;
}
