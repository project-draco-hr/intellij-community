{
  byte flags=dataStream.readByte();
  boolean isAnonymous=PsiClassStubImpl.isAnonymous(flags);
  boolean isEnumConst=PsiClassStubImpl.isEnumConstInitializer(flags);
  JavaClassElementType type=typeForClass(isAnonymous,isEnumConst);
  if (!isAnonymous) {
    StringRef name=dataStream.readName();
    StringRef qname=dataStream.readName();
    int languageLevelId=dataStream.readByte();
    StringRef sourceFileName=dataStream.readName();
    PsiClassStubImpl classStub=new PsiClassStubImpl(type,parentStub,StringRef.toString(qname),StringRef.toString(name),null,flags);
    classStub.setLanguageLevel(LanguageLevel.values()[languageLevelId]);
    classStub.setSourceFileName(sourceFileName);
    return classStub;
  }
 else {
    StringRef baseRef=dataStream.readName();
    return new PsiClassStubImpl(type,parentStub,null,null,StringRef.toString(baseRef),flags);
  }
}
