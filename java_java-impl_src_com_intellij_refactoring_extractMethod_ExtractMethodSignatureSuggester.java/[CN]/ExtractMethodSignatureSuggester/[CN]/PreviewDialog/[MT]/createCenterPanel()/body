{
  final Project project=myOldMethod.getProject();
  final DiffPanelEx diffPanel=(DiffPanelEx)DiffManager.getInstance().createDiffPanel(null,project,getDisposable(),null);
  diffPanel.setComparisonPolicy(ComparisonPolicy.IGNORE_SPACE);
  diffPanel.setHighlightMode(HighlightMode.BY_WORD);
  DiffPanelOptions diffPanelOptions=diffPanel.getOptions();
  diffPanelOptions.setShowSourcePolicy(DiffPanelOptions.ShowSourcePolicy.OPEN_EDITOR);
  diffPanelOptions.setRequestFocusOnNewContent(false);
  SimpleDiffRequest request=new SimpleDiffRequest(project,null);
  final String oldContent=myOldMethod.getText() + "\n\n\nmethod call:\n " + myOldCall.getText();
  final String newContent=myNewMethod.getText() + "\n\n\nmethod call:\n " + myNewCall.getText();
  request.setContents(new SimpleContent(oldContent),new SimpleContent(newContent));
  request.setContentTitles("Before","After");
  diffPanel.setDiffRequest(request);
  final JPanel panel=new JPanel(new BorderLayout());
  panel.add(diffPanel.getComponent(),BorderLayout.CENTER);
  panel.setBorder(IdeBorderFactory.createEmptyBorder(new Insets(5,0,0,0)));
  return panel;
}
