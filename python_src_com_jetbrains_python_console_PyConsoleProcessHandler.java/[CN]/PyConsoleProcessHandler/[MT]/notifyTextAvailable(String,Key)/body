{
  final LanguageConsoleImpl languageConsole=myPyConsoleRunner.getLanguageConsole();
  String string=StringUtil.convertLineSeparators(text);
  for (  String prompt : PROMPTS) {
    if (string.startsWith(prompt)) {
      final String currentPrompt=languageConsole.getPrompt();
      if (!currentPrompt.equals(prompt)) {
        languageConsole.setPrompt(prompt);
      }
      string=string.substring(prompt.length()).trim();
      break;
    }
  }
  final Ref<Boolean> shouldScroll=new Ref<Boolean>(false);
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    public void run(){
      shouldScroll.set(languageConsole.shouldScrollHistoryToEnd());
    }
  }
);
  Matcher matcher;
  while ((matcher=CODE_ELEMENT_PATTERN.matcher(string)).find()) {
    printToConsole(languageConsole,string.substring(0,matcher.start()),ConsoleViewContentType.NORMAL_OUTPUT);
    if (matcher.group(1) != null) {
      printToConsole(languageConsole,matcher.group(1),NUMBER_ATTRIBUTES);
    }
 else     if (matcher.group(4) != null) {
      printToConsole(languageConsole,matcher.group(4),STRING_ATTRIBUTES);
    }
 else {
      printToConsole(languageConsole,matcher.group(),ConsoleViewContentType.NORMAL_OUTPUT);
    }
    string=string.substring(matcher.end());
  }
  printToConsole(languageConsole,string,ConsoleViewContentType.NORMAL_OUTPUT);
  if (shouldScroll.get()) {
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      public void run(){
        languageConsole.queueUiUpdate(false);
      }
    }
);
  }
}
