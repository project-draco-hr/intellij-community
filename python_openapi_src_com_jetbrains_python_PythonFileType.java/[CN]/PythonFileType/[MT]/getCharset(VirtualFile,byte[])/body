{
  if (CharsetToolkit.hasUTF8Bom(content)) {
    return CharsetToolkit.UTF8;
  }
  ByteBuffer bytes=ByteBuffer.wrap(content,0,Math.min(256,content.length));
  String decoded=CharsetToolkit.UTF8_CHARSET.decode(bytes).toString();
  return getCharsetFromEncodingDeclaration(StringUtil.convertLineSeparators(decoded));
}
