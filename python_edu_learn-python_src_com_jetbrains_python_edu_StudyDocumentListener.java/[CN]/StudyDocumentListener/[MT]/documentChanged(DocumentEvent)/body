{
  if (e instanceof DocumentEventImpl) {
    DocumentEventImpl event=(DocumentEventImpl)e;
    Document document=e.getDocument();
    int offset=e.getOffset();
    int change=event.getNewLength() - event.getOldLength();
    if (myTaskWindow != null) {
      int newLength=myTaskWindow.getLength() + change;
      myTaskWindow.setLength(newLength <= 0 ? 0 : newLength);
    }
    int newEnd=offset + event.getNewLength();
    int newLine=document.getLineNumber(newEnd);
    int lineChange=newLine - myOldLine;
    myTaskFile.incrementLines(myOldLine + 1,lineChange);
    int newEndOffsetInLine=offset + e.getNewLength() - document.getLineStartOffset(newLine);
    int oldEndOffsetInLine=offset + e.getOldLength() - myOldLineStartOffset;
    myTaskFile.updateLine(lineChange,myOldLine,newEndOffsetInLine,oldEndOffsetInLine);
  }
}
