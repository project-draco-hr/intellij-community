{
  final XmlAttributeValue another=(XmlAttributeValue)myMatchingVisitor.getElement();
  final String text=value.getValue();
  final boolean isTypedVar=myMatchingVisitor.getMatchContext().getPattern().isTypedVar(text);
  MatchingHandler handler;
  if (isTypedVar && (handler=myMatchingVisitor.getMatchContext().getPattern().getHandler(text)) instanceof SubstitutionHandler) {
    String text2=another.getText();
    int offset=text2.length() > 0 && (text2.charAt(0) == '"' || text2.charAt(0) == '\'') ? 1 : 0;
    myMatchingVisitor.setResult(((SubstitutionHandler)handler).handle(another,offset,text2.length() - offset,myMatchingVisitor.getMatchContext()));
  }
 else {
    myMatchingVisitor.setResult(matches(text,another.getValue()));
  }
}
