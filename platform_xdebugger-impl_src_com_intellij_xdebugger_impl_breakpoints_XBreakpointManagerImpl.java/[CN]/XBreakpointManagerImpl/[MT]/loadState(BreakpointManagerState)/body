{
  myBreakpointsDialogSettings=state.getBreakpointsDialogProperties();
  myAllBreakpoints.clear();
  myDefaultBreakpoints.clear();
  myBreakpointsDefaults.clear();
  AccessToken token=ReadAction.start();
  try {
    for (    BreakpointState breakpointState : state.getDefaultBreakpoints()) {
      loadBreakpoint(breakpointState,true);
    }
    for (    XBreakpointType<?,?> type : XBreakpointUtil.getBreakpointTypes()) {
      if (!myDefaultBreakpoints.containsKey(type)) {
        addDefaultBreakpoint(type);
      }
    }
    for (    XBreakpointBase<?,?,?> breakpoint : myBreakpoints.values()) {
      doRemoveBreakpoint(breakpoint);
    }
    for (    BreakpointState breakpointState : state.getBreakpoints()) {
      loadBreakpoint(breakpointState,false);
    }
    for (    BreakpointState defaults : state.getBreakpointsDefaults()) {
      XBreakpointType<?,?> type=XBreakpointUtil.findType(defaults.getTypeId());
      if (type != null) {
        myBreakpointsDefaults.put(type,defaults);
      }
 else {
        LOG.warn("Unknown breakpoint type " + defaults.getTypeId());
      }
    }
    myDependentBreakpointManager.loadState();
  }
  finally {
    token.finish();
  }
  myLineBreakpointManager.updateBreakpointsUI();
  myTime=state.getTime();
  myDefaultGroup=state.getDefaultGroup();
}
