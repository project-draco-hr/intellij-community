{
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    @Override public void run(){
      ApplicationManager.getApplication().runWriteAction(new Runnable(){
        @SuppressWarnings("IOResourceOpenedButNotSafelyClosed") @Override public void run(){
          StudyEditor studyEditor=StudyUtils.getSelectedStudyEditor(project);
          StudyState studyState=new StudyState(studyEditor);
          if (studyEditor == null || !studyState.isValid()) {
            LOG.info("RefreshTaskFileAction was invoked outside of Study Editor");
            return;
          }
          refreshFile(studyState,project);
        }
      }
);
    }
  }
);
}
