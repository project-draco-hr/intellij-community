{
  final PsiElement element=result.getElement();
  if (element instanceof PsiMethod) {
    final PsiMethod method=(PsiMethod)element;
    final PsiParameter[] parameters=method.getParameterList().getParameters();
    PsiParameter parameter=null;
    if (parameters.length > parameterIdx) {
      parameter=parameters[parameterIdx];
    }
 else     if (method.isVarArgs()) {
      parameter=parameters[parameters.length - 1];
    }
    if (parameter != null) {
      final PsiParameter finalParameter=parameter;
      PsiType type=PsiResolveHelper.ourGuard.doPreventingRecursion(innerMethodCall,true,new Computable<PsiType>(){
        @Override public PsiType compute(){
          return substitutor.substitute(finalParameter.getType());
        }
      }
);
      PsiResolveHelperImpl resolveHelper=(PsiResolveHelperImpl)JavaPsiFacade.getInstance(method.getProject()).getResolveHelper();
      final Pair<PsiType,ConstraintType> constraint=resolveHelper.getSubstitutionForTypeParameterConstraint(typeParameter,innerReturnType,type,false,PsiUtil.getLanguageLevel(finalParameter));
      if (constraint != null)       return constraint;
    }
  }
  return null;
}
