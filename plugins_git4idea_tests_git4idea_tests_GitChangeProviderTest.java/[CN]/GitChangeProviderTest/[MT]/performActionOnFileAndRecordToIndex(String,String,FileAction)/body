{
  VirtualFile file=myRootDir.findChild(filename);
  assertNotNull("VirtualFile is null: " + filename,file);
switch (action) {
case CREATE:
    File f=touch(filename,"initial content in branch " + branchName);
  final VirtualFile createdFile=VfsUtil.findFileByIoFile(f,true);
dirty(createdFile);
add(filename);
break;
case MODIFY:
overwrite(VfsUtilCore.virtualToIoFile(file),"new content in branch " + branchName);
dirty(file);
add(filename);
break;
case DELETE:
dirty(file);
git("rm " + filename);
break;
case RENAME:
String newName=filename + "_" + branchName.replaceAll("\\s","_")+ "_new";
dirty(file);
mv(filename,newName);
myRootDir.refresh(false,true);
dirty(myRootDir.findChild(newName));
break;
default :
break;
}
}
