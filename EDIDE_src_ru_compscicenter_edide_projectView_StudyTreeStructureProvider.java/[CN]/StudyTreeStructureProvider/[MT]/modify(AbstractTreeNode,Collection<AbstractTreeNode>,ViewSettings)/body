{
  if (!needModify(parent)) {
    return children;
  }
  Collection<AbstractTreeNode> nodes=new ArrayList<AbstractTreeNode>();
  for (  AbstractTreeNode node : children) {
    Project project=node.getProject();
    if (node.getValue() instanceof PsiDirectory) {
      PsiDirectory nodeValue=(PsiDirectory)node.getValue();
      StudyDirectoryNode newNode=new StudyDirectoryNode(project,nodeValue,settings);
      nodes.add(newNode);
    }
 else {
      if (parent instanceof StudyDirectoryNode) {
        if (node instanceof PsiFileNode) {
          PsiFileNode psiFileNode=(PsiFileNode)node;
          TaskFile taskFile=StudyTaskManager.getInstance(project).getTaskFile(psiFileNode.getVirtualFile());
          if (taskFile != null) {
            nodes.add(node);
          }
          String parentName=parent.getName();
          if (parentName != null) {
            if (parentName.equals("Playground")) {
              nodes.add(node);
            }
          }
        }
      }
    }
  }
  return nodes;
}
