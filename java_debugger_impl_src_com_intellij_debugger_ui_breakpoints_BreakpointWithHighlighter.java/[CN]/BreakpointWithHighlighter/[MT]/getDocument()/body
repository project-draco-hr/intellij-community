{
  final RangeHighlighter highlighter=getHighlighter();
  if (highlighter != null) {
    return highlighter.getDocument();
  }
  final SourcePosition position=getSourcePosition();
  if (position != null) {
    final PsiFile file=position.getFile();
    return PsiDocumentManager.getInstance(getProject()).getDocument(file);
  }
  return null;
}
