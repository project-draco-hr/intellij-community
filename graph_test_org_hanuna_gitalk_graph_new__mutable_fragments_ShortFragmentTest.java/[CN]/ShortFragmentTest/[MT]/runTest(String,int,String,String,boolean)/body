{
  Set<Integer> unhiddenNodesRowIndex=parseInts(unhiddenNodeRows);
  MutableGraph graph=GraphTestUtils.getNewMutableGraph(inputGraph);
  ShortFragmentGenerator shortFragmentGenerator=new ShortFragmentGenerator(graph);
  final Set<Node> unhiddenNodes=new HashSet<Node>();
  for (  Integer i : unhiddenNodesRowIndex) {
    unhiddenNodes.add(getCommitNode(graph,i));
  }
  shortFragmentGenerator.setUnhiddenNodes(new UnhiddenNodeFunction(){
    @Override public boolean isUnhiddenNode(    @NotNull Node node){
      return unhiddenNodes.contains(node);
    }
  }
);
  Node commitNode=getCommitNode(graph,rowIndex);
  NewGraphFragment fragment;
  if (down) {
    fragment=shortFragmentGenerator.getDownShortFragment(commitNode);
  }
 else {
    fragment=shortFragmentGenerator.getUpShortFragment(commitNode);
  }
  assertEquals(fragmentStr,toStr(fragment));
}
