{
  int lastIndent=_indentStack.peek();
  int indent=getNextLineIndent();
  if (getBaseTokenType() == PyTokenTypes.END_OF_LINE_COMMENT) {
    indent=lastIndent;
  }
  int whiteSpaceEnd=(getBaseTokenType() == null) ? super.getBufferEnd() : getBaseTokenStart();
  if (indent > lastIndent) {
    _indentStack.push(indent);
    myTokenQueue.add(new PendingToken(PyTokenTypes.LINE_BREAK,whiteSpaceStart,whiteSpaceEnd));
    myTokenQueue.add(new PendingToken(PyTokenTypes.INDENT,whiteSpaceEnd,whiteSpaceEnd));
  }
 else   if (indent < lastIndent) {
    while (indent < lastIndent) {
      _indentStack.pop();
      lastIndent=_indentStack.peek();
      if (indent > lastIndent) {
        myTokenQueue.add(new PendingToken(PyTokenTypes.INCONSISTENT_DEDENT,whiteSpaceStart,whiteSpaceStart));
      }
      myTokenQueue.add(new PendingToken(PyTokenTypes.DEDENT,whiteSpaceStart,whiteSpaceStart));
    }
    myTokenQueue.add(new PendingToken(PyTokenTypes.LINE_BREAK,whiteSpaceStart,whiteSpaceEnd));
  }
 else {
    myTokenQueue.add(new PendingToken(PyTokenTypes.LINE_BREAK,whiteSpaceStart,whiteSpaceEnd));
  }
}
