{
  Cursor currentCursor=getCursor();
  try {
    setCursor(new Cursor(Cursor.WAIT_CURSOR));
    if (descriptor != null) {
      final JPanel editorPanel=new JPanel();
      editorPanel.setLayout(new BorderLayout());
      PsiElement containingElement=descriptor.getProblemElementIfOnlyOne();
      if (containingElement == null && refEntity instanceof RefElement) {
        containingElement=((RefElement)refEntity).getElement();
      }
      editorPanel.add(createBaseRightComponentFor(containingElement,descriptor),BorderLayout.CENTER);
      if (valid && descriptor.getProblemCount() > 0) {
        editorPanel.add(new QuickFixToolbar(descriptor,myTree.getSelectedToolWrapper(),myTree.getSelectionPaths()[0],myProject,myPreviewEditor,containingElement),BorderLayout.NORTH);
      }
      mySplitter.setSecondComponent(editorPanel);
    }
  }
  finally {
    setCursor(currentCursor);
  }
}
