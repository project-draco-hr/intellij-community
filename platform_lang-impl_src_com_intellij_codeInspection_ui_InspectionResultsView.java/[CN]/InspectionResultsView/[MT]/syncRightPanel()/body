{
  final Editor oldEditor=myPreviewEditor;
  if (myLoadingProgressPreview != null) {
    Disposer.dispose(myLoadingProgressPreview);
    myLoadingProgressPreview=null;
  }
  if (myTree.getSelectionModel().getSelectionCount() != 1) {
    if (myTree.getSelectedToolWrapper() == null) {
      mySplitter.setSecondComponent(getNothingToShowTextLabel());
    }
 else {
      showInRightPanel(myTree.getCommonSelectedElement(),oldEditor == null);
    }
  }
 else {
    TreePath pathSelected=myTree.getSelectionModel().getLeadSelectionPath();
    if (pathSelected != null) {
      final InspectionTreeNode node=(InspectionTreeNode)pathSelected.getLastPathComponent();
      if (node instanceof ProblemDescriptionNode) {
        final ProblemDescriptionNode problemNode=(ProblemDescriptionNode)node;
        showInRightPanel(problemNode.getElement(),oldEditor == null);
      }
 else       if (node instanceof InspectionPackageNode || node instanceof InspectionModuleNode || node instanceof RefElementNode) {
        showInRightPanel(node.getContainingFileLocalEntity(),oldEditor == null);
      }
 else       if (node instanceof InspectionNode) {
        final String shortName=((InspectionNode)node).getToolWrapper().getShortName();
        if (shortName.isEmpty()) {
          mySplitter.setSecondComponent(getNothingToShowTextLabel());
        }
 else {
          showInRightPanel(null,oldEditor == null);
        }
      }
 else       if (node instanceof InspectionRootNode || node instanceof InspectionGroupNode || node instanceof InspectionSeverityGroupNode) {
        final InspectionViewNavigationPanel panel=new InspectionViewNavigationPanel(node,myTree);
        myLoadingProgressPreview=panel;
        mySplitter.setSecondComponent(panel);
      }
 else {
        LOG.error("Unexpected node: " + node.getClass());
      }
    }
  }
  if (oldEditor != null) {
    if (Boolean.TRUE.equals(oldEditor.getUserData(PREVIEW_EDITOR_IS_REUSED_KEY))) {
      oldEditor.putUserData(PREVIEW_EDITOR_IS_REUSED_KEY,null);
    }
 else {
      releaseEditor(oldEditor);
      if (oldEditor == myPreviewEditor) {
        myPreviewEditor=null;
      }
    }
  }
}
