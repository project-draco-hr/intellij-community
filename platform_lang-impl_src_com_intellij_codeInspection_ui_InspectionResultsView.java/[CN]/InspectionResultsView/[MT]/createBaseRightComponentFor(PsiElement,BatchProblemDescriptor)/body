{
  final int count=descriptor.getProblemCount();
  if (count == 1 || (containingElement != null && !(containingElement instanceof PsiDirectory))) {
    final PsiElement element=descriptor.getFirstProblemElement();
    LOG.assertTrue(element != null);
    final PsiElement referencedElement=containingElement == null ? descriptor.getFirstProblemElement() : containingElement;
    final PsiFile file=referencedElement.getContainingFile();
    final Document document=PsiDocumentManager.getInstance(referencedElement.getProject()).getDocument(file);
    myPreviewEditor=EditorFactory.getInstance().createEditor(document,myProject,file.getVirtualFile(),true);
    final EditorSettings settings=myPreviewEditor.getSettings();
    settings.setLineNumbersShown(false);
    settings.setLineNumbersShown(false);
    settings.setWhitespacesShown(false);
    settings.setLineMarkerAreaShown(false);
    settings.setIndentGuidesShown(false);
    settings.setFoldingOutlineShown(false);
    settings.setAdditionalColumnsCount(0);
    settings.setAdditionalLinesCount(0);
    settings.setRightMarginShown(true);
    settings.setRightMargin(60);
    myPreviewEditor.getCaretModel().moveToOffset(referencedElement.getTextOffset());
    myPreviewEditor.getScrollingModel().scrollToCaret(ScrollType.CENTER);
    UsagePreviewPanel.highlight(containingElement == null ? Collections.singletonList(new UsageInfo(referencedElement)) : getElementToHighlight(containingElement),myPreviewEditor,myProject);
    return myPreviewEditor.getComponent();
  }
 else   if (count > 1) {
    return new InspectionNodeInfo(myTree.getSelectedToolWrapper(),myProject);
  }
  return new JPanel();
}
