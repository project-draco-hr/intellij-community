{
  final int count=descriptor.getProblemCount();
  if (count == 1 || (containingElement != null && !(containingElement instanceof PsiDirectory))) {
    final PsiElement referencedElement=descriptor.getFirstProblemElement();
    final PsiFile file=referencedElement.getContainingFile();
    final Document document=PsiDocumentManager.getInstance(referencedElement.getProject()).getDocument(file);
    myPreviewEditor=EditorFactory.getInstance().createEditor(document,myProject,file.getVirtualFile(),true);
    final EditorSettings settings=myPreviewEditor.getSettings();
    settings.setLineNumbersShown(false);
    settings.setLineMarkerAreaShown(false);
    settings.setAdditionalColumnsCount(0);
    settings.setAdditionalLinesCount(0);
    settings.setLeadingWhitespaceShown(true);
    settings.setRightMarginShown(true);
    settings.setRightMargin(60);
    if (count != 1) {
      myPreviewEditor.getCaretModel().moveToOffset(referencedElement.getTextOffset());
      myPreviewEditor.getScrollingModel().scrollToCaret(ScrollType.CENTER);
    }
    UsagePreviewPanel.highlight(containingElement == null ? Collections.emptyList() : getElementToHighlight(containingElement),myPreviewEditor,myProject);
    return myPreviewEditor.getComponent();
  }
 else   if (count > 1) {
    return new InspectionNodeInfo(myTree.getSelectedToolWrapper(),myProject);
  }
  return new JPanel();
}
