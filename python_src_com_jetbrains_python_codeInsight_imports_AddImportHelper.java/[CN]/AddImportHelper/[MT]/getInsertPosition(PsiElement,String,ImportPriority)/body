{
  PsiElement feeler=insertParent.getFirstChild();
  if (feeler == null)   return null;
  boolean skippedOverImports=false;
  boolean skippedOverDoc=false;
  PsiElement seeker=feeler;
  final boolean isInjected=InjectedLanguageManager.getInstance(feeler.getProject()).isInjectedFragment(feeler.getContainingFile());
  do {
    if (feeler instanceof PyImportStatementBase && !isInjected) {
      if (nameToImport != null && priority != null && shouldInsertBefore(insertParent,(PyImportStatementBase)feeler,nameToImport,priority)) {
        break;
      }
      seeker=feeler;
      feeler=feeler.getNextSibling();
      skippedOverImports=true;
    }
 else     if (PyUtil.instanceOf(feeler,PsiWhiteSpace.class,PsiComment.class)) {
      seeker=feeler;
      feeler=feeler.getNextSibling();
    }
 else     if (!skippedOverImports && !skippedOverDoc && insertParent instanceof PyFile) {
      PsiElement doc_elt=DocStringUtil.findDocStringExpression((PyElement)insertParent);
      if (doc_elt != null && doc_elt.getParent() == feeler) {
        feeler=feeler.getNextSibling();
        seeker=feeler;
        skippedOverDoc=true;
      }
 else {
        break;
      }
    }
 else {
      break;
    }
  }
 while (feeler != null);
  return seeker;
}
