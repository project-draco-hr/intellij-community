{
  String as_clause;
  if (asName == null) {
    as_clause="";
  }
 else {
    as_clause=" as " + asName;
  }
  if (!(file instanceof PyFile)) {
    return false;
  }
  List<PyImportElement> existingImports=((PyFile)file).getImportTargets();
  for (  PyImportElement element : existingImports) {
    final QualifiedName qName=element.getImportedQName();
    if (qName != null && name.equals(qName.toString())) {
      if ((asName != null && asName.equals(element.getAsName())) || asName == null) {
        return false;
      }
    }
  }
  final PyElementGenerator generator=PyElementGenerator.getInstance(file.getProject());
  final LanguageLevel languageLevel=LanguageLevel.forElement(file);
  final PyImportStatement importNodeToInsert=generator.createImportStatementFromText(languageLevel,"import " + name + as_clause);
  try {
    file.addBefore(importNodeToInsert,getInsertPosition(file,name,priority));
  }
 catch (  IncorrectOperationException e) {
    LOG.error(e);
  }
  return true;
}
