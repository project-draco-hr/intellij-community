{
  final VirtualFile vFile=toImport.getVirtualFile();
  if (vFile == null) {
    return ImportPriority.PROJECT;
  }
  final ProjectRootManager projectRootManager=ProjectRootManager.getInstance(toImport.getProject());
  if (projectRootManager.getFileIndex().isInContent(vFile)) {
    return ImportPriority.PROJECT;
  }
  Module module=ModuleUtil.findModuleForPsiElement(importLocation);
  Sdk pythonSdk=module != null ? PythonSdkType.findPythonSdk(module) : projectRootManager.getProjectSdk();
  if (pythonSdk != null) {
    final VirtualFile libDir=PyClassNameIndex.findLibDir(pythonSdk);
    if (libDir != null && VfsUtil.isAncestor(libDir,vFile,false)) {
      final VirtualFile sitePackages=libDir.findChild("site-packages");
      if (sitePackages != null && VfsUtil.isAncestor(sitePackages,vFile,false)) {
        return ImportPriority.THIRD_PARTY;
      }
      return ImportPriority.BUILTIN;
    }
    final VirtualFile skeletonsDir=PythonSdkType.findSkeletonsDir(pythonSdk);
    if (skeletonsDir != null && vFile.getParent() == skeletonsDir) {
      return ImportPriority.BUILTIN;
    }
  }
  return ImportPriority.THIRD_PARTY;
}
