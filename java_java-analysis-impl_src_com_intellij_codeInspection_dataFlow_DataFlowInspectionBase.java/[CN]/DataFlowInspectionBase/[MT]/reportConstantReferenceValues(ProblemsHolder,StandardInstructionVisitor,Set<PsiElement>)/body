{
  for (  Pair<PsiReferenceExpression,DfaConstValue> pair : visitor.getConstantReferenceValues()) {
    PsiReferenceExpression ref=pair.first;
    if (!reportedAnchors.add(ref)) {
      continue;
    }
    final Object value=pair.second.getValue();
    final String presentableName=value instanceof PsiNamedElement ? ((PsiNamedElement)value).getName() : String.valueOf(value);
    final String exprText=getConstantValueText(value);
    if (exprText == null) {
      continue;
    }
    holder.registerProblem(ref,"Value <code>#ref</code> #loc is always '" + presentableName + "'",new LocalQuickFix(){
      @NotNull @Override public String getName(){
        return "Replace with '" + presentableName + "'";
      }
      @NotNull @Override public String getFamilyName(){
        return "Replace with constant value";
      }
      @Override public void applyFix(      @NotNull Project project,      @NotNull ProblemDescriptor descriptor){
        PsiElement newElement=descriptor.getPsiElement().replace(JavaPsiFacade.getElementFactory(project).createExpressionFromText(exprText,null));
        JavaCodeStyleManager.getInstance(project).shortenClassReferences(newElement);
      }
    }
);
  }
}
