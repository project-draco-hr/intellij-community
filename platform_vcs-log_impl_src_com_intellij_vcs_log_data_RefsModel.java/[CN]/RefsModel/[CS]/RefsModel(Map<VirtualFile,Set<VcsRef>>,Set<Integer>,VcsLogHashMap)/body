{
  super(Iterables.concat(refsByRoot.values()));
  myRefs=refsByRoot;
  myBranchesToIndices=prepareRefsToIndicesMap(myBranches,hashMap);
  myRefsToHeadIndices=prepareRefsToIndicesMap(Iterables.filter(Iterables.concat(refsByRoot.values()),new Predicate<VcsRef>(){
    @Override public boolean apply(    VcsRef vcsRef){
      return heads.contains(hashMap.getCommitIndex(vcsRef.getCommitHash(),vcsRef.getRoot()));
    }
  }
),hashMap);
}
