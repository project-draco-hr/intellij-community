{
  @SuppressWarnings("deprecation") Project project=CommonDataKeys.PROJECT.getData(DataManager.getInstance().getDataContext());
  if (project == null) {
    LOG.debug("MacMenu: no project in data context");
    Project[] projects=ProjectManager.getInstance().getOpenProjects();
    project=projects.length > 0 ? projects[0] : null;
    if (project == null && useDefault) {
      LOG.debug("MacMenu: use default project instead");
      project=ProjectManager.getInstance().getDefaultProject();
    }
  }
  LOG.debug("MacMenu: project = ",project);
  return project;
}
