{
  Editor editor=getEditor(file);
  NullableFunction<List<VirtualFile>,NonProjectFileWritingAccessProvider.UnlockOption> unlocker=new NullableFunction<List<VirtualFile>,NonProjectFileWritingAccessProvider.UnlockOption>(){
    @Nullable @Override public NonProjectFileWritingAccessProvider.UnlockOption fun(    List<VirtualFile> files){
      return option;
    }
  }
;
  NonProjectFileWritingAccessProvider.setCustomUnlocker(unlocker);
  String before=editor.getDocument().getText();
  typeInChar(editor,'a');
  if (fileHasBeenChanged) {
    assertEquals("Text should be changed",'a' + before,editor.getDocument().getText());
  }
 else {
    assertEquals("Text should not be changed",before,editor.getDocument().getText());
  }
}
