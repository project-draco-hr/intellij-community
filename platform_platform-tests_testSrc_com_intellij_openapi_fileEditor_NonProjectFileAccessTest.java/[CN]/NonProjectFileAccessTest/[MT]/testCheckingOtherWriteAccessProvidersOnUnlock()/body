{
  final VirtualFile nonProjectFile1=createNonProjectFile();
  final VirtualFile nonProjectFile2=createNonProjectFile();
  final Set<VirtualFile> requested=registerWriteAccessProvider(nonProjectFile1);
  typeAndCheck(nonProjectFile1,false);
  assertSameElements(requested);
  typeAndCheck(nonProjectFile1,NonProjectFileWritingAccessProvider.UnlockOption.UNLOCK,false);
  assertSameElements(requested,nonProjectFile1);
  typeAndCheck(nonProjectFile1,false);
  requested.clear();
  typeAndCheck(nonProjectFile2,NonProjectFileWritingAccessProvider.UnlockOption.UNLOCK,true);
  assertSameElements(requested,nonProjectFile2);
}
