{
  if (path == null)   return;
  final InspectionConfigTreeNode node=(InspectionConfigTreeNode)path.getLastPathComponent();
  final ToolDescriptors descriptors=node.getDescriptors();
  if (descriptors != null) {
    final Descriptor defaultDescriptor=descriptors.getDefaultDescriptor();
    final String description=defaultDescriptor.loadDescription();
    if (description != null) {
      try {
        final HintHint hintHint=new HintHint(myBrowser,new Point(0,0));
        hintHint.setFont(myBrowser.getFont());
        myBrowser.read(new StringReader(SearchUtil.markup(HintUtil.prepareHintText(description,hintHint),myProfileFilter.getFilter())),null);
      }
 catch (      IOException e2) {
        try {
          myBrowser.read(new StringReader(XmlStringUtil.wrapInHtml("<b>" + UNDER_CONSTRUCTION + "</b>")),null);
        }
 catch (        IOException e1) {
        }
      }
catch (      Throwable t) {
        LOG.error("Failed to load description for: " + defaultDescriptor.getToolWrapper().getTool().getClass() + "; description: "+ description,t);
      }
    }
 else {
      try {
        myBrowser.read(new StringReader(EMPTY_HTML),null);
      }
 catch (      IOException e1) {
      }
    }
    myOptionsPanel.removeAll();
    final Project project=myProjectProfileManager.getProject();
    final NamedScope scope=node.getScope(project);
    final JPanel severityPanel=new JPanel(new GridBagLayout());
    final double severityPanelWeightY;
    final JPanel configPanelAnchor=new JPanel(new GridLayout());
    configPanelAnchor.setBorder(IdeBorderFactory.createTitledBorder("Options",false,new Insets(0,0,0,0)));
    final HighlightDisplayKey key=defaultDescriptor.getKey();
    final String toolId=key.toString();
    final List<ScopeToolState> nonDefaultDescriptors=mySelectedProfile.getNonDefaultTools(toolId,project);
    if (nonDefaultDescriptors.isEmpty()) {
      final LevelChooserAction severityLevelChooser=new LevelChooserAction(mySelectedProfile){
        @Override protected void onChosen(        final HighlightSeverity severity){
          final HighlightDisplayLevel level=HighlightDisplayLevel.find(severity);
          final boolean toUpdate=mySelectedProfile.getErrorLevel(key,scope,project) != level;
          mySelectedProfile.setErrorLevel(key,level,-1,project);
          if (toUpdate)           node.dropCache();
        }
      }
;
      severityLevelChooser.setChosen(mySelectedProfile.getErrorLevel(key,scope,project).getSeverity());
      final ScopesChooser scopesChooser=new ScopesChooser(defaultDescriptor,mySelectedProfile,project){
        @Override protected void onScopeAdded(){
          updateOptionsAndDescriptionPanel();
        }
      }
;
      severityPanel.add(new JLabel(InspectionsBundle.message("inspection.severity")),new GridBagConstraints(0,0,1,1,0,0,GridBagConstraints.WEST,GridBagConstraints.VERTICAL,new Insets(10,0,10,10),0,0));
      severityPanel.add(severityLevelChooser.createCustomComponent(severityLevelChooser.getTemplatePresentation()),new GridBagConstraints(1,0,1,1,1.0,0,GridBagConstraints.WEST,GridBagConstraints.VERTICAL,new Insets(10,0,10,0),0,0));
      severityPanel.add(scopesChooser.createCustomComponent(scopesChooser.getTemplatePresentation()),new GridBagConstraints(2,0,1,1,0,0,GridBagConstraints.WEST,GridBagConstraints.VERTICAL,new Insets(10,0,10,0),0,0));
      severityPanelWeightY=0.0;
    }
 else {
      for (      final Descriptor descriptor : descriptors.getNonDefaultDescriptors()) {
        descriptor.loadConfig();
      }
      final JTable scopesAndScopesAndSeveritiesTable=new ScopesAndSeveritiesTable(new ScopesAndSeveritiesTable.TableSettings(node,mySelectedProfile,myTree,project){
        @Override protected void onScopeChosen(        @NotNull final ScopeToolState state){
          setConfigPanel(configPanelAnchor,state);
          configPanelAnchor.revalidate();
          configPanelAnchor.repaint();
        }
        @Override protected void onScopeAdded(){
        }
        @Override protected void onScopeRemoved(        final int scopesCount){
          if (scopesCount == 1) {
            updateOptionsAndDescriptionPanel();
          }
        }
      }
);
      final ToolbarDecorator wrappedTable=ToolbarDecorator.createDecorator(scopesAndScopesAndSeveritiesTable);
      final JPanel panel=wrappedTable.createPanel();
      severityPanel.add(new JBLabel("Scopes & Severities"),new GridBagConstraints(0,0,1,1,0,0,GridBagConstraints.NORTHWEST,GridBagConstraints.NONE,new Insets(5,0,2,10),0,0));
      severityPanel.add(new JBLabel("Add scope to change its settings",UIUtil.ComponentStyle.SMALL),new GridBagConstraints(1,0,1,1,1.0,0,GridBagConstraints.NORTHEAST,GridBagConstraints.NONE,new Insets(5,0,2,0),0,0));
      severityPanel.add(panel,new GridBagConstraints(0,1,2,1,0,1.0,GridBagConstraints.NORTHWEST,GridBagConstraints.BOTH,new Insets(0,0,0,0),0,0));
      severityPanelWeightY=0.3;
    }
    setConfigPanel(configPanelAnchor,defaultDescriptor.getState());
    myOptionsPanel.add(severityPanel,new GridBagConstraints(0,0,1,1,1.0,severityPanelWeightY,GridBagConstraints.WEST,GridBagConstraints.BOTH,new Insets(0,0,0,0),0,0));
    myOptionsPanel.add(configPanelAnchor,new GridBagConstraints(0,1,1,1,1.0,1.0,GridBagConstraints.WEST,GridBagConstraints.BOTH,new Insets(0,0,0,0),0,0));
    myOptionsPanel.revalidate();
    GuiUtils.enableChildren(myOptionsPanel,node.isChecked());
  }
 else {
    initOptionsAndDescriptionPanel();
  }
  myOptionsPanel.repaint();
}
