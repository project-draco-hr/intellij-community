{
  EditorColorsScheme defaultScheme=EditorColorsManager.getInstance().getScheme(EditorColorsScheme.DEFAULT_SCHEME_NAME);
  EditorColorsScheme editorColorsScheme=(EditorColorsScheme)defaultScheme.clone();
  editorColorsScheme.setName("test");
  TextAttributesKey keyD=TextAttributesKey.createTextAttributesKey("D");
  TextAttributesKey keyC=TextAttributesKey.createTextAttributesKey("C",keyD);
  TextAttributesKey keyB=TextAttributesKey.createTextAttributesKey("B",keyC);
  TextAttributesKey keyA=TextAttributesKey.createTextAttributesKey("A",keyB);
  try {
    keyD.setFallbackAttributeKey(keyB);
    editorColorsScheme.getAttributes(keyA);
  }
 catch (  StackOverflowError e) {
    fail("Stack overflow detected!");
  }
catch (  Throwable e) {
    String s=e.getMessage();
    assertTrue(s.contains("B->C->D"));
  }
 finally {
    TextAttributesKey.removeTextAttributesKey("A");
    TextAttributesKey.removeTextAttributesKey("B");
    TextAttributesKey.removeTextAttributesKey("C");
    TextAttributesKey.removeTextAttributesKey("D");
  }
}
