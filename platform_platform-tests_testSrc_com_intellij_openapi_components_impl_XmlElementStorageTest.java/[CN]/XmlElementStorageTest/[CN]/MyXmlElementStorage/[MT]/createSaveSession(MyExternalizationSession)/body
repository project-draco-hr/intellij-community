{
  return new MySaveSession(externalizationSession){
    @Override protected void doSave() throws StateStorageException {
      Element elementToSave=getElementToSave();
      mySavedElement=elementToSave == null ? null : elementToSave.clone();
    }
    @NotNull @Override public Collection<IFile> getStorageFilesToSave() throws StateStorageException {
      return needsSave() ? getAllStorageFiles() : Collections.<IFile>emptyList();
    }
    @NotNull @Override public List<IFile> getAllStorageFiles(){
      throw new UnsupportedOperationException("Method getAllStorageFiles not implemented in " + getClass());
    }
  }
;
}
