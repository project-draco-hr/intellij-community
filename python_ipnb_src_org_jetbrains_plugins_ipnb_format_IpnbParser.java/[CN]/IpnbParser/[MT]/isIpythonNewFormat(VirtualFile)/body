{
  final Project project=ProjectUtil.guessProjectForFile(virtualFile);
  if (project != null) {
    final Module module=ProjectRootManager.getInstance(project).getFileIndex().getModuleForFile(virtualFile);
    if (module != null) {
      final Sdk sdk=PythonSdkType.findPythonSdk(module);
      if (sdk != null) {
        final List<PyPackage> packages=PyPackageManager.getInstance(sdk).getPackages();
        final PyPackage ipython=packages != null ? PyPackageUtil.findPackage(packages,"ipython") : null;
        final PyPackage jupyter=packages != null ? PyPackageUtil.findPackage(packages,"jupyter") : null;
        if (jupyter == null && ipython != null && VersionComparatorUtil.compare(ipython.getVersion(),"3.0") <= 0) {
          return false;
        }
      }
    }
  }
  return true;
}
