{
  final Project project=ProjectUtil.guessProjectForFile(virtualFile);
  if (project != null) {
    final Module module=ProjectRootManager.getInstance(project).getFileIndex().getModuleForFile(virtualFile);
    if (module != null) {
      final Sdk sdk=PythonSdkType.findPythonSdk(module);
      if (sdk != null) {
        try {
          final PyPackage ipython=PyPackageManager.getInstance(sdk).findPackage("ipython",true);
          final PyPackage jupyter=PyPackageManager.getInstance(sdk).findPackage("jupyter",true);
          if (jupyter == null && ipython != null && VersionComparatorUtil.compare(ipython.getVersion(),"3.0") <= 0) {
            return false;
          }
        }
 catch (        ExecutionException ignored) {
        }
      }
    }
  }
  return true;
}
