{
  if (!isEditing()) {
    return;
  }
  myFocusManager.doWhenFocusSettlesDown(new ExpirableRunnable(){
    @Override public boolean isExpired(){
      return !isEditing();
    }
    @Override public void run(){
      Component c=myFocusManager.getFocusOwner();
      if (UIUtil.isMeaninglessFocusOwner(c)) {
        return;
      }
      while (c != null) {
        if (c instanceof JPopupMenu) {
          c=((JPopupMenu)c).getInvoker();
        }
        if (c == JBTable.this) {
          return;
        }
 else         if (c instanceof Window) {
          if (c == SwingUtilities.getWindowAncestor(JBTable.this)) {
            removeCellEditor();
          }
          break;
        }
        c=c.getParent();
      }
    }
  }
);
}
