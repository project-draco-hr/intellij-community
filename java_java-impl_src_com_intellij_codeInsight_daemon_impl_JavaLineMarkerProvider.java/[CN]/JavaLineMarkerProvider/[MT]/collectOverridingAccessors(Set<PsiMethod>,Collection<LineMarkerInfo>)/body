{
  final Set<PsiMethod> overridden=new HashSet<PsiMethod>();
  Set<PsiClass> classes=new THashSet<PsiClass>();
  for (  PsiMethod method : methods) {
    ProgressManager.checkCanceled();
    final PsiClass parentClass=method.getContainingClass();
    if (!CommonClassNames.JAVA_LANG_OBJECT.equals(parentClass.getQualifiedName())) {
      classes.add(parentClass);
    }
  }
  for (  final PsiClass aClass : classes) {
    AllOverridingMethodsSearch.search(aClass).forEach(new Processor<Pair<PsiMethod,PsiMethod>>(){
      @Override public boolean process(      final Pair<PsiMethod,PsiMethod> pair){
        ProgressManager.checkCanceled();
        final PsiMethod superMethod=pair.getFirst();
        if (methods.remove(superMethod)) {
          overridden.add(superMethod);
        }
        return !methods.isEmpty();
      }
    }
);
  }
  if (!methods.isEmpty()) {
    for (    PsiClass aClass : classes) {
      final PsiMethod interfaceMethod=LambdaUtil.getFunctionalInterfaceMethod(aClass);
      if (interfaceMethod != null) {
        if (FunctionalExpressionSearch.search(aClass).findFirst() != null) {
          overridden.add(interfaceMethod);
        }
      }
    }
  }
  for (  PsiMethod method : overridden) {
    ProgressManager.checkCanceled();
    boolean overrides=!method.hasModifierProperty(PsiModifier.ABSTRACT);
    final Icon icon=overrides ? AllIcons.Gutter.OverridenMethod : AllIcons.Gutter.ImplementedMethod;
    PsiElement range;
    if (method.isPhysical()) {
      range=method.getNameIdentifier();
    }
 else {
      final PsiElement navigationElement=method.getNavigationElement();
      if (navigationElement instanceof PsiNameIdentifierOwner) {
        range=((PsiNameIdentifierOwner)navigationElement).getNameIdentifier();
      }
 else {
        range=navigationElement;
      }
    }
    if (range == null)     range=method;
    final MarkerType type=MarkerType.OVERRIDEN_METHOD;
    LineMarkerInfo<PsiElement> info=new LineMarkerInfo<PsiElement>(range,range.getTextRange(),icon,Pass.UPDATE_OVERRIDEN_MARKERS,type.getTooltip(),type.getNavigationHandler(),GutterIconRenderer.Alignment.RIGHT);
    info.setNavigateActionTextProvider(type.getNavigateActionText());
    result.add(info);
  }
}
