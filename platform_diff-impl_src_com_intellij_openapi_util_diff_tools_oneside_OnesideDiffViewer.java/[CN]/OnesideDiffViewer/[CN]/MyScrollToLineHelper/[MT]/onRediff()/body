{
  if (myShouldScroll && myScrollToChange != null) {
    myShouldScroll=!doScrollToChange(myScrollToChange);
  }
  if (myShouldScroll && myNavigationContext != null) {
    myShouldScroll=!doScrollToContext(myNavigationContext);
  }
  if (myShouldScroll && myCaretPosition != null && myCaretPosition.length == 2) {
    LogicalPosition twosidePosition=myMasterSide.selectN(myCaretPosition);
    int onesideLine=transferLineToOneside(myMasterSide,twosidePosition.line);
    LogicalPosition position=new LogicalPosition(onesideLine,twosidePosition.column);
    myEditor.getCaretModel().moveToLogicalPosition(position);
    if (myEditorPosition != null && myEditorPosition.isSame(myCaretPosition)) {
      DiffUtil.scrollToPoint(myEditor,myEditorPosition.myPoint);
    }
 else {
      myEditor.getScrollingModel().scrollToCaret(ScrollType.CENTER);
    }
    myShouldScroll=false;
  }
  if (myShouldScroll) {
    doScrollToChange(ScrollToPolicy.FIRST_CHANGE);
  }
  myShouldScroll=false;
}
