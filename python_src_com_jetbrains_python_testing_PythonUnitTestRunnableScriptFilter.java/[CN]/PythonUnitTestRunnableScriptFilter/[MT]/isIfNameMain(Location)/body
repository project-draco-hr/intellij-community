{
  PsiElement element=location.getPsiElement();
  while (true) {
    final PyIfStatement ifStatement=PsiTreeUtil.getParentOfType(element,PyIfStatement.class);
    if (ifStatement == null) {
      break;
    }
    element=ifStatement;
  }
  if (element instanceof PyIfStatement) {
    PyIfStatement ifStatement=(PyIfStatement)element;
    final PyExpression condition=ifStatement.getIfPart().getCondition();
    if (condition instanceof PyBinaryExpression) {
      PyBinaryExpression binaryExpression=(PyBinaryExpression)condition;
      final PyExpression rhs=binaryExpression.getRightExpression();
      return binaryExpression.getOperator() == PyTokenTypes.EQEQ && binaryExpression.getLeftExpression().getText().equals("__name__") && rhs != null && rhs.getText().contains("__main__");
    }
  }
  return false;
}
