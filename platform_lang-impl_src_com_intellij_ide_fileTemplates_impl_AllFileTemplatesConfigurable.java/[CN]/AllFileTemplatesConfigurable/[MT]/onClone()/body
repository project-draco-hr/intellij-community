{
  try {
    myEditor.apply();
  }
 catch (  ConfigurationException ignore) {
  }
  final FileTemplate selected=myCurrentTab.getSelectedTemplate();
  if (selected == null) {
    return;
  }
  final FileTemplate[] templates=myCurrentTab.getTemplates();
  final Set<String> names=new HashSet<>();
  for (  FileTemplate template : templates) {
    names.add(template.getName());
  }
  @SuppressWarnings({"UnresolvedPropertyKey"}) final String nameTemplate=IdeBundle.message("template.copy.N.of.T");
  String name=MessageFormat.format(nameTemplate,"",selected.getName());
  int i=0;
  while (names.contains(name)) {
    name=MessageFormat.format(nameTemplate,++i + " ",selected.getName());
  }
  final FileTemplate newTemplate=new CustomFileTemplate(name,selected.getExtension());
  newTemplate.setText(selected.getText());
  newTemplate.setReformatCode(selected.isReformatCode());
  newTemplate.setLiveTemplateEnabled(selected.isLiveTemplateEnabled());
  myCurrentTab.addTemplate(newTemplate);
  myModified=true;
  myCurrentTab.selectTemplate(newTemplate);
  fireListChanged();
}
