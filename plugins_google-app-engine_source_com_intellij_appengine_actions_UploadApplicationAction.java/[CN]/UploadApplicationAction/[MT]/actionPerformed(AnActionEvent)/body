{
  final Project project=e.getProject();
  if (project != null) {
    final List<Artifact> artifacts=AppEngineUtil.collectAppEngineArtifacts(project,true);
    if (artifacts.isEmpty()) {
      Messages.showErrorDialog(project,"No Web or EAR artifacts with AppEngine found in the project",CommonBundle.getErrorTitle());
      return;
    }
    Artifact artifact;
    if (artifacts.size() == 1) {
      artifact=artifacts.get(0);
    }
 else {
      final UploadApplicationDialog dialog=new UploadApplicationDialog(project);
      dialog.show();
      artifact=dialog.getSelectedArtifact();
      if (!dialog.isOK() || artifact == null) {
        return;
      }
    }
    final AppEngineUploader uploader=AppEngineUploader.createUploader(project,artifact,null,new ServerRuntimeInstance.DeploymentOperationCallback(){
      @Override public void succeeded(      @NotNull DeploymentRuntime deploymentRuntime){
      }
      @Override public void errorOccurred(      @NotNull final String errorMessage){
        ApplicationManager.getApplication().invokeLater(new Runnable(){
          public void run(){
            Messages.showErrorDialog(project,errorMessage,CommonBundle.getErrorTitle());
          }
        }
);
      }
    }
,null);
    if (uploader != null) {
      uploader.startUploading();
    }
  }
}
