{
  List<ArtifactState> artifactStates=managerState.getArtifacts();
  final List<ArtifactImpl> artifacts=new ArrayList<ArtifactImpl>(artifactStates.size());
  if (!artifactStates.isEmpty()) {
    AccessToken token=ReadAction.start();
    try {
      for (      ArtifactState state : artifactStates) {
        artifacts.add(loadArtifact(state));
      }
    }
  finally {
      token.finish();
    }
  }
  if (myLoaded) {
    final ArtifactModelImpl model=new ArtifactModelImpl(this,artifacts);
    doCommit(model);
  }
 else {
    myModel.setArtifactsList(artifacts);
    myLoaded=true;
  }
}
