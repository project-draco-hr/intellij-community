{
  if (file.getName().endsWith(".properties")) {
    try {
      PropertyResourceBundle bundle;
      InputStream fis=new BufferedInputStream(new FileInputStream(file));
      try {
        bundle=new PropertyResourceBundle(fis);
      }
  finally {
        fis.close();
      }
      if (bundle.containsKey(propertyName)) {
        return bundle.getString(propertyName);
      }
      return null;
    }
 catch (    IOException e) {
      return null;
    }
  }
  final String fileContent=getContent(file);
  final String propertyValue=findProperty(propertyName,fileContent);
  if (!StringUtil.isEmpty(propertyValue)) {
    return propertyValue;
  }
  return null;
}
