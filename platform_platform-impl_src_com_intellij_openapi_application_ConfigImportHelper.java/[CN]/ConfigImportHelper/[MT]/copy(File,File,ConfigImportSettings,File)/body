{
  src=src.getCanonicalFile();
  dest=dest.getCanonicalFile();
  if (!src.isDirectory()) {
    throw new IOException(ApplicationBundle.message("config.import.invalid.directory.error",src.getAbsolutePath()));
  }
  if (!dest.isDirectory()) {
    throw new IOException(ApplicationBundle.message("config.import.invalid.directory.error",dest.getAbsolutePath()));
  }
  if (FileUtil.filesEqual(src,dest)) {
    return;
  }
  FileUtil.ensureExists(dest);
  FileUtil.copyDir(src,dest);
  FileUtil.delete(new File(dest,"user.token"));
  File oldPluginsDir=new File(src,PLUGINS_PATH);
  if (!oldPluginsDir.isDirectory() && SystemInfo.isMac) {
    oldPluginsDir=getSettingsPath(oldInstallationHome,settings,PathManager.PROPERTY_PLUGINS_PATH,new Function<String,String>(){
      @Override public String fun(      String pathSelector){
        return PathManager.getDefaultPluginPathFor(pathSelector);
      }
    }
);
    if (oldPluginsDir == null) {
      oldPluginsDir=new File(PathManager.getDefaultPluginPathFor(src.getName()));
    }
    File newPluginsDir=new File(PathManager.getPluginsPath());
    FileUtil.copyDir(oldPluginsDir,newPluginsDir);
  }
  loadOldPlugins(oldPluginsDir,dest);
}
