{
  return requestCredentials(realm,StringUtil.toLowerCase(mode.toString()),new Getter<String>(){
    @Override public String get(){
      final Ref<String> answer=new Ref<String>();
      Runnable command=new Runnable(){
        public void run(){
          SimpleCredentialsDialog dialog=new SimpleCredentialsDialog(myVcs.getProject());
          dialog.setup(mode,realm,key,true);
          dialog.setTitle(SvnBundle.message("dialog.title.authentication.required"));
          dialog.setSaveEnabled(false);
          dialog.show();
          if (dialog.isOK()) {
            answer.set(dialog.getPassword());
          }
        }
      }
;
      WaitForProgressToShow.runOrInvokeAndWaitAboveProgress(command,ModalityState.any());
      return answer.get();
    }
  }
);
}
