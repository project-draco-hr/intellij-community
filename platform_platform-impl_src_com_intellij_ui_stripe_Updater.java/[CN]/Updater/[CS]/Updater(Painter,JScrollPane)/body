{
  myPainter=painter;
  myScrollBar=pane.getVerticalScrollBar();
  myScrollBar.addMouseListener(myMouseAdapter);
  myScrollBar.addMouseMotionListener(myMouseAdapter);
  myQueue=new MergingUpdateQueue("ErrorStripeUpdater",100,true,myScrollBar,this);
  UIUtil.putClientProperty(myScrollBar,ButtonlessScrollBarUI.EXTRA_TRACK,new RegionPainter<Object>(){
    @Override public void paint(    Graphics2D g,    int x,    int y,    int width,    int height,    Object object){
      DaemonCodeAnalyzerSettings settings=DaemonCodeAnalyzerSettings.getInstance();
      myPainter.setMinimalThickness(settings == null ? 2 : Math.min(settings.ERROR_STRIPE_MARK_MIN_HEIGHT,JBUI.scale(4)));
      myPainter.setErrorStripeGap(Registry.intValue("error.stripe.gap",0));
      if (myPainter instanceof ExtraErrorStripePainter) {
        ExtraErrorStripePainter extra=(ExtraErrorStripePainter)myPainter;
        extra.setGroupSwap(!myScrollBar.getComponentOrientation().isLeftToRight());
      }
      myPainter.paint(g,x,y,width,height,object);
    }
  }
);
  Disposer.register(this,new TranslucencyThumbPainter(myPainter,myScrollBar));
  Disposer.register(this,new TranslucencyThumbPainter(null,pane.getHorizontalScrollBar()));
}
