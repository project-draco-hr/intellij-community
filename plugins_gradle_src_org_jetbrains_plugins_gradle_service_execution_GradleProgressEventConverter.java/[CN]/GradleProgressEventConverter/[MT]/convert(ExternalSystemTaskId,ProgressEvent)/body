{
  final InternalOperationDescriptor internalDesc=event.getDescriptor() instanceof DefaultOperationDescriptor ? ((DefaultOperationDescriptor)event.getDescriptor()).getInternalOperationDescriptor() : null;
  final String eventId=internalDesc == null ? event.getDescriptor().getDisplayName() : internalDesc.getId().toString();
  final String parentEventId;
  if (event.getDescriptor().getParent() == null) {
    parentEventId=null;
  }
 else {
    parentEventId=internalDesc == null ? event.getDescriptor().getParent().getDisplayName() : internalDesc.getParentId().toString();
  }
  final String description=event.getDescriptor().getName();
  if (event instanceof StartEvent) {
    final OperationDescriptor descriptor=convert(event.getDescriptor(),event.getEventTime());
    return new ExternalSystemTaskExecutionEvent(id,new ExternalSystemStartEventImpl<OperationDescriptor>(eventId,parentEventId,descriptor));
  }
 else   if (event instanceof FinishEvent) {
    final OperationDescriptor descriptor=convert(event.getDescriptor(),event.getEventTime());
    return new ExternalSystemTaskExecutionEvent(id,new ExternalSystemFinishEventImpl<OperationDescriptor>(eventId,parentEventId,descriptor,convert(((FinishEvent)event).getResult())));
  }
 else   if (event instanceof TaskProgressEvent) {
    final OperationDescriptor descriptor=convert(event.getDescriptor(),event.getEventTime());
    return new ExternalSystemTaskExecutionEvent(id,new BaseExternalSystemProgressEvent<OperationDescriptor>(eventId,parentEventId,descriptor));
  }
 else {
    return new ExternalSystemTaskNotificationEvent(id,description);
  }
}
