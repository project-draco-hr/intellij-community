{
  final GridBagConstraints c=((GridBagLayout)getLayout()).getConstraints(from);
  final int index=myIpnbPanels.indexOf(from);
  IpnbPanel comp;
  if (cell instanceof CodeCell) {
    comp=new CodePanel(myProject,myParent,(CodeCell)cell);
    c.gridwidth=2;
    c.gridx=0;
    add(comp,c);
  }
 else   if (cell instanceof MarkdownCell) {
    comp=new MarkdownPanel((MarkdownCell)cell);
    c.gridwidth=1;
    c.gridx=1;
    add(comp,c);
  }
 else   if (cell instanceof HeadingCell) {
    comp=new HeadingPanel((HeadingCell)cell);
    c.gridwidth=1;
    c.gridx=1;
    add(comp,c);
  }
 else {
    throw new UnsupportedOperationException(cell.getClass().toString());
  }
  if (index >= 0) {
    myIpnbPanels.remove(index);
    myIpnbPanels.add(index,comp);
  }
  setSelectedCell(comp);
  remove(from);
  revalidate();
  repaint();
}
