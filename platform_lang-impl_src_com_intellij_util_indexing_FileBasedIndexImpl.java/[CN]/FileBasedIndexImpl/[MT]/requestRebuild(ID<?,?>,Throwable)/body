{
  cleanupProcessedFlag();
  boolean requiresRebuildWasSet=ourRebuildStatus.get(indexId).compareAndSet(OK,REQUIRES_REBUILD);
  if (requiresRebuildWasSet) {
    String message="Rebuild requested for index " + indexId;
    if (ApplicationManager.getApplication().isUnitTestMode()) {
      LOG.error(message,throwable);
    }
 else {
      LOG.info(message,throwable);
    }
  }
}
