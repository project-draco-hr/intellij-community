{
  myChangedFilesCollector.tryToEnsureAllInvalidateTasksCompleted();
  Collection<VirtualFile> allFilesToUpdate=getAllFilesToUpdate();
  if (!allFilesToUpdate.isEmpty()) {
    List<VirtualFile> virtualFilesToBeUpdatedForProject=ContainerUtil.filter(allFilesToUpdate,new ProjectFilesCondition(projectIndexableFiles(project),filter,restrictedTo));
    if (!virtualFilesToBeUpdatedForProject.isEmpty()) {
      myForceUpdateTask.processAll(virtualFilesToBeUpdatedForProject,project);
    }
  }
}
