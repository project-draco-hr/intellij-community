{
  buildStructure(myRoot);
  myElementUpdateHook=new ElementUpdateHook(){
    @Override public void onElementAction(    String action,    Object element){
      if (!element.toString().equals(actionElement.toString()))       return;
      Runnable runnable=new Runnable(){
        @Override public void run(){
          myReadyRequest=true;
          Disposer.dispose(getBuilder());
        }
      }
;
      if (actionAction.equals(action)) {
        if (getBuilder().getUi().isPassthroughMode()) {
          runnable.run();
        }
 else {
          SwingUtilities.invokeLater(runnable);
        }
      }
    }
  }
;
  buildAction.run();
  boolean released=waitFor(15000,new Condition(){
    @Override public boolean value(    Object o){
      return getBuilder().getUi() == null;
    }
  }
);
  assertTrue(released);
}
