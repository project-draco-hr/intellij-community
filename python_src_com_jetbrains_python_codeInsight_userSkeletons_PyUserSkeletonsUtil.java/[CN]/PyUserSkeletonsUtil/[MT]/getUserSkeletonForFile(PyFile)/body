{
  final VirtualFile moduleVirtualFile=file.getVirtualFile();
  if (moduleVirtualFile != null) {
    String moduleName=QualifiedNameFinder.findShortestImportableName(file,moduleVirtualFile);
    if (moduleName != null) {
      final PyQualifiedName qName=PyQualifiedName.fromDottedString(moduleName);
      for (      PyCanonicalPathProvider provider : Extensions.getExtensions(PyCanonicalPathProvider.EP_NAME)) {
        final PyQualifiedName restored=provider.getCanonicalPath(qName,null);
        if (restored != null) {
          moduleName=restored.toString();
        }
      }
      return getUserSkeletonForModuleQName(moduleName,file);
    }
  }
  return null;
}
