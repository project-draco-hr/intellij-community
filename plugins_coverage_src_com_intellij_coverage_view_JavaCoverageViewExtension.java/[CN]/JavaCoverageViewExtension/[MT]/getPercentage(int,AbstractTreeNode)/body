{
  final Object value=node.getValue();
  if (value instanceof PsiClass) {
    if (((PsiClass)value).isInterface())     return null;
    final String qualifiedName=((PsiClass)value).getQualifiedName();
    if (columnIndex == 1) {
      return myAnnotator.getClassCoveredPercentage(qualifiedName);
    }
 else     if (columnIndex == 2) {
      return myAnnotator.getClassMethodPercentage(qualifiedName);
    }
    return myAnnotator.getClassLinePercentage(qualifiedName);
  }
  final boolean flatten=myStateBean.myFlattenPackages;
  if (columnIndex == 1) {
    return myAnnotator.getPackageClassPercentage((PsiPackage)value,flatten);
  }
 else   if (columnIndex == 2) {
    return myAnnotator.getPackageMethodPercentage((PsiPackage)value,flatten);
  }
  return myAnnotator.getPackageLinePercentage((PsiPackage)value,flatten);
}
