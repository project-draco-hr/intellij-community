{
  final List<AbstractTreeNode> topLevelNodes=new ArrayList<AbstractTreeNode>();
  for (  CoverageSuite suite : bundle.getSuites()) {
    final List<PsiPackage> packages=((JavaCoverageSuite)suite).getCurrentSuitePackages(project);
    for (    PsiPackage aPackage : packages) {
      if (!bundle.isTrackTestFolders() && aPackage.getDirectories(GlobalSearchScope.projectScope(project)).length == 0)       continue;
      final CoverageListNode node=new CoverageListNode(aPackage,bundle,stateBean);
      topLevelNodes.add(node);
      collectSubPackages(topLevelNodes,aPackage,bundle,stateBean);
    }
    final List<PsiClass> classes=((JavaCoverageSuite)suite).getCurrentSuiteClasses(project);
    for (    PsiClass aClass : classes) {
      topLevelNodes.add(new CoverageListNode(aClass,bundle,stateBean));
    }
  }
  return topLevelNodes;
}
