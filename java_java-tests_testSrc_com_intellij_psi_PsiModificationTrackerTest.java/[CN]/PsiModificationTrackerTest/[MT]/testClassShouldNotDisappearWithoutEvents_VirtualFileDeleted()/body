{
  PsiModificationTracker tracker=PsiManager.getInstance(getProject()).getModificationTracker();
  final PsiManagerEx psiManager=(PsiManagerEx)PsiManager.getInstance(getProject());
  final VirtualFile file=addFileToProject("Foo.java","class Foo {}").getVirtualFile();
  assertNotNull(JavaPsiFacade.getInstance(getProject()).findClass("Foo",GlobalSearchScope.allScope(getProject())));
  long count1=tracker.getJavaStructureModificationCount();
  PlatformTestUtil.tryGcSoftlyReachableObjects();
  assertNull(FileDocumentManager.getInstance().getCachedDocument(file));
  assertNull(psiManager.getFileManager().getCachedPsiFile(file));
  delete(file);
  assertNull(JavaPsiFacade.getInstance(getProject()).findClass("Foo",GlobalSearchScope.allScope(getProject())));
  assertFalse(count1 == tracker.getJavaStructureModificationCount());
}
