{
  PsiModificationTracker tracker=PsiManager.getInstance(getProject()).getModificationTracker();
  final PsiManagerEx psiManager=(PsiManagerEx)PsiManager.getInstance(getProject());
  final VirtualFile file=addFileToProject("foo/Foo.java","package foo; class Foo {}").getVirtualFile();
  assertNotNull(JavaPsiFacade.getInstance(getProject()).findClass("foo.Foo",GlobalSearchScope.allScope(getProject())));
  long count1=tracker.getJavaStructureModificationCount();
  PlatformTestUtil.tryGcSoftlyReachableObjects();
  assertNull(FileDocumentManager.getInstance().getCachedDocument(file));
  assertNull(psiManager.getFileManager().getCachedPsiFile(file));
  delete(file.getParent());
  assertNull(JavaPsiFacade.getInstance(getProject()).findClass("foo.Foo",GlobalSearchScope.allScope(getProject())));
  assertFalse(count1 == tracker.getJavaStructureModificationCount());
}
