{
  PsiFile psiFile=addFileToProject("Foo.java","class Foo {}");
  GlobalSearchScope scope=GlobalSearchScope.allScope(getProject());
  PlatformTestUtil.tryGcSoftlyReachableObjects();
  PsiClass psiClass=JavaPsiFacade.getInstance(getProject()).findClass("Foo",scope);
  assertNotNull(psiClass);
  long count=PsiManager.getInstance(getProject()).getModificationTracker().getJavaStructureModificationCount();
  IdeaTestUtil.setModuleLanguageLevel(getModule(),LanguageLevel.JDK_1_3);
  assertTrue(count != PsiManager.getInstance(getProject()).getModificationTracker().getJavaStructureModificationCount());
  psiClass=JavaPsiFacade.getInstance(getProject()).findClass("Foo",scope);
  assertNotNull(psiClass);
  assertTrue(psiClass.isValid());
}
