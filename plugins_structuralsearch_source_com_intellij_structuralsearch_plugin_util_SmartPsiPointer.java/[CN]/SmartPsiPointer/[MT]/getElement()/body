{
  PsiElement el=(PsiElement)reference.get();
  if (el == null && file != null && project != null) {
    PsiFile psifile=PsiManager.getInstance(project).findFile(file);
    el=psifile.findElementAt(offset);
    if (el != null && el.getTextLength() < length) {
      el=el.getParent();
    }
    if (el == null || el.getTextLength() != length) {
      throw new RuntimeException("Problem restoring gc'ed element");
    }
    setElement(el);
  }
  return el;
}
