{
  Document document=side.selectN(myDocument1,myDocument2);
  int newline=document.getTextLength() > offset2 + 1 ? 1 : 0;
  TextRange base=new TextRange(myBuilder.length(),myBuilder.length() + offset2 - offset1 + newline);
  TextRange changed=new TextRange(offset1,offset2 + newline);
  myRanges.add(new HighlightRange(side,base,changed));
  myBuilder.append(document.getCharsSequence().subSequence(offset1,offset2));
  appendText("\n",0);
  if (startLine1 != -1) {
    myConvertor.put1(totalLines,totalLines + lines + 1,startLine1);
  }
  if (startLine2 != -1) {
    myConvertor.put2(totalLines,totalLines + lines + 1,startLine2);
  }
  totalLines+=lines + 1;
}
