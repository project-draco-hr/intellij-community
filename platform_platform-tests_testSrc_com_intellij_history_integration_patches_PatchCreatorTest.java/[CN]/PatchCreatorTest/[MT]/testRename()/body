{
  VirtualFile f=createChildData(myRoot,"f.txt");
  setBinaryContent(f,new byte[]{'x'});
  rename(f,"ff.txt");
  createPatchBetweenRevisions(1,0);
  rename(f,"f.txt");
  applyPatch();
  VirtualFile patched=myRoot.findChild("ff.txt");
  assertNull(myRoot.findChild("f.txt"));
  assertNotNull(patched);
  assertEquals('x',patched.contentsToByteArray()[0]);
}
