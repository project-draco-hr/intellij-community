{
  TaskFile selectedTaskFile=studyState.getTaskFile();
  Editor editor=studyState.getEditor();
  TaskFile taskFileToNavigate=selectedTaskFile;
  VirtualFile fileToNavigate=studyState.getVirtualFile();
  if (!selectedTaskFile.hasFailedTaskWindows()) {
    for (    Map.Entry<String,TaskFile> entry : task.getTaskFiles().entrySet()) {
      String name=entry.getKey();
      TaskFile taskFile=entry.getValue();
      if (taskFile.hasFailedTaskWindows()) {
        taskFileToNavigate=taskFile;
        VirtualFile virtualFile=taskDir.findChild(name);
        if (virtualFile == null) {
          continue;
        }
        FileEditor fileEditor=FileEditorManager.getInstance(project).getSelectedEditor(virtualFile);
        if (fileEditor instanceof StudyEditor) {
          StudyEditor studyEditor=(StudyEditor)fileEditor;
          editor=studyEditor.getEditor();
        }
        fileToNavigate=virtualFile;
        break;
      }
    }
  }
  FileEditorManager.getInstance(project).openFile(fileToNavigate,true);
  IdeFocusManager.getInstance(project).requestFocus(editor.getContentComponent(),true);
  taskFileToNavigate.navigateToFirstFailedTaskWindow(editor);
}
