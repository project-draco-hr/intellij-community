{
  final List<EvaluatedTextRange> characterRanges=myHost.getStringValueCharacterRanges();
  for (  EvaluatedTextRange range : characterRanges) {
    final TextRange xsect=rangeInsideHost.intersection(range.getRange());
    if (xsect != null) {
      outChars.append(range.getValue().substring(xsect.getStartOffset() - rangeInsideHost.getStartOffset(),xsect.getEndOffset() - rangeInsideHost.getStartOffset()));
    }
  }
  return true;
}
