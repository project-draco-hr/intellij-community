{
  final List<EvaluatedTextRange> characterRanges=myHost.getStringValueCharacterRanges();
  for (  EvaluatedTextRange range : characterRanges) {
    if (offsetInDecoded < range.getValue().length()) {
      return range.getRange().getStartOffset() + offsetInDecoded - rangeInsideHost.getStartOffset();
    }
    offsetInDecoded-=range.getValue().length();
  }
  return -1;
}
