{
  final Ref<Integer> offset=new Ref<Integer>(offsetInDecoded);
  final Ref<Integer> result=new Ref<Integer>(-1);
  myHost.iterateCharacterRanges(new TextRangeConsumer(){
    public boolean process(    int startOffset,    int endOffset,    String value){
      if (value.length() > offset.get()) {
        result.set(startOffset + offset.get());
        return false;
      }
      offset.set(offset.get() - value.length());
      return true;
    }
  }
);
  return result.get();
}
