{
  LOG.info("update started|" + updateMethod);
  String oldText=myProgressIndicator.getText();
  myProgressIndicator.setText("Updating...");
  for (  GitRepository repository : myRepositories) {
    repository.update();
  }
  if (checkRebaseInProgress() || isMergeInProgress() || areUnmergedFiles()|| !checkTrackedBranchesConfigured()) {
    return GitUpdateResult.NOT_READY;
  }
  if (!fetchAndNotify()) {
    return GitUpdateResult.NOT_READY;
  }
  AccessToken token=DvcsUtil.workingTreeChangeStarted(myProject);
  GitUpdateResult result;
  try {
    result=updateImpl(updateMethod);
  }
  finally {
    DvcsUtil.workingTreeChangeFinished(myProject,token);
  }
  myProgressIndicator.setText(oldText);
  return result;
}
