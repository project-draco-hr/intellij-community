{
  if (!isCompletionEnabled(parameters) || LiveTemplateCompletionContributor.shouldShowAllTemplates() || parameters.getEditor().getCaretModel().getCaretCount() != 1) {
    return;
  }
  PostfixLiveTemplate postfixLiveTemplate=getPostfixLiveTemplate(parameters.getOriginalFile(),parameters.getEditor());
  if (postfixLiveTemplate != null) {
    postfixLiveTemplate.addCompletions(parameters,result.withPrefixMatcher(new MyPrefixMatcher(result.getPrefixMatcher().getPrefix())));
    String possibleKey=postfixLiveTemplate.computeTemplateKeyWithoutContextChecking(new CustomTemplateCallback(parameters.getEditor(),parameters.getOriginalFile()));
    if (possibleKey != null) {
      result=result.withPrefixMatcher(possibleKey);
      result.restartCompletionOnPrefixChange(StandardPatterns.string().oneOf(postfixLiveTemplate.getAllTemplateKeys(parameters.getOriginalFile(),parameters.getOffset())));
    }
  }
}
