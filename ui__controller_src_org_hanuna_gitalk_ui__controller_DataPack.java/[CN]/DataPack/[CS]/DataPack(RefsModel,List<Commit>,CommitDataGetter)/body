{
  this.refsModel=refsModel;
  this.commits=commits;
  this.commitDataGetter=commitDataGetter;
  final MyTimer graphTimer=new MyTimer("graph build");
  final Set<Hash> trackedHashes=new HashSet<Hash>();
  for (  Commit commit : refsModel.getOrderedLogTrackedCommit()) {
    trackedHashes.add(commit.getCommitHash());
  }
  graph=GraphBuilder.build(commits);
  graphModel=new GraphModelImpl(graph);
  graphModel.getFragmentManager().setUnhiddenNodes(new Get<Node,Boolean>(){
    @NotNull @Override public Boolean get(    @NotNull Node key){
      return key.getDownEdges().size() == 0 || trackedHashes.contains(key.getCommitHash());
    }
  }
);
  graphTimer.print();
  updatePrintModel();
}
