{
  myOutConsumer=outConsumer;
  myOutputFileSink=sink;
  myCanceledStatus=canceledStatus;
  StandardJavaFileManager optimizedManager=null;
  Method cacheClearMethod=null;
  if (canUseOptimizedmanager) {
    final Class<StandardJavaFileManager> optimizedManagerClass=ClasspathBootstrap.getOptimizedFileManagerClass();
    if (optimizedManagerClass != null) {
      try {
        final Constructor<StandardJavaFileManager> constructor=optimizedManagerClass.getConstructor();
        constructor.setAccessible(true);
        optimizedManager=constructor.newInstance();
        cacheClearMethod=ClasspathBootstrap.getOptimizedFileManagerCacheClearMethod();
      }
 catch (      Throwable e) {
        if (SystemInfo.isWindows) {
          outConsumer.report(new PlainMessageDiagnostic(Diagnostic.Kind.OTHER,"JPS build failed to load optimized file manager for javac: " + e.getMessage()));
        }
      }
    }
 else {
      String error=ClasspathBootstrap.getOptimizedFileManagerLoadError();
      if (error == null) {
        error="";
      }
      outConsumer.report(new PlainMessageDiagnostic(Diagnostic.Kind.OTHER,"JPS build failed to load optimized file manager for javac:\n" + error));
    }
  }
  myCacheClearMethod=cacheClearMethod;
  if (optimizedManager != null) {
    myStdManager=optimizedManager;
  }
 else {
    myStdManager=compiler.getStandardFileManager(outConsumer,Locale.US,null);
  }
}
