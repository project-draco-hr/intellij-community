{
  TaskRepository repository=new YouTrackRepository();
  String format="foo \n bar";
  repository.setCommitMessageFormat(format);
  ((TaskManagerImpl)myTaskManager).setRepositories(Collections.singletonList(repository));
  TaskManagerImpl.Config config=((TaskManagerImpl)myTaskManager).getState();
  Element element=XmlSerializer.serialize(config);
  ByteArrayOutputStream stream=new ByteArrayOutputStream();
  JDOMUtil.writeDocument(new Document(element),stream,"\n");
  Element element1=JDOMUtil.load(new ByteArrayInputStream(stream.toByteArray()));
  TaskManagerImpl.Config deserialize=XmlSerializer.deserialize(element1,TaskManagerImpl.Config.class);
  ((TaskManagerImpl)myTaskManager).loadState(deserialize);
  TaskRepository[] repositories=myTaskManager.getAllRepositories();
  assertEquals(format,repositories[0].getCommitMessageFormat());
}
