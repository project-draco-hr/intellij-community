{
  EventLoop eventLoop=channel.eventLoop();
  try {
    channel.close().awaitUninterruptibly();
  }
  finally {
    eventLoop.shutdownGracefully(1,2,TimeUnit.NANOSECONDS);
  }
}
