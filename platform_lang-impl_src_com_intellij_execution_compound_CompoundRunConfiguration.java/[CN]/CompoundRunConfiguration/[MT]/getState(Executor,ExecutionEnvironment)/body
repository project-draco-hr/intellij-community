{
  try {
    checkConfiguration();
  }
 catch (  RuntimeConfigurationException e) {
    throw new ExecutionException(e.getMessage());
  }
  return new RunProfileState(){
    @Nullable @Override public ExecutionResult execute(    final Executor executor,    @NotNull ProgramRunner runner) throws ExecutionException {
      ApplicationManager.getApplication().invokeLater(new Runnable(){
        @Override public void run(){
          RunManagerImpl manager=RunManagerImpl.getInstanceImpl(getProject());
          for (          RunConfiguration configuration : getSetToRun()) {
            RunnerAndConfigurationSettings settings=new RunnerAndConfigurationSettingsImpl(manager,configuration,false);
            ExecutionEnvironmentBuilder builder=ExecutionEnvironmentBuilder.createOrNull(executor,settings);
            if (builder != null) {
              ExecutionManager.getInstance(getProject()).restartRunProfile(builder.activeTarget().dataContext(null).build());
            }
          }
        }
      }
);
      return null;
    }
  }
;
}
