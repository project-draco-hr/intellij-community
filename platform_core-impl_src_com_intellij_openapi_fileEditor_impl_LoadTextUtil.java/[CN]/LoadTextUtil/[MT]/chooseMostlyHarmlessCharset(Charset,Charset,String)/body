{
  try {
    if (specified.equals(existing)) {
      return Pair.createNonNull(specified,toBytes(text,existing));
    }
    byte[] out=isSupported(specified,text);
    if (out != null) {
      return Pair.createNonNull(specified,out);
    }
    out=isSupported(existing,text);
    if (out != null) {
      return Pair.createNonNull(existing,out);
    }
    return Pair.createNonNull(specified,toBytes(text,specified));
  }
 catch (  RuntimeException e) {
    return Pair.createNonNull(Charset.defaultCharset(),toBytes(text,null));
  }
}
