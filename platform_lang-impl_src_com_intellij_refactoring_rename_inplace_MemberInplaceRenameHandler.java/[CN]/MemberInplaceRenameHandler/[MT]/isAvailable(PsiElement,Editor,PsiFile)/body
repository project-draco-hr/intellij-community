{
  PsiElement nameSuggestionContext=file.findElementAt(editor.getCaretModel().getOffset());
  if (nameSuggestionContext == null && editor.getCaretModel().getOffset() > 0) {
    nameSuggestionContext=file.findElementAt(editor.getCaretModel().getOffset() - 1);
  }
  if (element == null && LookupManager.getActiveLookup(editor) != null) {
    element=PsiTreeUtil.getParentOfType(nameSuggestionContext,PsiNamedElement.class);
  }
  final RefactoringSupportProvider supportProvider=element == null ? null : LanguageRefactoringSupport.INSTANCE.forLanguage(element.getLanguage());
  return editor.getSettings().isVariableInplaceRenameEnabled() && supportProvider != null && supportProvider.isMemberInplaceRenameAvailable(element,nameSuggestionContext);
}
