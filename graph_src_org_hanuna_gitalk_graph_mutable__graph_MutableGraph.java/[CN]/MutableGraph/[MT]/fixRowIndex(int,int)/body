{
  if (from < 0 || to >= allRows.size() || from > to) {
    throw new IllegalArgumentException("from: " + from + "to: "+ to);
  }
  MutableNodeRow upRow=visibleRows.get(from);
  MutableNodeRow downRow=visibleRows.get(to);
  for (int i=upRow.getLogIndex(); i <= downRow.getLogIndex(); i++) {
    allRows.get(i).updateVisibleNodes();
  }
  updateRowIndex();
  return new Replace(from,to,downRow.getRowIndex() - upRow.getRowIndex() - 1);
}
