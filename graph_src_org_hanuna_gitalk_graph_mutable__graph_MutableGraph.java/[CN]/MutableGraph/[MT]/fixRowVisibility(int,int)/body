{
  if (fromRowIndex < 0 || toRowIndex >= allRows.size() || fromRowIndex > toRowIndex) {
    throw new IllegalArgumentException("fromRowIndex: " + fromRowIndex + "toRowIndex: "+ toRowIndex);
  }
  MutableNodeRow upRow=visibleRows.get(fromRowIndex);
  MutableNodeRow downRow=visibleRows.get(toRowIndex);
  for (int i=upRow.getLogIndex(); i <= downRow.getLogIndex(); i++) {
    allRows.get(i).updateVisibleNodes();
  }
  recalculateRowIndex();
  return new Replace(fromRowIndex,toRowIndex,downRow.getRowIndex() - upRow.getRowIndex() - 1);
}
