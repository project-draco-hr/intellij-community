{
  if (resolved.isEmpty()) {
    LOG.info("No artifacts were resolved for repository dependency " + lib.getProperties().getData().getMavenId());
    return;
  }
  final THashSet<File> libFiles=new THashSet<File>(FileUtil.FILE_HASHING_STRATEGY);
  libFiles.addAll(lib.getFiles(JpsOrderRootType.COMPILED));
  libFiles.removeAll(resolved);
  if (!libFiles.isEmpty()) {
    Map<String,File> nameToArtifactMap=null;
    for (    File file : libFiles) {
      if (file.exists()) {
        continue;
      }
      if (nameToArtifactMap == null) {
        nameToArtifactMap=new THashMap<String,File>(FileUtil.PATH_HASHING_STRATEGY);
        for (        File f : resolved) {
          final File prev=nameToArtifactMap.put(f.getName(),f);
          if (prev != null) {
            throw new Exception("Ambiguous artifacts with the same name: " + prev.getPath() + " and "+ f.getPath());
          }
        }
      }
      final File resolvedArtifact=nameToArtifactMap.get(file.getName());
      if (resolvedArtifact != null) {
        FileUtil.copy(resolvedArtifact,file);
      }
    }
  }
}
