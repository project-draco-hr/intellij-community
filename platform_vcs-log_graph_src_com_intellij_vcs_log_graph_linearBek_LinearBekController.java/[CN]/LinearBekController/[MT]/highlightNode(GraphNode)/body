{
  SortedSet<Integer> toCollapse=collectNodesToCollapse(node);
  if (toCollapse.isEmpty())   return null;
  Set<Integer> toHighlight=ContainerUtil.newHashSet();
  LinearBekGraphBuilder builder=new LinearBekGraphBuilder(new LinearBekGraph(myCompiledGraph),myBekGraphLayout);
  for (  Integer i : toCollapse) {
    LinearBekGraphBuilder.MergeFragment fragment=builder.collapseFragment(i);
    if (fragment != null) {
      toHighlight.addAll(fragment.getAllNodes());
    }
  }
  return LinearGraphUtils.createSelectedAnswer(myCompiledGraph,toHighlight);
}
