{
  if (action.getAffectedElement() != null) {
    if (action.getType() == GraphAction.Type.MOUSE_CLICK) {
      GraphElement graphElement=action.getAffectedElement().getGraphElement();
      if (graphElement instanceof GraphEdge) {
        GraphEdge edge=(GraphEdge)graphElement;
        if (edge.getType() == GraphEdgeType.DOTTED) {
          return new LinearGraphAnswer(replacedEdges(Collections.singleton(edge),myCompiledGraph.expandEdge(edge),getDelegateLinearGraphController().getCompiledGraph()),null,null,null);
        }
      }
 else       if (graphElement instanceof GraphNode) {
        if (new LinearBekGraphBuilder(myCompiledGraph,myBekGraphLayout).collapseFragment(((GraphNode)graphElement).getNodeIndex())) {
          return new LinearGraphAnswer(GraphChanges.SOME_CHANGES,null,null,null);
        }
      }
    }
 else     if (action.getType() == GraphAction.Type.MOUSE_OVER) {
      GraphElement graphElement=action.getAffectedElement().getGraphElement();
      if (graphElement instanceof GraphEdge) {
        GraphEdge edge=(GraphEdge)graphElement;
        if (edge.getType() == GraphEdgeType.DOTTED) {
          return LinearGraphUtils.createSelectedAnswer(myCompiledGraph,ContainerUtil.set(edge.getUpNodeIndex(),edge.getDownNodeIndex()));
        }
      }
 else       if (graphElement instanceof GraphNode) {
        LinearBekGraphBuilder.MergeFragment fragment=new LinearBekGraphBuilder(myCompiledGraph,myBekGraphLayout).getFragment(((GraphNode)graphElement).getNodeIndex());
        if (fragment != null) {
          return LinearGraphUtils.createSelectedAnswer(myCompiledGraph,fragment.getAllNodes());
        }
      }
    }
  }
  return null;
}
