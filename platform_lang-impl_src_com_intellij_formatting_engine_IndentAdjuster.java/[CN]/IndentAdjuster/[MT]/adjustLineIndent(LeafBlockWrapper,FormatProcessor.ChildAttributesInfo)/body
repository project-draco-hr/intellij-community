{
  AbstractBlockWrapper parent=info.parent;
  ChildAttributes childAttributes=info.attributes;
  int index=info.index;
  int alignOffset=getAlignOffsetBefore(childAttributes.getAlignment(),null);
  if (alignOffset == -1) {
    return parent.calculateChildOffset(myBlockIndentOptions.getIndentOptions(parent),childAttributes,index).createIndentInfo();
  }
 else {
    AbstractBlockWrapper indentedParentBlock=CoreFormatterUtil.getIndentedParentBlock(currentBlock);
    if (indentedParentBlock == null) {
      return new IndentInfo(0,0,alignOffset);
    }
 else {
      int indentOffset=indentedParentBlock.getWhiteSpace().getIndentOffset();
      if (indentOffset > alignOffset) {
        return new IndentInfo(0,0,alignOffset);
      }
 else {
        return new IndentInfo(0,indentOffset,alignOffset - indentOffset);
      }
    }
  }
}
