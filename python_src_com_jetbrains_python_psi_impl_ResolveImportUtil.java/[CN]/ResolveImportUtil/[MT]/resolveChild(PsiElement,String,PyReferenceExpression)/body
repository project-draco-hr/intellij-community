{
  PsiDirectory dir=null;
  PsiElement ret=null;
  if (parent instanceof PyFile) {
    PyFile pfparent=(PyFile)parent;
    if (INIT_PY.equals(pfparent.getName())) {
      dir=pfparent.getContainingDirectory();
    }
    ret=PyResolveUtil.treeWalkUp(new PyResolveUtil.ResolveProcessor(referencedName),parent,null,importRef);
  }
 else   if (parent instanceof PsiDirectory) {
    dir=(PsiDirectory)parent;
  }
  if (dir != null) {
    final PsiFile file=dir.findFile(referencedName + PY_SUFFIX);
    if (file != null)     return file;
    final PsiDirectory subdir=dir.findSubdirectory(referencedName);
    if (subdir != null)     return subdir;
 else {
      final PsiFile initPy=dir.findFile(INIT_PY);
      if (initPy != null) {
        return PyResolveUtil.treeWalkUp(new PyResolveUtil.ResolveProcessor(referencedName),initPy,null,importRef);
      }
    }
  }
  return ret;
}
