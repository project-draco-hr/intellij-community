{
  final BitSetFlags visited=new BitSetFlags(graph.nodesCount(),false);
  for (  int head : layout.getHeadNodeIndex()) {
    IntStack stack=new IntStack();
    visited.set(head,true);
    stack.push(head);
    visitor.enterSubtree(head);
    while (!stack.empty()) {
      int nextNode=nextNode(graph,stack.peek(),visited);
      if (nextNode != NODE_NOT_FOUND) {
        visited.set(nextNode,true);
        stack.push(nextNode);
        visitor.enterSubtree(nextNode);
      }
 else {
        visitor.leaveSubtree(stack.pop());
      }
    }
    stack.clear();
  }
}
