{
  final BitSetFlags visited=new BitSetFlags(graph.nodesCount(),false);
  IntStack stack=new IntStack();
  visited.set(start,true);
  stack.push(start);
  visitor.enterSubtree(start,start,visited);
  while (!stack.empty()) {
    int nextNode=simpleNextNode(graph,stack.peek(),visited);
    if (nextNode != NODE_NOT_FOUND && stack.size() < depth) {
      visited.set(nextNode,true);
      stack.push(nextNode);
      visitor.enterSubtree(nextNode,start,visited);
    }
 else {
      visitor.leaveSubtree(stack.pop(),start,visited);
    }
  }
  visitor.leaveSubtree(start,start,visited);
}
