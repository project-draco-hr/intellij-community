{
  final LanguageLevel languageLevel=PythonSdkType.getLanguageLevelForSdk(sdk);
  final VirtualFile[] files=sdk.getRootProvider().getFiles(OrderRootType.CLASSES);
  final Application application=ApplicationManager.getApplication();
  PyUtil.invalidateLanguageLevelCache(project);
  application.executeOnPooledThread(new Runnable(){
    @Override public void run(){
      application.runReadAction(new Runnable(){
        @Override public void run(){
          if (project.isDisposed()) {
            return;
          }
          for (          VirtualFile file : files) {
            if (file.isValid()) {
              VirtualFile parent=file.getParent();
              boolean suppressSizeLimit=false;
              if (parent != null && parent.getName().equals(PythonSdkType.SKELETON_DIR_NAME)) {
                suppressSizeLimit=true;
              }
              markRecursively(project,file,languageLevel,suppressSizeLimit);
            }
          }
        }
      }
);
    }
  }
);
}
