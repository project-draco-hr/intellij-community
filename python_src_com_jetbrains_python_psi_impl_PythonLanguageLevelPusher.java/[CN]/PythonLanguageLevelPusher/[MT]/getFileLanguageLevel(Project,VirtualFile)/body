{
  if (ApplicationManager.getApplication().isUnitTestMode() && LanguageLevel.FORCE_LANGUAGE_LEVEL != null) {
    return LanguageLevel.FORCE_LANGUAGE_LEVEL;
  }
  if (file == null)   return null;
  final Sdk sdk=getFileSdk(project,file);
  if (sdk != null) {
    return PythonSdkType.getLanguageLevelForSdk(sdk);
  }
  return PyUtil.guessLanguageLevelWithCaching(project);
}
