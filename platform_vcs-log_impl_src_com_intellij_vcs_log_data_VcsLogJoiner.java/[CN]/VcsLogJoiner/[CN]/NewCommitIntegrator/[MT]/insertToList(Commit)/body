{
  if (!newCommitsMap.containsKey(commit.getHash())) {
    throw new IllegalStateException("Commit was inserted, but insert call again. Commit hash: " + commit.getHash());
  }
  for (  Hash parentHash : commit.getParents()) {
    Commit parentCommit=newCommitsMap.get(parentHash);
    if (parentCommit != null) {
      insertToList(parentCommit);
    }
  }
  int insertIndex;
  HashSet<Hash> parents=new HashSet<Hash>(commit.getParents());
  for (insertIndex=0; insertIndex < list.size(); insertIndex++) {
    Commit currentCommit=list.get(insertIndex);
    if (parents.contains(currentCommit.getHash()))     break;
    if (currentCommit.getTime() < commit.getTime())     break;
  }
  list.add(insertIndex,commit);
  newCommitsMap.remove(commit.getHash());
}
