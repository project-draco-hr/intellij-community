{
  if (language == null) {
    return;
  }
  boolean injectionStarted=false;
  for (  Trinity<PsiLanguageInjectionHost,InjectedLanguage,TextRange> t : list) {
    PsiLanguageInjectionHost host=t.first;
    if (host.getContainingFile() != containingFile)     continue;
    TextRange textRange=t.third;
    InjectedLanguage injectedLanguage=t.second;
    if (!injectionStarted) {
      registrar.startInjecting(language);
      if (registrar instanceof MultiHostRegistrarImpl && !StringUtil.equalsIgnoreCase(language.getID(),t.second.getID())) {
        ((MultiHostRegistrarImpl)registrar).setFileExtension(StringUtil.toLowerCase(t.second.getID()));
      }
      injectionStarted=true;
    }
    registrar.addPlace(injectedLanguage.getPrefix(),injectedLanguage.getSuffix(),host,textRange);
  }
  if (injectionStarted) {
    registrar.doneInjecting();
  }
}
