{
  return new Producer<PsiElement>(){
    PsiElement e=element;
    @Nullable @Override public PsiElement produce(){
      if (e == null || e == scope)       return null;
      PsiElement prev=e.getPrevSibling();
      if (prev != null) {
        e=prev;
        while (true) {
          PsiElement lastChild=e.getLastChild();
          if (lastChild == null)           break;
          e=lastChild;
        }
        return e;
      }
 else {
        PsiElement parent=e.getParent();
        e=parent == scope || parent instanceof PsiFile ? null : parent;
        return e;
      }
    }
  }
;
}
