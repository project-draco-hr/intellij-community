{
  File jar=IoTestUtil.createTestJar();
  final VirtualFile vFile=LocalFileSystem.getInstance().refreshAndFindFileByIoFile(jar);
  assertNotNull(vFile);
  new WriteCommandAction.Simple(myProject){
    @Override protected void run() throws Throwable {
      PsiTestUtil.addContentRoot(myModule,vFile.getParent());
    }
  }
.execute();
  VirtualFile jarRoot=findByPath(jar.getPath() + JarFileSystem.JAR_SEPARATOR);
  final PsiFile file=getPsiManager().findFile(vFile);
  final String newName=vFile.getName() + ".jar";
  rename(file,newName);
  assertFalse(jarRoot.isValid());
  checkMove(jar,vFile,file);
}
