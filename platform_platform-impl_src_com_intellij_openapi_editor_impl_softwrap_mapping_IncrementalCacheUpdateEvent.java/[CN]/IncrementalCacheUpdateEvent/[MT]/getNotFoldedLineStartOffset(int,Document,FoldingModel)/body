{
  while (true) {
    offset=getLineStartOffset(offset,document);
    FoldRegion foldRegion=foldingModel.getCollapsedRegionAtOffset(offset);
    if (foldRegion == null || foldRegion.getStartOffset() >= offset) {
      break;
    }
    offset=foldRegion.getStartOffset();
  }
  return offset;
}
