{
  while (true) {
    offset=getLineEndOffset(offset,document);
    FoldRegion foldRegion=foldingModel.getCollapsedRegionAtOffset(offset);
    if (foldRegion == null || foldRegion.getEndOffset() <= offset) {
      break;
    }
    offset=foldRegion.getEndOffset();
  }
  return offset;
}
