{
  List<GrStatement> currentGroup=null;
  boolean spock=true;
  for (  ASTNode child : children) {
    PsiElement psi=child.getPsi();
    if (psi instanceof GrLabeledStatement) {
      alignGroup(currentGroup,spock,classLevel);
      currentGroup=ContainerUtil.newArrayList();
      spock=true;
    }
 else     if (currentGroup != null && spock && isTablePart(psi)) {
      currentGroup.add((GrStatement)psi);
    }
 else     if (psi instanceof GrVariableDeclaration) {
      GrVariable[] variables=((GrVariableDeclaration)psi).getVariables();
      if (variables.length > 0) {
        if (!classLevel || currentGroup == null || fieldGroupEnded(psi) || spock) {
          alignGroup(currentGroup,spock,classLevel);
          currentGroup=ContainerUtil.newArrayList();
          spock=false;
        }
        currentGroup.add((GrStatement)psi);
      }
    }
 else {
      if (shouldSkip(classLevel,psi))       continue;
      alignGroup(currentGroup,spock,classLevel);
      currentGroup=null;
    }
  }
  if (currentGroup != null) {
    alignGroup(currentGroup,spock,classLevel);
  }
}
