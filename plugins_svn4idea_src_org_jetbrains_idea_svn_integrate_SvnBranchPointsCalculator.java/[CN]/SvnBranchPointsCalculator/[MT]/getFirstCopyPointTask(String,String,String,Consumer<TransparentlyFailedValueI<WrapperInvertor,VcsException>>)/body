{
  TransparentlyFailedValueI<WrapperInvertor,VcsException> value=new ThreadSafeTransparentlyFailedValue<>();
  TaskDescriptor pooled=new TaskDescriptor("Looking for branch origin",Where.POOLED){
    @Override public void run(    ContinuationContext context){
      try {
        WrapperInvertor calculatedValue=calculateCopyPoint(repoUrl,sourceUrl,targetUrl);
        if (calculatedValue != null) {
          persist(repoUrl,calculatedValue.getWrapped());
        }
        value.set(calculatedValue);
      }
 catch (      Exception e) {
        setException(value,e);
      }
      context.next(new TaskDescriptor("final part",Where.AWT){
        @Override public void run(        ContinuationContext context){
          consumer.consume(value);
        }
      }
);
    }
  }
;
  return new TaskDescriptor("short part",Where.AWT){
    @Override public void run(    ContinuationContext context){
      try {
        value.set(getBestHit(repoUrl,sourceUrl,targetUrl));
      }
 catch (      Exception e) {
        setException(value,e);
      }
      if (value.haveSomething()) {
        consumer.consume(value);
        return;
      }
      context.next(pooled);
    }
  }
;
}
