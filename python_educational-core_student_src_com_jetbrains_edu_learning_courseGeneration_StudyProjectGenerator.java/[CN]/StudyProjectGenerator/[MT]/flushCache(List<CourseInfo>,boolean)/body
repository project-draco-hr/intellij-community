{
  File cacheFile=new File(OUR_COURSES_DIR,CACHE_NAME);
  PrintWriter writer=null;
  try {
    if (!createCacheFile(cacheFile))     return;
    Gson gson=new GsonBuilder().setFieldNamingPolicy(FieldNamingPolicy.LOWER_CASE_WITH_UNDERSCORES).create();
    final Set<CourseInfo> courseInfos=new HashSet<>();
    courseInfos.addAll(courses);
    if (preserveOld) {
      courseInfos.addAll(getCoursesFromCache());
    }
    writer=new PrintWriter(cacheFile,"UTF-8");
    try {
      for (      CourseInfo courseInfo : courseInfos) {
        final String json=gson.toJson(courseInfo);
        writer.println(json);
      }
    }
  finally {
      StudyUtils.closeSilently(writer);
    }
  }
 catch (  IOException e) {
    LOG.error(e);
  }
 finally {
    StudyUtils.closeSilently(writer);
  }
}
