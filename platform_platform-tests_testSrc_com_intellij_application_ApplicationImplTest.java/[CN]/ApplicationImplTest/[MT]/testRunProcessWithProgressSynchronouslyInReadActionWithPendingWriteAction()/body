{
  SwingUtilities.invokeLater(new Runnable(){
    @Override public void run(){
      ApplicationManager.getApplication().runWriteAction(EmptyRunnable.getInstance());
    }
  }
);
  boolean result=((ApplicationEx)ApplicationManager.getApplication()).runProcessWithProgressSynchronouslyInReadAction(getProject(),"title",true,"cancel",null,new Runnable(){
    @Override public void run(){
      TimeoutUtil.sleep(10000);
    }
  }
);
  assertTrue(result);
  UIUtil.dispatchAllInvocationEvents();
  if (exception != null)   throw exception;
}
