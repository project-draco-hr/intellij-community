{
  Future<?> future=((ProgressManagerImpl)ProgressManager.getInstance()).runProcessWithProgressAsynchronously(new Task.Backgroundable(getProject(),"xx"){
    @Override public void run(    @NotNull ProgressIndicator indicator){
      try {
        assertFalse(ApplicationManager.getApplication().isReadAccessAllowed());
        assertFalse(ApplicationManager.getApplication().isDispatchThread());
      }
 catch (      Exception e) {
        exception=e;
      }
    }
  }
);
  future.get();
  if (exception != null)   throw exception;
}
