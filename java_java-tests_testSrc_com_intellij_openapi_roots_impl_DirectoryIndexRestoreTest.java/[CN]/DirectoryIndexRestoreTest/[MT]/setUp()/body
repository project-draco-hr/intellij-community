{
  super.setUp();
  LocalFileSystem fs=LocalFileSystem.getInstance();
  File temp=createTempDirectory();
  myTempVFile=fs.findFileByIoFile(temp);
  assertNotNull(myTempVFile);
  File root=new File(temp,"top/d1/d2/root");
  assertTrue(root.mkdirs());
  VirtualFile rootVFile=fs.findFileByIoFile(root);
  assertNotNull(rootVFile);
  VirtualFile moduleDir=createChildDirectory(rootVFile,"module");
  VirtualFile srcDir=createChildDirectory(moduleDir,"src");
  VirtualFile testDir=createChildDirectory(srcDir,"pkg");
  ModuleRootModificationUtil.setModuleSdk(myModule,null);
  PsiTestUtil.addContentRoot(myModule,moduleDir);
  PsiTestUtil.addSourceRoot(myModule,srcDir);
  myTestDirPath=testDir.getPath();
  myFileIndex=ProjectRootManager.getInstance(myProject).getFileIndex();
  VirtualFileManager.getInstance().syncRefresh();
}
