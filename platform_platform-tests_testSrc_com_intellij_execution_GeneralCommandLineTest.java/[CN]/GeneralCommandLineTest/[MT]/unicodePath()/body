{
  String mark=String.valueOf(new Random().nextInt());
  String prefix="spaces 'and quotes' and " + UNICODE_RU + "_"+ UNICODE_EU+ " ";
  File script;
  if (SystemInfo.isWindows) {
    script=ExecUtil.createTempExecutableScript(prefix,".cmd","@echo " + mark + "\n");
  }
 else {
    script=ExecUtil.createTempExecutableScript(prefix,".sh","#!/bin/sh\n" + "echo " + mark + "\n");
  }
  try {
    String output=execAndGetOutput(new GeneralCommandLine(script.getPath()));
    assertEquals(mark + "\n",StringUtil.convertLineSeparators(output));
  }
  finally {
    FileUtil.delete(script);
  }
}
