{
  List vmParameters=new ArrayList(myVMParameters);
  myForkedDebuggerHelper.setupDebugger(vmParameters);
  final File tempFile=File.createTempFile("fork","test");
  tempFile.deleteOnExit();
  final String testOutputPath=tempFile.getAbsolutePath();
  final ProcessBuilder builder=new ProcessBuilder();
  builder.add(vmParameters);
  builder.add("-classpath");
  if (myDynamicClasspath.length() > 0) {
    try {
      builder.add(createClasspathJarFile(new Manifest(),classpath).getAbsolutePath());
    }
 catch (    Throwable e) {
      builder.add(classpath);
    }
  }
 else {
    builder.add(classpath);
  }
  builder.add(getStarterName());
  builder.add(testOutputPath);
  builder.add(args);
  builder.setWorkingDir(workingDir);
  final Process exec=builder.createProcess();
  final int result=exec.waitFor();
  ForkedVMWrapper.readWrapped(testOutputPath,myOut,myErr);
  return result;
}
