{
  final Ref<List<Pair<File,DownloadableFileDescription>>> localFiles=Ref.create(null);
  final Ref<IOException> exceptionRef=Ref.create(null);
  boolean completed=ProgressManager.getInstance().runProcessWithProgressSynchronously(new Runnable(){
    @Override public void run(){
      try {
        localFiles.set(download(targetDir));
      }
 catch (      IOException e) {
        exceptionRef.set(e);
      }
    }
  }
,myDialogTitle,true,project,parentComponent);
  if (!completed) {
    return null;
  }
  @SuppressWarnings("ThrowableResultOfMethodCallIgnored") Exception exception=exceptionRef.get();
  if (exception != null) {
    final boolean tryAgain=IOExceptionDialog.showErrorDialog(myDialogTitle,exception.getMessage());
    if (tryAgain) {
      return downloadWithProcess(targetDir,project,parentComponent);
    }
    return null;
  }
  return findVirtualFiles(localFiles.get());
}
