{
  PsiElement psiSource=referenceExpression.resolve();
  if (!(psiSource instanceof PsiVariable)) {
    return null;
  }
  final PsiVariable variable=(PsiVariable)psiSource;
  if (variable.hasModifierProperty(PsiModifier.FINAL) && !variable.hasModifierProperty(PsiModifier.TRANSIENT)) {
    DfaValue constValue=getConstFactory().create(variable);
    if (constValue != null)     return constValue;
  }
  if (!variable.hasModifierProperty(PsiModifier.VOLATILE) && isEffectivelyUnqualified(referenceExpression)) {
    return getVarFactory().createVariableValue(variable,referenceExpression.getType(),false,null);
  }
  return null;
}
