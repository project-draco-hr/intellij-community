{
  if (getModel().getSize() < index) {
    return null;
  }
  if (mySectionRuleManager != null) {
    final ArrangementSectionRuleData data=extractSectionText(index);
    if (data != null) {
      return validateSectionRule(data,index);
    }
  }
  final Object target=getModel().getElementAt(index);
  if (target instanceof StdArrangementMatchRule) {
    final Set<String> rules=ContainerUtil.newHashSet();
    for (int i=0; i < index; i++) {
      final Object element=getModel().getElementAt(i);
      if (element instanceof StdArrangementMatchRule) {
        final StdArrangementMatchRule rule=(StdArrangementMatchRule)element;
        rules.add(rule.toString());
      }
    }
    if (rules.contains(target.toString())) {
      return ApplicationBundle.message("arrangement.settings.validation.duplicate.matching.rule");
    }
  }
  return null;
}
