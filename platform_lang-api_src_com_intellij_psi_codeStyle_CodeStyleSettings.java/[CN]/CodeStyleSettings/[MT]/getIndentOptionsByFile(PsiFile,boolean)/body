{
  if (file != null && file.isValid()) {
    if (!ignoreDocOptions) {
      IndentOptions docOptions=IndentOptions.retrieveFromAssociatedDocument(file);
      if (docOptions != null)       return docOptions;
    }
    FileIndentOptionsProvider[] providers=Extensions.getExtensions(FileIndentOptionsProvider.EP_NAME);
    for (    FileIndentOptionsProvider provider : providers) {
      IndentOptions indentOptions=provider.getIndentOptions(file);
      if (indentOptions != null)       return indentOptions;
    }
    return getIndentOptions(file.getFileType());
  }
 else   return OTHER_INDENT_OPTIONS;
}
