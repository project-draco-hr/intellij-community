{
  if (element instanceof PsiComment) {
    PsiElement prev=getFirstElement(element);
    PsiElement next=getLastElement(element);
    final int startOffset=prev != null ? prev.getTextRange().getStartOffset() : element.getTextRange().getStartOffset();
    final int endOffset=next != null ? next.getTextRange().getEndOffset() : element.getTextRange().getEndOffset();
    return TextRange.create(startOffset,endOffset);
  }
 else {
    int startOffset=getStartOffset(element,editor);
    int endOffset=getEndOffset(element,editor);
    return TextRange.create(startOffset,endOffset);
  }
}
