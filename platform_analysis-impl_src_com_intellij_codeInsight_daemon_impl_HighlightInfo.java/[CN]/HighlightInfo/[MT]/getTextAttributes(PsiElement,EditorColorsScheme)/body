{
  if (forcedTextAttributes != null) {
    return forcedTextAttributes;
  }
  EditorColorsScheme colorsScheme=getColorsScheme(editorColorsScheme);
  if (forcedTextAttributesKey != null) {
    return colorsScheme.getAttributes(forcedTextAttributesKey);
  }
  TextAttributes attributes=getAttributesByType(element,type,colorsScheme);
  if (element != null && RainbowHighlighter.isRainbowEnabled() && !RainbowHighlighter.isByPassLanguage(element.getLanguage()) && isLikeVariable(type.getAttributesKey())) {
    String text=element.getContainingFile().getText();
    String name=text.substring(startOffset,endOffset);
    attributes=new RainbowHighlighter(colorsScheme,null).getAttributes(name,attributes);
  }
  return attributes;
}
