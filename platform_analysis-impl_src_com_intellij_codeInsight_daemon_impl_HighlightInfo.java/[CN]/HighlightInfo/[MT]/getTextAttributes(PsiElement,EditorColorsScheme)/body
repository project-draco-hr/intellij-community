{
  if (forcedTextAttributes != null) {
    return forcedTextAttributes;
  }
  EditorColorsScheme colorsScheme=getColorsScheme(editorColorsScheme);
  if (forcedTextAttributesKey != null) {
    return colorsScheme.getAttributes(forcedTextAttributesKey);
  }
  TextAttributes attributes=getAttributesByType(element,type,colorsScheme);
  if (RainbowHighlighter.isRainbowEnabled() && isLikeVariable(type.getAttributesKey()) && element != null) {
    String text=element.getContainingFile().getText();
    String name=text.substring(startOffset,endOffset);
    TextAttributes rainAttributes=new RainbowHighlighter(colorsScheme).getAttributes(name);
    attributes=TextAttributes.merge(attributes,rainAttributes);
  }
  return attributes;
}
