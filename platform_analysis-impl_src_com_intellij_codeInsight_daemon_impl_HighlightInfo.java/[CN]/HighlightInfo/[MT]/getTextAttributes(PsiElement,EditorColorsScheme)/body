{
  if (forcedTextAttributes != null) {
    return forcedTextAttributes;
  }
  EditorColorsScheme colorsScheme=getColorsScheme(editorColorsScheme);
  if (forcedTextAttributesKey != null) {
    return colorsScheme.getAttributes(forcedTextAttributesKey);
  }
  TextAttributes attributes=getAttributesByType(element,type,colorsScheme);
  if (element != null && RainbowHighlighter.isRainbowEnabled() && isLikeVariable(type.getAttributesKey())) {
    PsiFile containingFile=element.getContainingFile();
    if (!RainbowVisitor.existsPassSuitableForFile(containingFile)) {
      CharSequence text=containingFile.getViewProvider().getContents().subSequence(startOffset,endOffset);
      attributes=new RainbowHighlighter(colorsScheme).getAttributes(text.toString(),attributes);
    }
  }
  return attributes;
}
