{
  if (mySelectedWindow != null) {
    RangeHighlighter selectedRangeHighlighter=mySelectedWindow.getRangeHighlighter();
    if (selectedRangeHighlighter != null) {
      int lineChange=selectedEditor.getDocument().getLineCount() - getLineNum();
      if (lineChange != 0) {
        int newStartLine=getLineNumByOffset(selectedEditor,selectedRangeHighlighter.getStartOffset());
        int newEndLine=getLineNumByOffset(selectedEditor,selectedRangeHighlighter.getEndOffset());
        increment(newStartLine,lineChange);
        mySelectedWindow.setLine(mySelectedWindow.getLine() - lineChange);
        setNewOffsetInLine(newEndLine,mySelectedWindow.getStart() + mySelectedWindow.getOffsetInLine(),selectedRangeHighlighter.getEndOffset() - selectedEditor.getDocument().getLineStartOffset(newEndLine));
      }
 else {
        int oldEnd=mySelectedWindow.getRealStartOffset(selectedEditor) + mySelectedWindow.getOffsetInLine();
        int endChange=selectedRangeHighlighter.getEndOffset() - oldEnd;
        incrementAfterOffset(mySelectedWindow.getLine(),mySelectedWindow.getStart(),endChange);
      }
      int newLength=selectedRangeHighlighter.getEndOffset() - selectedRangeHighlighter.getStartOffset();
      mySelectedWindow.setOffsetInLine(newLength);
    }
  }
}
