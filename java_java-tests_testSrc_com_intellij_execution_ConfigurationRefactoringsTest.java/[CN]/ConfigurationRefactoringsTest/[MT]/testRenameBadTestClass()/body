{
  PsiClass psiClass=mySource.createClass("NotATest",NOT_A_TEST);
  assertNotNull(psiClass);
  JUnitConfigurationType instance=JUnitConfigurationType.getInstance();
  assertNotNull(instance);
  JUnitConfiguration configuration=new JUnitConfiguration("notATest",myProject,instance.getConfigurationFactories()[0]);
  configuration.setMainClass(psiClass);
  configuration.setModule(configuration.getValidModules().iterator().next());
  checkConfigurationException("NotATest isn't test class",configuration);
  RunManagerEx.getInstanceEx(myProject).setTemporaryConfiguration(new RunnerAndConfigurationSettingsImpl(null,configuration,false));
  rename(psiClass,"NotATest2");
  JUnitConfiguration.Data data=configuration.getPersistentData();
  assertEquals("NotATest2",data.getMainClassName());
  data.METHOD_NAME="test";
  data.TEST_OBJECT=JUnitConfiguration.TEST_METHOD;
  checkConfigurationException("Test method 'test' doesn't exist",configuration);
  rename(psiClass.findMethodsByName("test",false)[0],"test2");
  assertEquals("NotATest2",data.getMainClassName());
  assertEquals("test2",data.getMethodName());
}
