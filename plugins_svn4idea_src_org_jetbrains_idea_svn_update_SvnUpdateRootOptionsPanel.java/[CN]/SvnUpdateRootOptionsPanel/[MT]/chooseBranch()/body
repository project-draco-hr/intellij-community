{
  if (mySourceUrl == null) {
    myBranchField.setEnabled(false);
    return;
  }
  SelectBranchPopup.show(myVcs.getProject(),myRoot.getVirtualFile(),new SelectBranchPopup.BranchSelectedCallback(){
    public void branchSelected(    final Project project,    final SvnBranchConfigurationNew configuration,    final String url,    final long revision){
      SvnBranchConfigurationNew branchConfiguration=getBranchConfiguration();
      String branchRelativeUrl=branchConfiguration != null ? branchConfiguration.getRelativeUrl(mySourceUrl.toString()) : null;
      if (mySourceUrl == null || branchRelativeUrl == null) {
        myBranchField.setText("");
      }
 else {
        try {
          myURLText.setText(SVNURL.parseURIEncoded(url).appendPath(branchRelativeUrl,true).toDecodedString());
        }
 catch (        SVNException e) {
          LOG.error(e);
        }
        myBranchField.setText(SVNPathUtil.tail(url));
      }
    }
  }
,SvnBundle.message("select.branch.popup.general.title"),myPanel);
}
