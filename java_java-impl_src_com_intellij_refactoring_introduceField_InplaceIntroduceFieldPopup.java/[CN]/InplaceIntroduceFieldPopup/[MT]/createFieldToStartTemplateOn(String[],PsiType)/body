{
  final PsiElementFactory elementFactory=JavaPsiFacade.getElementFactory(myProject);
  return ApplicationManager.getApplication().runWriteAction(new Computable<PsiField>(){
    @Override public PsiField compute(){
      PsiField field=elementFactory.createField(chooseName(names,myParentClass.getLanguage()),defaultType);
      field=(PsiField)myParentClass.add(field);
      if (myExprText != null) {
        updateInitializer(elementFactory,field);
      }
      PsiUtil.setModifierProperty(field,PsiModifier.FINAL,myIntroduceFieldPanel.isDeclareFinal());
      final String visibility=myIntroduceFieldPanel.getFieldVisibility();
      if (visibility != null) {
        PsiUtil.setModifierProperty(field,visibility,true);
      }
      myFieldRangeStart=myEditor.getDocument().createRangeMarker(field.getTextRange());
      return field;
    }
  }
);
}
