{
  String fileTitle=EditorTabbedContainer.calcTabTitle(project,file);
  if (SystemInfo.isMac)   return fileTitle;
  VirtualFile parent=file.getParent();
  if (parent == null || !fileTitle.endsWith(file.getName()))   return fileTitle;
  String url=FileUtil.getLocationRelativeToUserHome(parent.getPresentableUrl() + "/" + PathUtil.getFileName(fileTitle));
  VirtualFile baseDir=ProjectBaseDirectory.getInstance(project).getBaseDir();
  if (baseDir == null)   baseDir=project.getBaseDir();
  if (baseDir != null) {
    final String projectHomeUrl=FileUtil.getLocationRelativeToUserHome(baseDir.getPresentableUrl());
    if (url.startsWith(projectHomeUrl)) {
      url="..." + url.substring(projectHomeUrl.length());
    }
  }
  return url;
}
