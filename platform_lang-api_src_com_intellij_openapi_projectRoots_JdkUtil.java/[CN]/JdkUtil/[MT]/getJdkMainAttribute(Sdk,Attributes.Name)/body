{
  VirtualFile homeDirectory=jdk.getHomeDirectory();
  if (homeDirectory == null)   return null;
  VirtualFile rtJar=homeDirectory.findFileByRelativePath("jre/lib/rt.jar");
  if (rtJar == null) {
    rtJar=homeDirectory.findFileByRelativePath("lib/rt.jar");
  }
  if (rtJar == null) {
    rtJar=homeDirectory.findFileByRelativePath("jre/lib/vm.jar");
  }
  if (rtJar == null) {
    rtJar=homeDirectory.findFileByRelativePath("../Classes/classes.jar");
  }
  if (rtJar == null) {
    String versionString=jdk.getVersionString();
    if (versionString != null) {
      final int start=versionString.indexOf("\"");
      final int end=versionString.lastIndexOf("\"");
      versionString=start >= 0 && (end > start) ? versionString.substring(start + 1,end) : null;
    }
    return versionString;
  }
  VirtualFile jarRoot=JarFileSystem.getInstance().getJarRootForLocalFile(rtJar);
  return jarRoot != null ? getJarMainAttribute(jarRoot,attribute) : null;
}
