{
  if (isDisposed() || changes.isEmpty()) {
    return;
  }
  if (changes.size() > 1) {
    ContainerUtil.sort(changes,new Comparator<TemplateDocumentChange>(){
      @Override public int compare(      TemplateDocumentChange o1,      TemplateDocumentChange o2){
        int startDiff=o2.startOffset - o1.startOffset;
        return startDiff != 0 ? startDiff : o2.endOffset - o1.endOffset;
      }
    }
);
  }
  DocumentUtil.executeInBulk(myDocument,true,new Runnable(){
    @Override public void run(){
      for (      TemplateDocumentChange change : changes) {
        replaceString(change.newValue,change.startOffset,change.endOffset,change.segmentNumber);
      }
    }
  }
);
}
