{
  myProject=project;
  myEditor=editor;
  myDocument=myEditor.getDocument();
  PsiFile file=getPsiFile();
  if (file != null) {
    myCompatibleContexts=TemplateManagerImpl.getApplicableContextTypes(file,editor.getCaretModel().getOffset()).toArray(new TemplateContextType[0]);
  }
 else {
    myCompatibleContexts=new TemplateContextType[0];
  }
}
