{
  if (value.getKind() == CodeFragmentKind.EXPRESSION) {
    JDOMExternalizerUtil.writeField(root,name,value.toExternalForm());
  }
 else {
    Element element=JDOMExternalizerUtil.writeOption(root,name);
    XExpression expression=TextWithImportsImpl.toXExpression(value);
    if (expression != null) {
      XmlSerializer.serializeInto(new XExpressionState(expression),element,new SkipDefaultValuesSerializationFilters());
    }
  }
}
