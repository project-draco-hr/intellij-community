{
  if (useSockets) {
    final int freePort;
    try {
      freePort=NetUtils.findAvailableSocketPort();
    }
 catch (    IOException e) {
      throw new ExecutionException(DebugProcessImpl.processError(e));
    }
    return Integer.toString(freePort);
  }
 else {
    TransportServiceWrapper transportService=TransportServiceWrapper.getTransportService(false);
    try {
      return tryShmemConnect(transportService,null);
    }
 catch (    IOException e) {
      int tryNum=0;
      while (true) {
        try {
          return tryShmemConnect(transportService,"javadebug_" + (int)(Math.random() * 1000));
        }
 catch (        Exception ex) {
          if (tryNum++ > 10) {
            throw new ExecutionException(DebugProcessImpl.processError(ex));
          }
        }
      }
    }
  }
}
