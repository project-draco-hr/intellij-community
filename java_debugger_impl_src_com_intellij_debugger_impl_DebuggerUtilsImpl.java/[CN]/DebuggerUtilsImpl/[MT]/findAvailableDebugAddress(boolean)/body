{
  final TransportServiceWrapper transportService=TransportServiceWrapper.getTransportService(useSockets);
  if (useSockets) {
    final int freePort;
    try {
      freePort=NetUtils.findAvailableSocketPort();
    }
 catch (    IOException e) {
      throw new ExecutionException(DebugProcessImpl.processError(e));
    }
    return Integer.toString(freePort);
  }
  try {
    TransportService.ListenKey listenKey=transportService.startListening();
    final String address=listenKey.address();
    transportService.stopListening(listenKey);
    return address;
  }
 catch (  IOException e) {
    throw new ExecutionException(DebugProcessImpl.processError(e));
  }
}
