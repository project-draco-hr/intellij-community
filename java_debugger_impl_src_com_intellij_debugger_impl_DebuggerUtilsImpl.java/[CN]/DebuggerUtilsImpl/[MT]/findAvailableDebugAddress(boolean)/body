{
  final TransportServiceWrapper transportService=TransportServiceWrapper.getTransportService(useSockets);
  if (useSockets) {
    final int freePort;
    try {
      freePort=NetUtils.findAvailableSocketPort();
    }
 catch (    IOException e) {
      throw new ExecutionException(DebugProcessImpl.processError(e));
    }
    return Integer.toString(freePort);
  }
  try {
    TransportService.ListenKey listenKey=transportService.startListening();
    final String address=listenKey.address();
    transportService.stopListening(listenKey);
    return address;
  }
 catch (  IOException e) {
    int tryNum=0;
    while (true) {
      try {
        TransportService.ListenKey listenKey=transportService.startListening("javadebug_" + (int)(Math.random() * 1000));
        final String address=listenKey.address();
        transportService.stopListening(listenKey);
        return address;
      }
 catch (      Exception ex) {
        if (tryNum++ > 10) {
          throw new ExecutionException(DebugProcessImpl.processError(ex));
        }
      }
    }
  }
}
