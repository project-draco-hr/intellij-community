{
  boolean correct=false;
  PsiFile file=myParams.first;
  PsiLanguageInjectionHost host=InjectedLanguageUtil.findInjectionHost(file);
  int flags=0;
  if (host != null) {
    for (    RegExpModifierProvider provider : RegExpModifierProvider.EP.getExtensions()) {
      flags=provider.getFlags(host,file);
      if (flags > 0)       break;
    }
  }
  try {
    correct=Pattern.compile(myRegExp.getText(),flags).matcher(mySampleText.getText()).matches();
  }
 catch (  Exception ignore) {
  }
  JBColor color1=new JBColor(new Color(231,250,219),new Color(68,85,66));
  JBColor color2=new JBColor(new Color(255,177,160),new Color(110,43,40));
  mySampleText.setBackground(correct ? color1 : color2);
  myMessage.setText(correct ? "Matches!" : "no match");
  BalloonImpl balloon=(BalloonImpl)myRef.get();
  if (balloon != null && balloon.isDisposed()) {
    balloon.revalidate();
  }
}
