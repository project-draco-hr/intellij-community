{
  final String regExp=regexpFile.getText();
  Integer patternFlags=ApplicationManager.getApplication().runReadAction(new Computable<Integer>(){
    @Override public Integer compute(){
      PsiLanguageInjectionHost host=InjectedLanguageUtil.findInjectionHost(regexpFile);
      int flags=0;
      if (host != null) {
        for (        RegExpModifierProvider provider : RegExpModifierProvider.EP.allForLanguage(host.getLanguage())) {
          flags=provider.getFlags(host,regexpFile);
          if (flags > 0)           break;
        }
      }
      return flags;
    }
  }
);
  try {
    return Pattern.compile(regExp,patternFlags).matcher(StringUtil.newBombedCharSequence(sampleText,1000)).matches();
  }
 catch (  ProcessCanceledException pc) {
    return null;
  }
catch (  Exception ignore) {
  }
  return false;
}
