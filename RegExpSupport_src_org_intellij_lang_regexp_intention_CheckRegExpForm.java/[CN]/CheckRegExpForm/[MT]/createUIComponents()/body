{
  myProject=myRegexpFile.getProject();
  Document document=PsiDocumentManager.getInstance(myProject).getDocument(myRegexpFile);
  myRegExp=new EditorTextField(document,myProject,RegExpLanguage.INSTANCE.getAssociatedFileType());
  myRegExp.setPreferredWidth(Math.max(300,myRegExp.getPreferredSize().width));
  final String sampleText=PropertiesComponent.getInstance(myProject).getValue(LAST_EDITED_REGEXP,"Sample Text");
  mySampleText=new EditorTextField(sampleText,myProject,PlainTextFileType.INSTANCE);
  mySampleText.setBorder(new CompoundBorder(new EmptyBorder(2,2,2,4),new LineBorder(UIUtil.isUnderDarcula() ? Gray._100 : JBColor.border())));
  mySampleText.setOneLineMode(false);
  myRootPanel=new JPanel(new BorderLayout()){
    Disposable disposable;
    @Override public void addNotify(){
      super.addNotify();
      disposable=Disposer.newDisposable();
      IdeFocusManager.getGlobalInstance().requestFocus(mySampleText);
      new AnAction(){
        @Override public void actionPerformed(        AnActionEvent e){
          IdeFocusManager.findInstance().requestFocus(myRegExp.getFocusTarget());
        }
      }
.registerCustomShortcutSet(CustomShortcutSet.fromString("shift TAB"),mySampleText);
      final Alarm updater=new Alarm(Alarm.ThreadToUse.SWING_THREAD,disposable);
      DocumentAdapter documentListener=new DocumentAdapter(){
        @Override public void documentChanged(        DocumentEvent e){
          updater.cancelAllRequests();
          if (!updater.isDisposed()) {
            updater.addRequest(new Runnable(){
              @Override public void run(){
                updateBalloon();
              }
            }
,200);
          }
        }
      }
;
      myRegExp.addDocumentListener(documentListener);
      mySampleText.addDocumentListener(documentListener);
      updateBalloon();
      mySampleText.selectAll();
    }
    @Override public void removeNotify(){
      super.removeNotify();
      Disposer.dispose(disposable);
      PropertiesComponent.getInstance(myProject).setValue(LAST_EDITED_REGEXP,mySampleText.getText());
    }
  }
;
}
