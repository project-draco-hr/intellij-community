{
  if (files == null) {
    return Collections.singletonList(GitBranchUtil.getCurrentRepository(project));
  }
  GitRepositoryManager manager=GitUtil.getRepositoryManager(project);
  Collection<GitRepository> repositories=ContainerUtil.newHashSet();
  for (  VirtualFile file : files) {
    GitRepository repo=manager.getRepositoryForFile(file);
    if (repo != null) {
      repositories.add(repo);
    }
  }
  return repositories;
}
