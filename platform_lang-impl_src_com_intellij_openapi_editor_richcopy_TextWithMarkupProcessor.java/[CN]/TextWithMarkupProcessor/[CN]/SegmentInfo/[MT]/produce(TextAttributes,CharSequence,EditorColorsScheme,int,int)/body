{
  if (end <= start) {
    return Collections.emptyList();
  }
  List<SegmentInfo> result=ContainerUtilRt.newArrayList();
  int currentStart=start;
  int fontSize=colorsScheme.getEditorFontSize();
  int fontStyle=attribute.getFontType();
  String defaultFontFamily=colorsScheme.getEditorFontName();
  Font font=ComplementaryFontsRegistry.getFontAbleToDisplay(text.charAt(start),fontSize,fontStyle,defaultFontFamily).getFont();
  String currentFontFamilyName=font.getFamily();
  int currentFontSize=font.getSize();
  String candidateFontFamilyName;
  int candidateFontSize;
  for (int i=start + 1; i < end; i++) {
    font=ComplementaryFontsRegistry.getFontAbleToDisplay(text.charAt(i),fontSize,fontStyle,defaultFontFamily).getFont();
    candidateFontFamilyName=font.getFamily();
    candidateFontSize=font.getSize();
    if (!candidateFontFamilyName.equals(currentFontFamilyName) || currentFontSize != candidateFontSize) {
      result.add(new SegmentInfo(attribute.getForegroundColor(),attribute.getBackgroundColor(),currentFontFamilyName,fontStyle,currentFontSize,currentStart,i));
      currentStart=i;
      currentFontFamilyName=candidateFontFamilyName;
      currentFontSize=candidateFontSize;
    }
  }
  if (currentStart < end) {
    result.add(new SegmentInfo(attribute.getForegroundColor(),attribute.getBackgroundColor(),currentFontFamilyName,fontStyle,currentFontSize,currentStart,end));
  }
  return result;
}
