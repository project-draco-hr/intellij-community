{
  if (myForeground == null && info.foreground != null) {
    addTextIfPossible(info.startOffset);
    myForeground=info.foreground;
    outputInfos.add(new Foreground(myColorRegistry.getId(info.foreground)));
  }
 else   if (myForeground != null) {
    Color c=info.foreground == null ? myDefaultForeground : info.foreground;
    if (!myForeground.equals(c)) {
      addTextIfPossible(info.startOffset);
      outputInfos.add(new Foreground(myColorRegistry.getId(c)));
      myForeground=c;
    }
  }
}
