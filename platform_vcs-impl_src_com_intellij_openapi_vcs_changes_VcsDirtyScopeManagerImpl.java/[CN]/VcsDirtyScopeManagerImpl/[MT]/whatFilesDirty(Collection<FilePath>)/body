{
  DirtBuilder dirtBuilder;
  DirtBuilder dirtBuilderInProgress;
synchronized (LOCK) {
    if (myDisposed)     return Collections.emptyList();
    dirtBuilder=new DirtBuilder(myDirtBuilder);
    dirtBuilderInProgress=myDirtInProgress != null ? new DirtBuilder(myDirtInProgress) : new DirtBuilder(myGuess);
  }
  VcsInvalidated invalidated=calculateInvalidated(dirtBuilder);
  VcsInvalidated inProgress=calculateInvalidated(dirtBuilderInProgress);
  Collection<FilePath> result=ContainerUtil.newArrayList();
  for (  FilePath fp : files) {
    if (invalidated.isFileDirty(fp) || inProgress.isFileDirty(fp)) {
      result.add(fp);
    }
  }
  return result;
}
