{
  if (myState.embedderJdk.equals(MavenRunnerSettings.USE_JAVA_HOME)) {
    final String javaHome=System.getenv("JAVA_HOME");
    if (!StringUtil.isEmptyOrSpaces(javaHome)) {
      Sdk jdk=JavaSdk.getInstance().createJdk("",javaHome);
      if (jdk != null) {
        return jdk;
      }
    }
  }
  for (  Sdk projectJdk : ProjectJdkTable.getInstance().getAllJdks()) {
    if (projectJdk.getName().equals(myState.embedderJdk)) {
      return projectJdk;
    }
  }
  return JavaAwareProjectJdkTableImpl.getInstanceEx().getInternalJdk();
}
