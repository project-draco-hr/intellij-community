{
  if (toImport.isEmpty()) {
    return;
  }
  List<ModifiableRootModel> models=ContainerUtilRt.newArrayList();
  try {
    MultiMap<DataNode<ModuleData>,DataNode<ContentRootData>> byModule=ExternalSystemApiUtil.groupBy(toImport,ProjectKeys.MODULE);
    for (    Map.Entry<DataNode<ModuleData>,Collection<DataNode<ContentRootData>>> entry : byModule.entrySet()) {
      Module module=platformFacade.findIdeModule(entry.getKey().getData(),project);
      if (module == null) {
        LOG.warn(String.format("Can't import content roots. Reason: target module (%s) is not found at the ide. Content roots: %s",entry.getKey(),entry.getValue()));
        continue;
      }
      models.add(importData(entry.getValue(),module,platformFacade));
    }
    ExternalSystemApiUtil.commitModels(synchronous,project,models);
  }
 catch (  Throwable t) {
    ExternalSystemApiUtil.disposeModels(models);
    ExceptionUtil.rethrowAllAsUnchecked(t);
  }
}
