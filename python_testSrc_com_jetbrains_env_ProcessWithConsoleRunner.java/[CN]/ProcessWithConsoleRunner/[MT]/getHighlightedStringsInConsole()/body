{
  final List<String> resultStrings=new ArrayList<String>();
  final List<Pair<Integer,Integer>> resultRanges=new ArrayList<Pair<Integer,Integer>>();
  ApplicationManager.getApplication().invokeAndWait(new Runnable(){
    @Override public void run(){
      myConsole.flushDeferredText();
      final Editor editor=myConsole.getEditor();
      for (      final RangeHighlighter highlighter : editor.getMarkupModel().getAllHighlighters()) {
        if (highlighter instanceof RangeHighlighterEx) {
          final int start=((RangeHighlighterEx)highlighter).getAffectedAreaStartOffset();
          final int end=((RangeHighlighterEx)highlighter).getAffectedAreaEndOffset();
          resultRanges.add(Pair.create(start,end));
          resultStrings.add(editor.getDocument().getText().substring(start,end));
        }
      }
    }
  }
,ModalityState.NON_MODAL);
  return Pair.create(resultRanges,resultStrings);
}
