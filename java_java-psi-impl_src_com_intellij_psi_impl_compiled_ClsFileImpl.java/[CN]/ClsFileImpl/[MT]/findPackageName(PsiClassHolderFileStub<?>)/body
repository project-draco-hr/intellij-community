{
  String packageName=null;
  if (stub instanceof PsiJavaFileStub) {
    packageName=((PsiJavaFileStub)stub).getPackageName();
  }
 else {
    PsiClass[] psiClasses=stub.getClasses();
    if (psiClasses.length > 0) {
      String className=psiClasses[0].getQualifiedName();
      if (className != null) {
        int index=className.lastIndexOf('.');
        if (index >= 0) {
          packageName=className.substring(0,index);
        }
      }
    }
  }
  return !StringUtil.isEmpty(packageName) ? packageName : null;
}
