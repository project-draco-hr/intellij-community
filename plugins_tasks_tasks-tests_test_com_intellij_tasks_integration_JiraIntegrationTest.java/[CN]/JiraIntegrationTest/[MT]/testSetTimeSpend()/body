{
  myRepository.setUrl(JIRA_5_TEST_SERVER_URL);
  Task task=myRepository.findTask("UT-21");
  assertNotNull("Test task not found",task);
  String comment="Timestamp: " + TaskUtil.formatDate(new Date());
  int minutes=(int)(System.currentTimeMillis() % 240) + 1;
  String duration=String.format("%dh %dm",minutes / 60,minutes % 60);
  myRepository.updateTimeSpent(new LocalTaskImpl(task),duration,comment);
  GetMethod request=new GetMethod(myRepository.getRestUrl("issue",task.getId(),"worklog"));
  String response=myRepository.executeMethod(request);
  JsonObject object=new Gson().fromJson(response,JsonObject.class);
  JsonArray worklogs=object.get("worklogs").getAsJsonArray();
  assertTrue("Michael, it's time to clean it!",worklogs.size() < 1000);
  JsonObject last=worklogs.get(worklogs.size() - 1).getAsJsonObject();
  assertEquals(comment,last.get("comment").getAsString());
  assertEquals(minutes * 60,last.get("timeSpentSeconds").getAsInt());
}
