{
  myRepository.setUrl(JIRA_5_TEST_SERVER_URL);
  final String issueId=createIssueViaRestApi("BTTTU","Test issue for time tracking updates (" + SHORT_TIMESTAMP_FORMAT.format(new Date()) + ")");
  final Task task=myRepository.findTask(issueId);
  assertNotNull("Test task not found",task);
  final String comment="Timestamp: " + TaskUtil.formatDate(new Date());
  final int minutes=(int)(System.currentTimeMillis() % 240) + 1;
  final String duration=String.format("%dh %dm",minutes / 60,minutes % 60);
  myRepository.updateTimeSpent(new LocalTaskImpl(task),duration,comment);
  final GetMethod request=new GetMethod(myRepository.getRestUrl("issue",task.getId(),"worklog"));
  final String response=myRepository.executeMethod(request);
  final JsonObject object=new Gson().fromJson(response,JsonObject.class);
  final JsonArray worklogs=object.get("worklogs").getAsJsonArray();
  final JsonObject last=worklogs.get(worklogs.size() - 1).getAsJsonObject();
  assertEquals(comment,last.get("comment").getAsString());
  assertEquals(minutes * 60,last.get("timeSpentSeconds").getAsInt());
}
