{
  myRepository.setUrl(JIRA_5_TEST_SERVER_URL);
  final String issueId=createIssueViaRestApi("BTTTU","Test issue for time tracking updates (" + SHORT_TIMESTAMP_FORMAT.format(new Date()) + ")");
  final Task task=myRepository.findTask(issueId);
  assertNotNull("Test task not found",task);
  final String comment="Timestamp: " + TaskUtil.formatDate(new Date());
  final Couple<Integer> duration=generateWorkItemDuration();
  final int hours=duration.getFirst(), minutes=duration.getSecond();
  myRepository.updateTimeSpent(new LocalTaskImpl(task),String.format("%dh %dm",hours,minutes),comment);
  final GetMethod request=new GetMethod(myRepository.getRestUrl("issue",task.getId(),"worklog"));
  final String response=myRepository.executeMethod(request);
  final JsonObject object=new Gson().fromJson(response,JsonObject.class);
  final JsonArray worklogs=object.get("worklogs").getAsJsonArray();
  final JsonObject last=worklogs.get(worklogs.size() - 1).getAsJsonObject();
  assertEquals(comment,last.get("comment").getAsString());
  assertEquals((hours * 60 + minutes) * 60,last.get("timeSpentSeconds").getAsInt());
}
