{
  myRepository.setUrl(url);
  Task task=myRepository.findTask(key);
  assertNotNull("Test task not found",task);
  if (task.getState() != TaskState.REOPENED) {
    myRepository.setTaskState(task,REOPENED_CUSTOM_STATE);
  }
  try {
    myRepository.setTaskState(task,RESOLVED_CUSTOM_STATE);
    task=myRepository.findTask(key);
    assertEquals(task.getState(),TaskState.RESOLVED);
  }
  finally {
    try {
      myRepository.setTaskState(task,REOPENED_CUSTOM_STATE);
    }
 catch (    Exception ignored) {
    }
  }
}
