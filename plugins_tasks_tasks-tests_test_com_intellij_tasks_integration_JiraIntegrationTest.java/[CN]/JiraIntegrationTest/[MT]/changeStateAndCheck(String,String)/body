{
  myRepository.setUrl(url);
  Task task=myRepository.findTask(key);
  assertNotNull("Test task not found",task);
  if (task.getState() != TaskState.REOPENED) {
    myRepository.setTaskState(task,TaskState.REOPENED);
  }
  try {
    myRepository.setTaskState(task,TaskState.RESOLVED);
    task=myRepository.findTask(key);
    assertEquals(task.getState(),TaskState.RESOLVED);
  }
  finally {
    try {
      myRepository.setTaskState(task,TaskState.REOPENED);
    }
 catch (    Exception ignored) {
    }
  }
}
