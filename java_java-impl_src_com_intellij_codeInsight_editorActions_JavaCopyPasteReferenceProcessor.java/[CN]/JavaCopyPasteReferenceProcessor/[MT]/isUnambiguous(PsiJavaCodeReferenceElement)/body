{
  if (ref == null)   return false;
  PsiElement parent=ref.getParent();
  if (parent instanceof PsiMethodCallExpression) {
    return CodeInsightSettings.getInstance().ADD_MEMBER_IMPORTS_ON_THE_FLY && new StaticImportMethodFix((PsiMethodCallExpression)parent).getMembersToImport().size() <= 1;
  }
  int constCount=new StaticImportConstantFix(ref).getMembersToImport().size();
  int classCount=new ImportClassFix(ref).getClassesToImport().size();
  if (constCount + classCount > 1)   return false;
  if (constCount + classCount == 0)   return true;
  return constCount == 1 ? CodeInsightSettings.getInstance().ADD_MEMBER_IMPORTS_ON_THE_FLY : CodeInsightSettings.getInstance().ADD_UNAMBIGIOUS_IMPORTS_ON_THE_FLY;
}
