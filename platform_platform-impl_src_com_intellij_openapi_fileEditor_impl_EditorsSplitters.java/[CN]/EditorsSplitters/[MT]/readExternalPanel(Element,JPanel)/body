{
  final Element splitterElement=element.getChild("splitter");
  if (splitterElement != null) {
    return readSplitter(panel,splitterElement);
  }
  final Element leaf=element.getChild("leaf");
  if (leaf == null) {
    return null;
  }
  final EditorWindow window=panel == null ? new EditorWindow(this) : findWindowWith(panel);
  LOG.assertTrue(window != null);
  @SuppressWarnings("unchecked") final List<Element> children=ContainerUtil.newArrayList(leaf.getChildren("file"));
  for (Iterator<Element> iterator=children.iterator(); iterator.hasNext() && UISettings.getInstance().EDITOR_TAB_LIMIT < children.size(); ) {
    Element child=iterator.next();
    if (!Boolean.valueOf(child.getAttributeValue(PINNED)).booleanValue()) {
      iterator.remove();
    }
  }
  for (int i=0; i < children.size(); i++) {
    final Element file=children.get(i);
    try {
      final FileEditorManagerImpl fileEditorManager=getManager();
      final HistoryEntry entry=new HistoryEntry(fileEditorManager.getProject(),file.getChild(HistoryEntry.TAG),true);
      final boolean isCurrentInTab=Boolean.valueOf(file.getAttributeValue(CURRENT_IN_TAB)).booleanValue();
      fileEditorManager.openFileImpl4(window,entry.myFile,isCurrentInTab,entry,isCurrentInTab,i);
      if (fileEditorManager.isFileOpen(entry.myFile)) {
        window.setFilePinned(entry.myFile,Boolean.valueOf(file.getAttributeValue(PINNED)).booleanValue());
      }
    }
 catch (    InvalidDataException e) {
      if (ApplicationManager.getApplication().isUnitTestMode()) {
        LOG.error(e);
      }
    }
  }
  return window.myPanel;
}
