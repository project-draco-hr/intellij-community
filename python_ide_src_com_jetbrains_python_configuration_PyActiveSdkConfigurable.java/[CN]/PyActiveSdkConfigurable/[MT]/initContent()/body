{
  myInterpreterList=PyConfigurableInterpreterList.getInstance(myProject);
  myProjectSdksModel=myInterpreterList.getModel();
  mySdkModelListener=new MySdkModelListener(this);
  myProjectSdksModel.addListener(mySdkModelListener);
  mySdkCombo.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      final Sdk selectedSdk=(Sdk)mySdkCombo.getSelectedItem();
      myPackagesPanel.updatePackages(selectedSdk != null ? new PyPackageManagementService(myProject,selectedSdk) : null);
      myPackagesPanel.updateNotifications(selectedSdk);
    }
  }
);
  myDetailsCallback=new NullableConsumer<Sdk>(){
    @Override public void consume(    @Nullable Sdk sdk){
      final Sdk moduleSdk=getSdk();
      if (sdk instanceof PyDetectedSdk) {
        final Sdk addedSdk=SdkConfigurationUtil.setupSdk(myProjectSdksModel.getSdks(),sdk.getHomeDirectory(),PythonSdkType.getInstance(),true,null,null);
        myProjectSdksModel.addSdk(addedSdk);
        updateSdkList(false);
        if (addedSdk != null)         mySdkCombo.getModel().setSelectedItem(myProjectSdksModel.findSdk(addedSdk.getName()));
      }
 else       if (moduleSdk != null && myProjectSdksModel.findSdk(moduleSdk) != sdk && sdk != null) {
        PythonSdkAdditionalData additionalData=(PythonSdkAdditionalData)sdk.getSdkAdditionalData();
        if (additionalData != null) {
          final String path=additionalData.getAssociatedProjectPath();
          final String basePath=myProject.getBasePath();
          if (basePath != null && !basePath.equals(path))           additionalData.setAssociatedProjectPath(null);
        }
        updateSdkList(false);
        mySdkCombo.getModel().setSelectedItem(myProjectSdksModel.findSdk(sdk.getName()));
      }
    }
  }
;
  myDetailsButton.addActionListener(new ActionListener(){
    @Override public void actionPerformed(    ActionEvent e){
      PythonSdkDetailsStep.show(myProject,myProjectSdksModel.getSdks(),myModule == null ? new PythonSdkDetailsDialog(myProject,myDetailsCallback) : new PythonSdkDetailsDialog(myModule,myDetailsCallback),myMainPanel,myDetailsButton.getLocationOnScreen(),new NullableConsumer<Sdk>(){
        @Override public void consume(        Sdk sdk){
          if (sdk == null)           return;
          final PySdkService sdkService=PySdkService.getInstance();
          sdkService.restoreSdk(sdk);
          if (myProjectSdksModel.findSdk(sdk) == null) {
            myProjectSdksModel.addSdk(sdk);
          }
          updateSdkList(false);
          mySdkCombo.getModel().setSelectedItem(myProjectSdksModel.findSdk(sdk.getName()));
          myPackagesPanel.updatePackages(new PyPackageManagementService(myProject,sdk));
          myPackagesPanel.updateNotifications(sdk);
        }
      }
);
    }
  }
);
}
