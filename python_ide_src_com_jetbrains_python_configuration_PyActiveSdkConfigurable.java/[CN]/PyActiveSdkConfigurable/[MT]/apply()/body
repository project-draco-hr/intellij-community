{
  final Sdk item=(Sdk)mySdkCombo.getSelectedItem();
  if (item instanceof PyDetectedSdk) {
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      @Override public void run(){
        final Sdk sdk=SdkConfigurationUtil.createAndAddSDK(item.getName(),PythonSdkType.getInstance());
        SdkConfigurationUtil.setDirectoryProjectSdk(myProject,sdk);
      }
    }
,ModalityState.any());
  }
  myProjectSdksModel.apply();
  final Sdk selectedSdk=myProjectSdksModel.findSdk(item);
  if (myModule == null) {
    final ProjectRootManager rootManager=ProjectRootManager.getInstance(myProject);
    ApplicationManager.getApplication().runWriteAction(new Runnable(){
      @Override public void run(){
        rootManager.setProjectSdk(selectedSdk);
      }
    }
);
  }
 else {
    ModuleRootModificationUtil.setModuleSdk(myModule,selectedSdk);
  }
  final Sdk prevSdk=ProjectRootManager.getInstance(myProject).getProjectSdk();
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      ProjectRootManager.getInstance(myProject).setProjectSdk(selectedSdk);
    }
  }
);
  myProjectSdksModel.setProjectSdk(selectedSdk);
  if (prevSdk != null && selectedSdk != null) {
    final PythonSdkFlavor flavor1=PythonSdkFlavor.getFlavor(selectedSdk);
    final PythonSdkFlavor flavor2=PythonSdkFlavor.getFlavor(prevSdk);
    if (flavor1 != null && flavor2 != null) {
      final LanguageLevel languageLevel1=flavor1.getLanguageLevel(selectedSdk);
      final LanguageLevel languageLevel2=flavor2.getLanguageLevel(prevSdk);
      if ((languageLevel1.isPy3K() && languageLevel2.isPy3K()) || (!languageLevel1.isPy3K()) && !languageLevel2.isPy3K()) {
        return;
      }
    }
  }
  rehighlightStrings(myProject);
}
