{
  if (myMarkers.isEmpty())   return;
  myState=State.APPLYING;
  final Document document=myEditor.getDocument();
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      for (      Couple<RangeMarker> couple : myMarkers) {
        final RangeMarker leader=couple.first;
        final RangeMarker support=couple.second;
        final String name=document.getText(new TextRange(leader.getStartOffset(),leader.getEndOffset()));
        document.replaceString(support.getStartOffset(),support.getEndOffset(),name);
      }
    }
  }
);
  myState=State.TRACKING;
}
