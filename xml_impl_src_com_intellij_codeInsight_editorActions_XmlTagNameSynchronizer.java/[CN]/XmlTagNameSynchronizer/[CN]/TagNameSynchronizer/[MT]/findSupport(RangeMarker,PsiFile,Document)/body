{
  final int offset=leader.getStartOffset();
  PsiElement element=InjectedLanguageUtil.findElementAtNoCommit(file,offset);
  PsiElement support=findSupportElement(element);
  if (support == null && file.getViewProvider() instanceof MultiplePsiFilesPerDocumentFileViewProvider) {
    element=file.getViewProvider().findElementAt(offset,myLanguage);
    support=findSupportElement(element);
  }
  if (support == null)   return null;
  int diff=offset - element.getTextRange().getStartOffset();
  final TextRange range=support.getTextRange();
  return range != null ? document.createRangeMarker(range.getStartOffset() + diff,range.getEndOffset() + diff,true) : null;
}
