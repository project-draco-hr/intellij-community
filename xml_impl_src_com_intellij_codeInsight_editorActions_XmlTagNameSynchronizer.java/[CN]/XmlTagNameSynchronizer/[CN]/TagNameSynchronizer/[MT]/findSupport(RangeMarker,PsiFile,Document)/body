{
  final int offset=leader.getStartOffset();
  PsiElement element=InjectedLanguageUtil.findElementAtNoCommit(file,offset);
  PsiElement support=findSupportElement(element);
  if (support == null && file.getViewProvider() instanceof MultiplePsiFilesPerDocumentFileViewProvider) {
    element=file.getViewProvider().findElementAt(offset,myLanguage);
    support=findSupportElement(element);
  }
  if (support == null)   return null;
  final TextRange range=support.getTextRange();
  TextRange realRange=InjectedLanguageManager.getInstance(file.getProject()).injectedToHost(element.getContainingFile(),range);
  return document.createRangeMarker(realRange.getStartOffset(),realRange.getEndOffset(),true);
}
