{
  File jar=IoTestUtil.createTestJar();
  VirtualFile vFile=LocalFileSystem.getInstance().refreshAndFindFileByIoFile(jar);
  assertNotNull(vFile);
  new WriteCommandAction.Simple(myProject){
    @Override protected void run() throws Throwable {
      PsiTestUtil.addContentRoot(myModule,vFile.getParent());
    }
  }
.execute();
  VirtualFile jarRoot=JarFileSystem.getInstance().getRootByLocal(vFile);
  assertNotNull(jarRoot);
  PsiFile file=getPsiManager().findFile(vFile);
  String newName=vFile.getName() + ".jar";
  rename(file,newName);
  assertFalse(jarRoot.isValid());
  checkMove(jar,vFile,file);
}
