{
  boolean success;
  try {
    success=handler.write(message);
  }
 catch (  Throwable e) {
    try {
      failedToSend(sequence);
    }
  finally {
      MessageHandler.LOG.error("Failed to send",e);
    }
    return;
  }
  if (!success) {
    failedToSend(sequence);
  }
}
