{
  final CharSequence textBeforeChange=document.getImmutableCharSequence();
  final Runnable calculateChangesAndNotify=new Runnable(){
    @Override public void run(){
      final String info=prepareMessage(document,textBeforeChange);
      ApplicationManager.getApplication().invokeLater(new Runnable(){
        @Override public void run(){
          if (!myEditor.isDisposed() && myEditor.getComponent().isShowing()) {
            showHint(myEditor,info);
          }
        }
      }
);
    }
  }
;
  return new Runnable(){
    @Override public void run(){
      ApplicationManager.getApplication().executeOnPooledThread(calculateChangesAndNotify);
    }
  }
;
}
