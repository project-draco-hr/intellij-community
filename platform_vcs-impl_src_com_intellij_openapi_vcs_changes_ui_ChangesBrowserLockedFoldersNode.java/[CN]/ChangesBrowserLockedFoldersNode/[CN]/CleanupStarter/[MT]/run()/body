{
  final List<VirtualFile> files=myParentNode.getAllFilesUnder();
  final ProjectLevelVcsManager plVcsManager=ProjectLevelVcsManager.getInstance(myProject);
  final Map<String,List<VirtualFile>> byVcs=new HashMap<>();
  for (  VirtualFile file : files) {
    final AbstractVcs vcs=plVcsManager.getVcsFor(file);
    if (vcs != null) {
      List<VirtualFile> list=byVcs.get(vcs.getName());
      if (list == null) {
        list=new ArrayList<>();
        byVcs.put(vcs.getName(),list);
      }
      list.add(file);
    }
  }
  for (  Map.Entry<String,List<VirtualFile>> entry : byVcs.entrySet()) {
    final AbstractVcs vcs=plVcsManager.findVcsByName(entry.getKey());
    if (vcs != null) {
      final ChangeProvider changeProvider=vcs.getChangeProvider();
      if (changeProvider != null) {
        changeProvider.doCleanup(entry.getValue());
      }
    }
  }
}
