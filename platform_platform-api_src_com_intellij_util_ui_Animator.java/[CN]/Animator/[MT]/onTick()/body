{
  if (isDisposed())   return;
  boolean initialStep=false;
  if (myStartTime == -1) {
    myStartTime=System.currentTimeMillis();
    myCycleOffset=myCurrentFrame;
    initialStep=true;
  }
  double cycleTime=System.currentTimeMillis() - myStartTime;
  if (cycleTime < 0)   return;
  long newFrame=(long)(cycleTime * myTotalFrames / myCycleDuration) + myCycleOffset;
  if (myRepeatable) {
    newFrame=newFrame % myTotalFrames;
  }
  if (!initialStep && newFrame == myCurrentFrame)   return;
  if (!myRepeatable && newFrame >= myTotalFrames) {
    animationDone();
    return;
  }
  myCurrentFrame=(int)(newFrame);
  paint();
}
