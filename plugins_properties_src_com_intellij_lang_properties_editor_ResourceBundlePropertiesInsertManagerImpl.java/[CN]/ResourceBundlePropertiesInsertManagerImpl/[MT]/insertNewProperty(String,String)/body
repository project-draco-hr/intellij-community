{
  if (ApplicationManager.getApplication().isUnitTestMode() && myKeysOrder != null) {
    LOG.assertTrue(!myKeysOrder.contains(key));
  }
  final PropertiesFile propertiesFile=myResourceBundle.getDefaultPropertiesFile();
  if (myAlphaSorted) {
    final Pair<IProperty,Integer> propertyAndPosition=findExistedPrevSiblingProperty(key,propertiesFile);
    if (propertyAndPosition == null) {
      propertiesFile.addPropertyFirst(key,value);
      myKeysOrder.add(0,key);
    }
 else {
      propertiesFile.addPropertyAfter(key,value,(Property)propertyAndPosition.getFirst());
      final Integer position=propertyAndPosition.getSecond();
      myKeysOrder.add(position,key);
    }
  }
 else {
    propertiesFile.addPropertyLast(key,value);
    if (myOrdered) {
      myKeysOrder.add(key);
    }
  }
}
