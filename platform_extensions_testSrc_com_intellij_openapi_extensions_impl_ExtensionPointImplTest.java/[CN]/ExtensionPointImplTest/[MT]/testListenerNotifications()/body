{
  ExtensionPoint<String> extensionPoint=buildExtensionPoint(String.class);
  final List<String> extensions=ContainerUtil.newArrayList();
  extensionPoint.addExtensionPointListener(new ExtensionPointListener.Adapter<String>(){
    @Override public void extensionAdded(    @NotNull String extension,    @Nullable PluginDescriptor pluginDescriptor){
      extensions.add(extension);
    }
  }
);
  MyShootingComponentAdapter adapter=buildAdapter();
  extensionPoint.registerExtension("first");
  assertThat(extensions,contains("first"));
  assertThat(ourTestLog.errors(),empty());
  extensionPoint.registerExtension("second",LoadingOrder.FIRST);
  ((ExtensionPointImpl)extensionPoint).registerExtensionAdapter(adapter);
  adapter.setFire(true);
  try {
    extensionPoint.getExtensions();
    fail("PCE expected");
  }
 catch (  ProcessCanceledException ignored) {
  }
  assertThat(extensions,contains("first","second"));
  assertThat(ourTestLog.errors(),empty());
  adapter.setFire(false);
  extensionPoint.getExtensions();
  assertThat(extensions,contains("first","second",""));
  assertThat(ourTestLog.errors(),empty());
}
