{
  ExtensionPoint<String> extensionPoint=buildExtensionPoint(String.class);
  MyShootingComponentAdapter adapter=buildAdapter();
  extensionPoint.registerExtension("first");
  assertThat(extensionPoint.getExtensions(),arrayWithSize(1));
  assertThat(ourTestLog.errors(),empty());
  extensionPoint.registerExtension("second",LoadingOrder.FIRST);
  ((ExtensionPointImpl)extensionPoint).registerExtensionAdapter(adapter);
  adapter.setFire(true);
  try {
    extensionPoint.getExtensions();
    fail("PCE expected");
  }
 catch (  ProcessCanceledException ignored) {
  }
  assertThat(ourTestLog.errors(),empty());
  adapter.setFire(false);
  assertThat(extensionPoint.getExtensions(),arrayContaining("second","","first"));
  assertThat(ourTestLog.errors(),empty());
}
