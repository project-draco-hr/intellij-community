{
  ExtensionPoint<String> extensionPoint=buildExtensionPoint(String.class);
  MyShootingComponentAdapter adapter=buildAdapter();
  extensionPoint.registerExtension("first");
  assertThat(extensionPoint.getExtensions(),arrayWithSize(1));
  assertThat(ourTestLog.errors(),empty());
  extensionPoint.registerExtension("second",LoadingOrder.FIRST);
  ((ExtensionPointImpl)extensionPoint).registerExtensionAdapter(adapter);
  adapter.setFire(true);
  try {
    extensionPoint.getExtensions();
    fail("PCE expected");
  }
 catch (  ProcessCanceledException ignored) {
  }
  assertThat(ourTestLog.errors(),empty());
  adapter.setFire(false);
  String[] extensions=extensionPoint.getExtensions();
  assertEquals("second",extensions[0]);
  assertThat(extensions[1],isOneOf("","first"));
  assertThat(extensions[2],isOneOf("","first"));
  assertNotEquals(extensions[2],extensions[1]);
  assertThat(ourTestLog.errors(),empty());
}
