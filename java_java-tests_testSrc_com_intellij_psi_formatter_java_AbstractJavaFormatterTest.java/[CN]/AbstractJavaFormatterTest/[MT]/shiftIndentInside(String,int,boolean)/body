{
  StringBuilder result=new StringBuilder(initial.length());
  List<byte[]> lines;
  try {
    LineReader reader=new LineReader(new ByteArrayInputStream(initial.getBytes(CharsetToolkit.UTF8_CHARSET)));
    lines=reader.readLines();
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
  boolean first=true;
  for (  byte[] line : lines) {
    try {
      if (!first)       result.append('\n');
      if (line.length > 0 || shiftEmptyLines) {
        StringUtil.repeatSymbol(result,' ',i);
      }
      result.append(new String(line));
    }
  finally {
      first=false;
    }
  }
  return result.toString();
}
