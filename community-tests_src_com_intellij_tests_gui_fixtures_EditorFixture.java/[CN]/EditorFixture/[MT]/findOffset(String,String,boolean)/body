{
  assertTrue(prefix != null || suffix != null);
  return execute(new GuiQuery<Integer>(){
    @Override @Nullable protected Integer executeInEDT() throws Throwable {
      FileEditorManager manager=FileEditorManager.getInstance(myFrame.getProject());
      Editor editor=manager.getSelectedTextEditor();
      if (editor != null) {
        CaretModel caretModel=editor.getCaretModel();
        Caret primaryCaret=caretModel.getPrimaryCaret();
        Document document=editor.getDocument();
        String contents=document.getCharsSequence().toString();
        String target=(prefix != null ? prefix : "") + (suffix != null ? suffix : "");
        int targetIndex=contents.indexOf(target,searchFromTop ? 0 : primaryCaret.getOffset());
        return targetIndex != -1 ? targetIndex + (prefix != null ? prefix.length() : 0) : -1;
      }
      return -1;
    }
  }
);
}
