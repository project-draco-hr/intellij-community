{
  final Set<String> extensions=new HashSet<String>(Arrays.asList(sourceExtensions));
  FileChooserDialog fileChooser=FileChooserFactory.getInstance().createFileChooser(new FileChooserDescriptor(true,false,false,false,false,false){
    @Override public boolean isFileVisible(    VirtualFile file,    boolean showHiddenFiles){
      return file.isDirectory() || extensions.contains(file.getExtension());
    }
    @Override public boolean isFileSelectable(    VirtualFile file){
      return !file.isDirectory() && extensions.contains(file.getExtension());
    }
  }
,null,parent);
  final VirtualFile[] preselectFiles;
  if (preselect != null) {
    preselectFiles=new VirtualFile[1];
    preselectFiles[0]=preselect;
  }
 else {
    preselectFiles=new VirtualFile[0];
  }
  final VirtualFile[] virtualFiles=fileChooser.choose(null,preselectFiles);
  if (virtualFiles.length != 1)   return null;
  virtualFiles[0].refresh(false,false);
  return virtualFiles[0];
}
