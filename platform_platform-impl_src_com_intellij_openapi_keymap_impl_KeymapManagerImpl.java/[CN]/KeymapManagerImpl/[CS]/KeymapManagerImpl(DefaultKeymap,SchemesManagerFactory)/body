{
  mySchemesManager=factory.createSchemesManager("$ROOT_CONFIG$/keymaps",new BaseSchemeProcessor<KeymapImpl>(){
    @Override public KeymapImpl readScheme(    @NotNull final Document schemeContent) throws InvalidDataException, IOException, JDOMException {
      return readKeymap(schemeContent);
    }
    @Override public Document writeScheme(    @NotNull final KeymapImpl scheme) throws WriteExternalException {
      return new Document(scheme.writeExternal());
    }
    @Override public boolean shouldBeSaved(    @NotNull final KeymapImpl scheme){
      return scheme.canModify();
    }
  }
,RoamingType.PER_USER);
  Keymap[] keymaps=defaultKeymap.getKeymaps();
  String systemDefaultKeymap=defaultKeymap.getDefaultKeymapName();
  for (  Keymap keymap : keymaps) {
    addKeymap(keymap);
    if (systemDefaultKeymap.equals(keymap.getName())) {
      setActiveKeymap(keymap);
    }
  }
  load();
  if (Registry.is("editor.add.carets.on.double.control.arrows")) {
    ModifierKeyDoubleClickHandler.getInstance().registerAction(IdeActions.ACTION_EDITOR_CLONE_CARET_ABOVE,KeyEvent.VK_CONTROL,KeyEvent.VK_UP);
    ModifierKeyDoubleClickHandler.getInstance().registerAction(IdeActions.ACTION_EDITOR_CLONE_CARET_BELOW,KeyEvent.VK_CONTROL,KeyEvent.VK_DOWN);
    ModifierKeyDoubleClickHandler.getInstance().registerAction(IdeActions.ACTION_EDITOR_MOVE_CARET_LEFT_WITH_SELECTION,KeyEvent.VK_CONTROL,KeyEvent.VK_LEFT);
    ModifierKeyDoubleClickHandler.getInstance().registerAction(IdeActions.ACTION_EDITOR_MOVE_CARET_RIGHT_WITH_SELECTION,KeyEvent.VK_CONTROL,KeyEvent.VK_RIGHT);
  }
  ourKeymapManagerInitialized=true;
}
