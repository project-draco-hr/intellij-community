{
  super((Frame)WindowManager.getInstance().suggestParentWindow(project),false);
  setTitle(isReplace ? "Structural Replace" : "Structural Search");
  setOKButtonText("Next");
  getOkButton().setMnemonic('N');
  this.project=project;
  index=-1;
  if (isReplace) {
    replaceButton=createJButtonForAction(new AbstractAction(){
      public void actionPerformed(      ActionEvent e){
        replacements.get(index).setReplacement(replacement.getDocument().getText());
        replaceCurrentResult();
        if (index + 1 < replacements.size() || !matchingProcess.isEnded())         doOKAction();
 else         setVisible(false);
      }
    }
);
    replaceAll=createJButtonForAction(new AbstractAction(){
      public void actionPerformed(      ActionEvent e){
        setVisible(false);
        doAll();
      }
    }
);
    replaceButton.setText("Replace");
    replaceButton.setMnemonic('R');
    replaceAll.setText("Replace all");
    replaceAll.setMnemonic('a');
  }
class PreviousMatchAction extends AbstractAction {
    PreviousMatchAction(){
      super("Previous");
      putValue(MNEMONIC_KEY,new Integer('P'));
    }
    public void actionPerformed(    ActionEvent e){
      if (index - 1 >= 0) {
        --index;
        navigateOne(index);
      }
    }
  }
  previousMatch=new PreviousMatchAction();
  setOKActionEnabled(false);
  previousMatch.setEnabled(false);
  statusBar=(StatusBarEx)WindowManagerEx.getInstanceEx().getStatusBar(project);
  statusBar.showCancelButton(IconLoader.getIcon("/actions/suspend.png"),new ActionListener(){
    public void actionPerformed(    ActionEvent e){
      matchingProcess.stop();
    }
  }
,null);
  init();
}
