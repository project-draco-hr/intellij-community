{
  List l=(List)replacements.get(index);
  SmartPsiElementPointer pointer=null;
  int start=0;
  int end=0;
  for (  Object aL : l) {
    final SmartPsiElementPointer ptr=(SmartPsiElementPointer)aL;
    final PsiElement element=UIUtil.getNavigationElement(ptr.getElement());
    if (pointer == null) {
      pointer=ptr;
      start=element.getTextRange().getStartOffset();
    }
    end=element.getTextRange().getEndOffset();
  }
  if (replaceButton != null) {
    if (pointer.getElement().isValid()) {
      final ReplacementInfo replacementInfo=replacements.get(index);
      UIUtil.setContent(replacement,replacementInfo.getReplacement(),0,-1,project);
      final PsiElement firstMatch=replacementInfo.getMatch(0);
      if (firstMatch != null) {
        final StructuralSearchProfile profile=StructuralSearchUtil.getProfileByPsiElement(firstMatch);
        if (profile != null) {
          UIUtil.updateHighlighter(editor,profile);
        }
      }
      replaceButton.setVisible(true);
      replacement.getComponent().setVisible(true);
    }
 else {
      replaceButton.setVisible(false);
      replacement.getComponent().setVisible(false);
    }
  }
  boolean hasNextMatch=index + 1 < replacements.size();
  if (!matchingProcess.isEnded()) {
    hasNextMatch=true;
  }
  setOKActionEnabled(hasNextMatch);
  previousMatch.setEnabled(index > 0);
  if (pointer != null) {
    UIUtil.navigate(pointer.getElement());
    hilight(start,end);
  }
}
