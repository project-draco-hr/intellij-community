{
  CharSequence revisionContent=null;
  if (options.getTextRangeType() == VCS_CHANGED_TEXT) {
    myFixture.configureByFile(getTestName(true) + "_revision.java");
    PsiFile file=myFixture.getFile();
    Document document=myFixture.getDocument(file);
    revisionContent=document.getCharsSequence();
  }
  myFixture.configureByFile(getTestName(true) + "_before.java");
  if (revisionContent != null) {
    myFixture.getFile().putUserData(FormatChangedTextUtil.TEST_REVISION_CONTENT,revisionContent);
  }
  FileInEditorProcessor processor=new FileInEditorProcessor(myFixture.getFile(),myFixture.getEditor(),options);
  processor.processCode();
  myFixture.checkResultByFile(getTestName(true) + "_after.java");
}
