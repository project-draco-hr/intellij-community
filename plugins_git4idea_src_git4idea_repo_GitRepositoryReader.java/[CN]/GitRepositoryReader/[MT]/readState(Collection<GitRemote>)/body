{
  Pair<Set<GitLocalBranch>,Set<GitRemoteBranch>> branches=readBranches(remotes);
  HeadInfo headInfo=readHead();
  Repository.State state=readRepositoryState(headInfo);
  GitLocalBranch currentBranch=findCurrentBranch(headInfo,state,branches.first);
  String currentRevision=getCurrentRevision(headInfo,currentBranch);
  return new GitBranchState(currentRevision,currentBranch,state,branches.first,branches.second);
}
