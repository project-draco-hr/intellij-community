{
  if (!rootDir.exists()) {
    return Collections.emptyMap();
  }
  final Map<String,String> result=new HashMap<String,String>();
  FileUtil.processFilesRecursively(rootDir,new Processor<File>(){
    @Override public boolean process(    File file){
      if (!file.isDirectory() && !isHidden(file)) {
        String relativePath=FileUtil.getRelativePath(myGitDir,file);
        if (relativePath != null) {
          String branchName=FileUtil.toSystemIndependentName(relativePath);
          String hash=loadHashFromBranchFile(file);
          if (hash != null) {
            result.put(branchName,hash);
          }
        }
      }
      return true;
    }
  }
,NOT_HIDDEN_DIRECTORIES);
  return result;
}
