{
  Set<GitLocalBranch> localBranches=ContainerUtil.newHashSet();
  Set<GitRemoteBranch> remoteBranches=ContainerUtil.newHashSet();
  for (  Map.Entry<String,Hash> entry : data.entrySet()) {
    String refName=entry.getKey();
    Hash hash=entry.getValue();
    if (refName.startsWith(REFS_HEADS_PREFIX)) {
      localBranches.add(new GitLocalBranch(refName,hash));
    }
 else     if (refName.startsWith(REFS_REMOTES_PREFIX)) {
      GitRemoteBranch remoteBranch=parseRemoteBranch(refName,hash,remotes);
      if (remoteBranch != null) {
        remoteBranches.add(remoteBranch);
      }
    }
 else {
      LOG.warn("Unexpected ref format: " + refName);
    }
  }
  return new GitBranchesCollection(localBranches,remoteBranches);
}
