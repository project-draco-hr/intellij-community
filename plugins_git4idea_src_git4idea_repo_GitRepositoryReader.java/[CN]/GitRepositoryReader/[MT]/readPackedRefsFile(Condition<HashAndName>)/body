{
  return RepositoryUtil.tryOrThrow(new Callable<List<HashAndName>>(){
    @Override public List<HashAndName> call() throws Exception {
      List<HashAndName> hashAndNames=ContainerUtil.newArrayList();
      BufferedReader reader=null;
      try {
        reader=new BufferedReader(new FileReader(myPackedRefsFile));
        for (String line=reader.readLine(); line != null; line=reader.readLine()) {
          HashAndName hashAndName=parsePackedRefsLine(line);
          if (hashAndName == null) {
            continue;
          }
          if (firstMatchCondition != null) {
            if (firstMatchCondition.value(hashAndName)) {
              return Collections.singletonList(hashAndName);
            }
          }
 else {
            hashAndNames.add(hashAndName);
          }
        }
      }
  finally {
        if (reader != null) {
          reader.close();
        }
      }
      return hashAndNames;
    }
  }
,myPackedRefsFile);
}
