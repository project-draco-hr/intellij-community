{
  ProjectSystemId externalSystemId=ExternalSystemDataKeys.EXTERNAL_SYSTEM_ID.getData(e.getDataContext());
  if (externalSystemId == null) {
    return;
  }
  ExternalSystemManager<?,?,?,?,?> manager=ExternalSystemApiUtil.getManager(externalSystemId);
  if (manager == null) {
    return;
  }
  Project project=PlatformDataKeys.PROJECT.getData(e.getDataContext());
  if (project == null) {
    return;
  }
  ProjectImportProvider[] providers=new ProjectImportProvider[1];
  for (  ProjectImportProvider provider : ProjectImportProvider.PROJECT_IMPORT_PROVIDER.getExtensions()) {
    if (provider instanceof AbstractExternalProjectImportProvider && externalSystemId.equals(((AbstractExternalProjectImportProvider)provider).getExternalSystemId())) {
      providers[0]=provider;
      break;
    }
  }
  if (providers[0] == null) {
    return;
  }
  AddModuleWizard wizard=ImportModuleAction.selectFileAndCreateWizard(project,null,manager.getExternalProjectDescriptor(),providers);
  if (wizard != null) {
    ImportModuleAction.createFromWizard(project,wizard);
  }
}
