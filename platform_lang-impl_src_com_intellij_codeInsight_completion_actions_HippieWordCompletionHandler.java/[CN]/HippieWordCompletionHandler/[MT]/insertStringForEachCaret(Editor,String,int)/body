{
  editor.getCaretModel().runForEachCaret(new CaretAction(){
    @Override public void perform(    Caret caret){
      int caretOffset=caret.getOffset();
      int startOffset=Math.max(0,caretOffset - relativeOffset);
      editor.getDocument().replaceString(startOffset,caretOffset,text);
      caret.moveToOffset(startOffset + text.length());
    }
  }
);
}
