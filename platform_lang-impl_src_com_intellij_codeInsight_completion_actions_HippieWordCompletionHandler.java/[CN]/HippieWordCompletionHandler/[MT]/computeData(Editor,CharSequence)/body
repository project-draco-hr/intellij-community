{
  final int offset=editor.getCaretModel().getOffset();
  final CompletionData data=new CompletionData();
  final int caretOffset=editor.getCaretModel().getOffset();
  HighlighterIterator iterator=((EditorEx)editor).getHighlighter().createIterator(offset - 1);
  int start=iterator.getStart();
  int end=iterator.getEnd();
  if (start <= offset && end >= offset) {
    if (isWordLike(charsSequence,start,end)) {
      data.myPrefix=charsSequence.subSequence(start,offset).toString();
      data.myWordUnderCursor=charsSequence.subSequence(start,end).toString();
      data.startOffset=start;
    }
  }
  iterator.advance();
  if (data.myPrefix == null) {
    data.myPrefix="";
    data.myWordUnderCursor="";
    data.startOffset=offset;
  }
  return data;
}
