{
  return new ArrayTableCellEditor(myProject){
    private String getCellSlice(){
      String expression=getSliceText();
      if (myTable.getRowCount() == 1) {
        expression+="[" + myTable.getSelectedColumn() + "]";
      }
 else       if (myTable.getColumnCount() == 1) {
        expression+="[" + myTable.getSelectedRow() + "]";
      }
 else {
        expression+="[" + myTable.getSelectedRow() + "]["+ myTable.getSelectedColumn()+ "]";
      }
      if (myTable.getRowCount() == 1 && myTable.getColumnCount() == 1) {
        return getSliceText();
      }
      return expression;
    }
    private String changeValExpression(){
      if (myEditor.getEditor() == null) {
        throw new IllegalStateException("Null editor in table cell.");
      }
      return getCellSlice() + " = " + myEditor.getEditor().getDocument().getText();
    }
    @Override public void cancelEditing(){
      super.cancelEditing();
      clearErrorMessage();
    }
    @Override public void doOKAction(    final int row,    final int col){
      if (myEditor.getEditor() == null) {
        return;
      }
      myEvaluator.evaluate(changeValExpression(),new XDebuggerEvaluator.XEvaluationCallback(){
        @Override public void evaluated(        @NotNull XValue result){
          AppUIUtil.invokeOnEdt(new Runnable(){
            @Override public void run(){
              XDebuggerTree tree=((XValueNodeImpl)myBaseNode).getTree();
              final XDebuggerTreeState treeState=XDebuggerTreeState.saveState(tree);
              tree.rebuildAndRestore(treeState);
            }
          }
);
          XDebuggerEvaluator.XEvaluationCallback callback=new XDebuggerEvaluator.XEvaluationCallback(){
            @Override public void evaluated(            @NotNull XValue value){
              String text=((PyDebugValue)value).getValue();
              final String corrected;
              if (!isNumeric()) {
                if (!text.startsWith("\\\'") && !text.startsWith("\\\"")) {
                  corrected="\'" + text + "\'";
                }
 else {
                  corrected=text;
                }
              }
 else {
                corrected=text;
                disableColor();
              }
              new WriteCommandAction(null){
                protected void run(                @NotNull Result result) throws Throwable {
                  if (myEditor.getEditor() != null) {
                    myEditor.getEditor().getDocument().setText(corrected);
                    ((PagingTableModel)myTable.getModel()).forcedChange(row,col,corrected);
                    cancelEditing();
                  }
                }
              }
.execute();
              lastValue=corrected;
            }
            @Override public void errorOccurred(            @NotNull String errorMessage){
              showError(errorMessage);
            }
          }
;
          myEvaluator.evaluate(getCellSlice(),callback,null);
        }
        @Override public void errorOccurred(        @NotNull String errorMessage){
          showError(errorMessage);
        }
      }
,null);
      super.doOKAction(row,col);
    }
  }
;
}
