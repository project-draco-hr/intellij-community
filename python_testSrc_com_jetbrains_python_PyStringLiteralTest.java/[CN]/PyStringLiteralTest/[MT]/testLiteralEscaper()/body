{
  final PsiFile file=PsiFileFactory.getInstance(myFixture.getProject()).createFileFromText("test.py","a = '\\nfoo");
  PyStringLiteralExpression expr=PsiTreeUtil.getParentOfType(file.findElementAt(5),PyStringLiteralExpression.class);
  assertNotNull(expr);
  final LiteralTextEscaper<? extends PsiLanguageInjectionHost> escaper=expr.createLiteralTextEscaper();
  StringBuilder builder=new StringBuilder();
  escaper.decode(new TextRange(3,5),builder);
  assertEquals("fo",builder.toString());
  builder.setLength(0);
  escaper.decode(new TextRange(1,3),builder);
  assertEquals("\n",builder.toString());
  assertEquals(1,escaper.getOffsetInHost(0,new TextRange(0,5)));
  assertEquals(3,escaper.getOffsetInHost(1,new TextRange(0,5)));
  assertEquals(4,escaper.getOffsetInHost(2,new TextRange(0,5)));
}
