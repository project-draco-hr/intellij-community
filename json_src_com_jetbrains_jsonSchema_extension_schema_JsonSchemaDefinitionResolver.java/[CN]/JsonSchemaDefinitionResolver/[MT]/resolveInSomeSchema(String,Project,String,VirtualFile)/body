{
  final Ref<Pair<VirtualFile,Integer>> reference=new Ref<>();
  final FileBasedIndex index=FileBasedIndex.getInstance();
  final GlobalSearchScope fileScope=filterFile == null ? null : GlobalSearchScope.fileScope(project,filterFile);
  final GlobalSearchScope enlarged=fileScope != null && JsonSchemaResourcesRootsProvider.ourFiles.getValue().contains(filterFile) ? fileScope : JsonSchemaResourcesRootsProvider.enlarge(project,fileScope == null ? GlobalSearchScope.allScope(project) : fileScope);
  index.processValues(JsonSchemaFileIndex.PROPERTIES_INDEX,referenceName,null,new FileBasedIndex.ValueProcessor<Integer>(){
    @Override public boolean process(    VirtualFile file,    Integer value){
      if (schemaId != null) {
        if (!JsonSchemaService.Impl.getEx(project).checkFileForId(schemaId,file)) {
          return true;
        }
      }
      reference.set(Pair.create(file,value));
      return false;
    }
  }
,enlarged);
  if (!reference.isNull()) {
    final Pair<VirtualFile,Integer> pair=reference.get();
    final PsiFile file=PsiManager.getInstance(project).findFile(pair.getFirst());
    if (file != null) {
      return file.findElementAt(pair.getSecond());
    }
  }
  return null;
}
