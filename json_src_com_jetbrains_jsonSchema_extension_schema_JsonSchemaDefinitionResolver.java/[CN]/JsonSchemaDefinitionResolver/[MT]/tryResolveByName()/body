{
  if (myRef == null)   initializeName();
  if (myRef == null)   return null;
  GlobalSearchScope filter=null;
  if (mySchemaId != null && myRef.startsWith("#/")) {
    filter=GlobalSearchScope.fileScope(myElement.getContainingFile());
  }
 else {
    final JsonSchemaServiceEx schemaServiceEx=JsonSchemaService.Impl.getEx(myElement.getProject());
    final Collection<Pair<VirtualFile,String>> pairs=schemaServiceEx.getSchemaFilesByFile(myElement.getContainingFile().getVirtualFile());
    if (pairs != null && !pairs.isEmpty()) {
      for (      Pair<VirtualFile,String> pair : pairs) {
        final PsiElement element=resolveInSomeSchema(myRef,myElement.getProject(),pair.getSecond(),GlobalSearchScope.fileScope(myElement.getProject(),pair.getFirst()));
        if (element != null)         return element;
      }
    }
  }
  return resolveInSomeSchema(myRef,myElement.getProject(),mySchemaId,filter);
}
