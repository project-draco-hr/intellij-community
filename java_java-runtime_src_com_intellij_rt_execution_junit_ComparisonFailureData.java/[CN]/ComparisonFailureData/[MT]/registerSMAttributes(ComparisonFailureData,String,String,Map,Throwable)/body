{
  if (notification != null) {
    attrs.put("expected",notification.getExpected());
    attrs.put("actual",notification.getActual());
    final int failureIdx=trace.indexOf(failureMessage);
    attrs.put("details",failureIdx > -1 ? trace.substring(failureIdx + failureMessage.length()) : trace);
    final String filePath=notification.getFilePath();
    if (filePath != null) {
      attrs.put("expectedFile",filePath);
    }
    attrs.put("message","Comparison Failure:");
  }
 else {
    attrs.put("details",trace);
    Throwable throwableCause=null;
    try {
      throwableCause=throwable.getCause();
    }
 catch (    Throwable ignored) {
    }
    if (!isAssertionError(throwable.getClass()) && !isAssertionError(throwableCause != null ? throwableCause.getClass() : null)) {
      attrs.put("error","true");
    }
    attrs.put("message",failureMessage != null ? failureMessage : "");
  }
}
