{
  int valueIndex=0;
  boolean inside=false;
  String[] values=new String[count];
  StringBuilder builder=new StringBuilder();
  char endQuote=0;
  for (int bIdx=start; bIdx < command.length(); bIdx++) {
    if (!inside) {
      while (bIdx < command.length() && !isQuote(command.charAt(bIdx))) {
        bIdx++;
      }
      if (bIdx >= command.length()) {
        break;
      }
      inside=true;
      endQuote=command.charAt(bIdx);
    }
 else {
      boolean escaped=false;
      for (; bIdx < command.length(); bIdx++) {
        char c=command.charAt(bIdx);
        if (c == '\\' && !escaped) {
          escaped=true;
          continue;
        }
        if (c == endQuote && !escaped) {
          break;
        }
        if (c == '$' && escaped) {
          builder.append('\\');
        }
        escaped=false;
        builder.append(c);
      }
      if (bIdx == command.length()) {
        return null;
      }
      values[valueIndex++]=builder.toString();
      builder.setLength(0);
      inside=false;
    }
  }
  return values;
}
