{
  super(new MyModel<T>(project,valueClass,valueTitle,showContentFilesOnly ? new ProjectContentFileFilter(project,filter) : filter));
  myProject=project;
  myModel=(MyModel)getTableModel();
  myModel.setTreeTable(this);
  new TreeTableSpeedSearch(this,new Convertor<TreePath,String>(){
    @Override public String convert(    final TreePath o){
      final DefaultMutableTreeNode node=(DefaultMutableTreeNode)o.getLastPathComponent();
      final Object userObject=node.getUserObject();
      if (userObject == null) {
        return getProjectNodeText();
      }
      if (userObject instanceof VirtualFile) {
        return ((VirtualFile)userObject).getName();
      }
      return node.toString();
    }
  }
);
  final DefaultTreeExpander treeExpander=new DefaultTreeExpander(getTree());
  CommonActionsManager.getInstance().createExpandAllAction(treeExpander,this);
  CommonActionsManager.getInstance().createCollapseAllAction(treeExpander,this);
  getTree().setShowsRootHandles(true);
  getTree().setLineStyleAngled();
  getTree().setRootVisible(showProjectNode);
  final ProjectFileIndex fileIndex=ProjectRootManager.getInstance(project).getFileIndex();
  getTree().setCellRenderer(new DefaultTreeCellRenderer(){
    private SimpleColoredComponent myComponent=new SimpleColoredComponent();
    @Override public Component getTreeCellRendererComponent(    JTree tree,    Object value,    boolean sel,    boolean expanded,    boolean leaf,    int row,    boolean hasFocus){
      myComponent.clear();
      if (value instanceof ProjectRootNode) {
        myComponent.append(getProjectNodeText());
        myComponent.setIcon(AllIcons.Nodes.Project);
      }
 else {
        FileNode fileNode=(FileNode)value;
        VirtualFile file=fileNode.getObject();
        myComponent.append(fileNode.getParent() instanceof FileNode ? file.getName() : file.getPresentableUrl());
        Icon icon=file.isDirectory() ? fileIndex.isExcluded(file) ? AllIcons.Modules.ExcludeRoot : PlatformIcons.DIRECTORY_CLOSED_ICON : IconUtil.getIcon(file,0,null);
        myComponent.setIcon(icon);
      }
      SpeedSearchUtil.applySpeedSearchHighlighting(AbstractFileTreeTable.this,myComponent,false,selected);
      return myComponent;
    }
  }
);
  getTableHeader().setReorderingAllowed(false);
  setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
  setPreferredScrollableViewportSize(new Dimension(300,getRowHeight() * 10));
  getColumnModel().getColumn(0).setPreferredWidth(280);
  getColumnModel().getColumn(1).setPreferredWidth(60);
}
