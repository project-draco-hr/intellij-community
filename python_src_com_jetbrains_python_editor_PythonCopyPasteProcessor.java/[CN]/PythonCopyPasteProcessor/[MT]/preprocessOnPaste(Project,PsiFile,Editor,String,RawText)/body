{
  final CaretModel caretModel=editor.getCaretModel();
  final Document document=editor.getDocument();
  if (file instanceof PyFile && StringUtil.startsWithWhitespace(text) && StringUtil.endsWithLineBreak(text)) {
    final int caretOffset=caretModel.getOffset();
    final PsiElement element=PsiUtilCore.getElementAtOffset(file,caretOffset - 1);
    final int lineNumber=document.getLineNumber(caretOffset);
    final int offset=getLineStartSafeOffset(document,lineNumber);
    final PsiElement element1=PsiUtilCore.getElementAtOffset(file,offset);
    if (element instanceof PsiWhiteSpace && element == element1) {
      caretModel.moveToOffset(offset);
    }
  }
  return text;
}
