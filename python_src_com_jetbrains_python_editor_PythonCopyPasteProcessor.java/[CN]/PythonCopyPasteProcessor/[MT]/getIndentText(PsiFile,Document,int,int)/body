{
  final PsiElement nonWS=PyUtil.findNextNonWhitespaceAtOffset(file,caretOffset);
  int lineStartOffset=getLineStartSafeOffset(document,lineNumber);
  String indentText=document.getText(TextRange.create(lineStartOffset,caretOffset));
  if (nonWS != null && document.getLineNumber(nonWS.getTextOffset()) == lineNumber) {
    indentText=document.getText(TextRange.create(lineStartOffset,nonWS.getTextOffset()));
  }
 else   if (caretOffset == lineStartOffset) {
    final PsiElement ws=file.findElementAt(lineStartOffset);
    if (ws != null) {
      final String wsText=ws.getText();
      final List<String> strings=StringUtil.split(wsText,"\n");
      if (strings.size() >= 1) {
        indentText=strings.get(0);
      }
    }
  }
  return indentText;
}
