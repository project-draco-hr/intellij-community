{
  Promise<Void> callback;
  try {
    Runnable runnable=connectCancelHandler.getAndSet(null);
    if (runnable != null) {
      runnable.run();
    }
  }
  finally {
    callback=super.detachAndClose();
  }
  return callback;
}
