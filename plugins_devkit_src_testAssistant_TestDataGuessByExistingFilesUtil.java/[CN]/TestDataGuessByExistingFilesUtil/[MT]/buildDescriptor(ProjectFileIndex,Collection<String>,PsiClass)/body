{
  GotoFileModel gotoModel=new GotoFileModel(psiClass.getProject());
  Set<String> testNamesLowerCase=new HashSet<String>();
  for (  String testName : testNames) {
    testNamesLowerCase.add(testName.toLowerCase());
  }
  Set<TestLocationDescriptor> descriptors=new HashSet<TestLocationDescriptor>();
  MultiMap<String,String> map=getAllFileNames(testNames,gotoModel);
  for (  String name : map.keySet()) {
    ProgressManager.checkCanceled();
    boolean currentNameProcessed=false;
    for (    String test : map.get(name)) {
      final Object[] elements=gotoModel.getElementsByName(name,false,name);
      for (      Object element : elements) {
        if (!(element instanceof PsiFile)) {
          continue;
        }
        final VirtualFile file=((PsiFile)element).getVirtualFile();
        if (file == null || fileIndex.isInSource(file) && !fileIndex.isUnderSourceRootOfType(file,JavaModuleSourceRootTypes.RESOURCES)) {
          continue;
        }
        final String filePath=PathUtil.getFileName(file.getPath()).toLowerCase();
        int i=filePath.indexOf(test.toLowerCase());
        if (i < 0 || (i + test.length() < filePath.length()) && Character.isDigit(filePath.charAt(i + test.length()))) {
          continue;
        }
        TestLocationDescriptor current=new TestLocationDescriptor();
        current.populate(test,file);
        if (!current.isComplete()) {
          continue;
        }
        String prefixPattern=current.filePrefix.toLowerCase();
        boolean checkPrefix=!StringUtil.isEmpty(prefixPattern);
        String suffixPattern=current.fileSuffix;
        for (        TestLocationDescriptor descriptor : descriptors) {
          if (suffixPattern.endsWith(descriptor.fileSuffix)) {
            suffixPattern=suffixPattern.substring(0,suffixPattern.length() - descriptor.fileSuffix.length());
          }
        }
        suffixPattern=suffixPattern.toLowerCase();
        boolean checkSuffix=!StringUtil.isEmpty(suffixPattern);
        boolean skip=false;
        for (        String testName : testNamesLowerCase) {
          if (testName.equals(test)) {
            continue;
          }
          if ((checkPrefix && testName.startsWith(prefixPattern)) || (checkSuffix && testName.endsWith(suffixPattern))) {
            skip=true;
            break;
          }
        }
        if (skip) {
          continue;
        }
        currentNameProcessed=true;
        if (descriptors.isEmpty() || (descriptors.iterator().next().dir.equals(current.dir) && !descriptors.contains(current))) {
          descriptors.add(current);
          continue;
        }
        if (moreRelevantPath(current,descriptors,psiClass)) {
          descriptors.clear();
          descriptors.add(current);
        }
      }
      if (currentNameProcessed) {
        break;
      }
    }
  }
  return new TestDataDescriptor(descriptors);
}
