{
  if (psiFile != null) {
    PsiElement[] range=CodeInsightUtil.findStatementsInRange(psiFile,startOffset,endOffset);
    return range.length > 1 ? EvaluationMode.CODE_FRAGMENT : EvaluationMode.EXPRESSION;
  }
  return super.getEvaluationMode(text,startOffset,endOffset,null);
}
