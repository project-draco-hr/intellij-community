{
  if (parameters.getInvocationCount() != 0) {
    return;
  }
  PostfixLiveTemplate postfixLiveTemplate=getPostfixLiveTemplate(parameters.getOriginalFile(),parameters.getOffset());
  if (postfixLiveTemplate != null) {
    PsiFile file=parameters.getPosition().getContainingFile();
    final CustomTemplateCallback callback=new CustomTemplateCallback(parameters.getEditor(),file,false);
    String computedKey=postfixLiveTemplate.computeTemplateKey(callback);
    if (computedKey != null) {
      PostfixTemplate template=postfixLiveTemplate.getTemplateByKey(computedKey);
      if (template != null) {
        result=result.withPrefixMatcher(computedKey);
        result.restartCompletionOnPrefixChange(StandardPatterns.string().startsWith(computedKey));
        result.addElement(new PostfixTemplateLookupElement(template,postfixLiveTemplate.getShortcut()));
      }
    }
  }
}
