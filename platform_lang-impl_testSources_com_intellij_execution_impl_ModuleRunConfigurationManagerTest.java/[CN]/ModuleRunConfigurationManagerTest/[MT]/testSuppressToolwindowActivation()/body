{
  RunnerAndConfigurationSettings settings=new RunnerAndConfigurationSettingsImpl(new MyRunManagerImpl(),new MyModuleBasedConfiguration("my-name",getProject(),getModule()),false);
  settings.setActivateToolWindowBeforeRun(true);
  MockProgramRunner programRunner=new MockProgramRunner();
  ExecutionEnvironment env=new ExecutionEnvironmentBuilder(getProject(),DefaultRunExecutor.getRunExecutorInstance()).runnerAndSettings(programRunner,settings).build();
  RunContentDescriptor descriptorToReuse=new RunContentDescriptor(null,null,new JPanel(),"name");
  descriptorToReuse.setActivateToolWindowWhenAdded(false);
  descriptorToReuse.setReuseToolWindowActivation(true);
  env.setContentToReuse(descriptorToReuse);
  env.getRunner().execute(env);
  RunContentDescriptor lastDescriptor=programRunner.getLastDescriptor();
  assertNotNull(lastDescriptor);
  assertFalse(lastDescriptor.isActivateToolWindowWhenAdded());
  Disposer.dispose(descriptorToReuse);
}
