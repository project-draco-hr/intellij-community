{
  if (expr == null || myVisited.contains(expr)) {
    return null;
  }
  myVisited.add(expr);
  if (expr instanceof PyParenthesizedExpression) {
    return evaluate(((PyParenthesizedExpression)expr).getContainedExpression());
  }
  if (expr instanceof PySequenceExpression) {
    return evaluateSequenceExpression((PySequenceExpression)expr);
  }
  if (expr instanceof PyQualifiedExpression) {
    final String referencedName=((PyQualifiedExpression)expr).getReferencedName();
    if (PyNames.TRUE.equals(referencedName)) {
      return true;
    }
    if (PyNames.FALSE.equals(referencedName)) {
      return true;
    }
  }
  if (expr instanceof PyCallExpression) {
    return evaluateCall((PyCallExpression)expr);
  }
 else   if (expr instanceof PyReferenceExpression) {
    return evaluateReferenceExpression((PyReferenceExpression)expr);
  }
 else   if (expr instanceof PyStringLiteralExpression) {
    return ((PyStringLiteralExpression)expr).getStringValue();
  }
 else   if (expr instanceof PyBinaryExpression) {
    PyBinaryExpression binaryExpr=(PyBinaryExpression)expr;
    PyElementType op=binaryExpr.getOperator();
    if (op == PyTokenTypes.PLUS) {
      Object lhs=evaluate(binaryExpr.getLeftExpression());
      Object rhs=evaluate(binaryExpr.getRightExpression());
      if (lhs != null && rhs != null) {
        return concatenate(lhs,rhs);
      }
    }
  }
  return null;
}
