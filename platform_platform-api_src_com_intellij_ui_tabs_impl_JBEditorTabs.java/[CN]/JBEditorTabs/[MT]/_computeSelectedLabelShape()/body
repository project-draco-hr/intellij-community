{
  final ShapeInfo shape=new ShapeInfo();
  shape.path=getEffectiveLayout().createShapeTransform(getSize());
  shape.insets=shape.path.transformInsets(getLayoutInsets());
  shape.labelPath=shape.path.createTransform(getSelectedLabel().getBounds());
  shape.labelBottomY=shape.labelPath.getMaxY() - shape.labelPath.deltaY(getActiveTabUnderlineHeight() - 1);
  boolean isTop=getPosition() == JBTabsPosition.top;
  boolean isBottom=getPosition() == JBTabsPosition.bottom;
  shape.labelTopY=shape.labelPath.getY() + (isTop ? shape.labelPath.deltaY(1) : isBottom ? shape.labelPath.deltaY(-1) : 0);
  shape.labelLeftX=shape.labelPath.getX() + (isTop || isBottom ? 0 : shape.labelPath.deltaX(1));
  shape.labelRightX=shape.labelPath.getMaxX();
  int leftX=shape.insets.left + (isTop || isBottom ? 0 : shape.labelPath.deltaX(1));
  shape.path.moveTo(leftX,shape.labelBottomY);
  shape.path.lineTo(shape.labelLeftX,shape.labelBottomY);
  shape.path.lineTo(shape.labelLeftX,shape.labelTopY);
  shape.path.lineTo(shape.labelRightX,shape.labelTopY);
  shape.path.lineTo(shape.labelRightX,shape.labelBottomY);
  int lastX=shape.path.getWidth() - shape.path.deltaX(shape.insets.right);
  shape.path.lineTo(lastX,shape.labelBottomY);
  shape.path.lineTo(lastX,shape.labelBottomY + shape.labelPath.deltaY(getActiveTabUnderlineHeight()));
  shape.path.lineTo(leftX,shape.labelBottomY + shape.labelPath.deltaY(getActiveTabUnderlineHeight()));
  shape.path.closePath();
  shape.fillPath=shape.path.copy();
  return shape;
}
