{
  final Balloon balloon=JBPopupFactory.getInstance().createBalloonBuilder(component).setShadow(true).setAnimationCycle(0).setHideOnClickOutside(true).setHideOnKeyOutside(true).setHideOnAction(false).setFillColor(UIUtil.getControlColor()).createBalloon();
  new AnAction(){
    @Override public void actionPerformed(    AnActionEvent e){
      balloon.hide();
    }
  }
.registerCustomShortcutSet(CommonShortcuts.ESCAPE,component);
  Disposer.register(newFile.getProject(),balloon);
  final Balloon.Position position=QuickEditAction.getBalloonPosition(editor);
  RelativePoint point=JBPopupFactory.getInstance().guessBestPopupLocation(editor);
  if (position == Balloon.Position.above) {
    final Point p=point.getPoint();
    point=new RelativePoint(point.getComponent(),new Point(p.x,p.y - editor.getLineHeight()));
  }
  balloon.show(point,position);
}
