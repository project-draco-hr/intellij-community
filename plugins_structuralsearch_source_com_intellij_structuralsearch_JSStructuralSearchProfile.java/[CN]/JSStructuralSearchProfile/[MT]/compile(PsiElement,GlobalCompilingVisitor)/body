{
  element.accept(new MyCompilingVisitor(globalVisitor){
    @Override public void visitElement(    final PsiElement element){
      super.visitElement(element);
      if (element instanceof JSStatement) {
        CompiledPattern pattern=myGlobalVisitor.getContext().getPattern();
        MatchingHandler handler=pattern.getHandler(element);
        if (handler.getFilter() == null) {
          handler.setFilter(new NodeFilter(){
            public boolean accepts(            PsiElement e){
              if (e instanceof JSBlockStatement) {
                e=extractOnlyStatement((JSBlockStatement)e);
              }
              return DefaultFilter.accepts(element instanceof JSBlockStatement ? extractOnlyStatement((JSBlockStatement)element) : element,e);
            }
          }
);
        }
      }
    }
  }
);
}
