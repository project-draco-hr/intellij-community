{
  Editor editor=null;
  if (fileTypes != null) {
    final FileType fileType=(FileType)fileTypes.getSelectedItem();
    final Language dialect=(Language)dialects.getSelectedItem();
    final StructuralSearchProfile profile=StructuralSearchUtil.getProfileByFileType(fileType);
    if (profile != null) {
      editor=profile.createEditor(searchContext,fileType,dialect,text,useLastConfiguration);
    }
  }
  if (editor == null) {
    final EditorFactory factory=EditorFactory.getInstance();
    final Document document=factory.createDocument("");
    editor=factory.createEditor(document,searchContext.getProject());
    editor.getSettings().setFoldingOutlineShown(false);
  }
  editor.getDocument().addDocumentListener(new DocumentListener(){
    @Override public void beforeDocumentChange(    final DocumentEvent event){
    }
    @Override public void documentChanged(    final DocumentEvent event){
      initiateValidation();
    }
  }
);
  return editor;
}
