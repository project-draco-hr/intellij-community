{
  StructuralSearchPlugin.getInstance(getProject()).setDialogVisible(true);
  searchCriteriaEdit.putUserData(SubstitutionShortInfoHandler.CURRENT_CONFIGURATION_KEY,model.getConfig());
  if (!useLastConfiguration) {
    final Editor editor=FileEditorManager.getInstance(searchContext.getProject()).getSelectedTextEditor();
    boolean setSomeText=false;
    if (editor != null) {
      final SelectionModel selectionModel=editor.getSelectionModel();
      if (selectionModel.hasSelection()) {
        addOrReplaceSelection(selectionModel.getSelectedText());
        existingTemplatesComponent.getPatternTree().setSelectionPath(null);
        existingTemplatesComponent.getHistoryList().setSelectedIndex(-1);
        setSomeText=true;
      }
    }
    if (!setSomeText) {
      int selection=existingTemplatesComponent.getHistoryList().getSelectedIndex();
      if (selection != -1) {
        setValuesFromConfig((Configuration)existingTemplatesComponent.getHistoryList().getSelectedValue());
      }
    }
  }
  initiateValidation();
  super.show();
}
