{
  final PsiElement element=descriptor.getPsiElement();
  final PsiElement parent=element.getParent();
  if (!(parent instanceof PsiJavaCodeReferenceElement)) {
    return;
  }
  final StringBuilder newElementText=new StringBuilder(typeString);
  final PsiJavaCodeReferenceElement referenceElement=(PsiJavaCodeReferenceElement)parent;
  final PsiReferenceParameterList parameterList=referenceElement.getParameterList();
  if (parameterList != null) {
    newElementText.append(parameterList.getText());
  }
  final PsiElement grandParent=parent.getParent();
  if (!(grandParent instanceof PsiTypeElement)) {
    return;
  }
  final PsiElementFactory factory=JavaPsiFacade.getElementFactory(project);
  final PsiTypeElement newTypeElement=factory.createTypeElementFromText(newElementText.toString(),element);
  JavaCodeStyleManager.getInstance(project).shortenClassReferences(grandParent.replace(newTypeElement));
}
