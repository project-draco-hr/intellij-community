{
  UpdatesInfo updateInfo;
  try {
    URIBuilder uriBuilder=new URIBuilder(getUpdateUrl());
    if (!URLUtil.FILE_PROTOCOL.equals(uriBuilder.getScheme())) {
      prepareUpdateCheckArgs(uriBuilder);
    }
    String updateUrl=uriBuilder.build().toString();
    LogUtil.debug(LOG,"load update xml (UPDATE_URL='%s')",updateUrl);
    updateInfo=HttpRequests.request(updateUrl).forceHttps(settings.canUseSecureConnection()).connect(new HttpRequests.RequestProcessor<UpdatesInfo>(){
      @Override public UpdatesInfo process(      @NotNull HttpRequests.Request request) throws IOException {
        try {
          return new UpdatesInfo(JDOMUtil.load(request.getReader()));
        }
 catch (        JDOMException e) {
          LOG.info(e);
          return null;
        }
      }
    }
);
  }
 catch (  URISyntaxException e) {
    return new CheckForUpdateResult(UpdateStrategy.State.CONNECTION_ERROR,e);
  }
catch (  IOException e) {
    return new CheckForUpdateResult(UpdateStrategy.State.CONNECTION_ERROR,e);
  }
  if (updateInfo == null) {
    return new CheckForUpdateResult(UpdateStrategy.State.NOTHING_LOADED,null);
  }
  ApplicationInfo appInfo=ApplicationInfo.getInstance();
  int majorVersion=Integer.parseInt(appInfo.getMajorVersion());
  UpdateStrategy strategy=new UpdateStrategy(majorVersion,appInfo.getBuild(),updateInfo,settings);
  return strategy.checkForUpdates();
}
