{
  checkNotDisposed();
  if (myParentBus != null) {
    LOG.assertTrue(myParentBus.myChildBuses.contains(this));
    myParentBus.pumpMessages();
  }
 else {
    Map<MessageBusImpl,Integer> map=asRoot().myWaitingBuses.get();
    if (map != null) {
      Set<MessageBusImpl> buses=map.keySet();
      if (!buses.isEmpty()) {
        for (        MessageBusImpl bus : new ArrayList<MessageBusImpl>(buses)) {
          if (bus.myDisposed) {
            map.remove(bus);
            LOG.error("Accessing disposed message bus " + bus);
            continue;
          }
          bus.doPumpMessages();
        }
      }
    }
  }
}
