{
  DebuggerManagerThreadImpl.assertIsManagerThread();
  InvalidStackFrameException error=null;
  for (int attempt=0; attempt < 2; attempt++) {
    try {
      final List<LocalVariable> list=getStackFrame().visibleVariables();
      final List<LocalVariableProxyImpl> locals=new ArrayList<LocalVariableProxyImpl>(list.size());
      for (      LocalVariable localVariable : list) {
        LOG.assertTrue(localVariable != null);
        locals.add(new LocalVariableProxyImpl(this,localVariable));
      }
      return locals;
    }
 catch (    InvalidStackFrameException e) {
      error=e;
      clearCaches();
    }
catch (    AbsentInformationException e) {
      throw EvaluateExceptionUtil.createEvaluateException(e);
    }
  }
  if (error != null) {
    throw new EvaluateException(error.getMessage(),error);
  }
  return Collections.emptyList();
}
