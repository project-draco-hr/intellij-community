{
  DebuggerManagerThreadImpl.assertIsManagerThread();
  InvalidStackFrameException error=null;
  for (int attempt=0; attempt < 2; attempt++) {
    try {
      final LocalVariable variable=localVariable.getVariable();
      final StackFrame stackFrame=getStackFrame();
      stackFrame.setValue(variable,(value instanceof ObjectReference) ? ((ObjectReference)value) : value);
      if (myAllValues != null) {
        myAllValues.put(variable,stackFrame.getValue(variable));
      }
      return;
    }
 catch (    InvalidStackFrameException e) {
      error=e;
      clearCaches();
    }
  }
  if (error != null) {
    throw new EvaluateException(error.getMessage(),error);
  }
}
