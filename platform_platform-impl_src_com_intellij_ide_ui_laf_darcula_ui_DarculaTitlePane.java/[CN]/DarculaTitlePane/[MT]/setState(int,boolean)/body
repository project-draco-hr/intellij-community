{
  Window wnd=getWindow();
  if (wnd != null && getWindowDecorationStyle() == JRootPane.FRAME) {
    if (myState == state && !updateRegardless) {
      return;
    }
    Frame frame=getFrame();
    if (frame != null) {
      JRootPane rootPane=getRootPane();
      if (((state & Frame.MAXIMIZED_BOTH) != 0) && (rootPane.getBorder() == null || (rootPane.getBorder() instanceof UIResource)) && frame.isShowing()) {
        rootPane.setBorder(null);
      }
 else       if ((state & Frame.MAXIMIZED_BOTH) == 0) {
        rootPaneUI.installBorder(rootPane);
      }
      if (frame.isResizable()) {
        if ((state & Frame.MAXIMIZED_BOTH) != 0) {
          updateToggleButton(myRestoreAction,myMinimizeIcon);
          myMaximizeAction.setEnabled(false);
          myRestoreAction.setEnabled(true);
        }
 else {
          updateToggleButton(myMaximizeAction,myMaximizeIcon);
          myMaximizeAction.setEnabled(true);
          myRestoreAction.setEnabled(false);
        }
        if (myToggleButton.getParent() == null || myIconifyButton.getParent() == null) {
          add(myToggleButton);
          add(myIconifyButton);
          revalidate();
          repaint();
        }
        myToggleButton.setText(null);
      }
 else {
        myMaximizeAction.setEnabled(false);
        myRestoreAction.setEnabled(false);
        if (myToggleButton.getParent() != null) {
          remove(myToggleButton);
          revalidate();
          repaint();
        }
      }
    }
 else {
      myMaximizeAction.setEnabled(false);
      myRestoreAction.setEnabled(false);
      myIconifyAction.setEnabled(false);
      remove(myToggleButton);
      remove(myIconifyButton);
      revalidate();
      repaint();
    }
    myCloseAction.setEnabled(true);
    myState=state;
  }
}
