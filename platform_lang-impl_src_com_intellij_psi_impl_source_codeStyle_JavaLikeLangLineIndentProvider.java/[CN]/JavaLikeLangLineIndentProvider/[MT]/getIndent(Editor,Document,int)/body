{
  CharSequence docChars=document.getCharsSequence();
  EditorHighlighter highlighter=((EditorEx)editor).getHighlighter();
  HighlighterIterator iterator=highlighter.createIterator(offset - 1);
  if (isWhitespace(iterator.getTokenType())) {
    if (containsLineBreaks(iterator,docChars)) {
      iterator.retreat();
      if (!iterator.atEnd()) {
        if (isEndOfCodeBlock(iterator))         return Indent.Type.NONE;
      }
    }
  }
  return null;
}
