{
  CharSequence docChars=editor.getDocument().getCharsSequence();
  if (offset > 0) {
    int indentLineOffset=getOffsetInBaseIndentLine(editor,docChars,afterElement,offset - 1);
    if (indentLineOffset > 0) {
      int indentStart=CharArrayUtil.shiftBackwardUntil(docChars,indentLineOffset,"\n") + 1;
      if (indentStart >= 0) {
        int indentEnd=CharArrayUtil.shiftForward(docChars,indentStart," \t");
        if (indentEnd > indentStart) {
          return docChars.subSequence(indentStart,indentEnd).toString();
        }
      }
    }
  }
  return "";
}
