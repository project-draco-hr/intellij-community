{
  GraphicsConfig config=GraphicsUtil.setupAAPainting(g);
  int x=isMirrored() ? 3 : 5;
  int paintWidth=width;
  boolean flatStyle=Registry.is("ide.new.markup.markers");
  if (thinErrorStripeMark) {
    paintWidth/=2;
    paintWidth+=flatStyle ? -2 : 1;
    x=isMirrored() ? width + 2 : 0;
    if (yEnd - yStart < 6) {
      yStart-=1;
      yEnd+=yEnd - yStart - 1;
    }
  }
  if (color == null)   return;
  Color darker=color;
  if (!UIUtil.isUnderDarcula()) {
    float[] hsb=Color.RGBtoHSB(color.getRed(),color.getGreen(),color.getBlue(),null);
    hsb[2]=Math.min(1f,hsb[2] * 0.85f);
    darker=new Color(Color.HSBtoRGB(hsb[0],hsb[1],hsb[2]));
  }
  if (flatStyle) {
    g.setColor(darker);
    g.fillRoundRect(x,yStart,paintWidth,yEnd - yStart,3,3);
    config.restore();
    return;
  }
  g.setColor(color);
  g.fillRect(x + 1,yStart,paintWidth - 2,yEnd - yStart + 1);
  Color brighter=color.brighter();
  g.setColor(brighter);
  UIUtil.drawLine(g,x,yStart,x,yEnd);
  if (drawTopDecoration) {
    UIUtil.drawLine(g,x + 1,yStart,x + paintWidth - 2,yStart);
  }
  g.setColor(darker);
  if (drawBottomDecoration) {
    UIUtil.drawLine(g,x + 1,yEnd,x + paintWidth - 2,yEnd);
  }
  UIUtil.drawLine(g,x + paintWidth - 2,yStart,x + paintWidth - 2,yEnd);
  config.restore();
}
