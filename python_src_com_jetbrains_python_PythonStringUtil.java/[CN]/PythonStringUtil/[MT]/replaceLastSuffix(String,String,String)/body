{
  Pair<String,String> quotes=null;
  if (isQuoted(s)) {
    quotes=getQuotes(s);
    s=stripQuotesAroundValue(s);
  }
  s=removeLastSuffix(s,separator);
  if (s.length() > 0) {
    s+=separator;
  }
  s+=newElementName;
  if (quotes != null) {
    s=quotes.first + s + quotes.second;
  }
  return s;
}
