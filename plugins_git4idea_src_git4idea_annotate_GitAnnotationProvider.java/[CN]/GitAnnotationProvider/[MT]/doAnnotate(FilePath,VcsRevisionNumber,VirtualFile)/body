{
  setProgressIndicatorText(GitBundle.message("computing.annotation",file.getName()));
  VirtualFile root=GitUtil.getGitRoot(repositoryFilePath);
  GitSimpleHandler h=new GitSimpleHandler(myProject,root,GitCommand.BLAME);
  h.setStdoutSuppressed(true);
  h.addParameters("--porcelain","-l","-t","-w");
  if (revision == null) {
    h.addParameters("HEAD");
  }
 else {
    h.addParameters(revision.asString());
  }
  h.endOptions();
  h.addRelativePaths(repositoryFilePath);
  String output=h.run();
  GitFileAnnotation fileAnnotation=parseAnnotations(revision,file,root,output);
  loadFileHistoryInBackground(fileAnnotation);
  return fileAnnotation;
}
