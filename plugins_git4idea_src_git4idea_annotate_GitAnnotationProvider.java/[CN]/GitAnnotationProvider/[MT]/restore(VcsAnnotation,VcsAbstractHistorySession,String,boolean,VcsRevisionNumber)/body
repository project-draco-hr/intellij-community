{
  VirtualFile virtualFile=vcsAnnotation.getFilePath().getVirtualFile();
  if (virtualFile == null)   return null;
  final VcsLineAnnotationData basicAnnotation=vcsAnnotation.getBasicAnnotation();
  final int size=basicAnnotation.getNumLines();
  final Map<VcsRevisionNumber,VcsFileRevision> historyAsMap=session.getHistoryAsMap();
  final List<LineInfo> lines=new ArrayList<LineInfo>();
  for (int i=0; i < size; i++) {
    final VcsRevisionNumber revision=basicAnnotation.getRevision(i);
    final VcsFileRevision vcsFileRevision=historyAsMap.get(revision);
    if (vcsFileRevision == null) {
      return null;
    }
    lines.add(new LineInfo(vcsFileRevision.getRevisionDate(),(GitRevisionNumber)revision,vcsFileRevision.getAuthor()));
  }
  return new GitFileAnnotation(myProject,virtualFile,revisionNumber,annotatedContent,lines,session.getRevisionList());
}
