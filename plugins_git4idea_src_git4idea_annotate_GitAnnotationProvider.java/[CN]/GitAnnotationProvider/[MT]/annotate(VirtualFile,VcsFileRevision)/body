{
  if (file.isDirectory()) {
    throw new VcsException("Cannot annotate a directory");
  }
  final FilePath currentFilePath=VcsUtil.getFilePath(file.getPath());
  final FilePath realFilePath;
  if (revision == null) {
    realFilePath=GitHistoryUtils.getLastCommitName(myProject,currentFilePath);
  }
 else {
    realFilePath=((GitFileRevision)revision).getPath();
  }
  VcsRevisionNumber revisionNumber=revision != null ? revision.getRevisionNumber() : null;
  return annotate(realFilePath,revisionNumber,file);
}
