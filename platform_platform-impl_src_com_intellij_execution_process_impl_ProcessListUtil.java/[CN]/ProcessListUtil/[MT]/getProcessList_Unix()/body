{
  File proc=new File("/proc");
  File[] processes=proc.listFiles();
  if (processes == null) {
    LOG.error("Cannot read /proc, not mounted?");
    return null;
  }
  List<ProcessInfo> result=new ArrayList<ProcessInfo>();
  for (  File each : processes) {
    int pid=StringUtil.parseInt(each.getName(),-1);
    if (pid == -1)     continue;
    List<String> cmdline;
    try {
      FileInputStream stream=new FileInputStream(new File(each,"cmdline"));
      try {
        String cmdlineString=new String(FileUtil.loadBytes(stream));
        cmdline=StringUtil.split(cmdlineString,"\0");
      }
  finally {
        stream.close();
      }
    }
 catch (    IOException e) {
      continue;
    }
    if (cmdline.isEmpty())     continue;
    String executablePath=null;
    try {
      File exe=new File(each,"exe");
      if (!exe.getAbsolutePath().equals(exe.getCanonicalPath())) {
        executablePath=exe.getCanonicalPath();
      }
    }
 catch (    IOException e) {
    }
    result.add(new ProcessInfo(pid,StringUtil.join(cmdline," "),PathUtil.getFileName(cmdline.get(0)),StringUtil.join(cmdline.subList(1,cmdline.size())," "),executablePath));
  }
  return result;
}
