{
  Set<ExternalSystemTaskId> ids=null;
  while (ids == null) {
    if (myListeners.containsKey(listener)) {
      ids=myListeners.get(listener);
    }
 else {
      ids=myListeners.putIfAbsent(listener,ContainerUtil.<ExternalSystemTaskId>newConcurrentSet());
    }
  }
  return ids.add(taskId);
}
