{
  final String dirName=myConfiguration.getPersistentData().getDirName();
  final VirtualFile file=LocalFileSystem.getInstance().findFileByPath(FileUtil.toSystemIndependentName(dirName));
  final GlobalSearchScope globalSearchScope=file == null ? GlobalSearchScope.EMPTY_SCOPE : GlobalSearchScopesCore.directoryScope(myConfiguration.getProject(),file,true);
  return new SourceScope(){
    @Override public GlobalSearchScope getGlobalSearchScope(){
      return globalSearchScope;
    }
    @Override public Project getProject(){
      return myConfiguration.getProject();
    }
    @Override public GlobalSearchScope getLibrariesScope(){
      final Module module=myConfiguration.getConfigurationModule().getModule();
      return module != null ? GlobalSearchScope.moduleWithLibrariesScope(module) : GlobalSearchScope.allScope(myConfiguration.getProject());
    }
    @Override public Module[] getModulesToCompile(){
      final Collection<Module> validModules=myConfiguration.getValidModules();
      return validModules.toArray(new Module[validModules.size()]);
    }
  }
;
}
