{
  JqlFieldType operandType;
  boolean listFunctionExpected;
  PsiElement curElem=parameters.getPosition();
  JqlHistoryPredicate predicate=PsiTreeUtil.getParentOfType(curElem,JqlHistoryPredicate.class);
  if (predicate != null) {
    listFunctionExpected=false;
    JqlHistoryPredicate.Type predicateType=predicate.getType();
switch (predicateType) {
case BEFORE:
case AFTER:
case DURING:
case ON:
      operandType=JqlFieldType.DATE;
    break;
case BY:
  operandType=JqlFieldType.USER;
break;
default :
operandType=findTypeOfField(curElem);
}
}
 else {
operandType=findTypeOfField(curElem);
listFunctionExpected=insideClauseWithListOperator(curElem);
}
for (String functionName : JqlStandardFunction.allOfType(operandType,listFunctionExpected)) {
result.addElement(LookupElementBuilder.create(functionName).withInsertHandler(ParenthesesInsertHandler.NO_PARAMETERS));
}
}
