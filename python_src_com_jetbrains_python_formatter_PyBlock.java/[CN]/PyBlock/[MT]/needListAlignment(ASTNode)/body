{
  final IElementType childType=child.getElementType();
  final ASTNode firstGrandchild=child.getFirstChildNode();
  final IElementType firstGrandchildType=firstGrandchild == null ? null : firstGrandchild.getElementType();
  if (PyTokenTypes.OPEN_BRACES.contains(childType)) {
    return false;
  }
  if (PyTokenTypes.OPEN_BRACES.contains(firstGrandchildType)) {
    final PsiElement psi=child.getPsi();
    if (psi instanceof PySequenceExpression && ((PySequenceExpression)psi).getElements().length == 0) {
      return false;
    }
  }
  if (PyTokenTypes.CLOSE_BRACES.contains(childType)) {
    final ASTNode prevNonSpace=findPrevNonSpaceNode(child);
    if (prevNonSpace != null && prevNonSpace.getElementType() == PyTokenTypes.COMMA && myContext.getMode() == FormattingMode.ADJUST_INDENT) {
      return true;
    }
    return !hasHangingIndent(myNode.getPsi());
  }
  if (myNode.getElementType() == PyElementTypes.ARGUMENT_LIST) {
    if (!myContext.getSettings().ALIGN_MULTILINE_PARAMETERS_IN_CALLS || hasHangingIndent(myNode.getPsi())) {
      return false;
    }
    if (child.getElementType() == PyTokenTypes.COMMA) {
      return false;
    }
    return true;
  }
  if (myNode.getElementType() == PyElementTypes.PARAMETER_LIST) {
    return !hasHangingIndent(myNode.getPsi()) && myContext.getSettings().ALIGN_MULTILINE_PARAMETERS;
  }
  if (myNode.getElementType() == PyElementTypes.SUBSCRIPTION_EXPRESSION) {
    return false;
  }
  if (child.getElementType() == PyTokenTypes.COMMA) {
    return false;
  }
  return myContext.getPySettings().ALIGN_COLLECTIONS_AND_COMPREHENSIONS;
}
