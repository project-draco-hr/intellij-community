{
  if (homePath == null || !new File(homePath).exists()) {
    return new ProcessOutput();
  }
  try {
    List<String> commands=new ArrayList<String>();
    if (SystemInfo.isWindows && StringUtil.endsWithIgnoreCase(command[0],".bat")) {
      commands.add("cmd");
      commands.add("/c");
    }
    Collections.addAll(commands,command);
    Process process=Runtime.getRuntime().exec(ArrayUtil.toStringArray(commands),null,new File(homePath));
    CapturingProcessHandler processHandler=new CapturingProcessHandler(process);
    return processHandler.runProcess(timeout);
  }
 catch (  IOException ex) {
    LOG.info(ex);
    return new ProcessOutput();
  }
}
