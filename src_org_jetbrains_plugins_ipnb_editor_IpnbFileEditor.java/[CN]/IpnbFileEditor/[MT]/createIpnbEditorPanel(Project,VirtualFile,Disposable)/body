{
  try {
    return new IpnbFilePanel(project,parent,IpnbParser.parseIpnbFile(new String(vFile.contentsToByteArray(),CharsetToolkit.UTF8)),new CellSelectionListener(){
      @Override public void selectionChanged(      @NotNull IpnbPanel ipnbPanel){
        if (ipnbPanel instanceof HeadingPanel) {
          final HeadingCell cell=((HeadingPanel)ipnbPanel).getCell();
          final int level=cell.getLevel();
          myCellTypeCombo.setSelectedItem(headingCellType + level);
        }
 else         if (ipnbPanel instanceof MarkdownPanel) {
          myCellTypeCombo.setSelectedItem(markdownCellType);
        }
 else         if (ipnbPanel instanceof CodePanel) {
          myCellTypeCombo.setSelectedItem(codeCellType);
        }
      }
    }
);
  }
 catch (  IOException e) {
    Messages.showErrorDialog(project,e.getMessage(),"Can't open " + vFile.getPath());
    throw new IllegalStateException(e);
  }
}
