{
  final InspectionProfile profile=InspectionProjectProfileManager.getInstance(project).getInspectionProfile();
  final String shortName=toolWrapper.getShortName();
  final HighlightDisplayKey key=HighlightDisplayKey.find(shortName);
  if (key == null) {
    HighlightDisplayKey.register(shortName,toolWrapper.getDisplayName(),toolWrapper.getID());
  }
  InspectionProfileImpl.initAndDo(new Computable(){
    @Override public Object compute(){
      InspectionProfileImpl impl=(InspectionProfileImpl)profile;
      InspectionToolWrapper existingWrapper=impl.getInspectionTool(shortName,project);
      if (existingWrapper == null || existingWrapper.isInitialized() != toolWrapper.isInitialized() || toolWrapper.isInitialized() && toolWrapper.getTool() != existingWrapper.getTool()) {
        impl.addTool(project,toolWrapper,new THashMap<String,List<String>>());
      }
      impl.enableTool(shortName,project);
      return null;
    }
  }
);
}
