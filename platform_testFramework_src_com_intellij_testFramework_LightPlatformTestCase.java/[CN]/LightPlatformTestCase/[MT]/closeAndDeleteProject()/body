{
  if (ourProject != null) {
    ApplicationManager.getApplication().assertWriteAccessAllowed();
    ((ProjectImpl)ourProject).setTemporarilyDisposed(false);
    VirtualFile projectFile=((ProjectEx)ourProject).getStateStore().getProjectFile();
    File ioFile=projectFile == null ? null : VfsUtilCore.virtualToIoFile(projectFile);
    if (!ourProject.isDisposed())     Disposer.dispose(ourProject);
    if (ioFile != null) {
      File dir=ioFile.getParentFile();
      if (dir.getName().startsWith(UsefulTestCase.TEMP_DIR_MARKER)) {
        FileUtil.delete(dir);
      }
 else {
        FileUtil.delete(ioFile);
      }
    }
    ProjectManagerEx.getInstanceEx().closeTestProject(ourProject);
    ourProject=null;
    ourPathToKeep=null;
  }
}
