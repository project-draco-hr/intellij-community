{
  if (ourProject != null) {
    ApplicationManager.getApplication().assertWriteAccessAllowed();
    if (!ourProject.isDisposed()) {
      VirtualFile projectFile=ourProject.getProjectFile();
      File ioFile=projectFile == null ? null : VfsUtilCore.virtualToIoFile(projectFile);
      Disposer.dispose(ourProject);
      if (ioFile != null) {
        File dir=ioFile.getParentFile();
        if (dir.getName().startsWith(UsefulTestCase.TEMP_DIR_MARKER)) {
          FileUtil.delete(dir);
        }
 else {
          FileUtil.delete(ioFile);
        }
      }
    }
    ProjectManagerEx.getInstanceEx().closeAndDispose(ourProject);
    if (ourPathToKeep != null) {
      File parent=new File(ourPathToKeep).getParentFile();
      if (parent.getName().startsWith(UsefulTestCase.TEMP_DIR_MARKER)) {
        parent.delete();
      }
    }
    ourProject=null;
    ourPathToKeep=null;
  }
}
