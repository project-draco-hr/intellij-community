{
  if (ourProject != null) {
    ApplicationManager.getApplication().assertWriteAccessAllowed();
    if (!ourProject.isDisposed()) {
      File ioFile=new File(ourProject.getProjectFilePath());
      Disposer.dispose(ourProject);
      if (ioFile.exists()) {
        File dir=ioFile.getParentFile();
        if (dir.getName().startsWith(UsefulTestCase.TEMP_DIR_MARKER)) {
          FileUtil.delete(dir);
        }
 else {
          FileUtil.delete(ioFile);
        }
      }
    }
    ProjectManagerEx.getInstanceEx().closeAndDispose(ourProject);
    if (ourPathToKeep != null) {
      File parent=new File(ourPathToKeep).getParentFile();
      if (parent.getName().startsWith(UsefulTestCase.TEMP_DIR_MARKER)) {
        parent.delete();
      }
    }
    ourProject=null;
    ourPathToKeep=null;
  }
}
