{
  UIUtil.invokeLaterIfNeeded(new Runnable(){
    @Override public void run(){
      if ((project == null) || project.isDisposed()) {
        emptyTextAndTooltip();
        return;
      }
      final HgRepository repo=HgUtil.getCurrentRepository(project);
      if (repo == null) {
        emptyTextAndTooltip();
        return;
      }
      myText=StringUtil.shortenTextWithEllipsis(HgUtil.getDisplayableBranchOrBookmarkText(repo),MAX_STRING.length(),5);
      myTooltip=HgUtil.getDisplayableBranchOrBookmarkText(repo);
      if (!isDisposed() && myStatusBar != null) {
        myStatusBar.updateWidget(ID());
      }
    }
  }
);
}
