{
  @SuppressWarnings("UnsafeVfsRecursion") VirtualFile[] fromChildren=from.getChildren();
  for (  VirtualFile fromChild : fromChildren) {
    if (fromChild.is(VFileProperty.SYMLINK) || fromChild.is(VFileProperty.SPECIAL))     continue;
    VirtualFile toChild=to.findChild(fromChild.getName());
    if (toChild != null && fromChild.isDirectory() != toChild.isDirectory()) {
      renameToBackupCopy(toChild);
      toChild=null;
    }
    if (fromChild.isDirectory()) {
      if (toChild == null) {
        toChild=to.createChildDirectory(ExtensionsRootType.class,fromChild.getName());
      }
      extractResources(fromChild,toChild);
    }
 else {
      if (toChild != null) {
        String fromHash=hash(fromChild);
        String toHash=hash(toChild);
        boolean upToDate=fromHash != null && toHash != null && StringUtil.equals(fromHash,toHash);
        if (upToDate) {
          continue;
        }
 else {
          renameToBackupCopy(toChild);
        }
      }
      toChild=to.createChildData(ExtensionsRootType.class,fromChild.getName());
      toChild.setBinaryContent(fromChild.contentsToByteArray());
    }
  }
}
