{
  VirtualFile resourcesDirectory=findExtensionsDirectory(pluginId,path,true);
  if (resourcesDirectory == null)   return;
  IdeaPluginDescriptor plugin=PluginManager.getPlugin(pluginId);
  ClassLoader classLoader=plugin != null ? plugin.getPluginClassLoader() : null;
  if (classLoader == null)   return;
  Application application=ApplicationManager.getApplication();
  Enumeration<URL> bundledResources=classLoader.getResources(EXTENSIONS_PATH + "/" + path);
  while (bundledResources.hasMoreElements()) {
    URL bundledResourceDirUrl=bundledResources.nextElement();
    VirtualFile bundledResourcesDir=VfsUtil.findFileByURL(bundledResourceDirUrl);
    if (!bundledResourcesDir.isDirectory())     continue;
    AccessToken token=application.acquireWriteActionLock(ExtensionsRootType.class);
    try {
      FileDocumentManager.getInstance().saveAllDocuments();
      extractResources(bundledResourcesDir,resourcesDirectory);
    }
  finally {
      token.finish();
    }
  }
}
