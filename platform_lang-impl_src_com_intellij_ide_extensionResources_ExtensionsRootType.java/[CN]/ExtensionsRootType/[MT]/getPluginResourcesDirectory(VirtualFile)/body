{
  if (virtualFile == null)   return null;
  VirtualFile root=getRootDirectory();
  if (root == null)   return null;
  VirtualFile parent=virtualFile;
  VirtualFile file=virtualFile;
  while (parent != null && !root.equals(parent)) {
    file=parent;
    parent=file.getParent();
  }
  return parent != null && file.isDirectory() ? file : null;
}
