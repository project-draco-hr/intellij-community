{
  PsiClass aClass=PsiTreeUtil.getParentOfType(element,PsiClass.class);
  if (memberClass != null && PsiTreeUtil.isAncestor(aClass,memberClass,false) || aClass != null && PsiTreeUtil.isAncestor(memberClass,aClass,false)) {
    PsiAnnotation annotation=PsiTreeUtil.getParentOfType(element,PsiAnnotation.class);
    if (annotation != null && annotation.getParent() instanceof PsiModifierList && annotation.getParent().getParent() == aClass) {
      return PsiUtil.ACCESS_LEVEL_PACKAGE_LOCAL;
    }
    return PsiUtil.ACCESS_LEVEL_PRIVATE;
  }
  PsiDirectory directory=file.getContainingDirectory();
  PsiPackage aPackage=directory == null ? null : JavaDirectoryService.getInstance().getPackage(directory);
  if (aPackage == memberPackage || aPackage != null && memberPackage != null && Comparing.strEqual(aPackage.getQualifiedName(),memberPackage.getQualifiedName())) {
    return PsiUtil.ACCESS_LEVEL_PACKAGE_LOCAL;
  }
  if (aClass != null && memberClass != null && aClass.isInheritor(memberClass,true)) {
    PsiElement resolved=element instanceof PsiReference ? ((PsiReference)element).resolve() : null;
    boolean isConstructor=resolved instanceof PsiClass && element.getParent() instanceof PsiNewExpression || resolved instanceof PsiMethod && ((PsiMethod)resolved).isConstructor();
    if (!isConstructor) {
      return PsiUtil.ACCESS_LEVEL_PROTECTED;
    }
  }
  return PsiUtil.ACCESS_LEVEL_PUBLIC;
}
