{
  ApplicationManager.getApplication().invokeLater(new Runnable(){
    @Override public void run(){
      if (documentChanged(modificationStampBefore) || myProject.isDisposed()) {
        return;
      }
      UpdateHighlightersUtil.setHighlightersToEditor(myProject,myDocument,myStartOffset,myEndOffset,highlights,getColorsScheme(),getId());
      DaemonCodeAnalyzerEx daemonCodeAnalyzer=DaemonCodeAnalyzerEx.getInstanceEx(myProject);
      daemonCodeAnalyzer.getFileStatusMap().markFileUpToDate(myDocument,getId());
    }
  }
,ModalityState.stateForComponent(myEditor.getComponent()));
}
