{
  if (myFontMetrics == null) {
    final Graphics graphics=UIUtil.createImage(1,1,BufferedImage.TYPE_INT_RGB).getGraphics();
    UISettings.setupAntialiasing(graphics);
    if (UIUtil.isRetina() && SystemInfo.isJavaVersionAtLeast("1.7.0.40")) {
      GraphicsUtil.setupFractionalMetrics(graphics);
    }
    graphics.setFont(myFont);
    myFontMetrics=graphics.getFontMetrics();
    for (int i=0; i < 128; i++) {
      charWidth[i]=myFontMetrics.charWidth(i);
    }
  }
  return myFontMetrics;
}
