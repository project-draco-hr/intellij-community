{
  super.visitComment(comment);
  final String text=comment.getText();
  Matcher matcher=ourPattern.matcher(text);
  boolean matches=false;
  if (!matcher.matches()) {
    matcher=ourPattern2.matcher(text);
    if (!matcher.matches()) {
      matcher=ourPattern3.matcher(text);
    }
 else {
      matches=true;
    }
  }
 else {
    matches=true;
  }
  if (matches || matcher.matches()) {
    String str=matcher.group(1);
    comment.putUserData(CompiledPattern.HANDLER_KEY,str);
    GlobalCompilingVisitor.setFilter(myCompilingVisitor.getContext().getPattern().getHandler(comment),CommentFilter.getInstance());
    SubstitutionHandler handler=(SubstitutionHandler)myCompilingVisitor.getContext().getPattern().getHandler(str);
    if (handler.getPredicate() != null) {
      ((RegExpPredicate)handler.getPredicate()).setMultiline(true);
    }
    RegExpPredicate predicate=MatchingHandler.getSimpleRegExpPredicate(handler);
    if (GlobalCompilingVisitor.isSuitablePredicate(predicate,handler)) {
      myCompilingVisitor.processTokenizedName(predicate.getRegExp(),true,GlobalCompilingVisitor.OccurenceKind.COMMENT);
    }
    matches=true;
  }
  if (!matches) {
    MatchingHandler handler=myCompilingVisitor.processPatternStringWithFragments(text,GlobalCompilingVisitor.OccurenceKind.COMMENT);
    if (handler != null)     comment.putUserData(CompiledPattern.HANDLER_KEY,handler);
  }
}
