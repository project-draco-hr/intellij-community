{
  if (head1.equals(head2)) {
    return 0;
  }
  Collection<VcsRef> refs1=myRefsModel.refsToHead(head1);
  Collection<VcsRef> refs2=myRefsModel.refsToHead(head2);
  boolean firstEmpty=isEmptyRefs(refs1,head1);
  boolean secondEmpty=isEmptyRefs(refs2,head2);
  if (firstEmpty && secondEmpty) {
    return head1 - head2;
  }
  if (firstEmpty) {
    return 1;
  }
  if (secondEmpty) {
    return -1;
  }
  VirtualFile root1=getFirstRoot(refs1);
  VirtualFile root2=getFirstRoot(refs2);
  VcsLogRefManager refManager1=myRefManagers.get(root1);
  VcsLogRefManager refManager2=myRefManagers.get(root2);
  if (!refManager1.equals(refManager2)) {
    return refManager1.toString().compareTo(refManager2.toString());
  }
  VcsRef bestRef=ContainerUtil.sorted(ContainerUtil.concat(refs1,refs2),refManager1.getBranchLayoutComparator()).get(0);
  if (refs1.contains(bestRef)) {
    if (refs2.contains(bestRef)) {
      LOG.error("Different heads " + myHashGetter.fun(head1) + " and "+ myHashGetter.fun(head2)+ " contain the same reference "+ bestRef);
    }
    return -1;
  }
  return 1;
}
