{
  EditorFactory editorFactory=EditorFactory.getInstance();
  Document document=editorFactory.createDocument(templateText);
  final EditorEx previewEditor=(EditorEx)editorFactory.createEditor(document,parentEditor.getProject(),fileType,true);
  final EditorSettings settings=previewEditor.getSettings();
  settings.setLineNumbersShown(false);
  settings.setAdditionalLinesCount(1);
  settings.setAdditionalColumnsCount(1);
  settings.setRightMarginShown(false);
  settings.setFoldingOutlineShown(false);
  settings.setLineMarkerAreaShown(false);
  settings.setIndentGuidesShown(false);
  settings.setVirtualSpace(false);
  settings.setWheelFontChangeEnabled(false);
  previewEditor.setCaretEnabled(false);
  previewEditor.setBorder(IdeBorderFactory.createEmptyBorder());
  EditorColorsScheme colorsScheme=previewEditor.getColorsScheme();
  colorsScheme.setColor(EditorColors.CARET_ROW_COLOR,null);
  JBPanel panel=new JBPanel(new BorderLayout()){
    @NotNull @Override public Dimension getPreferredSize(){
      Dimension size=super.getPreferredSize();
      Dimension parentEditorSize=parentEditor.getScrollPane().getSize();
      int maxWidth=(int)parentEditorSize.getWidth() / 3;
      int maxHeight=(int)parentEditorSize.getHeight() / 2;
      Dimension contentSize=previewEditor.getContentSize();
      return new Dimension(maxWidth > contentSize.getWidth() && !settings.isUseSoftWraps() ? (int)size.getWidth() : maxWidth,maxHeight > contentSize.getHeight() ? (int)size.getHeight() : maxHeight);
    }
    @NotNull @Override public Insets getInsets(){
      return new Insets(1,2,0,0);
    }
  }
;
  panel.setBackground(previewEditor.getBackgroundColor());
  panel.add(previewEditor.getComponent(),BorderLayout.CENTER);
  return new EmmetPreviewHint(panel,previewEditor,parentEditor);
}
