{
  JLayeredPane layeredPane=myParentEditor.getContentComponent().getRootPane().getLayeredPane();
  LogicalPosition logicalPosition=myParentEditor.getCaretModel().getLogicalPosition();
  LogicalPosition pos=new LogicalPosition(logicalPosition.line,logicalPosition.column);
  Point p1=HintManagerImpl.getHintPosition(this,myParentEditor,pos,HintManager.UNDER);
  Point p2=HintManagerImpl.getHintPosition(this,myParentEditor,pos,HintManager.ABOVE);
  boolean p1Ok=p1.y + getComponent().getPreferredSize().height < layeredPane.getHeight();
  boolean p2Ok=p2.y >= 0;
  if (p1Ok)   return new Pair<Point,Short>(p1,HintManager.UNDER);
  if (p2Ok)   return new Pair<Point,Short>(p2,HintManager.ABOVE);
  int underSpace=layeredPane.getHeight() - p1.y;
  int aboveSpace=p2.y;
  return aboveSpace > underSpace ? new Pair<Point,Short>(new Point(p2.x,0),HintManager.UNDER) : new Pair<Point,Short>(p1,HintManager.ABOVE);
}
