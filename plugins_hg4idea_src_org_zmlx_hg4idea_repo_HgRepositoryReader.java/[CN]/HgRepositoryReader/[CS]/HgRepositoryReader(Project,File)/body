{
  myHgDir=hgDir;
  RepositoryUtil.assertFileExists(myHgDir,".hg directory not found in " + myHgDir);
  myCacheDir=new File(myHgDir,"cache");
  File branchesFile=new File(myCacheDir,"branchheads-served");
  HgVcs vcs=HgVcs.getInstance(project);
  myBranchHeadsFile=vcs != null && vcs.getVersion().hasBranchHeadsServed() ? branchesFile : new File(myCacheDir,"branchheads");
  myCurrentBranch=new File(myHgDir,"branch");
  myBookmarksFile=new File(myHgDir,"bookmarks");
  myCurrentBookmark=new File(myHgDir,"bookmarks.current");
  myLocalTagsFile=new File(myHgDir,"localtags");
  myTagsFile=new File(myHgDir.getParentFile(),".hgtags");
  myVcsObjectsFactory=ServiceManager.getService(project,VcsLogObjectsFactory.class);
}
