{
  filePath=resolveShortWindowsName(filePath);
  final VirtualFile moduleFile=StandardFileSystems.local().findFileByPath(filePath);
  if (moduleFile == null || !moduleFile.exists()) {
    throw new FileNotFoundException(ProjectBundle.message("module.file.does.not.exist.error",filePath));
  }
  String path=moduleFile.getPath();
  ModuleEx module=getModuleByFilePath(path);
  if (module == null) {
    ApplicationManager.getApplication().invokeAndWait(new Runnable(){
      @Override public void run(){
        moduleFile.refresh(false,false);
      }
    }
,ModalityState.any());
    module=createAndLoadModule(path);
    initModule(module,path,null);
  }
  return module;
}
