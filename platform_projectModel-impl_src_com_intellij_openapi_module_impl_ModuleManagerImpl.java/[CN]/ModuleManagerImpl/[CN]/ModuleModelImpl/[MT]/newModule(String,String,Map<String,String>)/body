{
  assertWritable();
  filePath=resolveShortWindowsName(filePath);
  ModuleEx module=getModuleByFilePath(filePath);
  if (module == null) {
    module=createModule(filePath);
    module.setOption(Module.ELEMENT_TYPE_KEY,moduleTypeId);
    if (options != null) {
      for (      Map.Entry<String,String> option : options.entrySet()) {
        module.setOption(createOptionKey(option.getKey()),option.getValue());
      }
    }
    initModule(module);
  }
  return module;
}
