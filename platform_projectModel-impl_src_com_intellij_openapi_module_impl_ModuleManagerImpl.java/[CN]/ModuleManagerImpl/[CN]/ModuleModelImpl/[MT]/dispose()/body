{
  assertWritable();
  ApplicationManager.getApplication().assertWriteAccessAllowed();
  final Set<Module> set=new HashSet<Module>();
  set.addAll(myModuleModel.myModules.values());
  for (  Module thisModule : myModules.values()) {
    if (!set.contains(thisModule)) {
      Disposer.dispose(thisModule);
    }
  }
  for (  Module moduleToDispose : myModulesToDispose) {
    if (!set.contains(moduleToDispose)) {
      Disposer.dispose(moduleToDispose);
    }
  }
  clearRenamingStuff();
}
