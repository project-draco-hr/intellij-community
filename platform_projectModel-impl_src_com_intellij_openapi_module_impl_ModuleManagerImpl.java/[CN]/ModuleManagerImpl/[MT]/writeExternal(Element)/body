{
  final Module[] collection=getModules();
  List<SaveItem> sorted=new ArrayList<SaveItem>(collection.length + myFailedModulePaths.size());
  for (  Module module : collection) {
    sorted.add(new ModuleSaveItem(module));
  }
  for (  ModulePath modulePath : myFailedModulePaths) {
    sorted.add(new ModulePathSaveItem(modulePath));
  }
  if (!sorted.isEmpty()) {
    Collections.sort(sorted,new Comparator<SaveItem>(){
      @Override public int compare(      SaveItem item1,      SaveItem item2){
        return item1.getModuleName().compareTo(item2.getModuleName());
      }
    }
);
    Element modules=new Element(ELEMENT_MODULES);
    for (    SaveItem saveItem : sorted) {
      saveItem.writeExternal(modules);
    }
    element.addContent(modules);
  }
}
