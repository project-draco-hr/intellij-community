{
  Application app=ApplicationManager.getApplication();
  if (app != null && app.isUnitTestMode()) {
    if (t instanceof Error)     throw (Error)t;
    if (t instanceof RuntimeException)     throw (RuntimeException)t;
    throw new RuntimeException(t);
  }
  if (t instanceof StartupAbortedException) {
    throw (StartupAbortedException)t;
  }
  if (pluginId == null || CORE_PLUGIN_ID.equals(pluginId.getIdString())) {
    if (componentClassName != null) {
      pluginId=getPluginByClassName(componentClassName);
    }
  }
  if (pluginId == null || CORE_PLUGIN_ID.equals(pluginId.getIdString())) {
    if (t instanceof PicoPluginExtensionInitializationException) {
      pluginId=((PicoPluginExtensionInitializationException)t).getPluginId();
    }
  }
  if (pluginId != null && !CORE_PLUGIN_ID.equals(pluginId.getIdString())) {
    throw new StartupAbortedException(new PluginException(t,pluginId));
  }
 else {
    throw new StartupAbortedException("Fatal error initializing '" + componentClassName + "'",t);
  }
}
