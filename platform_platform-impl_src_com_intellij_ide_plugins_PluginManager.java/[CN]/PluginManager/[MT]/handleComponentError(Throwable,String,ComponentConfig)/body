{
  if (t instanceof StartupAbortedException) {
    throw (StartupAbortedException)t;
  }
  PluginId pluginId=config != null ? config.getPluginId() : getPluginByClassName(componentClassName);
  if (pluginId != null && !CORE_PLUGIN_ID.equals(pluginId.getIdString())) {
    getLogger().warn(t);
    disablePlugin(pluginId.getIdString());
    String message="Plugin '" + pluginId.getIdString() + "' failed to initialize and will be disabled\n"+ "(reason: "+ t.getMessage()+ ")\n\n"+ ApplicationNamesInfo.getInstance().getFullProductName()+ " will be restarted.";
    Main.showMessage("Plugin Error",message,false);
    throw new StartupAbortedException(t).exitCode(Main.PLUGIN_ERROR).logError(false);
  }
 else {
    throw new StartupAbortedException("Fatal error initializing '" + componentClassName + "'",t);
  }
}
