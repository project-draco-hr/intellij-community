{
  if (FileBasedIndex.ourEnableTracingOfKeyHashToVirtualFileMapping) {
    final THashSet<String> names=new THashSet<String>(1000);
    IdFilter filter=getFilter(project,includeNonProjectItems);
    processNames(new Processor<String>(){
      @Override public boolean process(      String s){
        names.add(s);
        return true;
      }
    }
,getScope(project,includeNonProjectItems),filter);
    if (LOG.isDebugEnabled()) {
      LOG.debug("All names retrieved2:" + names.size());
    }
    return ArrayUtil.toStringArray(names);
  }
 else {
    return FilenameIndex.getAllFilenames(project);
  }
}
