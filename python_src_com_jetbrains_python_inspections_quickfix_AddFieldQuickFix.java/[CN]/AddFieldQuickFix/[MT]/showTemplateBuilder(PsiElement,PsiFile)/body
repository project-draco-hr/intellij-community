{
  initStatement=CodeInsightUtilCore.forcePsiPostprocessAndRestoreElement(initStatement);
  if (initStatement instanceof PyAssignmentStatement) {
    final TemplateBuilder builder=TemplateBuilderFactory.getInstance().createTemplateBuilder(initStatement);
    final PyExpression assignedValue=((PyAssignmentStatement)initStatement).getAssignedValue();
    final PyExpression leftExpression=((PyAssignmentStatement)initStatement).getLeftHandSideExpression();
    if (assignedValue != null && leftExpression != null) {
      if (replaceInitializer)       builder.replaceElement(assignedValue,myInitializer);
 else       builder.replaceElement(leftExpression.getLastChild(),myIdentifier);
      final VirtualFile virtualFile=file.getVirtualFile();
      if (virtualFile == null)       return;
      final Editor editor=FileEditorManager.getInstance(file.getProject()).openTextEditor(new OpenFileDescriptor(file.getProject(),virtualFile),true);
      if (editor == null)       return;
      builder.run(editor,false);
    }
  }
}
