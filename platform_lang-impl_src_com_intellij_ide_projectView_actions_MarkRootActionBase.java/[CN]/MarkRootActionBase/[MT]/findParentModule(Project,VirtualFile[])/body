{
  if (project == null)   return null;
  Module result=null;
  DirectoryIndex index=DirectoryIndex.getInstance(project);
  for (  VirtualFile file : files) {
    Module module=index.getInfoForFile(file).getModule();
    if (module == null)     return null;
    if (result == null) {
      result=module;
    }
 else     if (!result.equals(module)) {
      return null;
    }
  }
  return result;
}
