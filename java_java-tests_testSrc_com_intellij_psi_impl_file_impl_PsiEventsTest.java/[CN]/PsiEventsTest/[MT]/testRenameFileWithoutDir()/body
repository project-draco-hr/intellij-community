{
  FileManager fileManager=myPsiManager.getFileManager();
  VirtualFile file=myPrjDir1.createChildData(null,"a.txt");
  PsiFile psiFile=fileManager.findFile(file);
  PlatformTestUtil.tryGcSoftlyReachableObjects();
  assertNull(((FileManagerImpl)fileManager).getCachedDirectory(myPrjDir1));
  EventsTestListener listener=new EventsTestListener();
  myPsiManager.addPsiTreeChangeListener(listener,getTestRootDisposable());
  file.rename(null,"b.txt");
  String string=listener.getEventsString();
  String expected="beforePropertyChange fileName\n" + "propertyChanged fileName\n";
  assertEquals(psiFile.getName(),expected,string);
}
