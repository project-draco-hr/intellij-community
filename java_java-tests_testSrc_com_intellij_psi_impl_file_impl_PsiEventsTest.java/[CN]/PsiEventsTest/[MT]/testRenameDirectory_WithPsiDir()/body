{
  FileManager fileManager=myPsiManager.getFileManager();
  VirtualFile file=createChildDirectory(myPrjDir1,"dir1");
  PsiDirectory psiDirectory=fileManager.findDirectory(file);
  EventsTestListener listener=new EventsTestListener();
  myPsiManager.addPsiTreeChangeListener(listener,getTestRootDisposable());
  rename(file,"dir2");
  String string=listener.getEventsString();
  String expected="beforePropertyChange directoryName\n" + "propertyChanged directoryName\n";
  assertEquals(psiDirectory.getName(),expected,string);
}
