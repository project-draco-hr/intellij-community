{
  final StopWatch sw=StopWatch.start("loading refs");
  final Map<VirtualFile,Collection<VcsRef>> refs=ContainerUtil.newHashMap();
  new ProviderIterator(){
    @Override void each(    @NotNull VirtualFile root,    @NotNull VcsLogProvider provider) throws VcsException {
      refs.put(root,provider.readAllRefs(root));
      sw.rootCompleted(root);
    }
  }
.iterate(providers);
  sw.report();
  return refs;
}
