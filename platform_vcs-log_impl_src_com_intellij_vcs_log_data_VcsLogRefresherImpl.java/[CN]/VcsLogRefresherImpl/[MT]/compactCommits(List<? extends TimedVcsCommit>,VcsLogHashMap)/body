{
  StopWatch sw=StopWatch.start("compacting commits");
  List<GraphCommit<Integer>> map=ContainerUtil.map(commits,new Function<TimedVcsCommit,GraphCommit<Integer>>(){
    @NotNull @Override public GraphCommit<Integer> fun(    @NotNull TimedVcsCommit commit){
      return new GraphCommitInt(hashMap.getCommitIndex(commit.getId()),ContainerUtil.map(commit.getParents(),hashMap.asIndexGetter()),commit.getTimestamp());
    }
  }
);
  hashMap.flush();
  sw.report();
  return map;
}
