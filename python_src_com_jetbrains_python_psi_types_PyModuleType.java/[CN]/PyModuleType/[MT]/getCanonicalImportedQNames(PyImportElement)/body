{
  final List<PyQualifiedName> importedQNames=new ArrayList<PyQualifiedName>();
  final PyStatement stmt=element.getContainingImportStatement();
  if (stmt instanceof PyFromImportStatement) {
    final PyFromImportStatement fromImportStatement=(PyFromImportStatement)stmt;
    final PyQualifiedName importedQName=fromImportStatement.getImportSourceQName();
    final String visibleName=element.getVisibleName();
    if (importedQName != null) {
      importedQNames.add(importedQName);
      final PyQualifiedName implicitSubModuleQName=importedQName.append(visibleName);
      if (implicitSubModuleQName != null) {
        importedQNames.add(implicitSubModuleQName);
      }
    }
  }
 else   if (stmt instanceof PyImportStatement) {
    final PyQualifiedName importedQName=element.getImportedQName();
    if (importedQName != null) {
      importedQNames.add(importedQName);
    }
  }
  if (!ResolveImportUtil.isAbsoluteImportEnabledFor(element)) {
    PsiFile file=element.getContainingFile();
    if (file != null) {
      file=file.getOriginalFile();
    }
    final PyQualifiedName absoluteQName=QualifiedNameFinder.findShortestImportableQName(file);
    if (file != null && absoluteQName != null) {
      final PyQualifiedName prefixQName=PyUtil.isPackage(file) ? absoluteQName : absoluteQName.removeLastComponent();
      if (prefixQName.getComponentCount() > 0) {
        final List<PyQualifiedName> results=new ArrayList<PyQualifiedName>();
        results.addAll(importedQNames);
        for (        PyQualifiedName qName : importedQNames) {
          final List<String> components=new ArrayList<String>();
          components.addAll(prefixQName.getComponents());
          components.addAll(qName.getComponents());
          results.add(PyQualifiedName.fromComponents(components));
        }
        return results;
      }
    }
  }
  return importedQNames;
}
