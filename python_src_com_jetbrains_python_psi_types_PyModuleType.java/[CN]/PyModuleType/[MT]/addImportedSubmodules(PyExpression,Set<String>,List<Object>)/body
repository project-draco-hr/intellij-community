{
  PsiFile file=location.getContainingFile();
  if (file instanceof PyFile) {
    PyFile pyFile=(PyFile)file;
    PsiElement moduleBase=myModule.getName().equals(PyNames.INIT_DOT_PY) ? myModule.getContainingDirectory() : myModule;
    for (    PyImportElement importElement : pyFile.getImportTargets()) {
      PsiElement target=ResolveImportUtil.resolveImportElement(importElement);
      if (target != null && PsiTreeUtil.isAncestor(moduleBase,target,true)) {
        LookupElement element=null;
        if (target instanceof PsiFileSystemItem) {
          element=buildFileLookupElement(location,names_already,(PsiFileSystemItem)target);
        }
        if (element == null && target instanceof PsiNamedElement) {
          element=LookupElementBuilder.create((PsiNamedElement)target).setIcon(target.getIcon(0));
        }
        if (element != null) {
          result.add(element);
        }
      }
    }
  }
}
