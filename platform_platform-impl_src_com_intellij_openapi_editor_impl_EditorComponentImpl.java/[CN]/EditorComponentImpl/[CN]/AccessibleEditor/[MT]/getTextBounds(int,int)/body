{
  final Point start=getEditor().offsetToXY(startIndex,true);
  final Point end=getEditor().offsetToXY(endIndex,true);
  if (start.y == end.y) {
    return new Rectangle(start,new Dimension(end.x - start.x,getEditor().getLineHeight()));
  }
  final int width=getEditor().getMaxWidthInRange(startIndex,endIndex);
  return new Rectangle(start,new Dimension(width,end.y - start.y + getEditor().getLineHeight()));
}
