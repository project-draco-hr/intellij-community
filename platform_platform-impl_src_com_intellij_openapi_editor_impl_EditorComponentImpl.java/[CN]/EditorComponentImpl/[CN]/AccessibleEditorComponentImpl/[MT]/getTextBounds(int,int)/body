{
  LogicalPosition startPos=myEditor.offsetToLogicalPosition(startIndex);
  Point startPoint=myEditor.logicalPositionToXY(startPos);
  Rectangle rectangle=new Rectangle(startPoint);
  LogicalPosition endPos=myEditor.offsetToLogicalPosition(endIndex);
  Point endPoint=myEditor.logicalPositionToXY(endPos);
  FontMetrics fontMetrics=myEditor.getFontMetrics(Font.PLAIN);
  char c=myEditor.getDocument().getCharsSequence().subSequence(endIndex - 1,endIndex).charAt(0);
  endPoint.x+=fontMetrics.charWidth(c);
  endPoint.y+=fontMetrics.getHeight();
  rectangle.add(endPoint);
  return rectangle;
}
