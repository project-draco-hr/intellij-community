{
  final Integer pos=event.getOffset();
  if (ApplicationManager.getApplication().isDispatchThread()) {
    firePropertyChange(ACCESSIBLE_TEXT_PROPERTY,null,pos);
    if (SystemInfo.isMac) {
      fireJTextComponentDocumentChange(event);
    }
  }
 else {
    ApplicationManager.getApplication().invokeLater(new Runnable(){
      @Override public void run(){
        firePropertyChange(ACCESSIBLE_TEXT_PROPERTY,null,pos);
        fireJTextComponentDocumentChange(event);
      }
    }
);
  }
}
