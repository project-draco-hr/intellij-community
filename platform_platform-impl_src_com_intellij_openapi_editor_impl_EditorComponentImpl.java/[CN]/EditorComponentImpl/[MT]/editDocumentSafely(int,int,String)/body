{
  final Project project=myEditor.getProject();
  final Document document=myEditor.getDocument();
  if (!FileDocumentManager.getInstance().requestWriting(document,project)) {
    return;
  }
  CommandProcessor.getInstance().executeCommand(project,new Runnable(){
    @Override public void run(){
      ApplicationManager.getApplication().runWriteAction(new DocumentRunnable(document,project){
        @Override public void run(){
          document.startGuardedBlockChecking();
          try {
            if (text == null) {
              document.deleteString(offset,offset + length);
            }
 else             if (length == 0) {
              document.insertString(offset,text);
            }
 else {
              document.replaceString(offset,offset + length,text);
            }
          }
 catch (          ReadOnlyFragmentModificationException e) {
            EditorActionManager.getInstance().getReadonlyFragmentModificationHandler(document).handle(e);
          }
 finally {
            document.stopGuardedBlockChecking();
          }
        }
      }
);
    }
  }
,"",document,UndoConfirmationPolicy.DEFAULT,document);
}
