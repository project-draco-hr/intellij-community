{
  List<String> escaped=new ArrayList<>();
  for (  String part : extractItemsAndAttributes(reference)) {
    if (part.startsWith(".")) {
      escaped.add(part);
    }
 else     if (part.startsWith("[")) {
      if (part.contains("\\")) {
        return null;
      }
      final String indexText=part.substring(1,part.length() - 1);
      if (indexText.matches("\\d+")) {
        escaped.add(part);
        continue;
      }
      final char quote=invertQuote(hostStringQuote);
      if (indexText.indexOf(hostStringQuote) >= 0 || indexText.indexOf(quote) >= 0) {
        return null;
      }
      escaped.add("[" + quote + indexText+ quote+ "]");
    }
  }
  return StringUtil.join(escaped,"");
}
