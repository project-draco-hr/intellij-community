{
  myLastTime=System.currentTimeMillis();
  myInitialized.set(false);
  if (event instanceof KeyEvent) {
    Component component=((KeyEvent)event).getComponent();
    if (component instanceof EditorComponentImpl) {
      EditorImpl editor=((EditorComponentImpl)component).getEditor();
      Point position=editor.visualPositionToXY(editor.getCaretModel().getVisualPosition());
      myPoint=SwingUtilities.convertPoint(component,position,this);
    }
 else {
      Point position=new Point(component.getWidth() / 2,component.getHeight() / 2);
      myPoint=SwingUtilities.convertPoint(component,position,this);
    }
  }
  if (event instanceof MouseEvent) {
    if (event.getID() == MouseEvent.MOUSE_EXITED) {
      myPoint=null;
    }
 else {
      Point point=((MouseEvent)event).getPoint();
      myPoint=SwingUtilities.convertPoint(((MouseEvent)event).getComponent(),point,this);
    }
  }
  if (myPoint != null) {
    myPoint.x=Math.min(getWidth(),Math.max(0,myPoint.x));
    myPoint.y=Math.min(getHeight(),Math.max(0,myPoint.y));
    scheduleUpdate();
  }
}
