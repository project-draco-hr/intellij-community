{
  final SVNStatus svnStatus=getFileStatus(file,true);
  if (svnStatus == null || itemExists(svnStatus) && SVNRevision.UNDEFINED.equals(svnStatus.getRemoteRevision())) {
    final SVNInfo info=myVcs.getInfo(file,SVNRevision.HEAD);
    if (info == null || info.getURL() == null) {
      LOG.info("No SVN status returned for " + file.getPath());
      return defaultResult();
    }
    return createResult(info.getCommittedRevision(),true,false);
  }
  final boolean exists=itemExists(svnStatus);
  if (!exists) {
    WorkingCopyFormat format=myVcs.getWorkingCopyFormat(file);
    long revision=-1;
    if (format.less(WorkingCopyFormat.ONE_DOT_EIGHT)) {
      if (svnStatus.getRepositoryRootURL() != null) {
        revision=new LatestExistentSearcher(myVcs,svnStatus.getURL(),svnStatus.getRepositoryRootURL()).getDeletionRevision();
      }
 else {
        LOG.info("Could not find repository url for file " + file);
      }
    }
    return createResult(SVNRevision.create(revision),exists,false);
  }
  final SVNRevision remoteRevision=svnStatus.getRemoteRevision();
  if (remoteRevision != null) {
    return createResult(remoteRevision,exists,false);
  }
  return createResult(svnStatus.getRevision(),exists,false);
}
