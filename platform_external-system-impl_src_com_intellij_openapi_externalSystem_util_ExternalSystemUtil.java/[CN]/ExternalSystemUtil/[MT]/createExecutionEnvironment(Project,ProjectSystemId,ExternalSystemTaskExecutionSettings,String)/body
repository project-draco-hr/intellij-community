{
  Executor executor=ExecutorRegistry.getInstance().getExecutorById(executorId);
  if (executor == null)   return null;
  String runnerId=getRunnerId(executorId);
  if (runnerId == null)   return null;
  ProgramRunner runner=RunnerRegistry.getInstance().findRunnerById(runnerId);
  if (runner == null)   return null;
  RunnerAndConfigurationSettings settings=createExternalSystemRunnerAndConfigurationSettings(taskSettings,project,externalSystemId);
  if (settings == null)   return null;
  return new ExecutionEnvironment(executor,runner,settings,project);
}
