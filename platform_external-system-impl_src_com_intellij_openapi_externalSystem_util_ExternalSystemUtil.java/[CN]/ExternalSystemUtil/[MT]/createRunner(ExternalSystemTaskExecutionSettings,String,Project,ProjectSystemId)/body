{
  Executor executor=ExecutorRegistry.getInstance().getExecutorById(executorId);
  if (executor == null)   return null;
  String runnerId=getRunnerId(executorId);
  if (runnerId == null)   return null;
  ProgramRunner runner=RunnerRegistry.getInstance().findRunnerById(runnerId);
  if (runner == null)   return null;
  AbstractExternalSystemTaskConfigurationType configurationType=findConfigurationType(externalSystemId);
  if (configurationType == null)   return null;
  String name=AbstractExternalSystemTaskConfigurationType.generateName(project,taskSettings);
  RunnerAndConfigurationSettings settings=RunManager.getInstance(project).createRunConfiguration(name,configurationType.getFactory());
  ExternalSystemRunConfiguration runConfiguration=(ExternalSystemRunConfiguration)settings.getConfiguration();
  runConfiguration.getSettings().setExternalProjectPath(taskSettings.getExternalProjectPath());
  runConfiguration.getSettings().setTaskNames(taskSettings.getTaskNames());
  return Pair.create(runner,new ExecutionEnvironment(executor,runner,settings,project));
}
