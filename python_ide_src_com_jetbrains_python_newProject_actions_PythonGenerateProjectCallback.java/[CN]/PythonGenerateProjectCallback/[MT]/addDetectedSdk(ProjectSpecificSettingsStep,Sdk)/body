{
  final Project project=ProjectManager.getInstance().getDefaultProject();
  final ProjectSdksModel model=PyConfigurableInterpreterList.getInstance(project).getModel();
  final String name=sdk.getName();
  VirtualFile sdkHome=ApplicationManager.getApplication().runWriteAction(new Computable<VirtualFile>(){
    @Override public VirtualFile compute(){
      return LocalFileSystem.getInstance().refreshAndFindFileByPath(name);
    }
  }
);
  PySdkService.getInstance().solidifySdk(sdk);
  sdk=SdkConfigurationUtil.createAndAddSDK(sdkHome.getPath(),PythonSdkType.getInstance());
  if (sdk != null) {
    PythonSdkUpdater.updateOrShowError(sdk,null,project,null);
  }
  model.addSdk(sdk);
  settingsStep.setSdk(sdk);
  try {
    model.apply();
  }
 catch (  ConfigurationException exception) {
    LOG.error("Error adding detected python interpreter " + exception.getMessage());
  }
}
