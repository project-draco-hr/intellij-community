{
  if (beforeRestart.length == 0)   return;
  File restartDir=new File(getRestarterDir());
  if (!FileUtilRt.createDirectory(restartDir)) {
    throw new IOException("Cannot create dir: " + restartDir);
  }
  File restarter=new File(restartDir,"restarter.sh");
  BufferedWriter output=new BufferedWriter(new FileWriter(restarter));
  try {
    output.write("#!/bin/sh\n");
    for (int i=0; i < beforeRestart.length; i++) {
      output.write(beforeRestart[i]);
      if (i <= beforeRestart.length - 2)       output.write(' ');
      if (i >= beforeRestart.length - 2)       output.write('"');
    }
    output.write('\n');
  }
  finally {
    output.close();
  }
  if (!restarter.setExecutable(true,true)) {
    throw new IOException("Cannot make file executable: " + restarter);
  }
}
