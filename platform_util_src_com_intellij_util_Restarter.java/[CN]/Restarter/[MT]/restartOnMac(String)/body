{
  final String homePath=PathManager.getHomePath().substring(0,PathManager.getHomePath().indexOf(".app") + 4);
  if (!StringUtil.endsWithIgnoreCase(homePath,".app"))   throw new IOException("Application bundle not found: " + homePath);
  doScheduleRestart(new File(PathManager.getBinPath(),"restarter"),new Consumer<List<String>>(){
    @Override public void consume(    List<String> commands){
      Collections.addAll(commands,homePath);
      Collections.addAll(commands,beforeRestart);
    }
  }
);
}
