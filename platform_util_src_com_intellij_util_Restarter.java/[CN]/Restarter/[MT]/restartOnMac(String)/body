{
  String homePath=PathManager.getHomePath();
  int p=homePath.indexOf(".app");
  if (p < 0)   throw new IOException("Application bundle not found: " + homePath);
  final String bundlePath=homePath.substring(0,p + 4);
  doScheduleRestart(new File(PathManager.getBinPath(),"restarter"),new Consumer<List<String>>(){
    @Override public void consume(    List<String> commands){
      Collections.addAll(commands,bundlePath);
      Collections.addAll(commands,beforeRestart);
    }
  }
);
}
