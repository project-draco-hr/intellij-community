{
  if (!editor.getSelectionModel().hasSelection(true)) {
    if (Registry.is(CopyAction.SKIP_COPY_AND_CUT_FOR_EMPTY_SELECTION_KEY)) {
      return;
    }
    editor.getCaretModel().runForEachCaret(new Runnable(){
      @Override public void run(){
        editor.getSelectionModel().selectLineAtCaret();
      }
    }
);
  }
  editor.getSelectionModel().copySelectionToClipboard();
  editor.getCaretModel().runForEachCaret(new Runnable(){
    @Override public void run(){
      EditorModificationUtil.deleteSelectedText(editor);
    }
  }
);
}
