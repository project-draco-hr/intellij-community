{
  final InspectionProfileImpl rootProfile=(InspectionProfileImpl)InspectionProfileManager.getInstance().getRootProfile();
  LinkedHashSet<InspectionToolWrapper> allWrappers=new LinkedHashSet<InspectionToolWrapper>();
  allWrappers.add(toolWrapper);
  rootProfile.collectDependentInspections(toolWrapper,allWrappers);
  InspectionToolWrapper[] toolWrappers=allWrappers.toArray(new InspectionToolWrapper[allWrappers.size()]);
  final InspectionProfileImpl model=InspectionProfileImpl.createSimple(toolWrapper.getDisplayName(),toolWrappers);
  try {
    Element element=new Element("toCopy");
    for (    InspectionToolWrapper wrapper : allWrappers) {
      wrapper.writeSettings(element);
      model.getInspectionTool(wrapper.getShortName(),psiElement).readSettings(element);
    }
  }
 catch (  Exception e) {
  }
  model.setEditable(toolWrapper.getDisplayName());
  final GlobalInspectionContextImpl inspectionContext=managerEx.createNewGlobalContext(false);
  inspectionContext.setExternalProfile(model);
  return inspectionContext;
}
