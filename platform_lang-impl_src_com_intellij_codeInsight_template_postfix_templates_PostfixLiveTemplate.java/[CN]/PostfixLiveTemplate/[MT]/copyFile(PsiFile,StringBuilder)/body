{
  final PsiFileFactory psiFileFactory=PsiFileFactory.getInstance(file.getProject());
  PsiFile copy=psiFileFactory.createFileFromText(file.getName(),file.getFileType(),fileContentWithoutKey);
  if (copy instanceof PsiFileImpl) {
    ((PsiFileImpl)copy).setOriginalFile(TemplateLanguageUtil.getBaseFile(file));
  }
  VirtualFile vFile=copy.getVirtualFile();
  if (vFile != null) {
    vFile.putUserData(UndoConstants.DONT_RECORD_UNDO,Boolean.TRUE);
  }
  return copy;
}
