{
  ApplicationManager.getApplication().assertIsDispatchThread();
  if (Disposer.isDisposed(disposable))   return;
  if (editor.isDisposed()) {
    Disposer.dispose(disposable);
    return;
  }
  EditorFactory.getInstance().addEditorFactoryListener(new EditorFactoryAdapter(){
    @Override public void editorReleased(    @NotNull EditorFactoryEvent event){
      if (event.getEditor() == editor) {
        Disposer.dispose(disposable);
      }
    }
  }
,disposable);
}
