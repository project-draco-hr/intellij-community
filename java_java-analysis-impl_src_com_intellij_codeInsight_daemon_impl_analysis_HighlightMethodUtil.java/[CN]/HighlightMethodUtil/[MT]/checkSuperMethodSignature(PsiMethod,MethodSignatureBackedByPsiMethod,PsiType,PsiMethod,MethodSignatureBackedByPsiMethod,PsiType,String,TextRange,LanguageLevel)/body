{
  if (superReturnType == null)   return null;
  if ("clone".equals(method.getName())) {
    final PsiClass containingClass=method.getContainingClass();
    final PsiClass superContainingClass=superMethod.getContainingClass();
    if (containingClass != null && superContainingClass != null && containingClass.isInterface() && !superContainingClass.isInterface()) {
      return null;
    }
  }
  PsiType substitutedSuperReturnType;
  final boolean isJdk15=languageLevel.isAtLeast(LanguageLevel.JDK_1_5);
  if (isJdk15 && !superMethodSignature.isRaw() && superMethodSignature.equals(methodSignature)) {
    PsiSubstitutor unifyingSubstitutor=MethodSignatureUtil.getSuperMethodSignatureSubstitutor(methodSignature,superMethodSignature);
    substitutedSuperReturnType=unifyingSubstitutor == null ? superReturnType : unifyingSubstitutor.substitute(superReturnType);
  }
 else {
    substitutedSuperReturnType=TypeConversionUtil.erasure(superMethodSignature.getSubstitutor().substitute(superReturnType));
  }
  if (returnType.equals(substitutedSuperReturnType))   return null;
  if (!(returnType instanceof PsiPrimitiveType) && substitutedSuperReturnType.getDeepComponentType() instanceof PsiClassType) {
    if (isJdk15 && TypeConversionUtil.isAssignable(substitutedSuperReturnType,returnType)) {
      return null;
    }
  }
  return createIncompatibleReturnTypeMessage(method,superMethod,substitutedSuperReturnType,returnType,detailMessage,range);
}
