{
  PsiElement psiElement=(PsiElement)this;
  PsiFile psiFile=psiElement.getContainingFile();
  if (psiFile == null || !psiFile.isValid())   return null;
  if (Registry.is("psi.deferIconLoading")) {
    Icon baseIcon=LastComputedIcon.get(psiElement,flags);
    if (baseIcon == null) {
      baseIcon=computeBaseIcon(flags);
    }
    return IconDeferrer.getInstance().defer(baseIcon,new ElementIconRequest(psiElement,psiFile.getProject(),flags),ICON_COMPUTE);
  }
  return computeIconNow(psiElement,flags);
}
