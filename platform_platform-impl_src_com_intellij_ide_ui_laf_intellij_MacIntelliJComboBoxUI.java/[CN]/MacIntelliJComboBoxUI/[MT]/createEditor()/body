{
  final ComboBoxEditor comboBoxEditor=new BasicComboBoxEditor.UIResource(){
    @Override protected JTextField createEditorComponent(){
      return new JTextField(){
{
          setOpaque(false);
        }
        public void setText(        String s){
          if (getText().equals(s)) {
            return;
          }
          super.setText(s);
        }
        public void setBorder(        Border b){
          super.setBorder(b);
        }
        @Override public Dimension getPreferredSize(){
          Dimension size=super.getPreferredSize();
          return new Dimension(size.width,COMBOBOX.getIconHeight() - 6);
        }
      }
;
    }
  }
;
  if (comboBoxEditor.getEditorComponent() != null) {
    comboBoxEditor.getEditorComponent().addKeyListener(new KeyAdapter(){
      @Override public void keyPressed(      KeyEvent e){
        process(e);
      }
      @Override public void keyReleased(      KeyEvent e){
        process(e);
      }
      private void process(      KeyEvent e){
        final int code=e.getKeyCode();
        if ((code == KeyEvent.VK_UP || code == KeyEvent.VK_DOWN) && e.getModifiers() == 0) {
          comboBox.dispatchEvent(e);
        }
      }
    }
);
    comboBoxEditor.getEditorComponent().addFocusListener(new FocusAdapter(){
      @Override public void focusGained(      FocusEvent e){
        update();
      }
      @Override public void focusLost(      FocusEvent e){
        update();
      }
      void update(){
        if (comboBox != null) {
          comboBox.revalidate();
          comboBox.repaint();
        }
      }
    }
);
  }
  return comboBoxEditor;
}
