{
  if (texts.getLocal() == null) {
    throw new DiffRequestProducerException("Can't show diff for '" + file.getPresentableUrl() + "'");
  }
  final String fullPath=file.getParent() == null ? file.getPath() : file.getParent().getPath();
  final String windowTitle="Result Of Patch Apply To " + file.getName() + " ("+ fullPath+ ")";
  final List<String> titles=ContainerUtil.list(VcsBundle.message("diff.title.local"),"Patched (with problems)");
  final DiffContentFactory contentFactory=DiffContentFactory.getInstance();
  DocumentContent localContent=contentFactory.createDocument(project,file);
  if (localContent == null)   localContent=contentFactory.create(texts.getLocal().toString(),file.getFileType());
  final DiffContent mergedContent=contentFactory.create(texts.getPatched(),file.getFileType());
  final List<DiffContent> contents=ContainerUtil.list(localContent,mergedContent);
  final DiffRequest request=new SimpleDiffRequest(windowTitle,contents,titles);
  DiffUtil.addNotification(new DiffIsApproximateNotification(),request);
  return request;
}
