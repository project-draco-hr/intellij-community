{
  myGenerator.downloadAndUnzip(true);
  Map<CourseInfo,File> downloadedCourses=myGenerator.loadCourses();
  if (downloadedCourses.isEmpty()) {
    setError(CONNECTION_ERROR);
    return;
  }
  Map<CourseInfo,File> oldCourses=myGenerator.getLoadedCourses();
  Map<CourseInfo,File> newCourses=new HashMap<CourseInfo,File>();
  for (  Map.Entry<CourseInfo,File> course : oldCourses.entrySet()) {
    File courseFile=course.getValue();
    if (courseFile.exists()) {
      newCourses.put(course.getKey(),courseFile);
    }
  }
  for (  Map.Entry<CourseInfo,File> course : downloadedCourses.entrySet()) {
    CourseInfo courseName=course.getKey();
    if (newCourses.get(courseName) == null) {
      newCourses.put(courseName,course.getValue());
    }
  }
  myCoursesComboBox.removeAllItems();
  for (  CourseInfo courseInfo : newCourses.keySet()) {
    myCoursesComboBox.addItem(courseInfo);
  }
  myGenerator.setSelectedCourse(StudyUtils.getFirst(newCourses.keySet()));
  myGenerator.setCourses(newCourses);
  myAvailableCourses=newCourses.keySet();
  myGenerator.flushCache();
}
