{
  if (toImport.isEmpty()) {
    return;
  }
  final Collection<DataNode<E>> toCreate=filterExistingModules(toImport,modelsProvider,project);
  if (!toCreate.isEmpty()) {
    createModules(toCreate,modelsProvider,project);
  }
  for (  DataNode<E> node : toImport) {
    Module module=node.getUserData(MODULE_KEY);
    if (module != null) {
      String productionModuleId=node.getData().getProductionModuleId();
      modelsProvider.setTestModuleProperties(module,productionModuleId);
      setModuleOptions(module,node);
      ModifiableRootModel modifiableRootModel=modelsProvider.getModifiableRootModel(module);
      syncPaths(module,modifiableRootModel,node.getData());
      setLanguageLevel(modifiableRootModel,node.getData());
    }
  }
  for (  DataNode<E> node : toImport) {
    Module module=node.getUserData(MODULE_KEY);
    if (module != null) {
      final String[] groupPath;
      groupPath=node.getData().getIdeModuleGroup();
      final ModifiableModuleModel modifiableModel=modelsProvider.getModifiableModuleModel();
      modifiableModel.setModuleGroupPath(module,groupPath);
    }
  }
}
