{
  myFixture.configureByText("a.java",THE_CODE);
  String key="ABC";
  int i=THE_CODE.indexOf(key);
  myFixture.getEditor().getSelectionModel().setSelection(i,i + key.length());
  myFixture.performEditorAction("Find");
  IdeEventQueue.getInstance().flushQueue();
  assertEquals(key,getEditorSearchComponent().getSearchTextComponent().getText());
  assertEquals(key,getEditorSearchComponent().getSearchTextComponent().getSelectedText());
  assertEquals(3,getEditorSearchComponent().getSearchTextComponent().getCaretPosition());
  assertTrue(getEditorSearchComponent().hasMatches());
  IdeFocusManager.findInstance().requestFocus(myFixture.getEditor().getContentComponent(),false);
  IdeEventQueue.getInstance().flushQueue();
  myFixture.performEditorAction("Find");
  IdeEventQueue.getInstance().flushQueue();
  assertEquals(key,getEditorSearchComponent().getSearchTextComponent().getText());
  assertEquals(key,getEditorSearchComponent().getSearchTextComponent().getSelectedText());
  assertEquals(key.length(),getEditorSearchComponent().getSearchTextComponent().getCaretPosition());
  getEditorSearchComponent().close();
  key="abcde";
  i=THE_CODE.indexOf(key);
  myFixture.getEditor().getSelectionModel().setSelection(i,i + key.length());
  IdeEventQueue.getInstance().flushQueue();
  myFixture.performEditorAction("Find");
  IdeEventQueue.getInstance().flushQueue();
  assertEquals(key,getEditorSearchComponent().getSearchTextComponent().getText());
  assertEquals(key,getEditorSearchComponent().getSearchTextComponent().getSelectedText());
  assertEquals(key.length(),getEditorSearchComponent().getSearchTextComponent().getCaretPosition());
}
