{
  final Project project=getProject();
  if (project.isDisposed()) {
    return;
  }
  if (Disposer.isDisposed(myParent))   return;
  PsiDocumentManager.getInstance(project).commitDocument(myDocument);
  final IpnbEditablePanel selectedCell=getSelectedCell();
  final int index=myIpnbPanels.indexOf(selectedCell);
  myInitialSelection=index >= 0 && index < myIpnbPanels.size() ? index : myIpnbPanels.size() - 1;
  readFromFile(false);
}
