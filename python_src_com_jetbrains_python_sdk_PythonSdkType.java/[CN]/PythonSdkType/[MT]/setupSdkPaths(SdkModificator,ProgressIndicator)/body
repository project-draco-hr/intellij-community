{
  String sdk_path=sdkModificator.getHomePath();
  String bin_path=getInterpreterPath(sdk_path);
  @NonNls final String stubs_path=PathManager.getSystemPath() + File.separator + SKELETON_DIR_NAME+ File.separator+ sdk_path.hashCode()+ File.separator;
  if (indicator != null) {
    indicator.setText("Adding library roots");
  }
  final List<String> paths=getSysPath(sdk_path,bin_path);
  if ((paths != null) && paths.size() > 0) {
    for (    String path : paths) {
      if (path.indexOf(File.separator) < 0)       continue;
      if (indicator != null) {
        indicator.setText2(path);
      }
      VirtualFile child=LocalFileSystem.getInstance().findFileByPath(path);
      if (child != null) {
        @NonNls String suffix=child.getExtension();
        if (suffix != null)         suffix=suffix.toLowerCase();
        if ((!child.isDirectory()) && ("zip".equals(suffix) || "egg".equals(suffix))) {
          child=JarFileSystem.getInstance().getJarRootForLocalFile(child);
        }
        if (child != null) {
          sdkModificator.addRoot(child,OrderRootType.SOURCES);
          sdkModificator.addRoot(child,OrderRootType.CLASSES);
        }
      }
 else       LOG.info("Bogus sys.path entry " + path);
    }
    if (indicator != null) {
      indicator.setText("Generating skeletons of __builtins__");
      indicator.setText2("");
    }
    generateBuiltinStubs(sdk_path,stubs_path);
    sdkModificator.addRoot(LocalFileSystem.getInstance().refreshAndFindFileByPath(stubs_path),BUILTIN_ROOT_TYPE);
  }
  if (SystemInfo.isLinux) {
    final VirtualFile file=LocalFileSystem.getInstance().findFileByPath("/usr/lib/python-django");
    if (file != null) {
      sdkModificator.addRoot(file,OrderRootType.SOURCES);
      sdkModificator.addRoot(file,OrderRootType.CLASSES);
    }
  }
  if (!new File(stubs_path).exists()) {
    generateBinaryStubs(sdk_path,stubs_path,indicator);
  }
}
