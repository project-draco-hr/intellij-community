{
  PsiCodeFragment fragment=JavaCodeFragmentFactory.getInstance(myProject).createExpressionCodeFragment("AAA.foo()",null,null,false);
  PsiClass arrayListClass=myJavaFacade.findClass("java.util.ArrayList",GlobalSearchScope.allScope(getProject()));
  PsiReference ref=fragment.findReferenceAt(0);
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      ref.bindToElement(arrayListClass);
    }
  }
);
  assertEquals("ArrayList.foo()",fragment.getText());
}
