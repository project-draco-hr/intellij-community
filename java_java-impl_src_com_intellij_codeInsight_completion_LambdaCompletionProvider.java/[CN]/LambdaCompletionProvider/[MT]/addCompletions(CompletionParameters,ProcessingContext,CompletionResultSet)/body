{
  if (!PsiUtil.isLanguageLevel8OrHigher(parameters.getOriginalFile()))   return;
  final ExpectedTypeInfo[] expectedTypes=JavaSmartCompletionContributor.getExpectedTypes(parameters);
  for (  ExpectedTypeInfo expectedType : expectedTypes) {
    final PsiType defaultType=expectedType.getDefaultType();
    if (LambdaUtil.isFunctionalType(defaultType)) {
      final PsiType functionalInterfaceType=FunctionalInterfaceParameterizationUtil.getGroundTargetType(defaultType);
      final PsiMethod method=LambdaUtil.getFunctionalInterfaceMethod(functionalInterfaceType);
      if (method != null) {
        PsiParameter[] params=method.getParameterList().getParameters();
        final Project project=method.getProject();
        final PsiElement originalPosition=parameters.getOriginalPosition();
        final JVMElementFactory jvmElementFactory=originalPosition != null ? JVMElementFactories.getFactory(originalPosition.getLanguage(),project) : null;
        if (jvmElementFactory != null) {
          final PsiSubstitutor substitutor=LambdaUtil.getSubstitutor(method,PsiUtil.resolveGenericsClassInType(functionalInterfaceType));
          final JavaCodeStyleManager codeStyleManager=JavaCodeStyleManager.getInstance(project);
          params=GenerateMembersUtil.overriddenParameters(params,jvmElementFactory,codeStyleManager,substitutor,originalPosition);
        }
        final String paramsString=params.length == 1 ? params[0].getName() : "(" + StringUtil.join(params,new Function<PsiParameter,String>(){
          @Override public String fun(          PsiParameter parameter){
            return parameter.getName();
          }
        }
,",") + ")";
        final LookupElementBuilder builder=LookupElementBuilder.create(paramsString).withPresentableText(paramsString + " -> {}").withInsertHandler(new InsertHandler<LookupElement>(){
          @Override public void handleInsert(          InsertionContext context,          LookupElement item){
            final Editor editor=context.getEditor();
            EditorModificationUtil.insertStringAtCaret(editor," -> ");
          }
        }
);
        result.addElement(builder.withAutoCompletionPolicy(AutoCompletionPolicy.NEVER_AUTOCOMPLETE));
      }
    }
  }
}
