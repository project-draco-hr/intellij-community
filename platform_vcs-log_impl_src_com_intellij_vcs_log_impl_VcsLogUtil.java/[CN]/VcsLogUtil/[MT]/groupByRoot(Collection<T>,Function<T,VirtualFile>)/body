{
  Map<VirtualFile,Set<T>> map=new TreeMap<VirtualFile,Set<T>>(new Comparator<VirtualFile>(){
    @Override public int compare(    @NotNull VirtualFile o1,    @NotNull VirtualFile o2){
      return o1.getPresentableUrl().compareTo(o2.getPresentableUrl());
    }
  }
);
  for (  T item : items) {
    VirtualFile root=rootGetter.fun(item);
    Set<T> set=map.get(root);
    if (set == null) {
      set=ContainerUtil.newHashSet();
      map.put(root,set);
    }
    set.add(item);
  }
  return map;
}
