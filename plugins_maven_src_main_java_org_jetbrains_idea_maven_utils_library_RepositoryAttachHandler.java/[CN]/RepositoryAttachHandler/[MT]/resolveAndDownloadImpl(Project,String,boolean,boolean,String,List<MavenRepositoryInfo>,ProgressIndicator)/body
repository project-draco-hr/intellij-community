{
  final SmartList<MavenExtraArtifactType> extraTypes=new SmartList<MavenExtraArtifactType>();
  if (attachSources)   extraTypes.add(MavenExtraArtifactType.SOURCES);
  if (attachJavaDoc)   extraTypes.add(MavenExtraArtifactType.DOCS);
  final Ref<List<OrderRoot>> result=Ref.create(null);
  doResolveInner(project,getMavenId(coord),extraTypes,repositories,new Processor<List<MavenArtifact>>(){
    public boolean process(    final List<MavenArtifact> artifacts){
      if (!artifacts.isEmpty()) {
        AccessToken accessToken=WriteAction.start();
        try {
          final List<OrderRoot> roots=createRoots(artifacts,copyTo);
          result.set(roots);
        }
  finally {
          accessToken.finish();
        }
      }
      return true;
    }
  }
,indicator);
  return result.get();
}
