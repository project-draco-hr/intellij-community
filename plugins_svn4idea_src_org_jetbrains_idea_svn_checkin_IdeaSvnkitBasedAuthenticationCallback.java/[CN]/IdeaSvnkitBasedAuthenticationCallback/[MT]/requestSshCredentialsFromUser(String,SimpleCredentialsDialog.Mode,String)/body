{
  String result;
  final Ref<String> answer=new Ref<String>();
  final Ref<Boolean> save=new Ref<Boolean>();
  Runnable command=new Runnable(){
    public void run(){
      SimpleCredentialsDialog dialog=new SimpleCredentialsDialog(myVcs.getProject());
      dialog.setup(mode,realm,key,true);
      dialog.setTitle(SvnBundle.message("dialog.title.authentication.required"));
      dialog.show();
      if (dialog.isOK()) {
        answer.set(dialog.getPassword());
        save.set(dialog.isSaveAllowed());
      }
    }
  }
;
  WaitForProgressToShow.runOrInvokeAndWaitAboveProgress(command);
  result=answer.get();
  if (!save.isNull() && save.get()) {
    myVcs.getSvnConfiguration().acknowledge(ISVNAuthenticationManager.SSH,realm,result);
  }
  return result;
}
