{
  String type=getComponentType(c);
  if (type == null)   return g;
  if ("frame".equals(type))   return withFrameBackground(g,c);
  if ("editor".equals(type)) {
    Editor editor=c instanceof EditorComponentImpl ? ((EditorComponentImpl)c).getEditor() : c instanceof EditorGutterComponentEx ? CommonDataKeys.EDITOR.getData((DataProvider)c) : null;
    if (editor != null) {
      if (!(g instanceof MyGraphics) && Boolean.TRUE.equals(EditorTextField.SUPPLEMENTARY_KEY.get(editor)))       return g;
      Graphics2D gg=withEditorBackground(g,c);
      if (gg instanceof MyGraphics) {
        ((MyGraphics)gg).preserved=editor.getColorsScheme().getColor(EditorColors.SELECTION_BACKGROUND_COLOR);
      }
      return gg;
    }
  }
  Graphics2D gg=withEditorBackground(g,c);
  if (gg instanceof MyGraphics) {
    Component view=c instanceof JViewport ? ((JViewport)c).getView() : c;
    ((MyGraphics)gg).preserved=view instanceof JTree ? UIUtil.getTreeSelectionBackground() : view instanceof JList ? UIUtil.getListSelectionBackground() : view instanceof JTable ? UIUtil.getTableSelectionBackground() : null;
  }
  return gg;
}
