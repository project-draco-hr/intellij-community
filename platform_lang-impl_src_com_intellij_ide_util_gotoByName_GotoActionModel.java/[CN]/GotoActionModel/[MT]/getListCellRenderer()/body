{
  return new DefaultListCellRenderer(){
    @Override public Component getListCellRendererComponent(    @NotNull final JList list,    final Object value,    final int index,    final boolean isSelected,    final boolean cellHasFocus){
      final JPanel panel=new JPanel(new BorderLayout());
      panel.setBorder(IdeBorderFactory.createEmptyBorder(2));
      panel.setOpaque(true);
      Color bg=UIUtil.getListBackground(isSelected);
      panel.setBackground(bg);
      Color groupFg=isSelected ? UIUtil.getListSelectionForeground() : UIUtil.getLabelDisabledForeground();
      if (value instanceof ActionWrapper) {
        final ActionWrapper actionWithParentGroup=(ActionWrapper)value;
        final AnAction anAction=actionWithParentGroup.getAction();
        final Presentation templatePresentation=anAction.getTemplatePresentation();
        final Icon icon=templatePresentation.getIcon();
        final Color fg=defaultActionForeground(isSelected,actionWithParentGroup.getPresentation());
        final JLabel actionLabel=createActionLabel(anAction,templatePresentation.getText(),fg,bg,icon);
        panel.add(actionLabel,BorderLayout.WEST);
        final String groupName=actionWithParentGroup.getGroupName();
        if (groupName != null) {
          final JLabel groupLabel=new JLabel(groupName);
          groupLabel.setBackground(bg);
          groupLabel.setForeground(groupFg);
          panel.add(groupLabel,BorderLayout.EAST);
        }
      }
 else       if (value instanceof OptionDescription) {
        if (!isSelected) {
          panel.setBackground(UIUtil.isUnderDarcula() ? ColorUtil.brighter(UIUtil.getListBackground(),1) : LightColors.SLIGHTLY_GRAY);
        }
        String hit=((OptionDescription)value).getHit();
        if (hit == null) {
          hit=((OptionDescription)value).getOption();
        }
        hit=StringUtil.unescapeXml(hit);
        hit=StringUtil.first(hit,50,true);
        hit=hit.replace("  "," ");
        final Color fg=UIUtil.getListForeground(isSelected);
        final JLabel label=new JLabel(hit.trim());
        label.setIcon(EMPTY_ICON);
        label.setForeground(fg);
        label.setBackground(bg);
        panel.add(label,BorderLayout.WEST);
        final JLabel settingsLabel=new JLabel(getGroupName((OptionDescription)value));
        settingsLabel.setForeground(groupFg);
        settingsLabel.setBackground(bg);
        panel.add(settingsLabel,BorderLayout.EAST);
      }
 else       if (value instanceof String) {
        final JBLabel label=new JBLabel((String)value);
        label.setIcon(EMPTY_ICON);
        panel.add(label,BorderLayout.WEST);
      }
      return panel;
    }
  }
;
}
