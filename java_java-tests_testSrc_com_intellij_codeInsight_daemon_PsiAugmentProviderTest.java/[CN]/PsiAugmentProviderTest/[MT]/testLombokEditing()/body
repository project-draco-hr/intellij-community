{
  PsiFile file=myFixture.configureByText("a.java","import lombok.val;\nclass Foo { {val o = <caret>;} }");
  PsiLocalVariable var=PsiTreeUtil.getParentOfType(file.findElementAt(myFixture.getCaretOffset()),PsiLocalVariable.class);
  assertNotNull(var);
  PsiType type1=var.getType();
  assertNotNull(type1);
  assertEquals("lombok.val",type1.getCanonicalText(false));
  myFixture.type('1');
  PsiDocumentManager.getInstance(getProject()).commitAllDocuments();
  assertTrue(var.isValid());
  PsiType type2=var.getType();
  assertNotNull(type2);
  assertEquals(PsiType.INT.getCanonicalText(false),type2.getCanonicalText(false));
}
