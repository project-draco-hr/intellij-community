{
  final String testId=getTestId(eventXml);
  final String startTime=eventXml.queryXml("/ijLog/event/test/result/@startTime");
  final String endTime=eventXml.queryXml("/ijLog/event/test/result/@endTime");
  final String exceptionMsg=eventXml.queryXml("/ijLog/event/test/result/errorMsg");
  final String stackTrace=eventXml.queryXml("/ijLog/event/test/result/stackTrace");
  final SMTestProxy testProxy=getConsoleManager().getTestsMap().get(testId);
  if (testProxy == null)   return;
  try {
    testProxy.setDuration(Long.valueOf(endTime) - Long.valueOf(startTime));
  }
 catch (  NumberFormatException ignored) {
  }
  final TestEventResult result=getTestEventResultType(eventXml);
switch (result) {
case SUCCESS:
    testProxy.setFinished();
  addToInvokeLater(new Runnable(){
    @Override public void run(){
      getResultsViewer().onTestFinished(testProxy);
    }
  }
);
break;
case FAILURE:
final String failureType=eventXml.queryXml("/ijLog/event/test/result/failureType");
if ("comparison".equals(failureType)) {
String actualText=eventXml.queryXml("/ijLog/event/test/result/actual");
String expectedText=eventXml.queryXml("/ijLog/event/test/result/expected");
testProxy.setTestComparisonFailed(exceptionMsg,stackTrace,actualText,expectedText);
}
 else {
Pair<String,String> comparisonPair=parseComparisonMessage(exceptionMsg,"\nExpected: is \"(.*)\"\n\\s*got: \"(.*)\"\n");
if (comparisonPair == null) {
comparisonPair=parseComparisonMessage(exceptionMsg,"\nExpected: is \"(.*)\"\n\\s*but: was \"(.*)\"");
}
if (comparisonPair == null) {
comparisonPair=parseComparisonMessage(exceptionMsg,"\nExpected: (.*)\n\\s*got: (.*)");
}
if (comparisonPair == null) {
comparisonPair=parseComparisonMessage(exceptionMsg,"\\s*expected same:<(.*)> was not:<(.*)>");
}
if (comparisonPair == null) {
comparisonPair=parseComparisonMessage(exceptionMsg,".*\\s*expected:<(.*)> but was:<(.*)>");
}
if (comparisonPair == null) {
comparisonPair=parseComparisonMessage(exceptionMsg,"\nExpected: \"(.*)\"\n\\s*but: was \"(.*)\"");
}
if (comparisonPair != null) {
testProxy.setTestComparisonFailed(exceptionMsg,stackTrace,comparisonPair.second,comparisonPair.first);
}
 else {
testProxy.setTestFailed(exceptionMsg,stackTrace,"error".equals(failureType));
}
}
addToInvokeLater(new Runnable(){
@Override public void run(){
getResultsViewer().onTestFailed(testProxy);
}
}
);
break;
case SKIPPED:
testProxy.setTestIgnored(null,null);
addToInvokeLater(new Runnable(){
@Override public void run(){
getResultsViewer().onTestIgnored(testProxy);
}
}
);
break;
case UNKNOWN_RESULT:
break;
}
}
