{
  File targetDir=IoTestUtil.createTestDir(myTempDirectory,"failed_delete");
  File file=IoTestUtil.createTestFile(targetDir,"file");
  @SuppressWarnings("IOResourceOpenedButNotSafelyClosed") RandomAccessFile rw=new RandomAccessFile(file,"rw");
  FileLock lock=null;
  try {
    lock=rw.getChannel().tryLock();
    assertFalse(FileUtil.delete(file));
  }
  finally {
    if (lock != null) {
      lock.release();
    }
    rw.close();
  }
}
