{
  SchemeExporter<CodeStyleScheme> exporter=SchemeExporterEP.getExporter(exporterName,CodeStyleScheme.class);
  if (exporter != null) {
    String ext=exporter.getExtension();
    FileSaverDialog saver=FileChooserFactory.getInstance().createSaveFileDialog(new FileSaverDescriptor(ApplicationBundle.message("code.style.scheme.exporter.ui.file.chooser.title"),ApplicationBundle.message("code.style.scheme.exporter.ui.file.chooser.message"),ext),myParentComponent);
    VirtualFileWrapper target=saver.save(null,getFileNameSuggestion() + "." + ext);
    if (target != null) {
      VirtualFile targetFile=target.getVirtualFile(true);
      if (targetFile != null) {
        try {
          exporter.exportScheme(myScheme,targetFile);
          myStatusCallback.showMessage(ApplicationBundle.message("code.style.scheme.exporter.ui.code.style.exported.message",myScheme.getName(),targetFile.getPresentableUrl()),MessageType.INFO);
        }
 catch (        SchemeExporterException e) {
          myStatusCallback.showMessage(e.getMessage(),MessageType.ERROR);
        }
      }
 else {
        myStatusCallback.showMessage(ApplicationBundle.message("code.style.scheme.exporter.ui.cannot.write.message"),MessageType.ERROR);
      }
    }
  }
}
