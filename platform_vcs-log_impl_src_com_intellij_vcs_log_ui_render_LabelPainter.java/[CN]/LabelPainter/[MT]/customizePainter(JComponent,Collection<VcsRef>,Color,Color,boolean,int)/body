{
  myBackground=background;
  myForeground=foreground;
  FontMetrics metrics=component.getFontMetrics(getReferenceFont());
  myHeight=metrics.getHeight() + TOP_TEXT_PADDING + BOTTOM_TEXT_PADDING;
  VcsLogRefManager manager=ReferencePainter.getRefManager(myLogData,references);
  List<RefGroup> refGroups=manager == null ? ContainerUtil.emptyList() : manager.groupForTable(references);
  myGreyBackground=calculateGreyBackground(refGroups,background,isSelected);
  Pair<List<Pair<String,LabelIcon>>,Integer> presentation=calculatePresentation(refGroups,metrics,myHeight,myGreyBackground != null ? myGreyBackground : myBackground,false);
  if (presentation.second > availableWidth) {
    presentation=calculatePresentation(refGroups,metrics,myHeight,myGreyBackground != null ? myGreyBackground : myBackground,true);
  }
  myLabels=presentation.first;
  myWidth=presentation.second;
}
