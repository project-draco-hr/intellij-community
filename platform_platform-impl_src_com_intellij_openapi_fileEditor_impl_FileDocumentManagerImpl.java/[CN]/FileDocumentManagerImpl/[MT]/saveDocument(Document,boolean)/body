{
  ApplicationManager.getApplication().assertIsDispatchThread();
  if (!((TransactionGuardImpl)TransactionGuard.getInstance()).isWriteActionAllowed()) {
    LOG.error("Write access is not allowed in this context, see TransactionGuard documentation for details");
  }
  if (!myUnsavedDocuments.contains(document))   return;
  try {
    doSaveDocument(document,explicit);
  }
 catch (  IOException e) {
    handleErrorsOnSave(Collections.singletonMap(document,e));
  }
catch (  SaveVetoException ignored) {
  }
}
