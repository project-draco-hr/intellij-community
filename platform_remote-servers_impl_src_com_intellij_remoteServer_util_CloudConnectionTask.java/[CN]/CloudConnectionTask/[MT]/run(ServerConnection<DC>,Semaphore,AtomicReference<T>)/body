{
  connection.connectIfNeeded(new ServerConnector.ConnectionCallback<DC>(){
    @Override public void connected(    @NotNull ServerRuntimeInstance<DC> serverRuntimeInstance){
      try {
        run((SR)serverRuntimeInstance,semaphore,result);
      }
  finally {
        ApplicationManager.getApplication().invokeLater(new Runnable(){
          @Override public void run(){
            connection.disconnect();
          }
        }
);
      }
    }
    @Override public void errorOccurred(    @NotNull String errorMessage){
      runtimeErrorOccurred(errorMessage);
      semaphore.up();
    }
  }
);
}
