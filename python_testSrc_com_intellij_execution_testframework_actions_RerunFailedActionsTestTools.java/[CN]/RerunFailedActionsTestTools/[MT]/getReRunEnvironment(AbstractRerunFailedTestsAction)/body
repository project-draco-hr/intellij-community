{
  final MyRunProfile profile=runAction.getRunProfile(new ExecutionEnvironment());
  if (profile == null) {
    return null;
  }
  final Ref<ExecutionEnvironment> stateRef=new Ref<ExecutionEnvironment>();
  UsefulTestCase.edt(new Runnable(){
    @Override public void run(){
      stateRef.set(ExecutionEnvironmentBuilder.create(DefaultRunExecutor.getRunExecutorInstance(),profile).build());
    }
  }
);
  return stateRef.get();
}
