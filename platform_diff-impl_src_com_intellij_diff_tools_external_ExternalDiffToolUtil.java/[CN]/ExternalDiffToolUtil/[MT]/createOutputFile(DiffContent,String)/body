{
  if (content instanceof FileContent) {
    FileContent fileContent=(FileContent)content;
    if (fileContent.getFile().isInLocalFileSystem()) {
      return new LocalOutputFile(fileContent.getFile());
    }
    String tempFileName=getFileName(null,windowTitle,content.getContentType());
    File tempFile=createTempFile(fileContent.getFile(),tempFileName);
    return new NonLocalOutputFile(fileContent.getFile(),tempFile);
  }
 else   if (content instanceof DocumentContent) {
    String tempFileName=getFileName(null,windowTitle,content.getContentType());
    File tempFile=createTempFile(((DocumentContent)content),tempFileName);
    return new DocumentOutputFile(((DocumentContent)content).getDocument(),((DocumentContent)content).getCharset(),tempFile);
  }
  throw new IllegalArgumentException(content.toString());
}
