{
  do {
    if (forward) {
      element=PsiTreeUtil.nextLeaf(element);
    }
 else {
      element=PsiTreeUtil.prevLeaf(element);
    }
  }
 while (element != null && element.getNode() != null && set.contains(element.getNode().getElementType()));
  return element;
}
