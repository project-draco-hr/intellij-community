{
  if (method instanceof GrLightMethodBuilder) {
    ((GrLightMethodBuilder)method).setContainingClass(myCodeClass);
  }
 else   if (method instanceof LightMethodBuilder) {
    ((LightMethodBuilder)method).setContainingClass(myCodeClass);
  }
  MethodSignature signature=method.getSignature(PsiSubstitutor.EMPTY);
  Set<MethodSignature> signatures=mySignaturesCache.get(method.getName());
  if (signatures.add(signature)) {
    if (prepend) {
      myMethods.addFirst(method);
    }
 else {
      myMethods.addLast(method);
    }
  }
}
