{
  myProgressCallback=callback;
  myDefaultIndentOption=options.myIndentOptions;
  mySettings=options.mySettings;
  myDocument=model.getDocument();
  myReformatContext=options.myReformatContext;
  InitialInfoBuilder builder=prepareToBuildBlocksSequentially(block,model,options,mySettings,myDefaultIndentOption,myProgressCallback);
  myStateProcessor=new StateProcessor(new WrapBlocksState(model,builder));
  myRightMargin=getRightMargin(block);
}
