{
  myProgressCallback=callback;
  myDefaultIndentOption=options.myIndentOptions;
  mySettings=options.mySettings;
  myBlockIndentOptions=new BlockIndentOptions(mySettings,myDefaultIndentOption,block);
  myDocument=model.getDocument();
  myReformatContext=options.myReformatContext;
  final InitialInfoBuilder builder=prepareToBuildBlocksSequentially(block,model,options,mySettings,myDefaultIndentOption,myProgressCallback);
  myWrapState=new WrapBlocksState(builder,myBlockIndentOptions);
  myStateProcessor=new StateProcessor(myWrapState);
}
