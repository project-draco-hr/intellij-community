{
  myJdkHome=IdeaTestUtil.requireRealJdkHome();
  super.setUp();
  assumeThat(gradleVersion,versionMatcherRule.getMatcher());
  new WriteAction(){
    @Override protected void run(    @NotNull Result result) throws Throwable {
      Sdk oldJdk=ProjectJdkTable.getInstance().findJdk(GRADLE_JDK_NAME);
      if (oldJdk != null) {
        ProjectJdkTable.getInstance().removeJdk(oldJdk);
      }
      VirtualFile jdkHomeDir=LocalFileSystem.getInstance().refreshAndFindFileByIoFile(new File(myJdkHome));
      Sdk jdk=SdkConfigurationUtil.setupSdk(new Sdk[0],jdkHomeDir,JavaSdk.getInstance(),true,null,GRADLE_JDK_NAME);
      assertNotNull("Cannot create JDK for " + myJdkHome,jdk);
      ProjectJdkTable.getInstance().addJdk(jdk);
    }
  }
.execute();
  myProjectSettings=new GradleProjectSettings();
  GradleSettings.getInstance(myProject).setGradleVmOptions("-Xmx128m -XX:MaxPermSize=64m");
  System.setProperty(ExternalSystemExecutionSettings.REMOTE_PROCESS_IDLE_TTL_IN_MS_KEY,String.valueOf(GRADLE_DAEMON_TTL_MS));
  configureWrapper();
}
