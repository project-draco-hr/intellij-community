{
  for (  BeforeCommitDialogHandler handler : BeforeCommitDialogHandler.EP_NAME.getExtensions()) {
    if (!handler.beforeCommitDialogShownCallback(project,changes,executors,showVcsCommit)) {
      return false;
    }
  }
  final ChangeListManager manager=ChangeListManager.getInstance(project);
  final LocalChangeList defaultList=manager.getDefaultChangeList();
  final ArrayList<LocalChangeList> changeLists=new ArrayList<LocalChangeList>(manager.getChangeListsCopy());
  CommitChangeListDialog dialog=new CommitChangeListDialog(project,changes,initialSelection,executors,showVcsCommit,defaultList,changeLists,null,false,comment,customResultHandler);
  if (!ApplicationManager.getApplication().isUnitTestMode()) {
    dialog.show();
  }
 else {
    dialog.doOKAction();
  }
  return dialog.isOK();
}
