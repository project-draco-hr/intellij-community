{
  if (visited.contains(type)) {
    return;
  }
  visited.add(type);
  if (type instanceof PyGenericType) {
    collected.add((PyGenericType)type);
  }
 else   if (type instanceof PyUnionType) {
    final PyUnionType union=(PyUnionType)type;
    for (    PyType t : union.getMembers()) {
      collectGenerics(t,context,collected,visited);
    }
  }
 else   if (type instanceof PyTupleType) {
    final PyTupleType tuple=(PyTupleType)type;
    final int n=tuple.isHomogeneous() ? 1 : tuple.getElementCount();
    for (int i=0; i < n; i++) {
      collectGenerics(tuple.getElementType(i),context,collected,visited);
    }
  }
 else   if (type instanceof PyCollectionType) {
    final PyCollectionType collection=(PyCollectionType)type;
    for (    PyType elementType : collection.getElementTypes(context)) {
      collectGenerics(elementType,context,collected,visited);
    }
  }
 else   if (type instanceof PyCallableType) {
    final PyCallableType callable=(PyCallableType)type;
    final List<PyCallableParameter> parameters=callable.getParameters(context);
    if (parameters != null) {
      for (      PyCallableParameter parameter : parameters) {
        if (parameter != null) {
          collectGenerics(parameter.getType(context),context,collected,visited);
        }
      }
    }
    collectGenerics(callable.getReturnType(context),context,collected,visited);
  }
}
