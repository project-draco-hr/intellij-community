{
  final Executor executor=DefaultRunExecutor.getRunExecutorInstance();
  final String executorId=executor.getId();
  ExecutionEnvironmentBuilder builder=ExecutionEnvironmentBuilder.createOrNull(executor,settings);
  if (builder == null) {
    return false;
  }
  ExecutionTarget compatibleTarget=getCompatibleTarget(env,settings);
  if (compatibleTarget == null) {
    return false;
  }
  final ExecutionEnvironment environment=builder.target(compatibleTarget).build();
  environment.setExecutionId(env.getExecutionId());
  if (!environment.getRunner().canRun(executorId,environment.getRunProfile())) {
    return false;
  }
 else {
    beforeRun(environment);
    return doRunTask(executorId,environment,environment.getRunner());
  }
}
