{
  final File file=new File(path);
  if (myFileSystem != null) {
    final int flags=(Integer)myGetBooleanAttributes.invoke(myFileSystem,file);
    if (flags != 0) {
      boolean isDirectory=isSet(flags,BA_DIRECTORY);
      boolean isSpecial=!isSet(flags,BA_REGULAR) && !isSet(flags,BA_DIRECTORY);
      boolean isHidden=isSet(flags,BA_HIDDEN) && !isWindowsRoot(path);
      boolean isWritable=SystemInfo.isWindows && isDirectory || file.canWrite();
      return new FileAttributes(isDirectory,isSpecial,false,isHidden,file.length(),file.lastModified(),isWritable);
    }
  }
 else   if (file.exists()) {
    boolean isDirectory=file.isDirectory();
    boolean isSpecial=!isDirectory && !file.isFile();
    boolean isHidden=file.isHidden() && !isWindowsRoot(path);
    boolean isWritable=SystemInfo.isWindows && isDirectory || file.canWrite();
    return new FileAttributes(isDirectory,isSpecial,false,isHidden,file.length(),file.lastModified(),isWritable);
  }
  return null;
}
