{
  final String currentValue=editor.getDocument().getText();
  final String currentSelectedProperty=propertyName == null ? getSelectedPropertyName() : propertyName;
  if (currentSelectedProperty == null) {
    return;
  }
  ApplicationManager.getApplication().runWriteAction(new Runnable(){
    @Override public void run(){
      WriteCommandAction.runWriteCommandAction(myProject,new Runnable(){
        @Override public void run(){
          final IProperty property=propertiesFile.findPropertyByKey(currentSelectedProperty);
          try {
            if (property == null) {
              myPropertiesInsertDeleteManager.insertTranslation(currentSelectedProperty,currentValue,propertiesFile);
            }
 else {
              property.setValue(currentValue);
            }
          }
 catch (          final IncorrectOperationException e) {
            LOG.error(e);
          }
        }
      }
);
    }
  }
);
}
