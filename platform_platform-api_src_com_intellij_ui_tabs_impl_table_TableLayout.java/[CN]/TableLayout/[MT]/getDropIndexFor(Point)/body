{
  if (myLastTableLayout == null)   return -1;
  int result=-1;
  Component c=myTabs.getComponentAt(point);
  if (c instanceof JBTabsImpl) {
    for (int i=0; i < myLastTableLayout.myVisibleInfos.size() - 1; i++) {
      TabLabel first=myTabs.myInfo2Label.get(myLastTableLayout.myVisibleInfos.get(i));
      TabLabel second=myTabs.myInfo2Label.get(myLastTableLayout.myVisibleInfos.get(i + 1));
      Rectangle firstBounds=first.getBounds();
      Rectangle secondBounds=second.getBounds();
      final boolean between=firstBounds.getMaxX() < point.x && secondBounds.getX() > point.x && firstBounds.y < point.y && secondBounds.getMaxY() > point.y;
      if (between) {
        c=first;
        break;
      }
    }
  }
  if (c instanceof TabLabel) {
    TabInfo info=((TabLabel)c).getInfo();
    int index=myLastTableLayout.myVisibleInfos.indexOf(info);
    boolean isDropTarget=myTabs.isDropTarget(info);
    if (!isDropTarget) {
      for (int i=0; i <= index; i++) {
        if (myTabs.isDropTarget(myLastTableLayout.myVisibleInfos.get(i))) {
          index-=1;
          break;
        }
      }
      result=index;
    }
 else     if (index < myLastTableLayout.myVisibleInfos.size()) {
      result=index;
    }
  }
  return result;
}
