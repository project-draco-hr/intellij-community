{
  super(project,settings,true,content);
  VirtualFile[] files=FileEditorManager.getInstance(project).getSelectedFiles();
  setFile(files.length == 0 ? null : PsiManager.getInstance(myProject).findFile(files[0]));
  project.getMessageBus().connect(this).subscribe(FileEditorManagerListener.FILE_EDITOR_MANAGER,new FileEditorManagerAdapter(){
    @Override public void selectionChanged(    @NotNull FileEditorManagerEvent e){
      VirtualFile file=e.getNewFile();
      final PsiFile psiFile=file != null && file.isValid() ? PsiManager.getInstance(myProject).findFile(file) : null;
      DumbService.getInstance(myProject).smartInvokeLater(new Runnable(){
        @Override public void run(){
          setFile(psiFile);
        }
      }
);
    }
  }
);
}
